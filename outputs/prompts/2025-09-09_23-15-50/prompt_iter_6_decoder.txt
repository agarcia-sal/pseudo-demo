Translate the following pseudocode into fully functional, clean, and optimized Python code, preserving the exact function names and signatures as given. Enclose the entire solution within a single Python code block starting with ```python and ending with ```. Your implementation must be self-contained and runnable as-is, without relying on any external scaffolding or undefined references (e.g., do not assume classes like `Solution` exist unless explicitly stated). Import any standard Python libraries if needed to enhance clarity or performance. Prioritize correctness, clarity, and efficiency, ensuring the code executes within 5 seconds on typical inputs. Do not output any explanation, comments, or text outside the code block. Here is the pseudocode: