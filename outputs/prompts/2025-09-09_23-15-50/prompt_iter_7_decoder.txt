Translate the given pseudocode into complete, clean, and highly efficient Python code that is ready to run immediately. Your code must define the function(s) exactly as named in the pseudocode, preserving all signatures. Enclose *only* the entire solution within a single fenced Python code block (```python ... ```). Do not add any explanations, comments, test scaffolding, or text outside this code block. Your implementation must be self-contained and must not refer to any undefined classes or wrappers (e.g., do not use or assume any external `Solution` class unless explicitly specified in the pseudocode). You may import any standard or widely used Python libraries that improve clarity or efficiency. Optimize for correct, maintainable, and performant code that runs within 5 seconds on typical inputs. Here is the pseudocode: