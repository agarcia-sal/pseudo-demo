Translate the given pseudocode into complete, clean, and idiomatic Python code that exactly implements the described logic with all variable and function names preserved as stated. Your code must be fully self-contained and runnable, including any necessary helper classes or imports implied by the pseudocode. Focus on correctness, edge-case completeness, readability, and maximal efficiency under a 5-second runtime constraint. Do not add explanatory comments or extraneous text. Use any standard Python libraries or built-ins only if they directly improve correctness or conciseness without changing the algorithmic intent.  
Enclose the entire solution in a single Python code block marked with ```python```.  
Output only the code block and nothing else.