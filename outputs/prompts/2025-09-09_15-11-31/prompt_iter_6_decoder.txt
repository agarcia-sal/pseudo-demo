Translate the given pseudocode into fully functional, well-structured Python code by directly implementing its logic step-by-step. Maintain exact variable names, control flow, and function names as described in the pseudocode to ensure functional equivalence. Enclose your entire output in one Python code block marked with ```python```. Prioritize clarity, correctness, and efficient runtime within 5 seconds. Use native Python libraries only if they clearly simplify and optimize the solution without changing the original algorithmic intent. Do not add explanations, comments, or any text outside the code block. If data structures or helper classes are implied in the pseudocode, define them exactly as needed. Ensure the code is production-ready and handles edge cases implicitly suggested by the pseudocode.