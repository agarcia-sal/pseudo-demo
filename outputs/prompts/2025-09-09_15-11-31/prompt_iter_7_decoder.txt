Translate the provided pseudocode into clean, production-quality Python code that faithfully implements the described logic with exact variable and function names preserved. Your solution must handle all details implied by the pseudocode, including data structures and helper classes, without adding extraneous comments or explanations. Prioritize correctness, readability, and optimal efficiency within the 5-second execution constraint. Use any standard Python libraries or packages only if they enhance clarity or performance *without altering* the original algorithmic approach. Enclose the entire code output in a single Python code block marked with ```python```. Avoid any text outside the code block. Ensure the final code is complete, syntactically correct, and ready to run in isolation, implicitly addressing any edge cases suggested by the pseudocode.