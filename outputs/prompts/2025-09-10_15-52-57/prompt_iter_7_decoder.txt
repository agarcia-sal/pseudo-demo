Translate the given pseudocode into a single, clean, and efficient Python function, strictly preserving the function name and parameters as implied or stated by the pseudocode. Do not wrap your code in any class or add extraneous text—submit only the functional code inside one Python markdown code block, formatted exactly as:

```python
# your fully functional solution here
```

Guidelines to maximize correctness and performance:
- Use standard Python libraries and language features; you may also use any Python package if it genuinely improves clarity or efficiency.
- Ensure the function is fully self-contained with clearly defined input and output matching the problem context.
- Optimize for readability, correctness, and runtime performance within a 5-second execution limit.
- Maintain faithful adherence to the pseudocode's logic and control flow, without adding or removing conceptual steps.
- Use idiomatic, concise Python that handles edge cases and large inputs efficiently.
- Do not include any test code, print statements, comments, or explanations inside the code block—only code.

This ensures your submission is directly executable in isolation, free from naming or namespace issues, and maximizes the chance of passing all evaluation criteria accurately and efficiently.