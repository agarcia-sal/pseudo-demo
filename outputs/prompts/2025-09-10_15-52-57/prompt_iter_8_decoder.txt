Translate the provided pseudocode into a single, fully self-contained, idiomatic, and highly efficient Python function. The function name and parameters must exactly match those implied or explicitly specified by the pseudocode.  

Your submission must adhere strictly to the following requirements:  
- Produce only the function implementation enclosed in a single Python markdown code block formatted exactly as:  
```python
# your solution here
```  
- Do not include any classes, extra functions, test code, print/debug statements, comments, or explanations inside the code block—only the final code of the function.  
- Use only standard Python libraries or well-known, widely available packages if they meaningfully improve code clarity or runtime efficiency.  
- Ensure the function correctly implements the exact logic and control flow of the pseudocode without omitting or adding conceptual steps.  
- Handle all relevant edge cases and optimize for readability and performance to complete within a 5-second runtime limit, even on large inputs.  
- Input/output behavior must directly reflect what the pseudocode intends: inputs as arguments, and outputs as the function’s return value.  
- Use modern, idiomatic Python constructs and concise expressions where appropriate without sacrificing clarity or correctness.

This approach ensures that your submission is immediately runnable and integratable, minimizing namespace or environment issues, and maximizing correctness and performance on all evaluation cases.