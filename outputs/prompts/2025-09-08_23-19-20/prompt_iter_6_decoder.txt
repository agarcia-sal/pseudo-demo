Translate the given pseudocode into fully functional, clean, and Pythonic code that faithfully preserves all function names and logic from the pseudocode. Optimize your solution for clarity, efficiency, and robustness, leveraging Python’s standard library and built-in features as appropriate. Your code must run within 5 seconds for typical inputs.  
Do not include explanatory comments, debug statements, or separator lines—only provide the minimal, correct implementation.  
Enclose **only** the resulting code in a Python code block as shown below:

```python
# Your translated code here
```