Translate the given pseudocode into concise, efficient, and idiomatic Python code that exactly matches all function names and logic from the pseudocode. Your implementation must be robust, leverage appropriate Python standard libraries or built-in features, and be optimized for performance to reliably run within 5 seconds on typical inputs. Preserve all original behaviors and edge cases without adding explanation, comments, or debugging output.  

Use clear and readable Python constructs, applying advanced or built-in idioms when suitable, but avoid unnecessary complexity. Import any standard libraries/packages if needed.  

Provide only the final, minimal, correct implementation enclosed strictly within a Python code block as shown:  

```python
# Your translated code here
```