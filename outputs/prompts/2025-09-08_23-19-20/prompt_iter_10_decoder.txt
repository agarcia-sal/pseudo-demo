Translate the provided pseudocode into clean, idiomatic, and optimized Python code that strictly retains all original function names, parameters, and control flow structures as given.  
Leverage Python 3's full standard library and built-in functions for maximum clarity, efficiency, and correctness.  
Avoid any unneeded comments, debug statements, extraneous whitespace, or formatting—output only the minimal, fully functional implementation.  
If multiple functions are defined, include all completely and correctly.  
Ensure the code executes within 5 seconds on typical inputs and preserves exact logic without simplification that changes behavior.  
You may assume input types and formatting align precisely with the pseudocode’s intent.  
Do not insert separator lines or additional text outside the code block.  
Enclose your entire final solution strictly within a single Python code block formatted as follows:

```python
# Your translated code here
```