Translate the given pseudocode into clean, idiomatic, and optimal Python 3 code that preserves **all original function names, parameters, and control flow exactly** as described.  
Use Pythonâ€™s full standard library and built-ins wherever they improve clarity, efficiency, or correctness.  
Produce **only the minimal working solution** with no extra comments, print statements, debug info, or unnecessary whitespace.  
If multiple functions appear, implement all completely and correctly in the single output block.  
Assume input data types and formats exactly as implied by the pseudocode without additional validation.  
Ensure the output Python code runs efficiently within 5 seconds for typical inputs and strictly matches the pseudocode logic (no behavior changes or simplifications that alter results).  
Do not include any explanation, text, or separators outside the code block.  
Wrap your entire final solution **only** within one Python code block formatted precisely as:  

```python
# Your translated code here
```