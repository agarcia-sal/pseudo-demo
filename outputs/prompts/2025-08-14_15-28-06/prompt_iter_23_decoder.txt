Translate the given pseudocode into clear, idiomatic, and efficient Python 3 code that precisely replicates the input/output behavior described. Your translation must:

- Use only `input()` with no prompt strings for all input operations.
- Produce exactly the output specified—no extra prints, debugging, comments, or explanations outside the code block.
- Use meaningful variable names inspired by the pseudocode, prioritizing readability and clarity.
- Ensure correctness and handle all edge cases robustly, with code optimized to run well within a 5-second time limit under typical competitive programming constraints.
- Exploit Python’s standard libraries and built-ins (e.g., `collections`, `heapq`, `itertools`, `math`, `re`, `sys`, `os`, etc.) judiciously to improve performance, clarity, or simplicity.
- Write concise code avoiding superfluous comments; only add minimal clarifications for any complex logic when absolutely necessary.
- Contain the entire solution inside a single Python fenced code block as shown:

```python
# your translated code here
```

**Do not include anything outside the code block.**  
Optimize for correctness, idiomatic style, and execution speed within the constraints.