Translate the following pseudocode into clean, idiomatic, and efficient Python 3 code that strictly follows the input/output behavior implied by the pseudocode. Your translation must:

- Use only `input()` without any prompt strings for all input operations.
- Produce **exactly** the outputs required by the pseudocode, with no extraneous prints, comments, or explanations.
- Handle all edge cases correctly and ensure the code runs within a 5-second time limit for typical competitive programming constraints.
- Write concise, readable code with meaningful variable names directly inspired by the pseudocode.
- Utilize Pythonâ€™s standard library and built-in functions (including modules like `collections`, `heapq`, `math`, `itertools`, `re`, `os`, `sys`, etc.) where they improve correctness, clarity, or efficiency.
- Avoid unnecessary comments; add only minimal clarifications for nontrivial logic if absolutely needed.
- Include all code inside a single fenced Python code block exactly as shown below:

```python
# your translated code here
```

**Do not include anything outside the code block.**  
Prioritize correctness, idiomatic style, and optimal performance under the given constraints.