Translate the provided pseudocode into a complete, executable Python function with an identical name and signature as implied or explicitly stated in the pseudocode. Your solution must be fully self-contained, including all necessary imports, without relying on any predefined classes, wrappers, or external context unless explicitly defined in the pseudocode. Implement all logic faithfully and efficiently, ensuring the code executes correctly within 5 seconds on typical inputs. Preserve all original variable and function names exactly as given. Output only the final code enclosed within a single Python code block formatted as follows:

```python
# Your complete Python code here
```

Do not include any additional explanations, comments beyond brief inline notes clarifying complex logic, or textual annotations. You may use any standard or widely available Python libraries as needed to maximize correctness and performance. Avoid adding placeholder classes or constructs not indicated by the pseudocode.