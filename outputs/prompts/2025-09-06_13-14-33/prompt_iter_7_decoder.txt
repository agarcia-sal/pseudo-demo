Translate the provided pseudocode into well-structured, clean, and highly efficient Python code that strictly preserves all function names exactly as given. Focus on optimal time and space complexity to guarantee execution within 5 seconds for typical inputs. Use Python’s built-in libraries or reputable third-party packages where they clearly enhance readability or performance. Include comprehensive and precise type annotations for all functions and variables wherever feasible. Your code should be correct, maintainable, and idiomatic Python, leveraging advanced language features appropriately (e.g., comprehensions, generators, data classes, typing constructs). Avoid any verbosity or unnecessary comments—clarity must come from clean code itself.

Wrap your entire Python solution inside a single code block, formatted exactly like this:

```python
# Your code here
```

Pseudocode:
```
[insert pseudocode here]
```