Translate the given pseudocode into clean, idiomatic, and optimized Python code enclosed entirely within a single Python code block formatted exactly as:

```python
# Your code here
```

Your translation must:

- Preserve all function and class names exactly as specified in the pseudocode.
- Include precise and complete Python type annotations for all functions, method signatures, variables, and class members where applicable.
- Prioritize clarity through well-structured code that leverages Python’s modern features appropriately—such as type hints (including `typing` module constructs), data classes, comprehensions, generators, and standard or widely trusted third-party libraries—to maximize readability and performance.
- Ensure optimal time and space complexity so the code reliably runs within 5 seconds for typical inputs.
- Avoid redundant comments; rely on expressive code style for clarity.
- Implement proper error checks if implied by the pseudocode logic.
- Define any data structures, helper functions, or classes mentioned or necessary for a complete, self-contained solution.

After this directive, the pseudocode to translate follows exactly within triple backticks:

```
[insert pseudocode here]
```

Do not include any explanation or commentary outside the code block.