Translate the provided pseudocode into fully functional, well-structured, and idiomatic Python code, strictly preserving all function names and signatures exactly as given. Your code must be complete and self-contained: implement any helper classes, functions, and include all necessary imports. Optimize your solution for clarity, correctness, and runtime efficiencyâ€”your code must reliably run within 5 seconds. Utilize any standard or widely accepted Python libraries as needed to enhance performance or maintainability. Output only the entire, runnable solution, enclosed solely within a single Python code block formatted as below with no extra text, comments, or explanation outside the code block:

```python
# your complete Python implementation here
```