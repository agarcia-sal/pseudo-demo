Translate the given pseudocode into fully working, clean, and optimized Python code. Your solution must:

- Preserve all original class names, method names, and their hierarchical structure exactly as in the pseudocode.
- Include all helper functions or inner functions described or implied within the pseudocode, correctly nested if specified.
- Enclose the entire code output strictly within a single Python code block formatted as:

```python
# your complete translated code here
```

- Aim for clarity, correctness, and optimal performance to ensure the code runs efficiently within a 5-second timeout.
- Use any standard Python libraries if they improve clarity or performance.
- Do not add any explanations, comments beyond what is essential for readability, or any text outside the code block.
- Do not add redundant code or unused classes/functions that do not appear in the pseudocode.  
- Carefully handle edge cases implied by the pseudocode, ensuring behavior matches typical Python semantics.  

Your response must be solely the final valid Python code block ready for direct execution.