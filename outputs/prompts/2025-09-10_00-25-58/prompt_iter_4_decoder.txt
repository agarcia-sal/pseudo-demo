Translate the given pseudocode into a fully working Python function.  
- **Preserve the exact function name** as stated or implied in the pseudocode header (e.g., `def function_name(...)`).  
- Implement the function so it can be directly executed without requiring extra class wrappers or external scaffolding.  
- Your code must be correct, complete, efficient, and ready to run within a 5-second timeout.  
- Avoid partial implementations or leaving code unfinished; handle all control flow and edge cases described in the pseudocode.  
- You may import and use any standard Python library if it improves clarity or performance.  
- Return only the Python code enclosed in a single, properly formatted code block as shown below:

```python
# your complete and executable Python code here
```

Make sure the function you provide can be tested independently by calling it directly with appropriate arguments, and that it faithfully implements the logic specified by the pseudocode.