Translate the given pseudocode into a complete, fully functional Python function that:

- Uses the exact function name stated (or clearly implied) in the pseudocode header.
- Implements every detail and control flow from the pseudocode with precise and comprehensive handling of all logic and edge cases.
- Includes all necessary supporting code (such as class definitions or imports) only if explicitly required by the pseudocode.
- Does not embed the function within any class or extra wrapperâ€”output only the function and its minimal support code.
- Avoids any placeholder or incomplete code; the function must be runnable and self-contained.
- Uses idiomatic and clear Python, preserving variable names from the pseudocode where possible.
- Ensures efficient execution, suitable for typical input sizes, and completes within 5 seconds.
- Imports any standard Python libraries if they meaningfully clarify or optimize the code.
- Returns strictly valid Python code enclosed only within a single triple-backtick Python code block, with no additional text, comments, or explanation outside the block.

```python
# Provide here the complete, ready-to-run Python code matching the pseudocode
```