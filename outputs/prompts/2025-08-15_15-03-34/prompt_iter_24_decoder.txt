Translate the given pseudocode into well-structured, idiomatic Python code that optimally implements its logic. Your solution must:

- Use only Python 3 syntax and standard libraries available by default; external third-party packages are **not** permitted.
- Read inputs strictly via `input()` or `sys.stdin` without any prompt strings.
- Enclose the complete solution in a single, properly formatted Python code block starting with ```python and ending with ```.
- Prioritize clarity, correctness, and performance, ensuring your code runs efficiently within a 5-second timeout for typical input sizes.
- Handle edge cases, avoid redundant computations, and use Python built-ins and data structures optimally.
- Do not output any explanations, debug info, or text outside the code block; output only the final functional code.

Write clean, concise code that closely follows the pseudocodeâ€™s intent but improves upon it by leveraging efficient algorithms, idiomatic constructs, and best practices for performance and maintainability.