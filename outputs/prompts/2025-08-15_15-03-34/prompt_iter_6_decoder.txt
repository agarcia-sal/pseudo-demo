Translate the provided pseudocode into clean, optimized Python code that faithfully implements the described logic. Your solution must:

- Use only standard Python syntax (built-in and standard library modules allowed).
- Avoid any prompts or messages inside input() calls; use plain input() or sys.stdin reads.
- Enclose the entire code in a single Python code block marked with ```python at start and ``` at the end.
- Prioritize clarity, correctness, and computational efficiency to execute within 5 seconds for typical inputs.
- Use appropriate data structures and idioms for readability and speed.
- Do not output any explanation or text outside the code block—output only the final code.

Focus on handling edge cases, avoiding redundant computations, and writing idiomatic Python that aligns tightly to the pseudocode’s intent.