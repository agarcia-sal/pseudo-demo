```python
Translate the given pseudocode into a single, self-contained, efficient, and idiomatic Python 3 program with the following strict criteria:

- Provide exactly one Python code block, beginning with ```python and ending with ```, containing only the final code — no explanations, comments, or any text outside or inside the block.
- Use only Python 3 standard library modules; no third-party or external dependencies.
- Match input handling exactly as implied by the pseudocode using `input()` or `sys.stdin` reads without prompts; produce output exclusively via `print()` statements, with no debugging prints.
- Your Python code must be a direct, idiomatic translation of the pseudocode’s logic while optimizing for performance, memory, and clarity by:
  - Selecting the best algorithms and data structures.
  - Utilizing Pythonic features: comprehensions, generators, built-ins, `itertools`, buffered I/O, and minimal allocations.
  - Thoroughly handling all edge and corner cases.
  - Eliminating redundant processing and unnecessary data storage.
  - Structuring code using encapsulated functions and local variables to maximize readability and maintainability; avoid global state unless essential.
  - Meeting a 5-second runtime ceiling on typical competitive programming input sizes.
- Output a fully executable script that requires no post-processing, modification, or additions, and passes correctness and efficiency tests perfectly.
- Assume the input pseudocode is valid; focus solely on producing the best possible Python 3 implementation.

Your submission must be exactly and only one Python code block as specified.
```