Translate the given pseudocode into clean, efficient, and idiomatic Python code that precisely implements the described algorithm and logic. Your output must meet the following requirements:

- Enclose the entire solution in a single Python code block marked with ```python at the start and ``` at the end.
- Use only standard Python syntax and publicly available standard libraries (including built-in modules). Third-party packages not in the Python standard library are not allowed.
- For all input operations, use simple `input()` calls without any prompt strings or messages.
- Ensure your code handles edge cases properly, avoids unnecessary computations, and is optimized for performance to run within 5 seconds on typical input sizes.
- Write clear, concise, and well-structured Python code using appropriate data structures, control flow, and Pythonic idioms.
- Do not include any additional explanation, comments, or debug outputâ€”output strictly only the final runnable code inside the code block.

Focus on correctness, readability, and computational efficiency.