Translate the given pseudocode into fully functional, clean, efficient, and Pythonic code. Preserve all class names, function names, parameters, and the overall structure exactly as stated in the pseudocode. Implement the logic precisely as described, ensuring correctness and robustness. Your final output must be contained within a single Python code block formatted as ```python ... ```. Do not include any explanatory text or comments outside the code block. Use any standard Python libraries or packages as needed to optimize performance and clarity. Ensure your code executes within 5 seconds on typical input sizes. Handle common edge cases and input conventions idiomatically to match typical Python usage. Avoid altering method signatures or class definitions from the pseudocode.