Translate the following pseudocode into clean, correct, and efficient Python code. Your output must:

- Preserve all class names, function names, and their signatures exactly as given in the pseudocode.
- Maintain the class structure and object-oriented designs intact.
- Convert pseudocode types and constructs idiomatically into Python.
- Handle common data representations properly (e.g., convert `null` to `None`, use appropriate imports such as `deque`, `Optional`, `cache`).
- Include necessary imports only if they appear logically required from the pseudocode.
- Use Pythonic conventions and optimize for clarity and runtime efficiency within a 5-second limit.
- Enclose the entire output code inside a single Python code block marked by triple backticks:
  ```python
  # translated code here
  ```
- Do NOT include explanatory comments unless absolutely necessary to clarify complex logic.
- Do NOT add any output, tests, or commentary outside of the code block.
- Ensure any helper functions or utilities needed are defined, matching their usage in the main translated code.
- Correctly handle edge cases such as empty inputs or invalid values in the pseudocode.
- Convert all pseudocode control structures (loops, conditionals) carefully and fully.
- Avoid introducing errors or omissions by assiduously following the pseudocode logic.

Deliver only the translated Python code inside the code block per above instructions.