Translate the given pseudocode into a single, self-contained Python script enclosed within a ```python``` code block. Your translation must adhere to these strict criteria:

- Use plain `input()` for reading inputs except for very large input volumes where `sys.stdin.readline()` substantially improves performance.
- Exclude all nonessential elements: no comments, prompts, debug prints, blank lines, or separators—only the minimal and necessary Python code that fully implements the pseudocode logic.
- Preserve the exact semantics and output format of the pseudocode, but improve the code by employing idiomatic Python features, built-in functions, comprehensions, efficient algorithms, and appropriate standard libraries (`sys`, `collections`, `heapq`, `itertools`, `math`, etc.) or widely accepted third-party libraries where justified.
- Ensure the code is immediately runnable without modification, dependency issues, or need for external context.
- Optimize for performance and clarity: avoid redundant calculations, superfluous variables, and verbose constructs; emphasize concise, readable, and efficient solutions.
- Output precisely what the pseudocode requires, with no added print statements, formatting, or extraneous output.
- Default to Python 3 syntax and style.
- When applicable, adopt best practices for Python performance and memory efficiency relevant to the problem’s characteristics and input size.

Here is the pseudocode to translate: