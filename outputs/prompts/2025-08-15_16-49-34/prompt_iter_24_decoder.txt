Translate the given pseudocode into a fully functional, idiomatic, and optimized Python program that precisely implements the described algorithm without deviation. Your output must adhere strictly to the following guidelines:

- Use only `input()` without any prompt strings to read all inputs.
- Output should be produced by direct `print()` calls with no extra prompts, debugging information, or commentary.
- Do not include any unnecessary blank lines, comments, or separator lines.
- Enclose the entire solution in a single Python code block starting with ```python and ending with ```.
- Implement efficient algorithms and data structures to meet a stringent runtime constraint of 5 seconds.
- Leverage Python’s standard library and widely accepted third-party packages **only if** they clearly improve clarity, maintainability, or efficiency.
- Write clean, readable code following Python best practices (e.g., meaningful variable names, list comprehensions where appropriate, avoiding superfluous operations).
- The code structure (control flow, variables, functions) should mirror the pseudocode in logic and sequence.
- Produce code that is runnable as-is—no external dependencies, configuration, or scaffolding required.

Here is the pseudocode to translate: