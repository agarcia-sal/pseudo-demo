Translate the given pseudocode into a single, readily executable, and highly optimized Python script enclosed strictly within a single ```python ... ``` code block. Your translation must adhere to these requirements:

- Use plain `input()` for all input reading unless large inputs clearly necessitate `sys.stdin.readline()` for performance; choose the minimal necessary method.

- Exclude any extra comments, debug statements, blank lines, or non-essential code. Include only the code required to perfectly implement the pseudocode’s logic.

- Exactly replicate the pseudocode’s semantics and output format, but rewrite the code using Pythonic constructs (comprehensions, built-ins, idiomatic control flows), leverage efficient standard libraries and data structures (`sys`, `collections`, `heapq`, `itertools`, `math`, etc.), and optimize algorithms to run well within 5 seconds on typical test cases.

- Avoid redundancy, unnecessary intermediate variables, and verbose logic; focus on clarity combined with maximum runtime efficiency.

- Do not print any prompts or explanatory text—output only what the pseudocode specifies, without added formatting.

- You are free to import and use any standard or widely accepted third-party Python libraries to maximize performance and maintainability.

- Guarantee that the code block is a self-contained script runnable as-is, without any external context or modification.

Here is the pseudocode to translate: