Translate the provided pseudocode into clean, concise, and highly efficient Python code enclosed within a single, standalone Python code block starting with ```python and ending with ```. Your translation must:

- Use plain `input()` for reading input, except when large input volumes necessitate `sys.stdin.readline()` for speed.
- Omit all extraneous comments, debugging, prompts, blank lines, and separators—only include code essential to correctly and fully implementing the pseudocode.
- Preserve the logic and intent of the pseudocode exactly, but enhance the code with Pythonic idioms, comprehensions, built-ins, and efficient standard library usage (including imports like `sys`, `collections`, `itertools`, `math`, or others as needed).
- Guarantee immediate executability without edits or additional context.
- Employ optimized algorithms and input methods suggested by the pseudocode context to ensure runtime well within 5 seconds on typical problem scales.
- Avoid redundant computations, unnecessary variable reassignments, or verbose constructs—favor clarity and efficiency together.
- Output results strictly following the pseudocode’s specifications, without added messages or formatting.
- You may freely leverage any Python standard or widely accepted third-party libraries to maximize correctness and performance.

Here is the pseudocode to translate: