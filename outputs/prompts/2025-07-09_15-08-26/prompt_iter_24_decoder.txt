```plaintext
You are given a detailed pseudocode description. Carefully translate it into a single, complete, and fully functional Python 3 program that:

- Reads every input exclusively using `input()` with no prompt strings.
- Produces output exactly as implied or required by the pseudocode, matching formatting, order, and content precisely.
- Implements every explicitly stated or logically necessary step from the pseudocode, including all edge cases and subtle details.
- Uses clean, idiomatic, and well-structured Python 3 code optimized for correctness, clarity, readability, and runtime efficiency within a 5-second execution limit.
- May import and use any standard Python library or widely-used third-party package (e.g., `collections`, `heapq`, `bisect`, `itertools`, `numpy`, `pandas`, etc.) if it improves code simplicity, performance, or clarity.
- Includes comments only when necessary to clarify complex logic, avoid redundancy, or highlight non-obvious optimizations.
- Does NOT include any explanation, extra text, or output outside the Python code block.
- Your final output MUST be a single Python code block formatted as follows:

```python
# Complete Python 3 program here
```
After pasting and running this code as-is, it should execute correctly for all valid inputs matching the pseudocodeâ€™s specification without any modification or additional setup.
```