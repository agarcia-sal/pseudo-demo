```plaintext
You are given pseudocode to translate into a working Python 3 program.

Requirements:

- Convert the entire pseudocode faithfully, including all explicit and implicit logic, handling all edge cases and input constraints.
- Use `input()` only for **all** input reading with no prompt strings or additional text.
- Output exactly as dictated by the pseudocode, with no extra prints, comments (except minimal inline for complex logic), or separators.
- Write clean, readable, and idiomatic Python 3 code that is optimized for performance and runs within 5 seconds.
- The code must be fully self-contained and immediately runnable in a standard Python 3 environment upon pasting.
- You may freely import and use any standard library or commonly accepted third-party Python modules (such as `collections`, `heapq`, `math`, `itertools`, `bisect`, `numpy`, etc.) to achieve clarity, efficiency, or elegance.
- Enclose your entire output in a single Python code block exactly as:

```python
# your complete Python 3 code here
```

- Do NOT add any explanations, text, or separators outside the single code block.

Your task: produce this final, runnable Python program that represents the pseudocode precisely and optimally.
```