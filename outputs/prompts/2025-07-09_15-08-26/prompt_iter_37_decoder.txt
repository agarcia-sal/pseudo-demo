```python
Translate the given pseudocode into a complete, efficient, and idiomatic Python 3 program that executes within 5 seconds. Your output must be a single, self-contained, runnable Python script enclosed **only** within one Python code block:

```python
# your complete Python 3 solution here
```

Follow these strict rules exactly:

- Use `input()` without prompts for **all** input reading.
- Faithfully implement **every explicit and logically implied step** from the pseudocode, fully handling all edge cases and input restrictions.
- Produce output exactly as specified by the pseudocode logic; do not add extra prints, debug info, or explanations.
- Write clean, readable, and Pythonic code using best practices and idiomatic constructs.
- You may import and use any **standard library or universally adopted third-party Python packages** that improve clarity, correctness, or performance (e.g., `collections`, `heapq`, `math`, `itertools`, `bisect`, `numpy`, `sys`).
- Ensure the program is fully runnable immediately after pasting â€” no extra setup, files, or modifications needed.
- Avoid any separators, comments except minimal inline explanations for complex logic, or textual output outside the single Python code block.
- Optimize for clarity, correctness, robustness, and runtime efficiency within the 5-second limit.

This prompt is designed to guarantee maximum fidelity to the original pseudocode while producing clean, idiomatic, and performant Python solutions suitable for all tested cases.
```