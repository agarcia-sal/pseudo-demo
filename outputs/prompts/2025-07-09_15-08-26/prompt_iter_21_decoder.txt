Translate the full pseudocode into a complete, efficient, and robust Python 3 program optimized for clarity and performance. Your response must strictly adhere to these requirements:

``` 
- Enclose your entire solution inside a single Python code block exactly as shown:

```python
# Your full runnable Python code here
```

- Use **only** `input()` calls (without any prompt strings) to read input, honoring the input format and semantics implied by the pseudocode.

- Implement every logical detail described or strongly implied by the pseudocode, covering all edge cases and ensuring correctness.

- Write clean, idiomatic, and well-structured Python code, prioritizing readability and efficiency.

- You may import and use any **standard or widely-used third-party Python libraries** to simplify or optimize your solution, but ensure they are essential and justified.

- Do not output any explanations, comments except minimal clarifying comments for complex or non-obvious logic, or extra text outside the code block.

- The code must be fully self-contained and ready to run as-is (no external dependencies beyond allowed imports).

- Design your solution to complete within 5 seconds on typical inputs, using best practices for algorithmic efficiency and Python performance.

This prompt is intended to maximize code quality, completeness, and runtime efficiency while maintaining strict adherence to input/output conventions.