```python
Translate the provided pseudocode into a complete, clean, and efficient Python 3 program that runs within 5 seconds. Your output must be **only** the final executable Python code enclosed in a single properly formatted code block as:

```python
# your full runnable Python code here
```

Requirements and constraints:

- Use **only** `input()` (without any prompt string) to read all inputs exactly as the pseudocode specifies.
- Implement every explicit and implicitly required step of the pseudocode with full correctness, covering edge cases and adhering strictly to input/output formats.
- Do **not** add any extraneous print statements, debugging output, separators, or comments other than very brief inline ones clarifying complex logic.
- Write code that is idiomatic, readable, and optimally efficient in time and memory.
- You may `import` and use any built-in or widely used standard and third-party Python libraries (e.g., `collections`, `heapq`, `math`, `itertools`, `bisect`, `numpy`) if they improve clarity or performance.
- The code must be self-contained and ready to run immediately after pasting—no manual modifications or extra configurations should be necessary.
- Avoid any textual explanation or formatting outside the single python code block.
- Do **not** include separators, headers, or any text besides the code block itself.

This prompt maximizes fidelity to the pseudocode’s intent, correctness, and runtime efficiency within a strict 5-second execution limit.
```