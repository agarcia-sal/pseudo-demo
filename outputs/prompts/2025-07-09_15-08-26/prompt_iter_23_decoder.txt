Translate the provided pseudocode into a complete, robust, and fully optimized Python 3 program meeting the following precise criteria:

- Enclose your entire submission strictly within a single Python code block:  
  ```python
  # Complete Python code here
  ```
- Read **all inputs** exclusively via `input()` with no prompt strings or extra parameters.  
- Produce output exactly as implied by the pseudocode, without any additional text, formatting, or printing beyond what the pseudocode specifies.  
- Implement **every logical detail** explicitly stated or strongly implied, handling all edge cases and input constraints carefully to ensure correctness and stability.  
- Optimize for clarity, idiomatic style, and runtime efficiency; use best practices including appropriate data structures and algorithms.  
- You may import and use any relevant standard library or widely adopted third-party Python packages to improve code quality, speed, or expressiveness, but the code must remain self-contained and runnable without modification.  
- Avoid superfluous comments; include only concise, clarifying comments if a complex section demands brief explanation.  
- Do not include any separators, banners, or extraneous formatting lines.  
- Your solution must be fully functional and ready to execute immediately in a standard Python 3 environment within a 5-second execution limit.

This prompt ensures maximal precision, correctness, robustness, and performance while keeping output clean and strictly code-only.