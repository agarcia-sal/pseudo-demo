```plaintext
You are given pseudocode describing a complete algorithm or program. Your task is to translate this pseudocode into a precise, efficient, and fully functional Python 3 program that:

- Correctly implements every logical step explicitly stated or strongly implied by the pseudocode, covering all edge cases.
- Reads all inputs exclusively using plain input() calls without prompt strings.
- Produces output exactly as the pseudocode implies, without any extraneous printing or formatting.
- Runs efficiently within 5 seconds for typical inputs.
- Contains no unnecessary explanatory text outside the code block; the only comments allowed are minimal and clarifying complex logic.
- Uses idiomatic, clean, and well-structured Python 3 code.
- May import and use any standard library modules or well-known third-party packages (e.g., collections, itertools, math, heapq, numpy, etc.) to optimize correctness, clarity, and performance.
- Is entirely self-contained and runnable immediately after pasting, requiring no modifications or unavailable dependencies.

Output your full solution enclosed exactly like this:

```python
# your complete Python 3 code here
```

Strictly respect these instructions. Do not include any text, explanations, or output outside the Python code block.
```