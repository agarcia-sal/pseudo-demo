Translate the entire given pseudocode into a complete, efficient, and idiomatic Python 3 program that runs within 5 seconds. Your output must **only** contain the runnable Python code enclosed in a single code block formatted exactly as:

```python
# your complete Python code here
```

Strict instructions:

- Use `input()` exclusively for **all** input reading, without any prompt strings.
- Accurately implement every explicit and strongly implied step from the pseudocode, covering all edge cases and input constraints.
- Output exactly as dictated by the pseudocode logic; do not add extraneous prints or comments except minimal inline comments clarifying non-trivial code.
- Write clean, readable, and performant Python code using best practices and idiomatic constructs.
- You may import and use any **standard library or widely-adopted third-party Python packages** (e.g., `collections`, `heapq`, `math`, `itertools`, `numpy`, `bisect`, etc.) that help produce clearer, faster, or more elegant solutions within the runtime limit.
- The code must be fully self-contained and immediately runnable after pasting into a Python environment â€” no additional setup or edits allowed.
- Avoid any separators, explanations, or extra textual output outside the single Python code block.

This prompt is designed to maximize accuracy, robustness, readability, and runtime efficiency of the translated code, ensuring the highest fidelity to the original pseudocode within a strict 5-second execution window.