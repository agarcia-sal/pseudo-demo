```python
Translate the provided pseudocode into a fully functional, clean, and efficient Python 3 program that executes within 5 seconds. Your output must be **only** the complete Python code enclosed in a single Python code block, formatted exactly as:

```python
# entire runnable Python program here
```

Requirements:

- Read **all** inputs exclusively via `input()` with no prompts or extra text.
- Implement every detail and nuance of the pseudocode, including all edge cases and constraints inferred or stated.
- Output exactly as the pseudocode prescribes; do not add or remove outputs, extra logging, or commentary.
- Write idiomatic, readable, and performant Python code using standard structures, comprehension, and libraries.
- You may freely import and use any standard library or widely adopted third-party Python packages (e.g., `collections`, `heapq`, `math`, `itertools`, `bisect`, `numpy`, etc.) that aid clarity or efficiency.
- The submitted code must be fully self-contained and runnable without modification or setup.
- Avoid any extraneous text outside the single Python code block—no explanations, separators, or commentary.
- Optimize for clarity, correctness, and maximum runtime efficiency within the 5-second limit.

This prompt is designed to produce highly faithful, robust, and performant code translations of pseudocode — ensuring accuracy, maintainability, and optimal execution time.
```