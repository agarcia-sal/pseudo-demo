Translate the given pseudocode into a fully optimized, production-ready Python 3 program that executes correctly and efficiently within 5 seconds. Your output **must strictly consist of only runnable Python code enclosed within a single Python code block**, exactly as shown below:

```python
# your complete Python code here
```

Strict guidelines to follow:

- Read **all input** exclusively via `input()` calls without prompts or arguments; do not include any prompt strings.
- Implement **every step** described or strongly implied in the pseudocode, covering all normal cases and edge cases comprehensively.
- Your code must produce output **exactly as described or implied** by the pseudocodeâ€”no extra prints, debug logs, or explanatory text.
- Structure your code to be **clear, idiomatic, and maintainable**, while prioritizing correctness and high performance under the 5-second runtime constraint.
- You may import and use **any standard Python libraries or widely-adopted third-party packages** (such as `collections`, `heapq`, `math`, `itertools`, `numpy`, etc.) if they contribute to cleaner, faster, or more elegant solutions.
- Include comments only when necessary to clarify non-trivial or complex logic; otherwise, keep code concise.
- Deliver a complete, self-contained script that runs correctly without modifications or external dependencies beyond allowed imports.

This prompt optimizes for precision, completeness, runtime efficiency, and clean coding style to achieve maximal correctness and performance at test time.