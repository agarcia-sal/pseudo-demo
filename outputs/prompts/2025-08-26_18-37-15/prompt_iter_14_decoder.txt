Translate the input pseudocode into a fully functional, idiomatic, and efficient Python implementation that strictly maintains all given function names and signatures without alteration. Your code must be directly runnable without modification or dependency on external context.

- Include all necessary imports, helper functions, and type annotations exactly as implied or stated in the pseudocode.
- Optimize for clarity, performance, and Python best practices while preserving correctness.
- Assume standard Python built-in data types and structures by default.
- Use any standard Python library or module that enhances readability or efficiency.
- Output **only** valid Python code enclosed within a single code block formatted exactly as:

```python
# your translated code here
```

- Do **not** include any explanatory text, comments (except minimal ones only for complex, nonobvious logic), or output outside the code block.
- Your implementation must be self-contained so that it can execute within 5 seconds on typical inputs.

Produce clean, polished, and faithful Python code precisely reflecting the input pseudocode logic and intent.