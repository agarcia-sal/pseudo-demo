Translate the given pseudocode into a complete, clean, and efficient Python implementation that exactly preserves all function names, signatures, and type annotations from the pseudocode. Your solution must be fully executable within 5 seconds and directly reflect the pseudocode logic without adding any extra functionality.

Instructions:

- Provide only the final Python code inside a single code block formatted as:
```python
# Your translated Python code here
```
- Keep all function names, parameters, and type annotations identical to those in the pseudocode.
- Implement every function and any required helper functions or imports to make the code self-contained and runnable.
- You may import any standard or third-party Python libraries that enhance clarity, correctness, or performance, but avoid unnecessary dependencies.
- Omit all explanatory text, comments, or output except for comments strictly necessary to clarify subtle logic.
- Assume all inputs and outputs use typical Python data structures unless the pseudocode specifies otherwise.
- Prioritize producing idiomatic, readable, and optimized code with no superfluous statements or I/O.
- Your implementation must faithfully follow the pseudocodeâ€™s algorithm and semantics to maximize correctness and runtime efficiency within the 5-second limit.