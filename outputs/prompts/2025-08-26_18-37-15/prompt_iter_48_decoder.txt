Translate the given pseudocode into a clean, idiomatic, and efficient Python implementation that precisely preserves all function names, signatures, and type annotations as presented. Your code must be fully self-contained, optimized for clarity and performance, and runnable within 5 seconds. Strictly implement the logic described, avoiding any unnecessary additions or input/output operations.

Guidelines:
- Provide your entire solution enclosed in a single Python code block formatted as:
```python
# Your Python implementation here
```
- Preserve all function names, signatures, and type annotations exactly as specified in the pseudocode.
- Include all necessary imports; you may use any standard or third-party libraries that improve readability, correctness, or efficiency.
- Fully implement all functions and any needed helper functions with proper return statements.
- Avoid any extraneous text, comments (unless essential to clarify subtle logic), or code outside the code block.
- Assume inputs and outputs use conventional Python data structures unless otherwise specified.
- Optimize for production-quality code prioritizing correctness, readability, and runtime efficiency under the 5-second limit.

Your output should be the best possible Python translation faithfully representing the pseudocodeâ€™s intent and structure.