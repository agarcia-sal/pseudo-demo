Translate the given pseudocode into a complete, efficient, and idiomatic Python implementation that precisely preserves all function names, signatures, and type annotations exactly as in the pseudocode. Your code must be fully self-contained and optimized to run within 5 seconds, faithfully representing the pseudocodeâ€™s logic without adding any extra input/output or unrelated functionality.

Instructions:
- Provide your entire solution enclosed **only** within a single Python code block formatted as:
```python
# translated Python code here
```
- Keep all function names, parameters, and type annotations exactly as in the pseudocode, preserving their order and naming.
- Implement every function and helper function fully, including necessary imports from standard or third-party libraries, if they improve clarity, correctness, or performance.
- Write clean, readable, and performant Python code that strictly corresponds to the described pseudocode, avoiding any superfluous code or debugging outputs.
- Do **not** include explanations, comments (unless mandatory for subtle logic), or any text outside the code block.
- Assume all inputs and outputs use conventional Python data structures per typical coding conventions unless explicitly stated otherwise.
- Optimize your implementation for both correctness and efficiency while ensuring it is production-quality and idiomatic Python code.

Your response must be the precise Python translation of the pseudocode, ready to be run and tested immediately.