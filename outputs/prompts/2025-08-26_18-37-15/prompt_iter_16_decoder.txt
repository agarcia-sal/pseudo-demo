Translate the provided pseudocode into a complete, clean, idiomatic, and efficient Python implementation that strictly preserves all function names, parameter names, and signatures exactly as stated. 

Your output must satisfy the following:

- Enclose **only** your final Python code within a single, properly formatted code block as shown:
```python
# your full translated code here
```
- Use type annotations whenever the pseudocode provides type hints.
- Include all necessary imports from Python’s standard library or widely used packages if they improve readability, correctness, or performance.
- Fully implement all specified functions with correct logic, handling edge cases robustly.
- Provide any required helper functions, constants, or classes used by the main functions.
- Avoid any commentary, explanation, or text outside the code block.
- Prioritize clarity, idiomatic style, and efficient runtime, ensuring solutions can run within 5 seconds.
- Assume standard Python data structures unless otherwise specified by the pseudocode.
- Do not alter function signatures or names.

Deliver polished, maintainable code that faithfully implements the pseudocode’s intent exactly and efficiently.