Translate the provided pseudocode into a fully functional, idiomatic, and efficient Python implementation that strictly preserves all function names, parameter names, and signatures exactly as given. Your solution must be self-contained and runnable within 5 seconds, prioritizing clarity, correctness, and optimal performance.

Requirements:
- Include all necessary imports (standard or third-party) only if they enhance readability, efficiency, or idiomatic style.
- Use type annotations whenever types are specified or can be clearly inferred.
- Implement all functions completely, including any helper or nested functions implicitly indicated by the pseudocode.
- Adhere strictly to Python conventions and best practices for code style and structure.
- Do not add comments unless absolutely necessary to clarify nontrivial logic.
- Do not output anything outside a single Python code block formatted exactly as follows:

```python
# your complete translated code here
```

- Assume input and output data conform to canonical Python types unless otherwise noted.
- Avoid extraneous explanatory text and separator lines.

Deliver a clean, polished, and fully executable Python code implementation faithful to the input pseudocode.