Translate the given pseudocode into a complete, idiomatic, and high-quality Python implementation that:

- Exactly preserves all function names, parameters, and type annotations as specified.
- Fully implements all functions and any necessary helper functions, including required imports.
- Produces clear, concise, and maintainable code that rigorously follows the pseudocodeâ€™s logic without adding unrelated functionality.
- Is optimized for readability, correctness, and runtime efficiency, ensuring execution within 5 seconds for typical inputs.
- Uses Pythonic constructs and built-in or standard libraries as appropriate to enhance clarity and performance.
- Handles inputs and outputs using standard Python data types fitting the problem context.

Strict requirements:
- Enclose the entire solution in **one single Python code block** formatted exactly as:
```python
# your translated Python code here
```
- Do not include any explanatory text, comments (unless essential to clarify subtle logic), or output other than the code block.
- Avoid unnecessary or redundant code; write only what is essential to faithfully implement the pseudocode exactly.

Your output must be syntactically correct, runnable, and self-contained, effectively bridging the pseudocode to production-quality Python code.