Translate the given pseudocode into clean, idiomatic, and efficient Python code that exactly preserves all function names, signatures, and type annotations as specified. Your implementation must be fully self-contained, runnable within 5 seconds, and correspond one-to-one with the logic described—no added functionality or extraneous code.

Guidelines:
- Output only a single Python code block formatted precisely as:
```python
# your complete Python code here
```
- Retain all function names and signatures identically.
- Include all type annotations exactly as in the pseudocode.
- Import any standard or third-party libraries that clearly enhance correctness, clarity, or performance.
- Fully implement every function and any helper functions needed, including all necessary imports and return statements.
- Do not include any explanatory text, print statements, or comments except where a brief comment is indispensable to clarify subtle logic.
- Assume all input and output use standard Python data types unless otherwise specified.
- Optimize for readability, maintainability, and performance without superfluous complexity.
- Your final code must faithfully reflect the pseudocode’s intent and run efficiently within the 5-second limit.