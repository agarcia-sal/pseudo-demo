Translate the given pseudocode into a complete, idiomatic, and efficient Python implementation that precisely follows the function names, signatures, and type annotations as specified. Your solution must be fully self-contained, optimized for readability and performance to run within 5 seconds, and map exactly to the logic described without adding extraneous behavior or I/O.

Guidelines:
- Provide only valid Python code enclosed in a single code block formatted as:
```python
# your translated Python code here
```
- Preserve all function names, parameters, and type hints exactly as in the pseudocode.
- Include all necessary imports, helper functions, and return statements.
- Use any standard or third-party Python libraries if they improve correctness, clarity, or efficiency.
- Avoid all explanation, commentary, or output other than strictly necessary in-code comments clarifying complex logic.
- Assume conventional Python data structures for inputs/outputs unless explicitly stated otherwise.
- Write clear, maintainable, and idiomatic Python that directly reflects the pseudocode's intent with no superfluous code.
- Prioritize correctness, idiomatic practices, and runtime efficiency within the 5-second execution constraint.