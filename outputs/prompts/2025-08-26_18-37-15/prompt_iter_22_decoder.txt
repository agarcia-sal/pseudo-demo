Translate the given pseudocode into a complete, clean, and idiomatic Python implementation that:

- Strictly preserves all original function names and signatures exactly as provided.
- Includes all necessary imports, helper functions, and type annotations as indicated or logically inferred.
- Produces fully self-contained, executable code optimized for clarity, correctness, and efficiency, with straightforward Pythonic style.
- Assumes canonical Python data structures and typing unless explicitly stated otherwise.
- Avoids any explanatory text, comments (unless absolutely required for complex logic), or output outside a single Python code block.
- Uses any standard Python libraries or well-established third-party packages if they improve code clarity or performance.
- Prioritizes reliable and maintainable code that reliably runs within 5 seconds on typical inputs.

Enclose your entire solution **only** inside a single Python code block as follows:

```python
# your translated code here
```