Translate the provided pseudocode into a fully functioning, idiomatic, and efficient Python implementation that strictly preserves the given function names and signatures. Your code must be completely self-contained, runnable within 5 seconds, and directly correspond to the logic described in the pseudocode without introducing extraneous behavior.

Requirements:
- Enclose your entire solution **only** within a single Python code block formatted as:
```python
# your translated Python code here
```
- Retain all function names and signatures exactly as specified in the pseudocode.
- Include type annotations exactly when they appear in the pseudocode.
- Import any standard or third-party Python libraries that meaningfully improve clarity, performance, or correctness.
- Fully implement all functions and any necessary helpers, including imports and return statements.
- Do not output any explanation, text, or comments unless a comment is crucial for clarifying subtle or complex logic.
- Assume input and output use standard Python data structures typical for such tasks unless otherwise noted.
- Optimize for clear, maintainable, and efficient code that faithfully reflects the given pseudocodeâ€™s intent without superfluous code or I/O.

Your goal is to produce polished, production-quality Python code that maximizes correctness and readability while minimizing runtime within the 5-second constraint.