Translate the provided pseudocode into a precise, fully functional, and idiomatic Python implementation that:

- Retains all function names and signatures exactly as specified in the pseudocode, including all type annotations.
- Includes all necessary imports from Pythonâ€™s standard library or well-known core packages if they improve clarity, efficiency, or correctness.
- Produces clean, readable, and efficient code optimized for execution within 5 seconds.
- Implements every detail implied or explicit in the pseudocode, including helper functions, internal logic, and return statements.
- Assumes standard Python data types for inputs and outputs unless otherwise specified.
- Avoids extraneous comments or narrative; comments only if essential to clarify complex logic.
- Outputs only a single self-contained Python code block formatted as:

```python
# your complete translated code here
```

Do not add text outside the code block. Your solution should be production-ready, maximally faithful to the input pseudocode, and idiomatic according to modern Python best practices.