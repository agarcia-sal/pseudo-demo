Translate the given pseudocode into clear, concise, and idiomatic Python code that preserves all function names, signatures, and type annotations exactly as provided. Your implementation must:

- Fully implement all described functionalities and any helper functions or necessary imports.
- Produce Python code that is self-contained, correct, efficient, and optimized to execute well under a 5-second runtime constraint.
- Use appropriate standard or well-known third-party libraries **only if** they add meaningful clarity, correctness, or performance improvements.
- Avoid any extraneous I/O operations, debugging statements, or non-essential comments. Only include comments essential for clarifying complex or subtle logic.
- Assume inputs and outputs correspond to typical Python data structures unless otherwise specified.
- Include the entire solution strictly enclosed in a single Python code block formatted as follows:

```python
# Your fully working Python code here
```

Do not deviate from the above output format or add text before or after the code block. Your goal is to deliver clean, production-quality Python code that reflects the pseudocode's intent precisely, maximizes readability and maintainability, and runs efficiently within the given constraints.