Translate the provided pseudocode into a fully executable, idiomatic, and well-structured Python implementation that exactly preserves all given function names, signatures, and type hints. Your code should be optimized for readability, correctness, and runtime efficiency within a 5-second execution constraint, handling all edge cases implicitly.

- Provide only the Python code, enclosed exclusively in a single, properly formatted Python code block:

```python
# Complete translated code here
```

- Include all necessary imports from standard libraries or widely adopted packages if they enhance clarity or performance.
- Implement every function and helper explicitly, with clear logical flow and proper return statements.
- Use type annotations precisely as specified; if types are missing or ambiguous in pseudocode, use reasonable idiomatic assumptions.
- Avoid comments and any form of explanation outside the code block. Include minimal comments inside only when the logic is intricate or non-obvious.
- Assume standard Python data types for inputs and outputs unless otherwise indicated.
- Prioritize producing correct, clean, and idiomatic Python code that faithfully matches the intent and structure of the pseudocode without superfluous constructs or verbosity.

Deliver a concise, polished, and runnable Python solution reflecting the full semantics of the input pseudocode.