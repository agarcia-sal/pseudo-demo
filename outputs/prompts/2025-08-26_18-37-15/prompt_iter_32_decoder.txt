Translate the given pseudocode into a clean, idiomatic, and efficient Python implementation that adheres **exactly** to the specified function names and signatures, including all type annotations as provided. Your code should be fully self-contained, execute correctly within 5 seconds on typical inputs, and precisely reflect the logic and structure of the pseudocode without adding or omitting any behavior.

Guidelines:
- Output **only one** Python code block with the entire solution, formatted as:
```python
# your translated Python code here
```
- Preserve all function names, parameter names, and type annotations exactly as in the pseudocode.
- Include all necessary imports explicitly; use any built-in or third-party libraries that improve code clarity, efficiency, or correctness.
- Implement all functions completely and correctly, including helper functions if needed.
- Avoid any extraneous output, comments, or explanations unless a comment is absolutely required to clarify subtle logic.
- Assume standard Python data structures for inputs and outputs unless the pseudocode specifies otherwise.
- Optimize the code for readability, maintainability, and runtime efficiency, minimizing unnecessary complexity or overhead.
- Do not add any input/output routines, debugging statements, or unrelated code.

Your final submission should be a polished, production-quality Python solution that maximizes correctness, clarity, and performance while staying strictly faithful to the provided pseudocode.