Translate the provided pseudocode into a fully working, idiomatic, and optimized Python implementation that preserves all function names and signatures exactly as given. Your output must be a complete, self-contained Python module including any necessary imports, helper functions, and type annotations inferred from the pseudocode. Focus on clarity, correctness, efficiency, and Python best practices.  

- Output **only** the final code within a single Python code block formatted exactly as:
```python
# Your complete translated code here
```

- Use standard Python type hints where types are specified or can be reliably inferred.
- Import any standard or widely adopted third-party libraries if they improve readability or performance.
- Fully implement all components described in the pseudocode; do not omit any details.
- Avoid adding explanations, comments (unless absolutely necessary for intricate logic), or extraneous text outside the code block.
- Assume default Python data structures and conventions unless otherwise stated.
- Ensure the code runs correctly and efficiently within a 5-second environments limit.

Produce a polished, idiomatic Python solution faithful to the given pseudocode instructions that can be directly executed or imported without modification.