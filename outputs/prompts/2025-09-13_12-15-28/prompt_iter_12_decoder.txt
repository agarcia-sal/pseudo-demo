Translate the given pseudocode into precise, production-ready Python code adhering strictly to the following instructions:

- Preserve **all class names, method names, function signatures, input/output formats, and data structures exactly as specified in the pseudocode**, without any modification.
- Your entire response must be and only be a single Python code block delimited by triple backticks and the language marker `python` at the start and triple backticks at the end. Do not write any text, comments, or explanations outside the code block.
- Produce clean, idiomatic, and highly efficient Python code optimized for correctness and performance, capable of running within 5 seconds on typical inputs.
- You may import and use any Python standard library modules or built-ins **if they improve clarity, efficiency, or correctness**, but do not import unused libraries.
- Do not include any debugging, logging, print statements, or extraneous comments in the code.
- Implement the logic fully and faithfully to the pseudocode, covering all implied edge cases and behaviors to maximize test case passing.
- Maintain the exact class structures and nesting as described; do not refactor, flatten, or rearrange code beyond what is needed for faithful translation.
- Assume the pseudocode provides all necessary info; do not infer or invent additional features or signatures.

Here is the pseudocode to translate: