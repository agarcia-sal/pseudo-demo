Translate the pseudocode into fully functional, efficient, and idiomatic Python code according to these mandatory requirements:

- Exactly preserve all given class names, method/function names, signatures, input/output formats, and data structures as specified in the pseudocode; do not rename, reorder, or alter these elements in any way.
- Implement the complete logic precisely as described, fully covering all edge cases and behaviors implied by the pseudocode; do not add features or change functionality beyond the given description.
- Your entire response must be only a single Python code block fenced with triple backticks and the language marker `python`, with zero additional explanations, text, or comments outside this block.
- Write clean, concise, and production-quality Python code with an emphasis on runtime performance and correctness, optimized to execute within 5 seconds on standard inputs.
- You may selectively import any necessary Python standard or widely accepted third-party libraries **only if they improve correctness, clarity, or performance**, but do not import unnecessary packages.
- Maintain the exact class and nesting structure as described in the pseudocode. Do not refactor or flatten nested classes or methods unless explicitly required by the pseudocode.
- Avoid printing, logging, debugging output, or any side effects.
- Rely solely on the information provided in the pseudocode; do not infer or invent missing signatures, methods, or features.

Here is the pseudocode to translate: