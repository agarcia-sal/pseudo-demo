Translate the given pseudocode into clean, idiomatic, and production-quality Python code with the following strict requirements:

- **Preserve all class names, method/function names, input/output signatures, and data structures exactly as presented** in the pseudocode â€” do not rename, reorder, or modify these in any way.
- **Maintain the exact class and method nesting structure** without flattening or restructuring.
- Implement every detail of the logic explicitly, addressing all implicit and explicit edge cases, ensuring maximum correctness and robustness.
- Prioritize **optimal performance and minimal memory usage**, with the solution capable of running within a 5-second time limit on typical inputs.
- You may import any **standard libraries or widely used third-party libraries** if and only if they clearly improve clarity, performance, or conciseness; avoid superfluous imports.
- **Do not add debugging statements, print calls, logging, comments, explanations, or any text outside the code block.**
- Do not assume or invent functionality beyond what the pseudocode defines; implement the pseudocode as a fully self-contained solution.
- Return your entire answer **only inside a single, contiguous Python code block, labeled `python` using triple backticks**, like so:

```python
# your solution here
```

Here is the pseudocode to translate: