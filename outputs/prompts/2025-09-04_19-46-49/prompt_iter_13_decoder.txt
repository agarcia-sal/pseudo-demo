Translate the given pseudocode into a single, self-contained, and optimized Python implementation that exactly matches the original function names, logic, and all subtle details â€” including edge cases and implicit behaviors. 

Your solution must:  
- Use modern, idiomatic Python to maximize clarity, maintainability, and runtime efficiency under a 5-second execution constraint.  
- Include comprehensive and precise type hints for all functions and variables.  
- Provide clear, concise docstrings for every function, fully documenting purpose, input parameters, return types, exceptions raised, and side effects if any.  
- Handle input validation and edge cases as reasonably inferred from the pseudocode.  
- Leverage built-in Python features or widely-adopted libraries (standard or third-party) where they improve correctness, readability, or performance without adding unnecessary complexity.  
- Avoid any extraneous explanations, comments, or formatting outside the code block.  
- Preserve the exact function names and signatures as implied by the pseudocode.  

Enclose the entire translated code in one Python code block as shown below:  

```python  
# Your fully translated, precise, robust, and efficient Python code here  
```