```markdown
Translate the provided pseudocode into a fully functional, production-quality Python implementation that strictly retains the original function names and logical structure, including all implicit behaviors and edge cases. Your solution must meet the following criteria:

- Correctly handle all input types and edge cases inferred from context.
- Utilize precise Python type annotations (including from `typing` and `numbers` modules) that express input and output types clearly.
- Include comprehensive, clear docstrings following PEP 257 conventions, documenting the functionâ€™s purpose, parameters (with types), return values, raised exceptions, and side effects if any.
- Leverage idiomatic, efficient, and readable Python constructs, favoring built-in or standard library utilities where appropriate for clarity and performance.
- Maintain algorithmic efficiency within a strict 5-second runtime budget.
- Avoid any extraneous comments or output outside the single Python code block.
- Preserve original function names exactly.
- Guarantee that your code is immediately ready for real-world use without requiring further modifications or explanations.
- You may import and use any stable Python standard library or third-party package that enhances robustness or performance.

Output your complete solution inside a single fenced Python code block as follows:

```python
# Your fully implemented Python code here
```
```