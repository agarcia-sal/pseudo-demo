Translate the provided pseudocode into a fully functional, concise, and idiomatic Python implementation that rigorously preserves all explicit and implicit logic, including edge cases and input constraints, while maintaining the exact function names specified. Your translation must emphasize:

- Correctness, clarity, and idiomatic Python style with performance suitable for execution within 5 seconds on typical input sizes.
- Comprehensive type annotations using standard typing features.
- Complete and precise docstrings describing purpose, parameters, return values, and potential exceptions, following Google or NumPy documentation styles.
- Use of appropriate standard libraries or widely accepted third-party packages only when they improve clarity, maintainability, or efficiency without adding unnecessary complexity.
- Robust handling and validation of inputs if implied or necessary.
- No additional text, explanations, comments, or separators outside the single Python code block.
- The entire solution enclosed in one Python code block formatted exactly as:

```python
# Your fully translated, optimized Python code here
```