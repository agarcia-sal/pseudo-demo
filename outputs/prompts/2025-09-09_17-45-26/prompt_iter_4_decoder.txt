Translate the given pseudocode into clean, efficient, and idiomatic Python code, strictly preserving the original function names, class names, and data structures exactly as indicated. Your final implementation must be fully self-contained, runnable without any external dependencies beyond the Python standard library (you may import any standard package if it improves clarity or performance), and optimized to run within 5 seconds.  
Enclose all your code exclusively within a Python markdown code block starting with ```python and ending with ```.  
Do not include any comments, explanations, or output outside of this code block unless explicitly requested.  
Maintain all classes and methods as defined in the pseudocode (i.e., if pseudocode uses a class, include it; if not, write standalone functions) to ensure compatibility with automated testing frameworks expecting these signatures.