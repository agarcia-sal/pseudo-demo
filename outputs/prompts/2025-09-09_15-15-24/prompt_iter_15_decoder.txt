```python
Given the pseudocode below, generate a single complete Python 3 implementation that replicates the logic exactly as described.  
- Use the exact function and parameter names from the pseudocode without changes.  
- Include any helper classes or data structures mentioned, defined before the main function.  
- Implement all logic, control flows, conditions, loops, and computations precisely, avoiding off-by-one and subtle errors.  
- Use idiomatic, clear, and efficient Python 3 constructs and standard libraries for optimal correctness and performance. You may import any widely available Python package if it clearly enhances clarity or efficiency, but avoid superfluous imports.  
- Handle all edge cases and inputs implied or explicitly indicated by the pseudocode.  
- Use `float('inf')` or `float('-inf')` for positive or negative infinity as needed.  
- Output only valid, runnable Python code, fully self-contained inside a single ```python ... ``` code block. No explanations, comments, or text outside the code block unless a minimal necessary import or class definition is required.  
- Maintain consistent variable names and formatting matching the pseudocode exactly for easy validation.  
- Ensure your solution respects a 5-second runtime limit on typical inputs.

```python
# Your Python 3 implementation here
```
```