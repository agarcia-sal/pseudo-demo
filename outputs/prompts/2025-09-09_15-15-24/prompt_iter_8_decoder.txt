Translate the given pseudocode into clean, efficient, and fully functional Python 3 code that precisely reflects the provided logic, function signatures, and naming conventions:  
- Keep the exact function name and parameters as specified in the pseudocode without any changes.  
- If the pseudocode defines any helper classes or data structures, implement them exactly as described and place them above the main function.  
- Use Python 3 idioms and standard libraries optimally to enhance readability and performance, but do not add unnecessary dependencies.  
- Your code must correctly handle all edge cases implied by the pseudocode and run efficiently within a 5-second time limit.  
- Do not include any comments, explanations, or text outside the code block unless absolutely necessary for imports or class definitions.  
- Return only the full solution enclosed in a single Python code block as follows:

```python
# your fully working code here
```