```python
Convert the given pseudocode into a complete, runnable Python 3 program that exactly preserves the described logic, control flow, and data structures:

- Use the exact function names, signatures, and parameter names from the pseudocode without alteration.
- If any helper classes, data structures, or types are mentioned, define them fully and place them above the main function.
- Ensure all conditionals, loops, variable assignments, and computations match the pseudocode precisely, including edge and boundary cases.
- Write clean, idiomatic, and efficient Python 3 code, leveraging appropriate standard libraries and builtin features for clarity and performance.
- You may import any commonly available Python module if it meaningfully improves correctness, readability, or runtime efficiencyâ€”avoid unnecessary or obscure imports.
- Represent positive and negative infinity using float('inf') and float('-inf') as required.
- Return or output only a single valid Python 3 code snippet enclosed strictly within a ```python ... ``` code block.
- Do not include any explanatory text, comments, or code outside this block.
- Maintain exact variable names and formatting consistent with the pseudocode to facilitate straightforward verification.
- Prioritize correctness and optimal runtime, respecting a strict 5-second execution limit on typical input sizes.
```