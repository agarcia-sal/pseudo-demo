```python
Translate the given pseudocode into an exact, minimal, and fully runnable Python 3 program that strictly complies with these definitive rules:

- Output exactly one Python code block, wrapped only as:
  ```python
  # complete solution here
  ```
- Use only standard input/output via `input()` and `print()` with no prompts, comments, blank lines, or extra text.
- Faithfully preserve all variable, function, and structural names from the pseudocode where meaningful, while adopting idiomatic, concise, and highly efficient Python style.
- Implement the logic precisely as specified, including all edge and implicit cases, without adding any extra scaffolding, debug code, or unused constructs.
- Optimize for speed and memory by:
  - Using the fastest built-ins and expressions (list/set/dict comprehensions, generator expressions, `map`, `filter`, `any`, `all`, `zip`, `divmod`).
  - Preferring built-in Python functions and standard modules (`collections`, `heapq`, `itertools`, `math`, `functools`, `re`, `os`, etc.) only when they offer clearer, simpler, or faster solutions while maintaining exact pseudocode equivalence.
  - Avoiding unnecessary data structures and repeated computations.
  - Minimizing mutable state changes and leveraging unpacking and short-circuiting where applicable.
- If a `main` function or equivalent entry point is indicated, define it verbatim and invoke it under:
  ```python
  if __name__ == "__main__":
      main()
  ```
  ensuring seamless execution in any environment.
- Exclude all comments, explanations, blank lines, or separators entirely.
- Do not import external or third-party packages; only use Python's standard library modules if they demonstrably enhance correctness or performance.
- The solution must execute correctly and efficiently within 5 seconds on typical competitive programming input sizes.
- Do not introduce any assumptions not supported by the pseudocode, nor alter its algorithm beyond exact translation.
- Produce a production-grade, idiomatic, and concise Python script that is ready for immediate use in contests, coding interviews, or performance-critical production scenarios.

Your sole output is the single Python code block as specified, nothing else.
```