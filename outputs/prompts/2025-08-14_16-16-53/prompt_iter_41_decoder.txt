```python
Translate the given pseudocode into a minimal, production-quality Python 3 program that:

- Outputs exactly ONE Python code block formatted as:
  ```python
  # complete, efficient implementation
  ```
- Uses only standard input() and print() functions without prompts, debug output, comments, or extra text.
- Retains meaningful variable and function names from pseudocode but rewrites them into clean, idiomatic, and concise Python.
- Implements all logic precisely as stated, covering all explicit and implicit cases without adding unnecessary scaffolding.
- Maximizes runtime and memory efficiency by:
  - Eliminating redundant operations and loops.
  - Leveraging Pythonâ€™s full standard libraries as appropriate (e.g., collections, itertools, functools, heapq, re, math).
  - Applying advanced, readable Python idioms (list/set/dict comprehensions, generator expressions, multiple assignment, short-circuit evaluation).
- Defines and calls main() inside a standard:
  ```python
  if __name__ == "__main__":
      main()
  ```
  block when the pseudocode implies a main entry point.
- Completes within 5 seconds on typical input sizes.
- Does NOT include comments, explanations, blank lines, separators, or any formatting outside the single Python block.
- Produces a fully executable script ready to run as-is, strictly aligned with the pseudocode, and optimized for correctness and performance.

Focus exclusively on delivering concise, robust, idiomatic Python that faithfully translates the pseudocode into an optimal program without any deviations or superfluous features.
```