```python
Translate the provided pseudocode into a single, minimal, fully functional Python 3 program that exactly reproduces the described logic with these strict requirements:

- Output only one contiguous Python code block, precisely enclosed as:
  ```python
  # complete, optimized, production-ready code here
  ```
- Use unadorned standard input/output via `input()` and `print()` with no prompts, debugging prints, comments, blank lines, or extraneous text.
- Preserve variable and function identifiers from the pseudocode when meaningful, adapting only for idiomatic, highly performant Python style.
- Implement the logic exactly as given—handle all explicit and implicit conditions faithfully without adding frameworks, extra code layers, or assumptions beyond the pseudocode.
- Prioritize maximum runtime and memory efficiency using:
  - Compact, efficient constructs like comprehensions, generator expressions, built-ins (`map`, `filter`, `zip`, `any`, `all`, `divmod`).
  - Standard libraries selectively only if they improve clarity, speed, or reduce complexity, favoring `collections`, `itertools`, `math`, `functools`, `heapq`, `re`, `os`.
  - Avoiding redundant data structures, recomputations, and unnecessary variable assignments.
  - Leveraging short-circuiting and unpacking liberally.
- If the pseudocode defines main or named functions, implement each precisely and invoke `main()` inside the:
  ```python
  if __name__=="__main__":
      main()
  ```
  block for proper execution.
- Do not include comments, blank lines, or separators anywhere inside or outside the code block.
- The solution should be compact yet robust and production-grade, suitable for immediate use in time-critical or competitive programming contexts.
- Ensure the solution completes within 5 seconds on typical input sizes.
- Do not output anything other than the single, exact Python code block—no explanations, clarifications, or extra text.

Focus entirely on delivering the most idiomatic, concise, and exact Python translation of the pseudocode, optimized for speed, clarity, and strict correctness, ready for high-stakes deployment or contests.
```