Translate the given pseudocode into fully functional, clean, and efficient Python code, strictly preserving all class names, function names, method signatures, and class/object hierarchy exactly as specified. Your translation must:

- Use the same variable names and types as in the pseudocode whenever possible; only adopt Python-idiomatic names or types if it is absolutely unambiguous and improves clarity or correctness.
- Precisely implement all logic including loops, recursion, conditionals, and control flows as described, ensuring correctness, handling all implicitly or explicitly suggested edge cases (such as empty inputs, None/null values, boundary conditions, and invalid data), and optimizing for performance under a 5-second runtime constraint.
- Retain all data structures exactly as implied in the pseudocode (lists, dicts, sets, queues, custom classes, etc.) and use appropriate Python standard library modules or widely used third-party libraries only if doing so clearly enhances correctness, readability, or efficiency.
- Reproduce all type hints explicitly if evident from pseudocode; if types are ambiguous or missing, choose the most clear and correct hints possible.
- Avoid adding any new classes, functions, parameters, or global variables not present in the pseudocode.
- Ensure the final code is ready to run and test immediately without modifications.
- When the pseudocode includes values like `null`, treat them as Python `None` accordingly.
- Import all relevant modules explicitly if needed for correctness or clarity.
- Output ONLY the resulting Python code enclosed exactly in a single fenced code block formatted as follows:

```python
# your translated code here
```

- Do NOT add any extra text, explanations, comments outside the code block, debugging statements, separators, or formatting other than the code block.
- Focus meticulously on faithful structural and logical fidelity, completeness, handling all input edge cases, and efficient code style.

Deliver ONLY the valid Python code inside the specified code block.