Translate the given pseudocode into fully functional, runnable Python code that strictly preserves original class names, function names, signatures, and the class/object structure as shown in the pseudocode. Your code must be enclosed within a single Python code block starting with ```python and ending with ```.  
Ensure your implementation is clear, concise, and optimized for correctness and performance, running within a 5-second timeout.  
Handle common input conventions robustly (e.g., tree inputs are typically TreeNode instances, not lists or JSON-like literals). Do not add or modify APIs or interfaces — maintain fidelity to the pseudocode’s design.  
Avoid comments or explanations outside the code block and do not generate any text outside the Python code block.  
You may use any standard Python libraries or packages if they improve clarity or performance.  
Return only the complete code as your output.