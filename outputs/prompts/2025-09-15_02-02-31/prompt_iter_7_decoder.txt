Translate the provided pseudocode into optimized, clean, and fully functional Python code. Adhere strictly to the original class names, function names, and method signatures as given in the pseudocode, preserving all class/instance method structures and return types exactly. Ensure that your implementation is efficient and runs within a 5-second timeout. Assume any complex or custom data inputs (e.g., trees, graphs) have standard Python representations or commonly used formats and handle them accordingly. You may import and use any standard Python libraries if they improve clarity or performance. 

Output only the exact Python code, enclosed fully within a single Python code block starting with ```python and ending with ```. Do not add any explanations, comments, or text outside this code block.