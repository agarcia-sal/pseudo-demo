```plaintext
Translate the provided pseudocode into a complete, clean, and idiomatic Python program that faithfully implements all described logic and data handling. 

- Provide the entire solution enclosed exclusively within one Python code block formatted as follows:

```python
# code here
```

- Use straightforward input() calls with no prompt strings (i.e., use input(), never input("prompt")) to read all input data exactly as implied by the pseudocode.

- Your code must be immediately executable as-is, correctly processing all inputs and producing outputs precisely as dictated by the pseudocode, including multiple input lines, multiple output lines, and complex data structures.

- Avoid adding any text, explanation, or decoration outside the code block; only include minimal, clear inline comments to clarify complex or non-obvious logic.

- Optimize for readability, correctness, and execution speed, ensuring your solution runs efficiently within a 5-second time limit even on large inputs.

- You are encouraged to import and use any relevant Python standard libraries or built-in modules that can improve clarity, robustness, or performance.

- Do not insert any separator lines, headers, or other formatting outside the code block.

- Assume the pseudocode might require handling intricate input patterns, nested loops, conditional branches, or advanced data structuresâ€”your translation must be comprehensive and idiomatic.

- Prioritize idiomatic Python constructs and best practices to produce clean, maintainable, and performant code.
```