Translate the given pseudocode into fully functional, efficient, and idiomatic Python code. Preserve exactly all function and class names, parameter names, and return types as specified in the pseudocode, along with the full class and object hierarchy. Use precise type hints as indicated or best inferred. Implement all logic clearly and concisely, applying Pythonic conventions and standard library usage to maximize correctness, readability, and performance. Import standard Python modules as needed to ensure completeness and avoid runtime errors (e.g., import random, math, copy, etc.).

Strictly do not add any text outside the code. Do not include explanations, comments, or test scaffolding. Do not modify function/class signatures unless explicitly specified in the pseudocode.

Assume the code will be evaluated with typical inputs running under 5 seconds.

Output only your complete translated implementation wrapped exactly in a single Python code block as follows:

```python
# Your translated Python code here
```

No other content outside this code block.