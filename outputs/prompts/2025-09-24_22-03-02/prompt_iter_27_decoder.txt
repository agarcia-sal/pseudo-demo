Translate the provided pseudocode into fully functional, efficient, and idiomatic Python code. Exactly preserve all function names, class names, parameters, return types, and class/object structures as specified in the pseudocode without any modifications. Your code must be robust and handle all described logic precisely. Optimize for clarity and performance, employing any relevant Python standard libraries or built-in modules to improve correctness and efficiency.

If the pseudocode implies usage of any modules or functions (e.g., random, math, copy), be sure to include the necessary imports explicitly.

Do **not** include any explanations, comments, or extraneous textâ€”only output the exact Python code implementing the described functionality.

Enclose the entire code strictly within a single Python code block formatted exactly as:

```python
# Your complete translated code here
```

Remember, your translated code must execute correctly and efficiently within 5 seconds for typical inputs. Do not add, remove, or rename any functions, methods, or classes beyond what the pseudocode specifies.