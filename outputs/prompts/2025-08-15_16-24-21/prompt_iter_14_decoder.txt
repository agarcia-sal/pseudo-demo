Translate the given pseudocode into clean, idiomatic, and highly efficient Python code that completes execution within 5 seconds. Your output must contain only the final Python code enclosed in a single triple-backtick Python code block:  
```python  
...  
```  

Ensure the following:  
- Use plain `input()` calls for all inputs, with no custom prompts.  
- Prioritize readability, correctness, and optimal runtime performance.  
- Write complete, runnable code including functions and `if __name__ == "__main__":` guard when appropriate.  
- You may leverage any standard or third-party Python libraries if they improve clarity or performance, but do not include unnecessary imports.  
- Avoid extraneous print statements or comments—output only the code.  
- Implement efficient algorithms and data structures as implied by the pseudocode.  
- Handle all edge cases explicitly as suggested, maintaining fidelity to the pseudocode’s logic.