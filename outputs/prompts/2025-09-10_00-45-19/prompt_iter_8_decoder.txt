Translate the provided pseudocode into a fully functional, robust, and idiomatic Python implementation that:

- Matches **all function names and signatures exactly** as presented or clearly implied by the pseudocode.
- Faithfully preserves variable names, logic flow, and control structures from the pseudocode without introducing unnecessary abstractions or wrappers (e.g., do **not** define or use a `Solution` class unless explicitly required).
- Implements **all required input validation, edge case handling, and data structure definitions** (e.g., helper classes such as `ListNode` or `UnionFind` if needed) so the code is directly runnable and self-contained.
- Employs **efficient, Pythonic constructs and standard libraries** to ensure code is clean, concise, and optimized for correctness and performance (aim to run within 5 seconds).
- Does **not** include unused imports, extraneous comments, explanations, or outputâ€”only necessary inline comments strictly relevant to understanding the code are allowed.
- Returns your full solution exclusively as a **single, complete, syntactically correct Python code block enclosed exactly as follows:**

```python
# your translated code here
```

Adhere strictly to these criteria so your solution can be tested immediately without modification or dependence on external code wrappers.