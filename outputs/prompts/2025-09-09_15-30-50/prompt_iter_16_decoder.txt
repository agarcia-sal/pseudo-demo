Translate the given pseudocode into a fully self-contained, production-grade Python implementation that faithfully preserves the original function names and signatures. Your generated code must:

- Implement *all* required functions, classes, and data structures precisely, without omissions or placeholders.
- Perform comprehensive, explicit input validation and error handling, including type checks and boundary conditions; raise informative exceptions where invalid inputs are detected.
- Retain all algorithmic steps and variable names from the pseudocode to preserve clarity and semantic meaning.
- Produce clean, idiomatic, efficient Python code optimized for readability and performance, ensuring execution within a 5-second time limit under typical constraints.
- Utilize only standard Python libraries and popular, well-maintained third-party packages **if and only if** they demonstrably improve correctness, clarity, or speed.
- Avoid any comments, explanations, print statements, or extra text outside a single, standalone Python code block.
- Use exact syntax and formatting as below, enclosing just the complete implementation:
```python
# your complete Python code here
```

Here is the pseudocode to translate: