Translate the following pseudocode into correct, clean, and efficient Python code, preserving all function names exactly as stated. Focus on producing a fully working implementation that strictly follows the logic and structure implied by the pseudocode, while optimizing for readability and runtime performance within 5 seconds. Use only standard Python libraries unless absolutely necessary.

- Enclose your entire code output within a single Python code block formatted as:
```python
...your code...
```
- Do not include comments, explanations, or any extra text unless explicitly requested.
- Define all required helper classes or functions that the pseudocode assumes.
- Ensure edge cases described or implied in the pseudocode are properly handled.
- Avoid adding superfluous code or assumptions beyond the pseudocode instructions.
- Write idiomatic Python that uses best practices for clarity and efficiency.

Here is the pseudocode: