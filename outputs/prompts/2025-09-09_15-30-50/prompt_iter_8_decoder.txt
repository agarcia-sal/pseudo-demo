Translate the provided pseudocode into a complete, fully functional, and highly optimized Python implementation that strictly preserves all function names and signatures exactly as given. Your solution must:

- Explicitly handle all edge cases that are described or can be reasonably inferred from the pseudocode.
- Include full definitions of any helper classes, data structures, or functions that the pseudocode relies upon.
- Produce clean, idiomatic, and maintainable Python code, leveraging Python standard libraries or widely accepted efficient third-party packages only if they meaningfully improve performance or clarity. Do not add unnecessary dependencies.
- Guarantee that the implementation runs efficiently, completing well within 5 seconds for typical input sizes.
- Return only the exact Python code, enclosed entirely within one properly formatted Python code block:
```python
# your complete code here
```
- Avoid any explanations, comments, or additional text outside the code block.
- Preserve variable names and logic flow from the pseudocode as much as possible for semantic consistency.

Here is the pseudocode: