Translate the given pseudocode into a complete, efficient, and idiomatic Python implementation that strictly preserves all original function names, signatures, and core logic flow. Your output must:

- Fully implement any helper classes, data structures, or functions referenced or implied by the pseudocode.
- Handle all explicit and implicit edge cases, including boundary conditions and invalid inputs, to ensure robustness.
- Use Python standard libraries and only well-established third-party packages if they substantially improve clarity or performance.
- Prioritize readability, maintainability, and efficiencyâ€”your solution must execute within 5 seconds on typical input sizes.
- Retain variable names and algorithmic structure to preserve the semantic intent of the pseudocode.
- Output only the complete Python code enclosed in a single code block as follows:
```python
# Complete code here
```
- Do not include any explanations, comments, or text outside the code block.

Here is the pseudocode: