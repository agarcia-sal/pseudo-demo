Translate the given pseudocode into a complete, production-ready Python implementation that precisely matches the function names and signatures specified. Your solution must:

- Fully implement all described functions, helper functions, classes, and data structures without omissions.
- Include explicit and defensive input validation to handle edge cases, invalid or unexpected inputs, and boundary conditions robustly.
- Preserve the original algorithmic logic and maintain variable names to keep the semantic intent clear and faithful to the pseudocode.
- Strive for idiomatic, clean, and maintainable Python code optimized for clarity and performance, ensuring it runs efficiently within a 5-second time limit for typical input sizes.
- Use only standard Python libraries, or widely accepted third-party packages if they demonstrably enhance correctness, readability, or runtime efficiency.
- Avoid comments, explanatory text, or anything outside a single, self-contained code block.
- Enclose the entire code solution in exactly this format:

```python
# your complete code here
```

Here is the pseudocode to translate: