Translate the provided pseudocode into a fully functional, optimized, and idiomatic Python implementation that exactly preserves all function names, signatures, and the original algorithmic structure. Your solution must:

- Implement all mentioned or indicated helper functions, classes, and data structures completely.
- Robustly handle all explicit and implicit edge cases, including boundary values and invalid inputs, to ensure correctness and reliability.
- Use only Python standard libraries or widely accepted third-party packages if they clearly enhance clarity, correctness, or performance.
- Maximize both readability and efficiency, ensuring your code runs well within a 5-second time limit for typical input sizes.
- Maintain variable names and logic flow to preserve the intent and semantics of the pseudocode.
- Avoid any comments, explanations, or extra text outside the code.
- Enclose only the complete Python solution in a single code block formatted exactly as:
```python
# your complete code here
```
Here is the pseudocode to translate: