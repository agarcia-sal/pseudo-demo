Translate the given pseudocode into a complete, self-contained, and executable Python implementation that strictly follows these enhanced guidelines:

- Preserve all function names, parameter names, class names, and class/object structures **exactly** as specified in the pseudocode, with identical signatures.
- Include **all** imports explicitly at the very top of the single Python code block, importing **only** what is necessary for correctness, type hints, and robust handling.
- Provide precise and appropriate Python type hints inferred logically from the pseudocode.
- Maintain descriptive variable names consistent with the pseudocode; add concise, meaningful comments only to clarify complex or non-obvious logic.
- Rigorously handle all edge cases and implicit conditions to ensure correctness, robustness, and resilience against invalid or unexpected inputs, without sacrificing readability.
- Use efficient, idiomatic, and optimized Python constructs and standard library modules or widely used packages (if necessary) to ensure your code runs reliably within a 5-second time limit.
- Avoid introducing any additional functions, classes, or variables not defined or implied by the pseudocode.
- Do **not** output any explanatory text, test cases, debugging prints, or separator lines outside the single Python code block.
- Fully enclose your translated solution inside one Python code block formatted exactly as:

```python
# your translated code here
```

Your submission should consist of **only** this code blockâ€”all code must be runnable as-is and adhere to the original algorithmic intent, maximizing correctness, clarity, and runtime reliability.