Translate the given pseudocode into a single, fully executable, clean, idiomatic, and optimized Python function (or functions) that precisely implements the described logic and structure.  
- **Strictly preserve** all function and variable names exactly as given; do not rename or alter them in any way.  
- Your output must contain **only** the final Python code enclosed within a single fenced code block labeled `python`, formatted exactly as:  
```python
# Your translated Python code here
```  
- Ensure your implementation handles **all control flows, edge cases, and implied data types** accurately without fail.  
- Prioritize clarity, efficiency, and minimal complexity in the code; avoid redundant computations or data structures.  
- You may import and use any modules from Python’s standard library or well-known third-party libraries if they enhance correctness, readability, or performance—but do so judiciously, avoiding unnecessary dependencies.  
- Do **not** include any comments, explanations, print statements, or text outside the code block—only pure, production-ready Python code that exactly matches the pseudocode semantics.  
- The solution must be designed to run efficiently within a 5-second execution timeout, suitable for real-world applications.