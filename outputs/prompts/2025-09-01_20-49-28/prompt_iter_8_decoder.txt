Translate the given pseudocode into a fully working, idiomatic Python implementation, strictly preserving all original function names and signatures. Your implementation must be correct, efficient, and concise, leveraging Pythonâ€™s built-in features and standard libraries for readability and performance. Ensure the output contains **only** the Python code enclosed within a single triple-backtick block labeled `python` (```python ... ```), with no explanations, comments, or any text outside the code block. Avoid any extra output or separators. Your code should be optimized to run within 5 seconds and should not include unnecessary code beyond what is required by the pseudocode.