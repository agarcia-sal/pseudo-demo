Translate the given pseudocode into an idiomatic, complete, and efficient Python implementation that preserves all original function names, signatures, and logical structure exactly as described. Your solution must:

- Use Python 3 standard conventions and typing hints if they appear in the pseudocode.
- Be fully functional, syntactically correct, and optimized for clarity, performance, and brevity.
- Leverage Python’s built-ins and standard library intelligently—avoid reinventing common functionality.
- Include necessary imports only if strictly required by the code.
- Produce no output, comments, explanations, or extraneous text—**only** the final code.
- Enclose your entire Python code in a single ```python ... ``` code block.
- Avoid any separator lines, trailing whitespace, or surrounding text.
- Ensure the code executes successfully within 5 seconds on typical inputs.

Deliver just the Python code block with the solution faithful to the pseudocode logic and structure.