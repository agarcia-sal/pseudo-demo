Translate the provided pseudocode into a fully functional, production-quality Python implementation that exactly retains all original function names, parameters, and structural flow. Your translation must be:

- Concise, clear, and idiomatic Python, leveraging standard libraries and built-ins to maximize readability and runtime efficiency.
- Correct and robust, handling typical edge cases implied by the pseudocode.
- Minimalistic: include **only** the final Python code in a single triple-backtick code block labeled `python` (```python ... ```), without any comments, explanations, imports, or extraneous lines unless absolutely necessary for correctness.
- Consistent with type hints when the pseudocode implies data types.
- Free from irrelevant text, separator lines, or output outside the specified code block.
- Optimized so the code executes well within a 5-second limit on typical inputs.

Your output must be solely the Python code block, adhering strictly to these instructions.