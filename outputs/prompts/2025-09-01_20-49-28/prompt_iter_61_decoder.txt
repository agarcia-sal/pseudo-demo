```python
Translate the provided pseudocode into a complete, production-ready Python function that:

- Uses the exact function name, parameter names, and overall logical flow as given, with no assumptions or added features beyond the pseudocode.
- Infers and applies accurate type hints for all parameters and the return type based on the pseudocode context.
- Handles all edge cases and potential input irregularities implied by the pseudocode, ensuring robust, error-free execution.
- Writes clean, efficient, and idiomatic Python code leveraging built-in functions, comprehensions, and standard libraries optimally for clarity and performance.
- Minimizes overhead: imports only essential standard or widely-used well-maintained packages if they clearly add value in speed, readability or reliability; avoid unnecessary imports.
- Avoids redundant calculations, unnecessary variables, or extraneous constructsâ€”prioritize concise, straightforward solutions without sacrificing readability.
- Does not include any logging, debugging code, comments, or test scaffolding.
- Wraps all output strictly inside a single fenced Python code block (```python ... ```) with no additional explanation, headers, or text outside the block.
- Ensures all code executes efficiently within 5 seconds on typical input sizes.

Output only the requested Python code block exactly as specified.
```