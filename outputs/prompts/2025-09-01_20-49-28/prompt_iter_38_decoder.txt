Translate the pseudocode into a fully functional, production-grade Python implementation that strictly preserves all original function names, parameters, and logic. Your output must:

- Contain **only** a single Python code block wrapped in triple backticks labeled `python` (```python ... ```), with no additional text, comments, or explanations.
- Use precise and appropriate type hints inferred from the pseudocode; include minimal necessary imports (standard library or third-party) only if essential for correctness or enhanced efficiency.
- Produce clear, idiomatic, and optimized Python code prioritizing correctness, readability, and runtime efficiency, fully leveraging Python’s built-ins, standard library modules, or well-established third-party packages where they add value without bloat.
- Implement all implied edge cases robustly, ensuring your solution completes well within 5 seconds on typical inputs.
- Avoid redundant computations, unnecessary variable assignments, or extraneous scaffolding; your code must be lean yet maintain clarity.
- Preserve exact intended behavior and structure from pseudocode without adding placeholders or assumptions beyond what is explicitly or strongly implied.
- Do not include debugging, logging, or test code—just the clean, ready-to-use function(s).

Strictly output only the Python code block exactly as specified.