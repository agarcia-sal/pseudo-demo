Translate the given pseudocode into a clean, idiomatic, and production-grade Python implementation that strictly preserves all original function names, parameters, and control flow. Your output must:

- Use Python 3.10+ features and standard libraries to create concise, efficient, and readable code.
- Include precise type hints reflecting any types implied by the pseudocode.
- Handle all edge cases logically inferred from the pseudocode without adding unwarranted assumptions.
- Contain **only** the final code inside a single triple-backtick Python code block ```python ... ``` with no comments, explanations, extra imports, or any text outside the blockâ€”imports are allowed only if clearly necessary for correctness or efficiency.
- Optimize so the solution easily executes within 5 seconds on typical inputs.
- Avoid unnecessary data structures or loops while maintaining clarity and correctness.
- Maintain function signatures exactly as specified in the pseudocode.

Output nothing other than this Python code block.