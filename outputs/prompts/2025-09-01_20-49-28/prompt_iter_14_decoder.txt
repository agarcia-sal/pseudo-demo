Translate the provided pseudocode into a fully functional, idiomatic Python implementation that exactly preserves all original function names, argument names, and the overall structure. Your Python code must be concise, efficient, and highly readableâ€”favor clear Pythonic constructs and leverage the standard library and built-in features optimally for both runtime performance and code clarity. You may include imports if and only if they are strictly necessary for correctness or optimality.  
Return only the Python code enclosed in a single triple-backtick code block labeled `python` (```python ... ```).  
Do not include any explanations, comments, extra output, or separator lines.  
Ensure your code runs correctly within 5 seconds on typical inputs and uses minimal necessary dependencies.  
If type hints were present or implied in the pseudocode, include them exactly as indicated.  
Do not alter function signatures or behavior in any way from the pseudocode.