Translate the given pseudocode into a complete, idiomatic Python implementation that strictly preserves all original function names and structure. Your code must be correct, clean, and optimized for both readability and performance, leveraging Pythonâ€™s standard library and builtin features where suitable. Use clear, concise constructs without unnecessary verbosity or extraneous elements. Enclose **only** the entire Python solution within a single triple-backtick code block labeled `python` (```python ... ```). Do **not** include explanations, comments, imports unless required for correctness, or any output beyond this block. The code must run under 5 seconds and must not contain any separator lines or extra surrounding text.