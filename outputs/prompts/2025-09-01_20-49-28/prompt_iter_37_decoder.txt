Translate the provided pseudocode into a Python implementation that is fully optimized, idiomatic, and production-ready. Your translation must strictly:

- Preserve exact function names, parameter names, and the logic flow as described in the pseudocode.
- Include precise and minimal Python type hints using appropriate imports from `typing` only if necessary.
- Produce self-contained, concise code with the minimal required standard library imports.
- Utilize efficient Python built-ins, data structures, and language features to maximize clarity and runtime performance.
- Handle all typical and edge cases implicitly or explicitly as logically implied by the pseudocode.
- Avoid any superfluous code such as comments, print statements, debugging scaffolds, or placeholders.
- Fit all code inside a single Python code block denoted by triple backticks followed by `python` (i.e., ```python ... ```).
- Exclude any text or explanation outside the code block.
- Do not add extraneous whitespace or separate functions with extra lines beyond PEP 8 style norms.
- Complete execution well within a 5-second limit for typical inputs.
  
Your output must be **only** the Python code block.