Translate the given pseudocode into an exact, fully functional Python implementation that strictly preserves all original function names, parameter names, and overall control flow. Your translation must meet these criteria:

- Produce concise, clear, and idiomatic Python code that leverages standard library modules and built-ins to maximize readability, correctness, and runtime efficiency.
- Include precise and consistent type annotations if implied or explicit in the pseudocode.
- Your implementation must be robust and correct, gracefully handling any typical edge cases or inputs reasonably inferred from the pseudocode.
- You may use Python standard libraries or well-known built-in modules where appropriate to optimize clarity and performance.
- Return **only** the final Python code enclosed within a single triple-backtick python code block (```python ... ```), with no comments, explanations, imports, or extraneous content unless the import is strictly required by your code.
- Do not emit any separator lines, blank lines outside the block, or other text before or after the code block.
- Optimize your code to execute efficiently, targeting a runtime well within 5 seconds on typical inputs.

Strictly follow these instructions for maximal clarity and automated evaluation compatibility.