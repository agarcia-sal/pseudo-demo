```python
Translate the given pseudocode into a single, fully functional, idiomatic Python function that:

- Preserves all original function names, parameter names, and overall logic precisely, without introducing speculative or extraneous elements.
- Includes explicit and accurate type hints for all parameters and return values, inferred solely from the pseudocode.
- Is enclosed exclusively within one Python code block labeled as python (```python ... ```), with absolutely no additional text, comments, or explanations outside the block.
- Imports only standard library modules that are definitively essential for correctness, clarity, or performance; third-party libraries are allowed only if they unequivocally enhance performance or code quality and do not add unnecessary bloat.
- Produces clean, readable, and optimized code that uses Pythonic constructs—such as comprehensions, generator expressions, built-in functions, and relevant standard library utilities—while avoiding duplicated work or redundant variables.
- Thoroughly implements all implied edge cases, input validations, and boundary conditions suggested by the pseudocode, ensuring robustness.
- Avoids any debugging, logging, or test scaffolding artifacts.
- Maintains optimal runtime performance, guaranteeing the execution completes well within 5 seconds on typical inputs.
- Returns exactly what the pseudocode specifies, with no added functionality or assumptions beyond what is directly expressed.

Strictly output only the single Python code block as specified, no explanations or extra content outside it.
```