```python
Translate the given pseudocode into a single, executable, and idiomatic Python function that:

- Retains all original function and parameter names exactly as in the pseudocode without adding, renaming, or removing any identifiers.
- Includes explicit, precise type hints derived logically from the pseudocode's inputs and outputs.
- Handles all edge cases and input anomalies conveyed or implied by the pseudocode, ensuring robust behavior without assumptions beyond the description.
- Avoids any speculative or placeholder code; implementation must strictly reflect the pseudocode logic and intent.
- Produces clean, concise, and efficient Python code leveraging built-in functions, comprehensions, itertools, collections, typing, and other standard libraries as appropriate; third-party libraries may be used only if they unambiguously improve clarity or performance without unnecessary dependencies.
- Minimizes unnecessary variables, redundant computations, and verbose constructs while preserving readability and maintainability.
- Does not include comments, debugging statements, logging, print calls, or test scaffoldingâ€”output must contain solely the implemented function with any necessary imports.
- Wraps all code in a single fenced Python code block labeled ```python``` with no additional text before or after.

Strictly output only this Python code block.
```