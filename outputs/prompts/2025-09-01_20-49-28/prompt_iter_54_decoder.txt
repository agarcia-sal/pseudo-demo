```markdown
Translate the given pseudocode into a single, clean, production-ready Python function that:

- Uses **exactly** the function names, parameter names, and overall logic structure as given in the pseudocode without adding, removing, or guessing beyond what is explicitly specified.
- Provides full and precise type hints, inferring types strictly from the pseudocode input/output information.
- Handles all reasonable edge cases implied or typical for the operation, including empty inputs or invalid states, raising meaningful exceptions only if absolutely necessary.
- Writes highly idiomatic, efficient, and readable Python code by leveraging built-ins, comprehensions, generators, standard libraries, and language features optimally.
- Produces minimal, focused importsâ€”only standard library modules are allowed unless third-party libraries offer significant clarity or performance benefits without any overhead.
- Contains no debugging, logging, comments, or extraneous print statements.
- Completes execution well within 5 seconds on typical inputs.
- Outputs exactly one Python code block labeled as ```python that contains only the final complete implementation without any surrounding explanation, commentary, or additional text.

Strictly conform to these guidelines. Provide only the Python code block in your response.
```