```python
Translate the provided pseudocode into a precise, idiomatic, and production-quality Python implementation that meets the following criteria:

- Retain all function names, parameter names, and the logical structure exactly as in the pseudocode without adding, removing, or altering intended behavior.
- Infer and add explicit, accurate type hints for all function signatures and variables wherever possible.
- Implement complete, robust handling of all implied edge cases and input irregularities that can be reasonably deduced.
- Produce concise, clear, and highly optimized Python code by utilizing built-in functions, comprehensions, standard library modules, and efficient algorithmsâ€”minimizing time and space complexity.
- Avoid any superfluous variables, redundant computations, or unnecessary control flow; make the code as lean as possible without sacrificing clarity or correctness.
- Limit imports strictly to essential standard libraries or built-in modules; third-party libraries are allowed only if they significantly boost performance or code clarity without introducing bloat.
- Do not include comments, debug/log statements, explanations, or any text outside a single Python code block.
- Enclose the entire implementation in one triple-backtick code block labeled `python` (```python ... ```).
- Ensure the solution executes efficiently within 5 seconds on typical input sizes, balancing performance with maintainability.

Only return the complete Python code block, nothing else.
```