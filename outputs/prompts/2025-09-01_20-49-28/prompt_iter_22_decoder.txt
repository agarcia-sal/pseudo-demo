Translate the given pseudocode into a clean, efficient, and fully functional Python implementation that strictly preserves all original function names, parameters, and control flow. Your translation must:

- Use idiomatic, production-quality Python with standard libraries and concise constructs to maximize readability and efficiency.
- Include precise type hints when the pseudocode implies data types.
- Properly handle typical edge cases that can be inferred from the pseudocode logic.
- Contain only the final Python code enclosed within a single triple-backtick Python code block (```python ... ```).
- Avoid any comments, explanations, imports, or extra output lines unless absolutely required for correctness or type hinting.
- Not include separator lines or unrelated text.
- Run efficiently enough to comfortably meet a 5-second execution limit on typical inputs.
- Use standard or well-known third-party packages only if explicitly necessary for correctness or notable performance gains.

Your entire output must be exactly one Python code block as specified, containing only the translated code and nothing else.