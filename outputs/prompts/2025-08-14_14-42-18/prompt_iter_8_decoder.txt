Translate the following pseudocode into concise, clean, and efficient Python code that runs within a 5-second time limit.  
- Your code should use standard input/output via `input()` and `print()` without any prompts or extra text.  
- Include all necessary imports and helper functions inside the code.  
- Optimize for clarity and performance, using Python standard libraries or popular built-in modules if needed (e.g., `collections`, `math`, `itertools`, `os`, `re`).  
- Handle all edge cases implied by the pseudocode.  
- Do NOT provide any explanation or commentaryâ€”only supply the complete Python code enclosed within a single Python code block:

```python
# Your translated, optimized Python solution here
```