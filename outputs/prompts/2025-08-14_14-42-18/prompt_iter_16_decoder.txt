```plaintext
You are given a pseudocode snippet. Translate it into a single, clean, fully functional Python script that:

- Is enclosed only within one Python code block as shown below:
```python
# complete code here
```
- Uses plain input() calls with no prompts or arguments inside them.
- Contains all necessary imports and helper code explicitly—nothing needed should be omitted.
- Implements the pseudocode logic exactly with no additional input/output or debugging statements.
- Handles all implicit and explicit edge cases with full correctness.
- Produces idiomatic, efficient, and production-quality Python code optimized for clarity, speed, and memory within a strict 5-second runtime.
- Leverages any standard library or widely available packages such as collections, heapq, itertools, functools, math, bisect, sys, pathlib, re, numpy, or others as appropriate to maximize performance and readability.
- Prefers algorithmic best practices, vectorized operations, and well-known optimization patterns over simple or naive methods.
- Ensures that input parsing, processing, and output printing strictly follow the pseudocode’s described flow with zero deviations.

Do NOT output anything other than the exact Python code within the prescribed single code block. No explanations, no comments, no narrative—only the complete runnable Python script.
```