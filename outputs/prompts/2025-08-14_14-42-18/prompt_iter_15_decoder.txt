```plaintext
Translate the provided pseudocode into optimized, production-quality Python code meeting the following requirements:

- Return only runnable Python code enclosed within a single, clean Python code block like this:
```python
# your code here
```
- Use **only** plain `input()` calls (no prompts inside input).
- Include all necessary imports and helper functions explicitly; do not omit any needed code.
- Exclude all comments, explanations, or any text outside the code block—only the complete code is allowed.
- Optimize for both clarity and maximum runtime efficiency within a 5-second execution limit.
- Robustly handle all edge cases implied or suggested by the pseudocode.
- Utilize any built-in or third-party Python libraries available in the standard environment, including `collections`, `heapq`, `itertools`, `math`, `functools`, `bisect`, `sys`, `pathlib`, `re`, `numpy`, or others as needed.
- Prefer idiomatic, vectorized, or well-known algorithmic solutions over naïve implementations to improve speed and memory efficiency.
- Ensure input reading and output printing follow the pseudocode logic exactly with no extra input/output or debugging statements.

Do not output anything other than the precise Python code solution inside the single code block.
```