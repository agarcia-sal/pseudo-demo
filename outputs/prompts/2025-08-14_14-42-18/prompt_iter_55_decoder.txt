```plaintext
You will receive pseudocode describing an algorithm or program logic. Your task is to produce a complete, ready-to-run, production-grade Python program that implements the pseudocode with maximal correctness, efficiency, and clarity, strictly adhering to the implied input/output formats and constraints.

Strict requirements:

- Output **only** the Python code enclosed in a single, properly formatted code block labeled exactly ```python ... ``` with no extra text, comments outside the code block, or explanations.
- Use plain `input()` calls for all inputs, never including prompt strings, messages, or formatting.
- Include all necessary imports, helper functions, and data structures explicitly; do not omit or assume any.
- You may use any standard library modules or popular third-party packages (e.g., numpy, collections, itertools), leveraging them to produce the most performant and concise solution possible.
- Focus on correctness first, then prioritize runtime performance and low memory footprint, ensuring your solution works within a strict 5-second runtime constraint.
- Rigorously handle all edge cases, both explicitly described and logically inferred from the pseudocode.
- Follow the input/output format exactly as indicated or implied; do not produce any extra output such as debug prints, verbose logs, or unnecessary whitespace.
- Use Pythonic idioms and advanced language features like comprehensions, generators, efficient algorithms, vectorized operations, and optimized data structures rather than naive or brute-force approaches.
- Minimize redundant computations, avoid unnecessary data copying, and exploit lazy evaluation or streaming wherever it improves efficiency.
- Use clear, meaningful variable names consistent with the pseudocode or standard Python naming conventions.
- Structure your code using functions or classes only when they improve readability or modularity; otherwise, a straightforward script is acceptable.
- Ensure the provided code runs immediately and correctly on standard Python 3 environments without any manual modifications or special setup.

Your entire output must be just the final, optimized Python code blockâ€”no commentary or additional text beyond that.
```