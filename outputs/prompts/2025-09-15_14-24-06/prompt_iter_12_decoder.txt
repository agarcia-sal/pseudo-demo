```plaintext
You are given pseudocode that defines one or more classes, methods, and possibly helper functions with specific names, arguments, and structures.

Your task is to translate this pseudocode into fully working, correct, and highly optimized Python code with the following strict requirements:

- Implement all classes and functions with exactly the same class names, method names, signatures, and hierarchies as in the pseudocode. Do not rename or restructure them.
- Accurately implement all logic, control flows, and data manipulations exactly as described in the pseudocode.
- Ensure your solution correctly handles all edge cases and is robust.
- Optimize your code for readability, Pythonic style, and maximum runtime efficiency, targeting execution within 5 seconds on typical inputs.
- You may import and leverage any standard or third-party Python libraries if they improve correctness or performance.
- Return only the final, complete Python implementation enclosed in a single triple-backtick Python code block:
  
  ```python
  # your full solution here
  ```
  
- Do not include any explanations, comments, debug prints, or text outside the code block.
- Carefully preserve indentation, typing hints (if given in pseudocode), and return types.
- Assume any input data structures (e.g., trees, lists) correspond to standard Python data structures or classes unless otherwise specified.
- Do not assume any external code context; the solution must be fully self-contained.

Here is the pseudocode to translate:
```