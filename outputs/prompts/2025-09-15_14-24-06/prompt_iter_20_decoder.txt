Translate the given pseudocode into clean, efficient, and idiomatic Python code enclosed in a single code block. Preserve every class name, method name, and method signature exactly as presented in the pseudocode, maintaining the full original class and method structure without any renaming, reordering, or additional wrapper code. Ensure your implementation correctly handles all edge cases and is optimized to run under 5 seconds for typical inputs. You may utilize any built-in or third-party Python libraries to enhance correctness and performance.  
Output only the final Python code wrapped precisely as follows, without any extra text, comments, or explanation outside the code block:

```python
# your code here
```

Here is the pseudocode to translate: