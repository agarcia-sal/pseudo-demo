Translate the provided pseudocode into precise, optimized, and Pythonic code, strictly preserving all class names, method names, and their signatures exactly as given in the pseudocode. Maintain the original class and method hierarchy without any renaming or restructuring. Your implementation must correctly handle all edge cases and aim for both clarity and maximum performance, ensuring it runs within 5 seconds on typical inputs. You may leverage any standard or third-party Python libraries that can improve correctness or efficiency. Return only the final complete solution enclosed in a single Python code block using the syntax:

```python
# your code here
```

Do not include any explanations, comments, or text outside this code block. Here is the pseudocode to translate: