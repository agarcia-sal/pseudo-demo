Translate the given pseudocode into fully functional, optimized, and idiomatic Python code that precisely preserves all class names, method names, parameters, and their signatures exactly as specified. Maintain the class hierarchy and method structure without any renaming, flattening, or restructuring. Handle every edge case explicitly and ensure the solution is performant and robust within a 5-second runtime constraint for standard input sizes. You may freely import and use any built-in or third-party Python libraries to maximize correctness, readability, and efficiency.

Output only the complete Python implementation inside a single code block formatted exactly as:

```python
# code here
```

Include no explanations, comments, or anything outside this code block.

Here is the pseudocode to translate: