FUNCTION closest_integer(value STRING) RETURNS INTEGER
    SET count_of_dot TO NUMBER OF OCCURRENCES OF CHARACTER '.' IN value
    IF count_of_dot EQUALS 1 THEN
        WHILE LAST CHARACTER OF value EQUALS CHARACTER '0' DO
            SET value TO SUBSTRING OF value FROM START TO SECOND LAST CHARACTER
    END IF

    SET num TO CONVERSION OF value FROM STRING TO FLOAT

    IF LAST TWO CHARACTERS OF value EQUAL '.5' THEN
        IF num GREATER THAN 0 THEN
            SET res TO CALL ceil WITH ARGUMENT num
        ELSE
            SET res TO CALL floor WITH ARGUMENT num
        END IF
    ELSE IF LENGTH OF value GREATER THAN 0 THEN
        SET res TO CONVERSION TO INTEGER OF CALL round WITH ARGUMENT num
    ELSE
        SET res TO 0
    END IF

    RETURN res
END FUNCTION