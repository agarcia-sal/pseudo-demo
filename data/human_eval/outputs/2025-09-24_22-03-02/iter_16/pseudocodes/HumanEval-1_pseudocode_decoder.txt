FUNCTION separate_paren_groups(paren_string : STRING) RETURNS LIST OF STRING
    SET result TO EMPTY LIST
    SET current_string TO EMPTY LIST
    SET current_depth TO 0

    FOR EACH c IN paren_string
        IF c EQUALS '('
            SET current_depth TO current_depth PLUS 1
            CALL current_string.APPEND WITH ARGUMENT c
        ELSE IF c EQUALS ')'
            SET current_depth TO current_depth MINUS 1
            CALL current_string.APPEND WITH ARGUMENT c

            IF current_depth EQUALS 0
                SET joined_string TO EMPTY STRING
                FOR EACH element IN current_string
                    SET joined_string TO joined_string CONCATENATE element
                END FOR
                CALL result.APPEND WITH ARGUMENT joined_string
                CALL current_string.CLEAR
            END IF
        END IF
    END FOR

    RETURN result
END FUNCTION