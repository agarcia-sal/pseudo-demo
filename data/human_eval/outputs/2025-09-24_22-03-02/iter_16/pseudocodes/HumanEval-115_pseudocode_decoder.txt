FUNCTION max_fill(grid, capacity)
    IMPORT math
    SET total_lowerings TO 0
    FOR EACH arr IN grid
        SET sum_units TO 0
        FOR EACH unit IN arr
            SET sum_units TO sum_units PLUS unit
        END FOR
        SET lowerings_for_well TO CALL math.ceil WITH ARGUMENT sum_units DIVIDE BY capacity
        SET total_lowerings TO total_lowerings PLUS lowerings_for_well
    END FOR
    RETURN total_lowerings
END FUNCTION