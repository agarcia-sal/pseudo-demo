FUNCTION how_many_times WITH PARAMETERS string, substring
    SET times TO 0
    SET string_length TO CALL len WITH ARGUMENT string
    SET substring_length TO CALL len WITH ARGUMENT substring
    SET limit TO string_length MINUS substring_length PLUS 1
    FOR i IN RANGE FROM 0 TO limit MINUS 1
        SET segment TO EMPTY STRING
        FOR j IN RANGE FROM 0 TO substring_length MINUS 1
            SET index TO i PLUS j
            SET character TO string AT INDEX index
            SET segment TO segment CONCATENATE character
        END FOR
        IF segment EQUALS substring THEN
            SET times TO times PLUS 1
        END IF
    END FOR
    RETURN times