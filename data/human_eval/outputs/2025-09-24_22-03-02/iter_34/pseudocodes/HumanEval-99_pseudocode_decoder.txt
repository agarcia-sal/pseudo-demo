FUNCTION closest_integer(value)
    IMPORT floor FROM math
    IMPORT ceil FROM math

    SET dot_count TO 0
    FOR index FROM 0 TO LENGTH OF value MINUS 1
        IF CHARACTER AT value AT index EQUALS '.'
            INCREMENT dot_count BY 1
    IF dot_count EQUALS 1
        SET finished TO FALSE
        WHILE finished EQUALS FALSE
            IF CHARACTER AT value AT LENGTH OF value MINUS 1 EQUALS '0'
                SET value TO SUBSTRING OF value FROM START TO LENGTH OF value MINUS 1
            ELSE
                SET finished TO TRUE

    SET num TO CALL float WITH ARGUMENT value

    SET last_two_chars TO EMPTY STRING
    IF LENGTH OF value GREATER THAN OR EQUAL TO 2
        SET last_two_chars TO SUBSTRING OF value FROM LENGTH OF value MINUS 2 TO LENGTH OF value

    IF last_two_chars EQUALS '.5'
        IF num GREATER THAN 0
            SET res TO CALL ceil WITH ARGUMENT num
        ELSE
            SET res TO CALL floor WITH ARGUMENT num
    ELSE
        IF LENGTH OF value GREATER THAN 0
            SET res TO CALL round WITH ARGUMENT num
            SET res TO CALL int WITH ARGUMENT res
        ELSE
            SET res TO 0

    RETURN res