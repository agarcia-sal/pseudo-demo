FUNCTION vowels_count WITH PARAMETER s
    SET vowels TO STRING "aeiouAEIOU"
    SET n_vowels TO 0
    SET length_s TO LENGTH OF s
    FOR i FROM 0 TO length_s MINUS 1
        SET c TO CHARACTER AT INDEX i IN s
        SET j TO 0
        SET found TO FALSE
        WHILE j LESS THAN LENGTH OF vowels AND found EQUALS FALSE
            IF c EQUALS CHARACTER AT INDEX j IN vowels
                SET found TO TRUE
            END IF
            INCREMENT j BY 1
        END WHILE
        IF found EQUALS TRUE
            SET n_vowels TO n_vowels PLUS 1
        END IF
    END FOR
    IF length_s GREATER THAN 0
        SET last_char TO CHARACTER AT INDEX length_s MINUS 1 IN s
        IF last_char EQUALS "y" OR last_char EQUALS "Y"
            SET n_vowels TO n_vowels PLUS 1
        END IF
    END IF
    RETURN n_vowels