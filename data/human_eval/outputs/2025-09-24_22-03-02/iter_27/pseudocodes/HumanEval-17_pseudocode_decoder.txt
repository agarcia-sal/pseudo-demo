FUNCTION parse_music WITH PARAMETER music_string OF TYPE str RETURNS List OF int
    SET note_map TO DICTIONARY WITH ELEMENTS 'o' MAPPED TO 4, 'o|' MAPPED TO 2, '.|' MAPPED TO 1
    SET split_list TO EMPTY LIST
    SET i TO 0
    WHILE i LESS THAN LENGTH OF music_string
        SET current_char TO CHARACTER AT INDEX i OF music_string
        IF current_char EQUALS ' '
            INCREMENT i BY 1
            CONTINUE
        END IF
        SET token TO EMPTY STRING
        WHILE i LESS THAN LENGTH OF music_string AND CHARACTER AT INDEX i OF music_string NOT EQUAL TO ' '
            CONCATENATE token WITH CHARACTER AT INDEX i OF music_string
            INCREMENT i BY 1
        END WHILE
        APPEND token TO split_list
    END WHILE
    SET result_list TO EMPTY LIST
    SET j TO 0
    WHILE j LESS THAN LENGTH OF split_list
        SET x TO ELEMENT AT INDEX j OF split_list
        IF x NOT EQUAL TO EMPTY STRING
            SET value TO ELEMENT WITH KEY x FROM note_map
            APPEND value TO result_list
        END IF
        INCREMENT j BY 1
    END WHILE
    RETURN result_list