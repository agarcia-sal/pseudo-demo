FUNCTION closest_integer(value)
    IMPORT floor FROM math
    IMPORT ceil FROM math

    IF CALL value.count WITH ARGUMENT '.' EQUALS 1 THEN
        WHILE CALL value.GET CHARACTER AT INDEX LENGTH OF value MINUS 1 EQUALS '0' DO
            SET value TO SLICE value FROM START TO LENGTH OF value MINUS 1
        END WHILE
    END IF

    SET num TO CALL float WITH ARGUMENT value

    IF SLICE value FROM LENGTH OF value MINUS 2 TO END EQUALS '.5' THEN
        IF num GREATER THAN 0 THEN
            SET res TO CALL ceil WITH ARGUMENT num
        ELSE
            SET res TO CALL floor WITH ARGUMENT num
        END IF
    ELSE IF LENGTH OF value GREATER THAN 0 THEN
        SET res TO CALL round WITH ARGUMENT num
        SET res TO CONVERT res TO INTEGER
    ELSE
        SET res TO 0
    END IF

    RETURN res
END FUNCTION