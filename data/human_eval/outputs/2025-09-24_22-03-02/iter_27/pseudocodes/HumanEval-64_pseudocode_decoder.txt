FUNCTION vowels_count(s)
    SET vowels TO STRING "aeiouAEIOU"
    SET n_vowels TO 0
    SET index TO 0
    WHILE index LESS THAN LENGTH OF s
        SET c TO CHARACTER AT POSITION index IN s
        SET found_vowel TO FALSE
        SET vowel_index TO 0
        WHILE vowel_index LESS THAN LENGTH OF vowels
            IF c EQUALS CHARACTER AT POSITION vowel_index IN vowels
                SET found_vowel TO TRUE
                BREAK
            ENDIF
            INCREMENT vowel_index BY 1
        ENDWHILE
        IF found_vowel EQUALS TRUE
            INCREMENT n_vowels BY 1
        ENDIF
        INCREMENT index BY 1
    ENDWHILE
    IF LENGTH OF s GREATER THAN 0
        SET last_char TO CHARACTER AT POSITION LENGTH OF s MINUS 1 IN s
        IF last_char EQUALS STRING 'y' OR last_char EQUALS STRING 'Y'
            INCREMENT n_vowels BY 1
        ENDIF
    ENDIF
    RETURN n_vowels
END FUNCTION