FUNCTION minPath(grid, k)
    SET n TO LENGTH OF grid
    SET val TO n MULTIPLY n PLUS 1
    FOR i FROM ZERO TO n MINUS 1
        FOR j FROM ZERO TO n MINUS 1
            IF grid AT i AT j EQUALS 1 THEN
                SET temp TO LIST WITH ELEMENTS EMPTY
                IF i NOT EQUAL TO ZERO THEN
                    APPEND grid AT i MINUS 1 AT j TO temp
                END IF
                IF j NOT EQUAL TO ZERO THEN
                    APPEND grid AT i AT j MINUS 1 TO temp
                END IF
                IF i NOT EQUAL TO n MINUS 1 THEN
                    APPEND grid AT i PLUS 1 AT j TO temp
                END IF
                IF j NOT EQUAL TO n MINUS 1 THEN
                    APPEND grid AT i AT j PLUS 1 TO temp
                END IF
                SET val TO temp AT ZERO
                FOR index FROM ONE TO LENGTH OF temp MINUS 1
                    IF temp AT index LESS THAN val THEN
                        SET val TO temp AT index
                    END IF
                END FOR
            END IF
        END FOR
    END FOR
    SET ans TO LIST WITH ELEMENTS EMPTY
    FOR i FROM ZERO TO k MINUS 1
        IF i MODULO TWO EQUALS ZERO THEN
            APPEND 1 TO ans
        ELSE
            APPEND val TO ans
        END IF
    END FOR
    RETURN ans
END FUNCTION