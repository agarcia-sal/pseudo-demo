FUNCTION sort_array(arr)
    SET sorted_by_value TO CALL sorted WITH ARGUMENTS arr
    DEFINE FUNCTION count_ones(x)
        SET binary_representation TO CALL bin WITH ARGUMENT x
        SET binary_string TO SUBSTRING OF binary_representation FROM INDEX 2 TO END
        SET ones_count TO COUNT OF CHARACTER '1' IN binary_string
        RETURN ones_count
    END FUNCTION
    SET final_sorted TO CALL sorted WITH ARGUMENTS sorted_by_value AND key FUNCTION count_ones
    RETURN final_sorted
END FUNCTION