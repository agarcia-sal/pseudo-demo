FUNCTION separate_paren_groups(paren_string : str) RETURNS List OF str
    SET result TO empty List OF str
    SET current_string TO empty List OF str
    SET current_depth TO 0

    FOR index FROM 0 TO LENGTH OF paren_string MINUS 1
        SET c TO paren_string AT index

        IF c EQUALS '('
            SET current_depth TO current_depth PLUS 1
            CALL current_string APPEND WITH ARGUMENTS c

        ELSE IF c EQUALS ')'
            SET current_depth TO current_depth MINUS 1
            CALL current_string APPEND WITH ARGUMENTS c

            IF current_depth EQUALS 0
                SET combined_string TO empty String
                FOR i FROM 0 TO LENGTH OF current_string MINUS 1
                    SET combined_string TO combined_string PLUS current_string AT i
                END FOR
                CALL result APPEND WITH ARGUMENTS combined_string

                CALL current_string CLEAR WITH NO ARGUMENTS
            END IF
        END IF
    END FOR

    RETURN result
END FUNCTION