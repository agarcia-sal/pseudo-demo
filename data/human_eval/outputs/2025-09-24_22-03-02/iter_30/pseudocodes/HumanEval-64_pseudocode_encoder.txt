FUNCTION vowels_count WITH PARAMETER s
    SET vowels TO STRING WITH ELEMENTS "aeiouAEIOU"
    SET n_vowels TO 0
    SET length_s TO LENGTH OF s
    SET index TO 0
    WHILE index LESS THAN length_s
        SET c TO CHARACTER OF s AT index
        SET found_vowel TO FALSE
        SET v_index TO 0
        SET vowels_length TO LENGTH OF vowels
        WHILE v_index LESS THAN vowels_length AND found_vowel EQUALS FALSE
            IF c EQUALS CHARACTER OF vowels AT v_index THEN
                SET found_vowel TO TRUE
            END IF
            INCREMENT v_index BY 1
        END WHILE
        IF found_vowel EQUALS TRUE THEN
            SET n_vowels TO n_vowels PLUS 1
        END IF
        INCREMENT index BY 1
    END WHILE
    IF length_s GREATER THAN 0 THEN
        SET last_char TO CHARACTER OF s AT length_s MINUS 1
        IF last_char EQUALS "y" OR last_char EQUALS "Y" THEN
            SET n_vowels TO n_vowels PLUS 1
        END IF
    END IF
    RETURN n_vowels