FUNCTION filter_by_substring WITH PARAMETERS strings OF TYPE List OF str, substring OF TYPE str RETURNS List OF str
    SET filtered_strings TO LIST WITH ELEMENTS EMPTY
    SET index TO 0
    WHILE index LESS THAN LENGTH OF strings
        SET current_string TO strings AT INDEX index
        SET found TO FALSE
        SET sub_index TO 0
        SET substring_length TO LENGTH OF substring
        SET string_length TO LENGTH OF current_string
        WHILE sub_index LESS THAN OR EQUAL TO string_length MINUS substring_length AND found EQUALS FALSE
            SET match TO TRUE
            SET char_index TO 0
            WHILE char_index LESS THAN substring_length AND match EQUALS TRUE
                IF current_string AT INDEX sub_index PLUS char_index NOT EQUALS substring AT INDEX char_index
                    SET match TO FALSE
                INCREMENT char_index BY 1
            END WHILE
            IF match EQUALS TRUE
                SET found TO TRUE
            INCREMENT sub_index BY 1
        END WHILE
        IF found EQUALS TRUE
            APPEND current_string TO filtered_strings
        INCREMENT index BY 1
    END WHILE
    RETURN filtered_strings
END FUNCTION