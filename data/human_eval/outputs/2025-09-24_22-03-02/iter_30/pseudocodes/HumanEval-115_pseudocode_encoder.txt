FUNCTION max_fill WITH PARAMETERS grid, capacity
    SET import_math TO TRUE
    
    SET total_lowerings TO 0
    
    FOR i FROM 0 TO LENGTH OF grid MINUS 1
        SET arr TO grid AT INDEX i
        SET sum_units TO 0
        
        FOR j FROM 0 TO LENGTH OF arr MINUS 1
            SET sum_units TO sum_units PLUS arr AT INDEX j
        
        SET lowers_for_arr TO CALL math CEIL WITH ARGUMENT sum_units DIVIDE BY capacity
        SET total_lowerings TO total_lowerings PLUS lowers_for_arr
    
    RETURN total_lowerings