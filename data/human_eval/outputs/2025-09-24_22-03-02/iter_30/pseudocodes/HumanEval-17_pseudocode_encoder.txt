FUNCTION parse_music WITH PARAMETER music_string OF TYPE STRING RETURNS LIST OF INTEGER
    SET note_map TO DICTIONARY WITH KEYS AND VALUES:
        KEY 'o' ASSOCIATED WITH VALUE 4
        KEY 'o|' ASSOCIATED WITH VALUE 2
        KEY '.|' ASSOCIATED WITH VALUE 1
    SET split_list TO CALL split ON music_string WITH ARGUMENT ' '
    SET result_list TO LIST WITH ELEMENTS EMPTY
    SET index TO 0
    WHILE index LESS THAN LENGTH OF split_list
        SET element TO split_list AT index
        IF element NOT EQUAL TO EMPTY STRING
            SET value TO note_map AT KEY element
            CALL APPEND ON result_list WITH ARGUMENT value
        END IF
        SET index TO index PLUS 1
    END WHILE
    RETURN result_list