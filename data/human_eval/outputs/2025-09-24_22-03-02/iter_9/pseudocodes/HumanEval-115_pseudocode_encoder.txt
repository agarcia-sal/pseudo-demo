FUNCTION max_fill(grid, capacity)
    IMPORT math
    
    RETURN SUM of
        FOR EACH arr IN grid DO
            SET total_water_units TO SUM of elements in arr
            SET required_lowerings TO math.ceil(total_water_units DIVIDED BY capacity)
            RETURN required_lowerings
        END FOR
    END SUM
END FUNCTION