FUNCTION minPath(grid, k)
    SET n TO length of grid
    SET val TO n multiplied by n plus 1
    FOR i FROM 0 TO n minus 1
        FOR j FROM 0 TO n minus 1
            IF grid at position i, j EQUALS 1 THEN
                SET temp TO empty list
                IF i NOT EQUAL TO 0 THEN
                    APPEND grid at position i minus 1, j TO temp
                IF j NOT EQUAL TO 0 THEN
                    APPEND grid at position i, j minus 1 TO temp
                IF i NOT EQUAL TO n minus 1 THEN
                    APPEND grid at position i plus 1, j TO temp
                IF j NOT EQUAL TO n minus 1 THEN
                    APPEND grid at position i, j plus 1 TO temp
                SET val TO minimum element of temp
    SET ans TO empty list
    FOR i FROM 0 TO k minus 1
        IF i modulo 2 EQUALS 0 THEN
            APPEND 1 TO ans
        ELSE
            APPEND val TO ans
    RETURN ans