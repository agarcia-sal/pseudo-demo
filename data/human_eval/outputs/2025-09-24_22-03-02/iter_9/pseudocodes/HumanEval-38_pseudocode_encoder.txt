FUNCTION encode_cyclic(s)
    SET groups TO EMPTY LIST
    FOR i FROM 0 TO INTEGER_DIVISION_OF (LENGTH OF s PLUS 2) BY 3 MINUS 1
        SET start_index TO 3 MULTIPLIED BY i
        SET end_index TO MINIMUM OF (3 MULTIPLIED BY i PLUS 3) AND LENGTH OF s
        APPEND SUBSTRING OF s FROM start_index TO end_index TO groups
    END FOR
    SET cycled_groups TO EMPTY LIST
    FOR EACH group IN groups
        IF LENGTH OF group EQUALS 3 THEN
            APPEND CONCATENATION OF SUBSTRING OF group FROM INDEX 1 TO END WITH FIRST CHARACTER OF group TO cycled_groups
        ELSE
            APPEND group TO cycled_groups
        END IF
    END FOR
    RETURN CONCATENATION OF ALL ELEMENTS IN cycled_groups

FUNCTION decode_cyclic(s)
    RETURN encode_cyclic(encode_cyclic(s))