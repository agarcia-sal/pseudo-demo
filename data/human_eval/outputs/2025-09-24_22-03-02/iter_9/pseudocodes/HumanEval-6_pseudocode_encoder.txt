FUNCTION parse_nested_parens(paren_string)
    FUNCTION parse_paren_group(s)
        SET depth TO 0
        SET max_depth TO 0
        FOR EACH character IN s
            IF character IS '('
                INCREMENT depth BY 1
                IF depth IS GREATER THAN max_depth
                    SET max_depth TO depth
            ELSE
                DECREMENT depth BY 1
        RETURN max_depth

    SET result_list TO empty list
    FOR EACH x IN split paren_string BY space
        IF x IS NOT empty
            APPEND parse_paren_group(x) TO result_list
    RETURN result_list