FUNCTION max_fill WITH PARAMETERS grid, capacity
    IMPORT math
    SET total_lowerings TO 0
    FOR i FROM 0 TO LENGTH OF grid MINUS 1
        SET current_row TO grid AT INDEX i
        SET sum_units TO 0
        FOR j FROM 0 TO LENGTH OF current_row MINUS 1
            SET sum_units TO sum_units PLUS current_row AT INDEX j
        END FOR
        SET lowers_for_row TO CALL math.ceil WITH ARGUMENTS sum_units DIVIDE BY capacity
        SET total_lowerings TO total_lowerings PLUS lowers_for_row
    END FOR
    RETURN total_lowerings
END FUNCTION