FUNCTION closest_integer(value)
    IMPORT floor FROM math
    IMPORT ceil FROM math
    SET dot_count TO zero
    SET dot_count TO CALL count ON value WITH ARGUMENTS '.'
    IF dot_count EQUALS 1 THEN
        WHILE TRUE DO
            SET last_index TO CALL length ON value MINUS 1
            SET last_char TO value AT last_index
            IF last_char EQUALS '0' THEN
                SET value TO CALL substring OF value FROM zero TO last_index MINUS 0
            ELSE
                BREAK
            END IF
        END WHILE
    END IF
    SET num TO CALL float WITH ARGUMENTS value
    SET length_value TO CALL length ON value
    IF length_value GREATER THAN OR EQUAL TO 2 THEN
        SET last_two_chars TO CONCATENATE value AT length_value MINUS 2 WITH value AT length_value MINUS 1
        IF last_two_chars EQUALS '.5' THEN
            IF num GREATER THAN 0 THEN
                SET res TO CALL ceil WITH ARGUMENTS num
            ELSE
                SET res TO CALL floor WITH ARGUMENTS num
            END IF
        ELSE
            IF length_value GREATER THAN 0 THEN
                SET rounded_num TO CALL round WITH ARGUMENTS num
                SET res TO CALL int WITH ARGUMENTS rounded_num
            ELSE
                SET res TO 0
            END IF
        END IF
    ELSE
        IF length_value GREATER THAN 0 THEN
            SET rounded_num TO CALL round WITH ARGUMENTS num
            SET res TO CALL int WITH ARGUMENTS rounded_num
        ELSE
            SET res TO 0
        END IF
    END IF
    RETURN res
END FUNCTION