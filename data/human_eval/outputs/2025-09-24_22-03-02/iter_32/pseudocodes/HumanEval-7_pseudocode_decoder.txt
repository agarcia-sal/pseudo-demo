FUNCTION filter_by_substring WITH PARAMETERS strings, substring
    SET result TO LIST WITH ELEMENTS EMPTY
    SET index TO 0
    WHILE index LESS THAN LENGTH OF strings
        SET current_string TO strings AT index
        SET contains_substring TO FALSE
        SET sub_index TO 0
        WHILE sub_index LESS THAN OR EQUAL TO LENGTH OF current_string MINUS LENGTH OF substring
            SET match_found TO TRUE
            SET char_index TO 0
            WHILE char_index LESS THAN LENGTH OF substring
                IF current_string AT (sub_index PLUS char_index) NOT EQUAL TO substring AT char_index THEN
                    SET match_found TO FALSE
                    BREAK
                END IF
                INCREMENT char_index BY 1
            END WHILE
            IF match_found EQUALS TRUE THEN
                SET contains_substring TO TRUE
                BREAK
            END IF
            INCREMENT sub_index BY 1
        END WHILE
        IF contains_substring EQUALS TRUE THEN
            APPEND current_string TO result
        END IF
        INCREMENT index BY 1
    END WHILE
    RETURN result
END FUNCTION