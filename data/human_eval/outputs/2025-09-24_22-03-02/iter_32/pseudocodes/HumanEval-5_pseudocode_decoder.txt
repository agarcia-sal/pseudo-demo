FUNCTION intersperse WITH PARAMETERS numbers AS LIST OF INTEGER, delimeter AS INTEGER RETURNS LIST OF INTEGER
    IF numbers EQUALS LIST WITH ELEMENTS EMPTY THEN
        RETURN LIST WITH ELEMENTS EMPTY
    END IF

    SET result TO LIST WITH ELEMENTS EMPTY

    SET last_index TO LENGTH OF numbers MINUS 1

    FOR index FROM 0 TO last_index MINUS 1
        SET n TO ELEMENT AT index OF numbers
        CALL APPEND n ON result
        CALL APPEND delimeter ON result
    END FOR

    CALL APPEND ELEMENT AT last_index OF numbers ON result

    RETURN result
END FUNCTION