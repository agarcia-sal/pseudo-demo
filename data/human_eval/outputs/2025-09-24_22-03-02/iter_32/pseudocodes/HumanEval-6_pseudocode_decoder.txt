FUNCTION parse_nested_parens WITH PARAMETER paren_string OF TYPE STRING RETURNS LIST OF INTEGER
    FUNCTION parse_paren_group WITH PARAMETER s OF TYPE STRING RETURNS INTEGER
        SET depth TO 0
        SET max_depth TO 0
        SET index TO 0
        WHILE index LESS THAN LENGTH OF s
            SET c TO CHARACTER AT s WITH INDEX index
            IF c EQUALS OPEN PARENTHESIS CHARACTER '('
                SET depth TO depth PLUS 1
                IF depth GREATER THAN max_depth
                    SET max_depth TO depth
                END IF
            ELSE
                SET depth TO depth MINUS 1
            END IF
            SET index TO index PLUS 1
        END WHILE
        RETURN max_depth
    END FUNCTION

    SET result TO LIST WITH ELEMENTS EMPTY
    SET split_index TO 0
    SET length_of_paren_string TO LENGTH OF paren_string
    WHILE split_index LESS THAN length_of_paren_string
        SET current_string TO EMPTY STRING
        WHILE split_index LESS THAN length_of_paren_string AND CHARACTER AT paren_string WITH INDEX split_index NOT EQUAL TO SPACE CHARACTER
            CONCATENATE current_string WITH CHARACTER AT paren_string WITH INDEX split_index
            SET split_index TO split_index PLUS 1
        END WHILE
        IF LENGTH OF current_string GREATER THAN 0
            SET max_depth_value TO CALL parse_paren_group WITH ARGUMENTS current_string
            APPEND max_depth_value TO result
        END IF
        SET split_index TO split_index PLUS 1
    END WHILE
    RETURN result
END FUNCTION