FUNCTION sort_array WITH PARAMETER arr
    SET sorted_arr TO CALL sorted WITH ARGUMENT arr
    SET result TO CALL sorted WITH ARGUMENT sorted_arr AND KEY FUNCTION key_function

    FUNCTION key_function WITH PARAMETER x
        SET binary_string TO CALL bin WITH ARGUMENT x
        SET binary_substring TO CALL substring ON binary_string FROM index 2 TO LENGTH OF binary_string MINUS 1
        SET count_ones TO 0
        SET i TO 0
        WHILE i LESS THAN LENGTH OF binary_substring
            IF character AT binary_substring AT index i EQUALS "1"
                INCREMENT count_ones BY 1
            ENDIF
            INCREMENT i BY 1
        ENDWHILE
        RETURN count_ones
    ENDFUNCTION

    RETURN result
ENDFUNCTION