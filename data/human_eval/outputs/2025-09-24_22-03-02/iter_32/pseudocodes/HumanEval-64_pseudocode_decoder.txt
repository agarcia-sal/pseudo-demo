FUNCTION vowels_count WITH PARAMETER s
    SET vowels TO STRING "aeiouAEIOU"
    SET n_vowels TO 0
    FOR i IN RANGE FROM 0 TO LENGTH OF s MINUS 1
        SET c TO CHARACTER AT INDEX i IN s
        IF c EQUALS TO 'a' OR c EQUALS TO 'e' OR c EQUALS TO 'i' OR c EQUALS TO 'o' OR c EQUALS TO 'u' OR c EQUALS TO 'A' OR c EQUALS TO 'E' OR c EQUALS TO 'I' OR c EQUALS TO 'O' OR c EQUALS TO 'U' THEN
            SET n_vowels TO n_vowels PLUS 1
        END IF
    END FOR
    SET last_index TO LENGTH OF s MINUS 1
    IF last_index GREATER THAN OR EQUAL TO 0 THEN
        SET last_char TO CHARACTER AT INDEX last_index IN s
        IF last_char EQUALS TO 'y' OR last_char EQUALS TO 'Y' THEN
            SET n_vowels TO n_vowels PLUS 1
        END IF
    END IF
    RETURN n_vowels