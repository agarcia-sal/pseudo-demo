Translate the provided pseudocode into fully functional Python code, strictly preserving all function and class names, including parameter names and return types, and maintaining class structures and object hierarchies exactly as indicated. Implement precise and idiomatic Python solutions that are efficient and robust; wherever possible, import and utilize relevant standard Python libraries to improve correctness, safety, and performance (e.g., for math, datetime, collections). If the pseudocode implies or requires exception handling or input validation, incorporate it appropriately.

Avoid modifying any function or class signatures unless explicitly instructed in the pseudocode. Ensure your code handles edge cases gracefully and is optimized to complete execution within 5 seconds for typical inputs. Do not add any explanatory comments, prints, or extraneous outputâ€”provide only the pure Python implementation.

Wrap your entire code output inside a single Python code block using exactly:

```python
# Your code here
```

Provide only this Python code block and nothing else.