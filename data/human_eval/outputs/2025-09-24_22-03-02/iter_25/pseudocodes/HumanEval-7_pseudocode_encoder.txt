FUNCTION filter_by_substring WITH PARAMETERS strings OF TYPE List OF str, substring OF TYPE str RETURNS List OF str
    SET filtered_list TO LIST WITH ELEMENTS EMPTY
    SET index TO 0
    SET length_of_strings TO LENGTH OF strings
    WHILE index LESS THAN length_of_strings
        SET current_string TO strings AT index
        SET contains_substring TO FALSE
        SET substring_index TO 0
        SET length_of_current_string TO LENGTH OF current_string
        SET length_of_substring TO LENGTH OF substring
        WHILE substring_index LESS THAN OR EQUAL TO length_of_current_string MINUS length_of_substring AND contains_substring EQUALS FALSE
            SET match_index TO 0
            SET is_match TO TRUE
            WHILE match_index LESS THAN length_of_substring AND is_match EQUALS TRUE
                IF current_string AT (substring_index PLUS match_index) NOT EQUALS substring AT match_index
                    SET is_match TO FALSE
                END IF
                INCREMENT match_index BY 1
            END WHILE
            IF is_match EQUALS TRUE
                SET contains_substring TO TRUE
            END IF
            INCREMENT substring_index BY 1
        END WHILE
        IF contains_substring EQUALS TRUE
            APPEND current_string TO filtered_list
        END IF
        INCREMENT index BY 1
    END WHILE
    RETURN filtered_list
END FUNCTION