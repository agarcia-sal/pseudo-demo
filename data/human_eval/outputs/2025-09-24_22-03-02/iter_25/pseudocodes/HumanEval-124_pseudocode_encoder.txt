FUNCTION valid_date(date):
    TRY
        SET date TO CALL strip ON date
        SET parts TO CALL split ON date WITH ARGUMENT '-'
        IF LENGTH OF parts NOT EQUAL TO 3 THEN
            RETURN False
        ENDIF
        SET month_string TO parts AT INDEX 0
        SET day_string TO parts AT INDEX 1
        SET year_string TO parts AT INDEX 2
        SET month TO CALL int WITH ARGUMENT month_string
        SET day TO CALL int WITH ARGUMENT day_string
        SET year TO CALL int WITH ARGUMENT year_string
        IF month LESS THAN 1 OR month GREATER THAN 12 THEN
            RETURN False
        ENDIF
        SET months_31_days TO LIST WITH ELEMENTS 1,3,5,7,8,10,12
        SET months_30_days TO LIST WITH ELEMENTS 4,6,9,11
        SET is_month_31_days TO False
        FOR index FROM 0 TO LENGTH OF months_31_days MINUS 1 DO
            IF month EQUALS months_31_days AT INDEX index THEN
                SET is_month_31_days TO True
                BREAK
            ENDIF
        ENDFOR
        IF is_month_31_days IS True THEN
            IF day LESS THAN 1 OR day GREATER THAN 31 THEN
                RETURN False
            ENDIF
        ELSE
            SET is_month_30_days TO False
            FOR index FROM 0 TO LENGTH OF months_30_days MINUS 1 DO
                IF month EQUALS months_30_days AT INDEX index THEN
                    SET is_month_30_days TO True
                    BREAK
                ENDIF
            ENDFOR
            IF is_month_30_days IS True THEN
                IF day LESS THAN 1 OR day GREATER THAN 30 THEN
                    RETURN False
                ENDIF
            ELSE
                IF month EQUALS 2 THEN
                    IF day LESS THAN 1 OR day GREATER THAN 29 THEN
                        RETURN False
                    ENDIF
                ENDIF
            ENDIF
        ENDIF
    EXCEPT
        RETURN False
    ENDTRY
    RETURN True