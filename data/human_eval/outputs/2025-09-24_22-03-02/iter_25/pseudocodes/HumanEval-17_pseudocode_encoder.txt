FUNCTION parse_music WITH PARAMETER music_string AS STRING RETURNS LIST OF INTEGER
    SET note_map TO DICTIONARY WITH PAIRS 'o' MAPPED TO 4, 'o|' MAPPED TO 2, AND '.|' MAPPED TO 1
    SET result_list TO LIST WITH ELEMENTS EMPTY
    SET split_notes TO LIST WITH ELEMENTS EMPTY
    SET current_index TO 0
    SET music_length TO LENGTH OF music_string
    WHILE current_index LESS THAN music_length
        SET current_char TO CHARACTER AT INDEX current_index OF music_string
        IF current_char EQUALS SPACE
            INCREMENT current_index BY 1
            CONTINUE
        END IF
        SET temp_string TO EMPTY STRING
        WHILE current_index LESS THAN music_length AND CHARACTER AT INDEX current_index OF music_string NOT EQUAL TO SPACE
            CONCATENATE temp_string WITH CHARACTER AT INDEX current_index OF music_string
            INCREMENT current_index BY 1
        END WHILE
        APPEND temp_string TO split_notes
    END WHILE
    SET i TO 0
    WHILE i LESS THAN LENGTH OF split_notes
        SET note TO ELEMENT AT INDEX i OF split_notes
        IF note MAPS TO A KEY IN note_map
            APPEND VALUE MAPPED BY note FROM note_map TO result_list
        END IF
        INCREMENT i BY 1
    END WHILE
    RETURN result_list
END FUNCTION