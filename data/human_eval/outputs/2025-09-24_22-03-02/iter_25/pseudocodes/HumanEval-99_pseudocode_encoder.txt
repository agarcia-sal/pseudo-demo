FUNCTION closest_integer(value STRING) RETURNS INTEGER
    IMPORT floor FROM math
    IMPORT ceil FROM math
    SET count_dot INTEGER TO 0
    FOR index INTEGER FROM 0 TO LENGTH OF value MINUS 1
        IF value AT index EQUALS '.'
            INCREMENT count_dot BY 1
        END IF
    END FOR
    IF count_dot EQUALS 1
        WHILE LENGTH OF value GREATER THAN 0 AND value AT (LENGTH OF value MINUS 1) EQUALS '0'
            SET value TO SUBSTRING OF value FROM INDEX 0 TO (LENGTH OF value MINUS 1)
        END WHILE
    END IF
    SET num FLOAT TO CALL float WITH value
    SET length_value INTEGER TO LENGTH OF value
    IF length_value GREATER THAN OR EQUAL TO 2 AND substring OF value FROM (length_value MINUS 2) TO length_value EQUALS '.5'
        IF num GREATER THAN 0
            SET res INTEGER TO CALL ceil WITH num
        ELSE
            SET res INTEGER TO CALL floor WITH num
        END IF
    ELSE IF length_value GREATER THAN 0
        SET rounded_num FLOAT TO CALL round WITH num
        SET res INTEGER TO CALL int WITH rounded_num
    ELSE
        SET res INTEGER TO 0
    END IF
    RETURN res
END FUNCTION