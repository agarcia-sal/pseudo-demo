FUNCTION separate_paren_groups(paren_string: STRING) RETURNS LIST OF STRING
    SET result TO LIST WITH ELEMENTS EMPTY
    SET current_string TO LIST WITH ELEMENTS EMPTY
    SET current_depth TO 0

    FOR index FROM 0 TO LENGTH OF paren_string MINUS 1
        SET c TO CHARACTER AT index OF paren_string

        IF c EQUALS '('
            SET current_depth TO current_depth PLUS 1
            CALL APPEND METHOD OF current_string WITH ARGUMENT c
        ELSE IF c EQUALS ')'
            SET current_depth TO current_depth MINUS 1
            CALL APPEND METHOD OF current_string WITH ARGUMENT c

            IF current_depth EQUALS 0
                SET concatenated_string TO EMPTY STRING
                FOR j FROM 0 TO LENGTH OF current_string MINUS 1
                    SET concatenated_string TO concatenated_string CONCATENATE ELEMENT AT j OF current_string
                CALL APPEND METHOD OF result WITH ARGUMENT concatenated_string
                CALL CLEAR METHOD OF current_string

    RETURN result