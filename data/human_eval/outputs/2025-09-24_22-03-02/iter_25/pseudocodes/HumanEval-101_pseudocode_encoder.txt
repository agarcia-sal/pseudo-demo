FUNCTION words_string WITH PARAMETER s
    IF s EQUALS EMPTY STRING THEN
        RETURN LIST WITH ELEMENTS EMPTY
    ENDIF
    SET s_list TO LIST WITH ELEMENTS EMPTY
    SET length_of_s TO LENGTH OF s
    FOR index FROM 0 TO length_of_s MINUS 1 DO
        SET letter TO CHARACTER AT POSITION index IN s
        IF letter EQUALS ',' THEN
            CALL s_list.APPEND WITH ARGUMENT ' '
        ELSE
            CALL s_list.APPEND WITH ARGUMENT letter
        ENDIF
    ENDFOR
    SET joined_string TO EMPTY STRING
    SET length_of_s_list TO LENGTH OF s_list
    FOR index FROM 0 TO length_of_s_list MINUS 1 DO
        SET joined_string TO joined_string CONCATENATE CHARACTER AT POSITION index IN s_list
    ENDFOR
    SET words TO LIST WITH ELEMENTS EMPTY
    SET start_index TO 0
    SET end_index TO 0
    SET length_of_joined_string TO LENGTH OF joined_string
    WHILE end_index LESS THAN OR EQUAL TO length_of_joined_string DO
        IF end_index EQUALS length_of_joined_string OR CHARACTER AT POSITION end_index IN joined_string EQUALS ' ' THEN
            SET word_length TO end_index MINUS start_index
            IF word_length GREATER THAN 0 THEN
                SET word TO EMPTY STRING
                FOR char_index FROM start_index TO end_index MINUS 1 DO
                    SET word TO word CONCATENATE CHARACTER AT POSITION char_index IN joined_string
                ENDFOR
                CALL words.APPEND WITH ARGUMENT word
            ENDIF
            SET start_index TO end_index PLUS 1
        ENDIF
        INCREMENT end_index BY 1
    ENDWHILE
    RETURN words
ENDFUNCTION