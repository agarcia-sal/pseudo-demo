FUNCTION max_fill(grid, capacity)
    SET import_math TO TRUE

    SET total_times TO 0
    FOR index_row FROM 0 TO LENGTH OF grid MINUS 1
        SET current_row TO grid AT index_row
        SET sum_units TO 0
        FOR index_unit FROM 0 TO LENGTH OF current_row MINUS 1
            SET sum_units TO sum_units PLUS current_row AT index_unit
        END FOR

        CALL math_ceil_result TO CALL math.ceil WITH sum_units DIVIDED BY capacity
        SET total_times TO total_times PLUS math_ceil_result
    END FOR

    RETURN total_times
END FUNCTION