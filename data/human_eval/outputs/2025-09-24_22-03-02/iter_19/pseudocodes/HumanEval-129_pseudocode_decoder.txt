FUNCTION minPath WITH PARAMETERS grid, k
    SET n TO LENGTH OF grid
    SET val TO n MULTIPLY n PLUS 1
    FOR i FROM 0 TO n MINUS 1
        FOR j FROM 0 TO n MINUS 1
            IF grid AT i AT j EQUALS 1
                SET temp TO LIST WITH ELEMENTS EMPTY
                IF i NOT EQUAL TO 0
                    CALL temp APPEND WITH ARGUMENT grid AT i MINUS 1 AT j
                IF j NOT EQUAL TO 0
                    CALL temp APPEND WITH ARGUMENT grid AT i AT j MINUS 1
                IF i NOT EQUAL TO n MINUS 1
                    CALL temp APPEND WITH ARGUMENT grid AT i PLUS 1 AT j
                IF j NOT EQUAL TO n MINUS 1
                    CALL temp APPEND WITH ARGUMENT grid AT i AT j PLUS 1
                SET val TO FIRST ELEMENT OF temp
                FOR index FROM 1 TO LENGTH OF temp MINUS 1
                    IF temp AT index LESS THAN val
                        SET val TO temp AT index
    SET ans TO LIST WITH ELEMENTS EMPTY
    FOR i FROM 0 TO k MINUS 1
        IF i MODULO 2 EQUALS 0
            CALL ans APPEND WITH ARGUMENT 1
        ELSE
            CALL ans APPEND WITH ARGUMENT val
    RETURN ans