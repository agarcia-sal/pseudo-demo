FUNCTION valid_date(date)
    TRY
        SET date TO CALL strip METHOD ON date
        SET parts TO CALL split METHOD ON date WITH ARGUMENTS ['-']
        SET month_str TO parts AT INDEX 0
        SET day_str TO parts AT INDEX 1
        SET year_str TO parts AT INDEX 2
        SET month TO CALL int WITH ARGUMENTS month_str
        SET day TO CALL int WITH ARGUMENTS day_str
        SET year TO CALL int WITH ARGUMENTS year_str
        IF month LESS THAN 1 OR month GREATER THAN 12 THEN
            RETURN False
        SET long_months TO LIST WITH ELEMENTS [1, 3, 5, 7, 8, 10, 12]
        SET short_months TO LIST WITH ELEMENTS [4, 6, 9, 11]
        SET is_long_month TO False
        FOR i FROM 0 TO LENGTH OF long_months MINUS 1
            IF month EQUALS long_months AT INDEX i THEN
                SET is_long_month TO True
                BREAK
        SET is_short_month TO False
        FOR i FROM 0 TO LENGTH OF short_months MINUS 1
            IF month EQUALS short_months AT INDEX i THEN
                SET is_short_month TO True
                BREAK
        IF is_long_month AND (day LESS THAN 1 OR day GREATER THAN 31) THEN
            RETURN False
        IF is_short_month AND (day LESS THAN 1 OR day GREATER THAN 30) THEN
            RETURN False
        IF month EQUALS 2 AND (day LESS THAN 1 OR day GREATER THAN 29) THEN
            RETURN False
    EXCEPT
        RETURN False
    RETURN True