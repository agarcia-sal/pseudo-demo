FUNCTION encrypt WITH PARAMETER s
    SET d TO 'abcdefghijklmnopqrstuvwxyz'
    SET out TO empty string
    FOR i FROM 0 TO LENGTH OF s MINUS 1
        SET c TO CHARACTER AT POSITION i OF s
        SET found TO FALSE
        FOR j FROM 0 TO LENGTH OF d MINUS 1
            IF CHARACTER AT POSITION j OF d EQUALS c THEN
                SET found TO TRUE
                SET index_c TO j
                BREAK
            ENDIF
        ENDFOR
        IF found EQUALS TRUE THEN
            SET rotated_index TO (index_c PLUS 2 MULTIPLY 2) MODULO 26
            SET out TO out CONCATENATE CHARACTER AT POSITION rotated_index OF d
        ELSE
            SET out TO out CONCATENATE c
        ENDIF
    ENDFOR
    RETURN out