FUNCTION encode_cyclic WITH PARAMETER s OF TYPE str
    SET groups TO LIST WITH ELEMENTS EMPTY
    SET length_s TO LENGTH OF s
    SET count_groups TO (length_s PLUS 2) DIVIDED BY 3
    FOR i FROM 0 TO count_groups MINUS 1
        SET start_index TO 3 MULTIPLY i
        IF start_index PLUS 3 LESS THAN length_s PLUS 1
            SET end_index TO start_index PLUS 3
        ELSE
            SET end_index TO length_s
        END IF
        SET substring TO EMPTY STRING
        FOR index FROM start_index TO end_index MINUS 1
            CONCATENATE substring WITH CHARACTER AT POSITION index IN s
        END FOR
        APPEND substring TO groups
    END FOR
    SET cycled_groups TO LIST WITH ELEMENTS EMPTY
    FOR EACH group IN groups
        IF LENGTH OF group EQUALS 3
            SET cycled_group TO EMPTY STRING
            FOR index FROM 1 TO 2
                CONCATENATE cycled_group WITH CHARACTER AT POSITION index IN group
            END FOR
            CONCATENATE cycled_group WITH CHARACTER AT POSITION 0 IN group
            APPEND cycled_group TO cycled_groups
        ELSE
            APPEND group TO cycled_groups
        END IF
    END FOR
    SET result TO EMPTY STRING
    FOR EACH element IN cycled_groups
        CONCATENATE result WITH element
    END FOR
    RETURN result
END FUNCTION

FUNCTION decode_cyclic WITH PARAMETER s OF TYPE str
    SET intermediate TO CALL encode_cyclic WITH ARGUMENT s
    SET result TO CALL encode_cyclic WITH ARGUMENT intermediate
    RETURN result
END FUNCTION