FUNCTION get_closest_vowel WITH PARAMETER word
    IF LENGTH OF word LESS THAN 3 THEN
        RETURN EMPTY STRING
    END IF

    SET vowels TO LIST WITH ELEMENTS "a", "e", "i", "o", "u", "A", "E", "O", "U", "I"

    SET index TO LENGTH OF word MINUS 2
    WHILE index GREATER THAN 0
        SET current_char TO CHARACTER IN word AT INDEX index
        SET next_char TO CHARACTER IN word AT INDEX index PLUS 1
        SET prev_char TO CHARACTER IN word AT INDEX index MINUS 1

        SET is_current_char_vowel TO FALSE
        FOR vowel_index FROM 0 TO LENGTH OF vowels MINUS 1
            IF current_char EQUALS vowels AT vowel_index THEN
                SET is_current_char_vowel TO TRUE
                BREAK
            END IF
        END FOR

        SET is_next_char_vowel TO FALSE
        FOR vowel_index FROM 0 TO LENGTH OF vowels MINUS 1
            IF next_char EQUALS vowels AT vowel_index THEN
                SET is_next_char_vowel TO TRUE
                BREAK
            END IF
        END FOR

        SET is_prev_char_vowel TO FALSE
        FOR vowel_index FROM 0 TO LENGTH OF vowels MINUS 1
            IF prev_char EQUALS vowels AT vowel_index THEN
                SET is_prev_char_vowel TO TRUE
                BREAK
            END IF
        END FOR

        IF is_current_char_vowel EQUALS TRUE THEN
            IF is_next_char_vowel EQUALS FALSE AND is_prev_char_vowel EQUALS FALSE THEN
                RETURN current_char
            END IF
        END IF

        SET index TO index MINUS 1
    END WHILE

    RETURN EMPTY STRING
END FUNCTION