FUNCTION encode_shift WITH PARAMETER s OF TYPE string
    SET result TO EMPTY LIST
    SET length TO CALL LENGTH OF s
    SET index TO 0
    WHILE index LESS THAN length
        SET ch TO VALUE AT INDEX index OF s
        SET ch_ord TO CALL ORD WITH ARGUMENT ch
        SET base TO CALL ORD WITH ARGUMENT "a"
        SET shifted_value TO ch_ord PLUS 5 MINUS base
        SET modulo_value TO shifted_value MODULO 26
        SET final_value TO modulo_value PLUS base
        SET shifted_char TO CALL CHR WITH ARGUMENT final_value
        APPEND shifted_char TO result
        INCREMENT index BY 1
    END WHILE
    SET encoded_string TO EMPTY STRING
    SET j TO 0
    SET result_length TO CALL LENGTH OF result
    WHILE j LESS THAN result_length
        SET encoded_string TO encoded_string CONCATENATE VALUE AT INDEX j OF result
        INCREMENT j BY 1
    END WHILE
    RETURN encoded_string
END FUNCTION

FUNCTION decode_shift WITH PARAMETER s OF TYPE string
    SET result TO EMPTY LIST
    SET length TO CALL LENGTH OF s
    SET index TO 0
    WHILE index LESS THAN length
        SET ch TO VALUE AT INDEX index OF s
        SET ch_ord TO CALL ORD WITH ARGUMENT ch
        SET base TO CALL ORD WITH ARGUMENT "a"
        SET shifted_value TO ch_ord MINUS 5 MINUS base
        SET modulo_value TO shifted_value MODULO 26
        SET final_value TO modulo_value PLUS base
        SET shifted_char TO CALL CHR WITH ARGUMENT final_value
        APPEND shifted_char TO result
        INCREMENT index BY 1
    END WHILE
    SET decoded_string TO EMPTY STRING
    SET j TO 0
    SET result_length TO CALL LENGTH OF result
    WHILE j LESS THAN result_length
        SET decoded_string TO decoded_string CONCATENATE VALUE AT INDEX j OF result
        INCREMENT j BY 1
    END WHILE
    RETURN decoded_string
END FUNCTION