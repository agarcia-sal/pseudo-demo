FUNCTION parse_music WITH PARAMETER music_string OF TYPE STRING RETURNS LIST OF INTEGER
    SET note_map TO DICTIONARY WITH ELEMENTS KEY 'o' VALUE 4, KEY 'o|' VALUE 2, KEY '.|' VALUE 1
    SET result_list TO EMPTY LIST
    SET split_list TO CALL split ON music_string WITH ARGUMENTS ' '
    SET index TO 0
    WHILE index LESS THAN LENGTH OF split_list
        SET current_element TO split_list AT index
        IF current_element NOT EQUAL TO EMPTY STRING
            SET current_value TO note_map AT KEY current_element
            APPEND current_value TO result_list
        END IF
        INCREMENT index BY 1
    END WHILE
    RETURN result_list
END FUNCTION