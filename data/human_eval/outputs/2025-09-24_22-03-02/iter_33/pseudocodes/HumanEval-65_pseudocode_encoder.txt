FUNCTION circular_shift WITH PARAMETERS x, shift
    SET s EQUALS CALL str WITH ARGUMENT x
    IF shift GREATER THAN CALL len WITH ARGUMENT s THEN
        SET result TO EMPTY LIST WITH ELEMENTS EMPTY
        FOR index FROM CALL len WITH ARGUMENT s MINUS ONE DOWNTO 0 DECREMENT BY 1
            SET current_char TO s AT INDEX index
            CONCATENATE current_char TO result
        END FOR
        SET reversed_string TO CALL concatenate ALL ELEMENTS OF result
        RETURN reversed_string
    ELSE
        SET length TO CALL len WITH ARGUMENT s
        SET first_part_start TO length MINUS shift
        SET first_part TO EMPTY LIST WITH ELEMENTS EMPTY
        FOR index FROM first_part_start TO length MINUS ONE INCREMENT BY 1
            SET current_char TO s AT INDEX index
            CONCATENATE current_char TO first_part
        END FOR
        SET second_part TO EMPTY LIST WITH ELEMENTS EMPTY
        FOR index FROM 0 TO first_part_start MINUS ONE INCREMENT BY 1
            SET current_char TO s AT INDEX index
            CONCATENATE current_char TO second_part
        END FOR
        SET shifted_string TO CALL concatenate ALL ELEMENTS OF first_part CONCATENATED WITH concatenate ALL ELEMENTS OF second_part
        RETURN shifted_string
    END IF