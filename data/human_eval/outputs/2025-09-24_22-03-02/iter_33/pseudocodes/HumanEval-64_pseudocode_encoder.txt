FUNCTION vowels_count WITH PARAMETER s
    SET vowels TO LIST WITH ELEMENTS 'a', 'e', 'i', 'o', 'u', 'A', 'E', 'I', 'O', 'U'
    SET n_vowels TO 0
    SET index TO 0
    WHILE index LESS THAN LENGTH OF s
        SET c TO ELEMENT OF s AT INDEX index
        SET is_vowel TO FALSE
        SET v_index TO 0
        WHILE v_index LESS THAN LENGTH OF vowels
            IF c EQUALS ELEMENT OF vowels AT INDEX v_index THEN
                SET is_vowel TO TRUE
                BREAK
            END IF
            INCREMENT v_index BY 1
        END WHILE
        IF is_vowel EQUALS TRUE THEN
            SET n_vowels TO n_vowels PLUS 1
        END IF
        INCREMENT index BY 1
    END WHILE
    SET last_char TO ELEMENT OF s AT INDEX LENGTH OF s MINUS 1
    IF last_char EQUALS 'y' OR last_char EQUALS 'Y' THEN
        SET n_vowels TO n_vowels PLUS 1
    END IF
    RETURN n_vowels