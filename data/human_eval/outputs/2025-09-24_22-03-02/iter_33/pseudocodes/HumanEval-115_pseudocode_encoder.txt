FUNCTION max_fill(grid, capacity)
    IMPORT math
    SET total_times TO 0
    SET grid_length TO LENGTH OF grid

    FOR i FROM 0 TO grid_length MINUS 1 DO
        SET current_row TO grid AT INDEX i
        SET row_length TO LENGTH OF current_row
        SET row_sum TO 0

        FOR j FROM 0 TO row_length MINUS 1 DO
            SET row_sum TO row_sum PLUS current_row AT INDEX j
        END FOR

        SET times_for_row TO CALL math.ceil WITH ARGUMENT row_sum DIVIDE BY capacity
        SET total_times TO total_times PLUS times_for_row
    END FOR
    
    RETURN total_times
END FUNCTION