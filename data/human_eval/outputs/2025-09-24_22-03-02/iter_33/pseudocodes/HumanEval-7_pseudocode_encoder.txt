FUNCTION filter_by_substring WITH PARAMETERS strings OF TYPE LIST OF STRING, substring OF TYPE STRING RETURNS LIST OF STRING
    SET filtered_list TO LIST WITH ELEMENTS EMPTY
    SET index TO 0
    WHILE index LESS THAN LENGTH OF strings
        SET current_string TO ELEMENT AT index OF strings
        SET contains_substring TO FALSE
        SET substring_index TO 0
        SET substring_length TO LENGTH OF substring
        SET current_string_length TO LENGTH OF current_string
        WHILE substring_index LESS THAN OR EQUAL TO current_string_length MINUS substring_length AND contains_substring EQUALS FALSE
            SET match TO TRUE
            SET char_index TO 0
            WHILE char_index LESS THAN substring_length AND match EQUALS TRUE
                IF ELEMENT AT (substring_index PLUS char_index) OF current_string NOT EQUAL TO ELEMENT AT char_index OF substring
                    SET match TO FALSE
                END IF
                INCREMENT char_index BY 1
            END WHILE
            IF match EQUALS TRUE
                SET contains_substring TO TRUE
            END IF
            INCREMENT substring_index BY 1
        END WHILE
        IF contains_substring EQUALS TRUE
            APPEND current_string TO filtered_list
        END IF
        INCREMENT index BY 1
    END WHILE
    RETURN filtered_list
END FUNCTION