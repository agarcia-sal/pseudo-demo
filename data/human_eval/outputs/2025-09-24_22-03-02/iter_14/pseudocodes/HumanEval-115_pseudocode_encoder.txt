FUNCTION max_fill(grid, capacity)
    IMPORT math
    SET total_lowerings TO 0
    FOR EACH arr IN grid
        SET water_units TO 0
        FOR EACH element IN arr
            IF element EQUALS 1 THEN
                INCREMENT water_units BY 1
        END FOR
        SET lowers_for_arr TO CALL math.ceil WITH ARGUMENT water_units DIVIDE BY capacity
        INCREMENT total_lowerings BY lowers_for_arr
    END FOR
    RETURN total_lowerings
END FUNCTION