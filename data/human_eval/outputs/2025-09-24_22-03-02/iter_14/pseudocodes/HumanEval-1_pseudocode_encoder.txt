FUNCTION separate_paren_groups(paren_string: STR) RETURNS LIST OF STR
    SET result TO EMPTY LIST
    SET current_string TO EMPTY LIST
    SET current_depth TO ZERO

    FOR EACH c IN paren_string
        IF c EQUALS LEFT PARENTHESIS
            SET current_depth TO current_depth PLUS ONE
            CALL current_string APPEND WITH ARGUMENT c
        ELSE IF c EQUALS RIGHT PARENTHESIS
            SET current_depth TO current_depth MINUS ONE
            CALL current_string APPEND WITH ARGUMENT c
            IF current_depth EQUALS ZERO
                SET concatenated_string TO JOIN ALL ELEMENTS OF current_string INTO SINGLE STRING
                CALL result APPEND WITH ARGUMENT concatenated_string
                CALL current_string CLEAR
    RETURN result