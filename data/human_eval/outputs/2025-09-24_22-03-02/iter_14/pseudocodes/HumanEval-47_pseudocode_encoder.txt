FUNCTION median WITH PARAMETER l OF TYPE list
    SET l TO CALL sorted WITH ARGUMENT l
    IF LENGTH OF l MODULO 2 EQUALS 1
        SET middle_index TO LENGTH OF l DIVIDE BY 2
        RETURN ELEMENT AT INDEX middle_index OF l
    ELSE
        SET left_middle_index TO LENGTH OF l DIVIDE BY 2 MINUS 1
        SET right_middle_index TO LENGTH OF l DIVIDE BY 2
        SET left_middle_value TO ELEMENT AT INDEX left_middle_index OF l
        SET right_middle_value TO ELEMENT AT INDEX right_middle_index OF l
        SET median_value TO left_middle_value PLUS right_middle_value DIVIDE BY 2.0
        RETURN median_value