FUNCTION closest_integer(value)
    IMPORT floor AND ceil FROM math

    IF COUNT OF '.' IN value EQUALS 1 THEN
        WHILE LAST CHARACTER OF value EQUALS CHARACTER '0' DO
            SET value TO SUBSTRING OF value FROM START TO ONE CHARACTER BEFORE END
        END WHILE
    END IF

    SET num TO FLOAT CONVERSION OF value

    IF LAST TWO CHARACTERS OF value EQUALS STRING '.5' THEN
        IF num GREATER THAN 0 THEN
            SET res TO CALL ceil WITH ARGUMENT num
        ELSE
            SET res TO CALL floor WITH ARGUMENT num
        END IF
    ELSE IF LENGTH OF value GREATER THAN 0 THEN
        SET res TO INTEGER ROUNDING OF num
    ELSE
        SET res TO 0
    END IF

    RETURN res
END FUNCTION