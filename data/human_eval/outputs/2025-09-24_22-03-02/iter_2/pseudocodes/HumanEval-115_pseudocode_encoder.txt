FUNCTION max_fill(grid, capacity)
    IMPORT math

    SET total_lowerings TO 0

    FOR EACH well_row IN grid DO
        SET water_units TO SUM of well_row
        SET lowerings_for_well TO math ceiling of (water_units divided by capacity)
        SET total_lowerings TO total_lowerings plus lowerings_for_well
    END FOR

    RETURN total_lowerings
END FUNCTION