FUNCTION closest_integer(value)
    IMPORT floor, ceil FROM math

    IF value CONTAINS '.'
        WHILE last character of value IS '0'
            REMOVE last character from value

    SET num TO float conversion of value

    IF last two characters of value ARE '.5'
        IF num IS GREATER THAN 0
            SET res TO ceil(num)
        ELSE
            SET res TO floor(num)
    ELSE IF length of value IS GREATER THAN 0
        SET res TO nearest integer to num using standard rounding
    ELSE
        SET res TO 0

    RETURN res