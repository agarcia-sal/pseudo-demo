FUNCTION parse_music WITH PARAMETER music_string AS STRING RETURNS LIST OF INTEGER
    SET note_map TO DICTIONARY MAPPING 'o' TO 4, 'o|' TO 2, '.|' TO 1
    SET tokens TO SPLIT music_string BY SPACE
    SET result TO EMPTY LIST
    FOR EACH token IN tokens
        IF token IS NOT EMPTY
            APPEND note_map[token] TO result
    END FOR
    RETURN result
END FUNCTION