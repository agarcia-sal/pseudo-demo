FUNCTION vowels_count WITH PARAMETER s
    SET vowels TO STRING "aeiouAEIOU"
    SET n_vowels TO 0
    FOR EACH index FROM 0 TO LENGTH OF s MINUS 1 INCLUSIVE
        SET c TO CHARACTER AT POSITION index IN s
        IF c EQUALS ANY CHARACTER IN vowels THEN
            SET n_vowels TO n_vowels PLUS 1
        END IF
    END FOR
    IF CHARACTER AT POSITION LENGTH OF s MINUS 1 IN s EQUALS 'y' OR CHARACTER AT POSITION LENGTH OF s MINUS 1 IN s EQUALS 'Y' THEN
        SET n_vowels TO n_vowels PLUS 1
    END IF
    RETURN n_vowels