FUNCTION sort_array WITH PARAMETER arr
    SET sorted_by_value TO CALL sorted WITH ARGUMENTS arr
    SET LENGTH arr_length TO LENGTH OF sorted_by_value
    SET result TO CALL sorted WITH ARGUMENTS sorted_by_value AND KEY FUNCTION AS FUNCTION WITH PARAMETER x
        SET binary_representation TO CALL bin WITH ARGUMENTS x
        SET binary_string TO SUBSTRING OF binary_representation FROM INDEX 2 TO END
        SET count_ones TO 0
        SET LENGTH binary_length TO LENGTH OF binary_string
        SET index TO 0
        WHILE index LESS THAN binary_length
            IF CHARACTER AT binary_string WITH INDEX index EQUALS '1'
                INCREMENT count_ones BY 1
            END IF
            INCREMENT index BY 1
        END WHILE
        RETURN count_ones
    END FUNCTION
    RETURN result
END FUNCTION