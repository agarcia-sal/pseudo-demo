FUNCTION max_fill WITH PARAMETERS grid, capacity
    IMPORT math
    SET total_calls TO 0
    FOR each_index_row FROM 0 TO LENGTH OF grid MINUS 1
        SET current_row TO grid AT each_index_row
        SET sum_water_units TO 0
        FOR each_index_col FROM 0 TO LENGTH OF current_row MINUS 1
            SET sum_water_units TO sum_water_units PLUS current_row AT each_index_col
        END FOR
        SET calls_for_row TO CALL math.ceil WITH ARGUMENTS (sum_water_units DIVIDE capacity)
        SET total_calls TO total_calls PLUS calls_for_row
    END FOR
    RETURN total_calls
END FUNCTION