FUNCTION parse_music WITH PARAMETER music_string OF TYPE string RETURNS List OF int
    SET note_map TO DICTIONARY WITH ELEMENTS
        KEY 'o' VALUE 4
        KEY 'o|' VALUE 2
        KEY '.|' VALUE 1
    SET split_notes TO LIST WITH ELEMENTS EMPTY
    SET index TO 0
    WHILE index LESS THAN LENGTH OF music_string
        SET current_char TO CHARACTER AT POSITION index IN music_string
        SET temp_string TO EMPTY STRING
        WHILE index LESS THAN LENGTH OF music_string AND current_char NOT EQUAL TO SPACE CHARACTER
            CONCATENATE current_char TO temp_string
            INCREMENT index BY 1
            IF index LESS THAN LENGTH OF music_string
                SET current_char TO CHARACTER AT POSITION index IN music_string
        APPEND temp_string TO split_notes
        INCREMENT index BY 1
    SET result TO LIST WITH ELEMENTS EMPTY
    FOR i FROM 0 TO LENGTH OF split_notes MINUS 1
        SET note TO ELEMENT AT POSITION i IN split_notes
        IF note NOT EQUAL TO EMPTY STRING
            APPEND ELEMENT AT KEY note IN note_map TO result
    RETURN result