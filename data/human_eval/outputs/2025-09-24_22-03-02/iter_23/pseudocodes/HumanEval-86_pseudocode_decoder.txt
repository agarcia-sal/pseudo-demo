FUNCTION anti_shuffle WITH PARAMETER s
    SET result TO LIST WITH ELEMENTS EMPTY
    SET words TO LIST WITH ELEMENTS EMPTY
    SET index TO 0
    SET length TO LENGTH OF s
    SET current_word TO EMPTY STRING
    WHILE index LESS THAN length
        SET character TO CHARACTER AT POSITION index IN s
        IF character EQUALS SPACE
            APPEND current_word TO words
            APPEND SPACE TO words
            SET current_word TO EMPTY STRING
        ELSE
            SET current_word TO CONCATENATE current_word WITH character
        INCREMENT index BY 1
    IF current_word NOT EQUAL TO EMPTY STRING
        APPEND current_word TO words
    SET i TO 0
    SET ordered_words TO LIST WITH ELEMENTS EMPTY
    WHILE i LESS THAN LENGTH OF words
        SET element TO ELEMENT AT POSITION i IN words
        IF element EQUALS SPACE
            APPEND element TO ordered_words
        ELSE
            SET characters TO LIST WITH ELEMENTS EMPTY
            SET j TO 0
            WHILE j LESS THAN LENGTH OF element
                CALL APPEND ON characters WITH ELEMENT CHARACTER AT POSITION j IN element
                INCREMENT j BY 1
            SET sorted_characters TO LIST WITH ELEMENTS EMPTY
            WHILE LENGTH OF characters GREATER THAN 0
                SET min_char TO ELEMENT AT POSITION 0 IN characters
                SET k TO 1
                WHILE k LESS THAN LENGTH OF characters
                    IF ELEMENT AT POSITION k IN characters LESS THAN min_char
                        SET min_char TO ELEMENT AT POSITION k IN characters
                    INCREMENT k BY 1
                CALL APPEND ON sorted_characters WITH ELEMENT min_char
                SET new_characters TO LIST WITH ELEMENTS EMPTY
                SET l TO 0
                WHILE l LESS THAN LENGTH OF characters
                    IF ELEMENT AT POSITION l IN characters NOT EQUAL TO min_char
                        CALL APPEND ON new_characters WITH ELEMENT ELEMENT AT POSITION l IN characters
                    INCREMENT l BY 1
                SET characters TO new_characters
            SET new_word TO EMPTY STRING
            SET m TO 0
            WHILE m LESS THAN LENGTH OF sorted_characters
                SET new_word TO CONCATENATE new_word WITH ELEMENT AT POSITION m IN sorted_characters
                INCREMENT m BY 1
            APPEND new_word TO ordered_words
        INCREMENT i BY 1
    SET final_string TO EMPTY STRING
    SET n TO 0
    WHILE n LESS THAN LENGTH OF ordered_words
        SET final_string TO CONCATENATE final_string WITH ELEMENT AT POSITION n IN ordered_words
        INCREMENT n BY 1
    RETURN final_string