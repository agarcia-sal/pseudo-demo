FUNCTION max_fill(grid, capacity)
    IMPORT math

    SET total_buckets_lowered TO 0

    FOR EACH well IN grid
        SET water_units TO SUM of well
        SET lowers_for_well TO math ceiling of (water_units divided by capacity)
        ADD lowers_for_well TO total_buckets_lowered

    RETURN total_buckets_lowered