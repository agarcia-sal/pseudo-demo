FUNCTION valid_date(date)
    TRY
        SET date TO date with leading and trailing whitespace removed
        SPLIT date BY '-' INTO month, day, year
        CONVERT month TO integer
        CONVERT day TO integer
        CONVERT year TO integer

        IF month LESS THAN 1 OR month GREATER THAN 12 THEN
            RETURN False
        END IF

        IF month IN [1, 3, 5, 7, 8, 10, 12] THEN
            IF day LESS THAN 1 OR day GREATER THAN 31 THEN
                RETURN False
            END IF
        END IF

        IF month IN [4, 6, 9, 11] THEN
            IF day LESS THAN 1 OR day GREATER THAN 30 THEN
                RETURN False
            END IF
        END IF

        IF month EQUALS 2 THEN
            IF day LESS THAN 1 OR day GREATER THAN 29 THEN
                RETURN False
            END IF
        END IF

    EXCEPT
        RETURN False
    END TRY

    RETURN True
END FUNCTION