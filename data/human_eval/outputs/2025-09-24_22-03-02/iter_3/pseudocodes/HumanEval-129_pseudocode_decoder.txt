FUNCTION minPath(grid, k)
    SET n TO LENGTH OF grid
    SET val TO n TIMES n PLUS 1
    
    FOR i FROM 0 TO n MINUS 1
        FOR j FROM 0 TO n MINUS 1
            IF grid AT i AND j EQUALS 1 THEN
                SET temp TO EMPTY LIST
                
                IF i NOT EQUAL TO 0 THEN
                    ADD grid AT (i MINUS 1) AND j TO temp
                
                IF j NOT EQUAL TO 0 THEN
                    ADD grid AT i AND (j MINUS 1) TO temp
                
                IF i NOT EQUAL TO n MINUS 1 THEN
                    ADD grid AT (i PLUS 1) AND j TO temp
                
                IF j NOT EQUAL TO n MINUS 1 THEN
                    ADD grid AT i AND (j PLUS 1) TO temp
                
                SET val TO MINIMUM VALUE IN temp
    
    SET ans TO EMPTY LIST
    FOR i FROM 0 TO k MINUS 1
        IF i MODULO 2 EQUALS 0 THEN
            ADD 1 TO ans
        ELSE
            ADD val TO ans
    
    RETURN ans