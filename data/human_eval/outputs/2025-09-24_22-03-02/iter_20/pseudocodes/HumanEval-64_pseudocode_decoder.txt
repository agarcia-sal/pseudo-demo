FUNCTION vowels_count(s)
    SET vowels TO STRING WITH ELEMENTS "aeiouAEIOU"
    SET n_vowels TO 0
    SET index TO 0
    WHILE index LESS THAN LENGTH OF s
        IF CALL character_at s WITH index IN vowels EQUALS TRUE
            INCREMENT n_vowels BY 1
        END IF
        INCREMENT index BY 1
    END WHILE
    IF CALL character_at s WITH (LENGTH OF s MINUS 1) EQUALS "y" OR CALL character_at s WITH (LENGTH OF s MINUS 1) EQUALS "Y"
        INCREMENT n_vowels BY 1
    END IF
    RETURN n_vowels
END FUNCTION