FUNCTION anti_shuffle(s)
    SET result_words TO LIST WITH ELEMENTS EMPTY
    SET words TO LIST WITH ELEMENTS EMPTY
    SET current_word TO EMPTY STRING
    SET index TO 0
    WHILE index LESS THAN LENGTH OF s
        IF CHARACTER AT s AT index EQUALS SPACE
            APPEND current_word TO words
            APPEND SPACE TO words
            SET current_word TO EMPTY STRING
        ELSE
            SET current_word TO current_word CONCATENATE CHARACTER AT s AT index
        END IF
        INCREMENT index BY ONE
    END WHILE
    IF current_word NOT EQUALS EMPTY STRING
        APPEND current_word TO words
    END IF
    SET index TO 0
    WHILE index LESS THAN LENGTH OF words
        IF words AT index EQUALS SPACE
            APPEND SPACE TO result_words
        ELSE
            SET letters_list TO LIST WITH ELEMENTS EMPTY
            SET letter_index TO 0
            SET word_to_sort TO words AT index
            WHILE letter_index LESS THAN LENGTH OF word_to_sort
                APPEND CHARACTER AT word_to_sort AT letter_index TO letters_list
                INCREMENT letter_index BY ONE
            END WHILE
            SET sorted_letters TO LIST WITH ELEMENTS EMPTY
            SET letter_index TO 0
            WHILE letter_index LESS THAN LENGTH OF letters_list
                SET min_index TO letter_index
                SET compare_index TO letter_index PLUS ONE
                WHILE compare_index LESS THAN LENGTH OF letters_list
                    IF CHARACTER AT letters_list AT compare_index LESS THAN CHARACTER AT letters_list AT min_index
                        SET min_index TO compare_index
                    END IF
                    INCREMENT compare_index BY ONE
                END WHILE
                IF min_index NOT EQUALS letter_index
                    SET temp TO letters_list AT letter_index
                    SET letters_list AT letter_index TO letters_list AT min_index
                    SET letters_list AT min_index TO temp
                END IF
                INCREMENT letter_index BY ONE
            END WHILE
            SET sorted_word TO EMPTY STRING
            SET letter_index TO 0
            WHILE letter_index LESS THAN LENGTH OF letters_list
                SET sorted_word TO sorted_word CONCATENATE letters_list AT letter_index
                INCREMENT letter_index BY ONE
            END WHILE
            APPEND sorted_word TO result_words
        END IF
        INCREMENT index BY ONE
    END WHILE
    SET final_string TO EMPTY STRING
    SET index TO 0
    WHILE index LESS THAN LENGTH OF result_words
        SET final_string TO final_string CONCATENATE result_words AT index
        INCREMENT index BY ONE
    END WHILE
    RETURN final_string