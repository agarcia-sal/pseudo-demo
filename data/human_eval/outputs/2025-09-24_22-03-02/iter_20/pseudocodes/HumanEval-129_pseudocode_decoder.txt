FUNCTION minPath WITH PARAMETERS grid, k
    SET n EQUALS LENGTH OF grid
    SET val EQUALS n MULTIPLY n PLUS 1
    FOR i IN RANGE FROM 0 TO n MINUS 1
        FOR j IN RANGE FROM 0 TO n MINUS 1
            IF grid AT i AT j EQUALS 1
                SET temp TO LIST WITH ELEMENTS EMPTY
                IF i NOT EQUALS 0
                    APPEND grid AT i MINUS 1 AT j TO temp
                IF j NOT EQUALS 0
                    APPEND grid AT i AT j MINUS 1 TO temp
                IF i NOT EQUALS n MINUS 1
                    APPEND grid AT i PLUS 1 AT j TO temp
                IF j NOT EQUALS n MINUS 1
                    APPEND grid AT i AT j PLUS 1 TO temp
                SET val TO minimum VALUE IN temp
    SET ans TO LIST WITH ELEMENTS EMPTY
    FOR i IN RANGE FROM 0 TO k MINUS 1
        IF i MODULO 2 EQUALS 0
            APPEND 1 TO ans
        ELSE
            APPEND val TO ans
    RETURN ans