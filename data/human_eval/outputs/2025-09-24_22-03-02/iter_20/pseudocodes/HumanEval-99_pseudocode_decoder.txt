FUNCTION closest_integer(value)
    SET decimal_point_count TO 0
    FOR index FROM 0 TO LENGTH OF value MINUS 1
        IF value AT index EQUALS '.'
            INCREMENT decimal_point_count
    IF decimal_point_count EQUALS 1
        WHILE value AT (LENGTH OF value MINUS 1) EQUALS '0'
            SET value TO SUBSTRING OF value FROM 0 TO (LENGTH OF value MINUS 1)
    SET num TO CONVERT value TO FLOAT
    IF LENGTH OF value GREATER THAN OR EQUAL TO 2
        IF SUBSTRING OF value FROM (LENGTH OF value MINUS 2) TO LENGTH OF value EQUALS '.5'
            IF num GREATER THAN 0
                CALL FUNCTION ceil FROM MODULE math WITH ARGUMENT num RETURN TO res
            ELSE
                CALL FUNCTION floor FROM MODULE math WITH ARGUMENT num RETURN TO res
        ELSE IF LENGTH OF value GREATER THAN 0
            SET res TO CONVERT CALL FUNCTION round WITH ARGUMENT num TO INTEGER
        ELSE
            SET res TO 0
    ELSE
        IF LENGTH OF value GREATER THAN 0
            SET res TO CONVERT CALL FUNCTION round WITH ARGUMENT num TO INTEGER
        ELSE
            SET res TO 0
    RETURN res