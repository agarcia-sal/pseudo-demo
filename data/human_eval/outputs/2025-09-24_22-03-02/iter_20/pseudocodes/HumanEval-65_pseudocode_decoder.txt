FUNCTION circular_shift(x, shift)
    SET s TO CALL str WITH ARGUMENT x
    IF shift GREATER THAN CALL len WITH ARGUMENT s THEN
        SET reversed_string TO LIST WITH ELEMENTS EMPTY
        SET index TO CALL len WITH ARGUMENT s MINUS 1
        WHILE index GREATER THAN OR EQUAL TO 0 DO
            APPEND s AT index TO reversed_string
            DECREMENT index BY 1
        END WHILE
        SET result TO EMPTY STRING
        SET i TO 0
        WHILE i LESS THAN CALL len WITH ARGUMENT reversed_string DO
            CONCATENATE reversed_string AT i TO result
            INCREMENT i BY 1
        END WHILE
        RETURN result
    ELSE
        SET length TO CALL len WITH ARGUMENT s
        SET part1 TO LIST WITH ELEMENTS EMPTY
        SET start_index_part1 TO length MINUS shift
        SET index_part1 TO start_index_part1
        WHILE index_part1 LESS THAN length DO
            APPEND s AT index_part1 TO part1
            INCREMENT index_part1 BY 1
        END WHILE
        SET part2 TO LIST WITH ELEMENTS EMPTY
        SET index_part2 TO 0
        WHILE index_part2 LESS THAN start_index_part1 DO
            APPEND s AT index_part2 TO part2
            INCREMENT index_part2 BY 1
        END WHILE
        SET result TO EMPTY STRING
        SET i TO 0
        WHILE i LESS THAN CALL len WITH ARGUMENT part1 DO
            CONCATENATE part1 AT i TO result
            INCREMENT i BY 1
        END WHILE
        SET j TO 0
        WHILE j LESS THAN CALL len WITH ARGUMENT part2 DO
            CONCATENATE part2 AT j TO result
            INCREMENT j BY 1
        END WHILE
        RETURN result
    END IF
END FUNCTION