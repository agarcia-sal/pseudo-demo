FUNCTION max_fill(grid, capacity)  
    IMPORT math  
    SET total_raises TO 0  
    FOR index_row FROM 0 TO LENGTH OF grid MINUS 1  
        SET current_row TO grid AT index_row  
        SET sum_units TO 0  
        FOR index_unit FROM 0 TO LENGTH OF current_row MINUS 1  
            SET sum_units TO sum_units PLUS current_row AT index_unit  
        END FOR  
        SET raises_for_row TO CALL math.ceil WITH ARGUMENT sum_units DIVIDE BY capacity  
        SET total_raises TO total_raises PLUS raises_for_row  
    END FOR  
    RETURN total_raises  
END FUNCTION