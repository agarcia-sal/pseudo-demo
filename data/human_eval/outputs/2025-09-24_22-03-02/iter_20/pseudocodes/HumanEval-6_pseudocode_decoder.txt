FUNCTION parse_nested_parens(paren_string : STRING) RETURNS LIST OF INTEGER
    FUNCTION parse_paren_group(s : STRING) RETURNS INTEGER
        SET depth TO 0
        SET max_depth TO 0
        FOR index FROM 0 TO LENGTH OF s MINUS 1
            SET c TO CHARACTER AT POSITION index OF s
            IF c EQUALS '(' THEN
                SET depth TO depth PLUS 1
                IF depth GREATER THAN max_depth THEN
                    SET max_depth TO depth
                ENDIF
            ELSE
                SET depth TO depth MINUS 1
            ENDIF
        ENDFOR
        RETURN max_depth
    ENDFUNCTION

    SET result TO LIST WITH ELEMENTS EMPTY
    SET parts TO LIST WITH ELEMENTS EMPTY
    SET current_string TO EMPTY STRING
    FOR index FROM 0 TO LENGTH OF paren_string MINUS 1
        SET char TO CHARACTER AT POSITION index OF paren_string
        IF char EQUALS ' ' THEN
            IF current_string NOT EQUALS EMPTY STRING THEN
                APPEND current_string TO parts
                SET current_string TO EMPTY STRING
            ENDIF
        ELSE
            CONCATENATE char TO current_string
        ENDIF
    ENDFOR
    IF current_string NOT EQUALS EMPTY STRING THEN
        APPEND current_string TO parts
    ENDIF

    FOR i FROM 0 TO LENGTH OF parts MINUS 1
        SET x TO ELEMENT AT POSITION i OF parts
        APPEND CALL parse_paren_group WITH ARGUMENTS x TO result
    ENDFOR

    RETURN result
ENDFUNCTION