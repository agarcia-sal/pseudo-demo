FUNCTION encode_cyclic(s)
    SET groups TO EMPTY LIST
    FOR i IN RANGE OF LENGTH OF s PLUS 2 DIVIDE BY 3
        SET start_index TO 3 MULTIPLY BY i
        SET end_index TO MINIMUM OF start_index PLUS 3 AND LENGTH OF s
        APPEND SUBSTRING OF s FROM start_index TO end_index TO groups
    SET new_groups TO EMPTY LIST
    FOR EACH group IN groups
        IF LENGTH OF group EQUALS 3
            APPEND CONCATENATION OF SUBSTRING OF group FROM INDEX 1 TO END AND FIRST CHARACTER OF group TO new_groups
        ELSE
            APPEND group TO new_groups
    RETURN CONCATENATION OF ALL ELEMENTS OF new_groups

FUNCTION decode_cyclic(s)
    RETURN CALL encode_cyclic WITH ARGUMENT CALL encode_cyclic WITH ARGUMENT s