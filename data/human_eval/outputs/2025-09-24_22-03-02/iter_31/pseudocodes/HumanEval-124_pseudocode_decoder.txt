FUNCTION valid_date(date)
    TRY
        SET date TO CALL strip ON date WITH ARGUMENTS EMPTY
        SET parts TO CALL split ON date WITH ARGUMENTS LIST WITH ELEMENTS '-'
        SET month TO CALL int WITH ARGUMENTS parts AT INDEX 0
        SET day TO CALL int WITH ARGUMENTS parts AT INDEX 1
        SET year TO CALL int WITH ARGUMENTS parts AT INDEX 2
        IF month LESS THAN 1 OR month GREATER THAN 12 THEN
            RETURN False
        END IF
        SET allowed_months_31 TO LIST WITH ELEMENTS 1, 3, 5, 7, 8, 10, 12
        SET allowed_months_30 TO LIST WITH ELEMENTS 4, 6, 9, 11
        IF CALL contains ON allowed_months_31 WITH ARGUMENTS month THEN
            IF day LESS THAN 1 OR day GREATER THAN 31 THEN
                RETURN False
            END IF
        END IF
        IF CALL contains ON allowed_months_30 WITH ARGUMENTS month THEN
            IF day LESS THAN 1 OR day GREATER THAN 30 THEN
                RETURN False
            END IF
        END IF
        IF month EQUALS 2 THEN
            IF day LESS THAN 1 OR day GREATER THAN 29 THEN
                RETURN False
            END IF
        END IF
    EXCEPT ANY ERROR
        RETURN False
    END TRY

    RETURN True
END FUNCTION