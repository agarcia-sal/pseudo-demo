FUNCTION words_string WITH PARAMETER s
    IF s EQUALS EMPTY STRING
        RETURN LIST WITH ELEMENTS EMPTY
    ENDIF

    SET s_list TO LIST WITH ELEMENTS EMPTY

    FOR index FROM 0 TO LENGTH OF s MINUS 1
        SET letter TO ELEMENT AT index IN s
        IF letter EQUALS STRING WITH ELEMENT ','
            CALL APPEND ON s_list WITH ARGUMENT STRING WITH ELEMENT ' '
        ELSE
            CALL APPEND ON s_list WITH ARGUMENT letter
        ENDIF
    ENDFOR

    SET joined_string TO EMPTY STRING
    FOR index FROM 0 TO LENGTH OF s_list MINUS 1
        SET joined_string TO joined_string CONCATENATE ELEMENT AT index IN s_list
    ENDFOR

    SET word_list TO LIST WITH ELEMENTS EMPTY
    SET current_word TO EMPTY STRING

    FOR index FROM 0 TO LENGTH OF joined_string MINUS 1
        SET current_char TO ELEMENT AT index IN joined_string
        IF current_char EQUALS STRING WITH ELEMENT ' '
            IF current_word NOT EQUAL TO EMPTY STRING
                CALL APPEND ON word_list WITH ARGUMENT current_word
                SET current_word TO EMPTY STRING
            ENDIF
        ELSE
            SET current_word TO current_word CONCATENATE current_char
        ENDIF
    ENDFOR

    IF current_word NOT EQUAL TO EMPTY STRING
        CALL APPEND ON word_list WITH ARGUMENT current_word
    ENDIF

    RETURN word_list
END FUNCTION