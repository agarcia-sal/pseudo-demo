FUNCTION sort_third WITH PARAMETER l OF TYPE list
    SET l TO CALL list WITH ARGUMENTS l
    SET indices_divisible_by_three TO LIST WITH ELEMENTS EMPTY
    SET values_at_divisible_indices TO LIST WITH ELEMENTS EMPTY
    SET length_of_l TO CALL length ON l
    FOR index FROM 0 TO length_of_l MINUS 1 DO
        IF index MODULO 3 EQUALS 0 THEN
            APPEND index TO indices_divisible_by_three
            APPEND VALUE AT l WITH INDEX index TO values_at_divisible_indices
        END IF
    END FOR
    SET sorted_values TO CALL sorted WITH ARGUMENTS values_at_divisible_indices
    SET counter TO 0
    FOR each_index FROM 0 TO CALL length ON indices_divisible_by_three MINUS 1 DO
        SET index_to_replace TO VALUE AT indices_divisible_by_three WITH INDEX each_index
        SET VALUE AT l WITH INDEX index_to_replace TO VALUE AT sorted_values WITH INDEX counter
        INCREMENT counter BY 1
    END FOR
    RETURN l