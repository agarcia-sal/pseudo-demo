FUNCTION parse_music WITH PARAMETER music_string OF TYPE STRING RETURNS LIST OF INTEGER
    SET note_map TO DICTIONARY WITH
        KEY 'o' AND VALUE 4,
        KEY 'o|' AND VALUE 2,
        KEY '.|' AND VALUE 1
    SET split_notes TO CALL split ON music_string WITH ARGUMENT ' '
    SET result TO LIST WITH ELEMENTS EMPTY
    SET index TO 0
    WHILE index LESS THAN LENGTH OF split_notes
        SET current_note TO split_notes AT INDEX index
        IF current_note NOT EQUAL TO EMPTY STRING
            SET note_value TO note_map AT KEY current_note
            APPEND note_value TO result
        END IF
        INCREMENT index BY 1
    END WHILE
    RETURN result
END FUNCTION