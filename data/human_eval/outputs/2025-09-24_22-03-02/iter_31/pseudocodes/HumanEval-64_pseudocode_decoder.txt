FUNCTION vowels_count WITH PARAMETER s
    SET vowels TO LIST WITH ELEMENTS "a", "e", "i", "o", "u", "A", "E", "I", "O", "U"
    SET n_vowels TO 0
    SET length_s TO CALL LENGTH ON s
    SET index TO 0
    WHILE index LESS THAN length_s
        SET c TO ELEMENT AT index OF s
        SET is_vowel TO FALSE
        SET vowel_index TO 0
        SET vowels_length TO CALL LENGTH ON vowels
        WHILE vowel_index LESS THAN vowels_length
            IF c EQUALS ELEMENT AT vowel_index OF vowels
                SET is_vowel TO TRUE
                BREAK
            END IF
            INCREMENT vowel_index BY 1
        END WHILE
        IF is_vowel EQUALS TRUE
            SET n_vowels TO n_vowels PLUS 1
        END IF
        INCREMENT index BY 1
    END WHILE
    SET last_index TO length_s MINUS 1
    IF last_index GREATER THAN OR EQUAL TO 0
        SET last_char TO ELEMENT AT last_index OF s
        IF last_char EQUALS "y" OR last_char EQUALS "Y"
            SET n_vowels TO n_vowels PLUS 1
        END IF
    END IF
    RETURN n_vowels