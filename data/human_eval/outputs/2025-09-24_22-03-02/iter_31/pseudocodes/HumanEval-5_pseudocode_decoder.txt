FUNCTION intersperse WITH PARAMETERS numbers AS LIST OF INTEGERS, delimeter AS INTEGER RETURNS LIST OF INTEGERS
    IF numbers EQUALS LIST WITH ELEMENTS EMPTY THEN
        RETURN LIST WITH ELEMENTS EMPTY
    END IF

    SET result TO LIST WITH ELEMENTS EMPTY

    SET last_index TO LENGTH OF numbers MINUS 1

    SET i TO 0
    WHILE i LESS THAN last_index DO
        SET n TO ELEMENT AT INDEX i OF numbers
        CALL APPEND ON result WITH ARGUMENT n
        CALL APPEND ON result WITH ARGUMENT delimeter
        INCREMENT i BY 1
    END WHILE

    SET last_element TO ELEMENT AT INDEX last_index OF numbers
    CALL APPEND ON result WITH ARGUMENT last_element

    RETURN result
END FUNCTION