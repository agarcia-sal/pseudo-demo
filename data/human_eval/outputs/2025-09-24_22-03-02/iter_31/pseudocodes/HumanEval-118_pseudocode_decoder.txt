FUNCTION get_closest_vowel WITH PARAMETER word
    IF LENGTH OF word LESS THAN 3 THEN
        RETURN EMPTY STRING
    END IF

    SET vowels TO LIST WITH ELEMENTS "a", "e", "i", "o", "u", "A", "E", "O", "U", "I"

    SET index TO LENGTH OF word MINUS 2
    WHILE index GREATER THAN 0
        SET current_char TO CHARACTER AT POSITION index IN word

        SET is_current_char_vowel TO FALSE
        SET vowel_index TO 0
        WHILE vowel_index LESS THAN LENGTH OF vowels
            IF current_char EQUALS ELEMENT AT POSITION vowel_index IN vowels THEN
                SET is_current_char_vowel TO TRUE
                BREAK
            END IF
            INCREMENT vowel_index BY 1
        END WHILE

        IF is_current_char_vowel EQUALS TRUE THEN
            SET right_char TO CHARACTER AT POSITION (index PLUS 1) IN word
            SET left_char TO CHARACTER AT POSITION (index MINUS 1) IN word

            SET is_right_char_vowel TO FALSE
            SET vowel_index TO 0
            WHILE vowel_index LESS THAN LENGTH OF vowels
                IF right_char EQUALS ELEMENT AT POSITION vowel_index IN vowels THEN
                    SET is_right_char_vowel TO TRUE
                    BREAK
                END IF
                INCREMENT vowel_index BY 1
            END WHILE

            SET is_left_char_vowel TO FALSE
            SET vowel_index TO 0
            WHILE vowel_index LESS THAN LENGTH OF vowels
                IF left_char EQUALS ELEMENT AT POSITION vowel_index IN vowels THEN
                    SET is_left_char_vowel TO TRUE
                    BREAK
                END IF
                INCREMENT vowel_index BY 1
            END WHILE

            IF is_right_char_vowel EQUALS FALSE AND is_left_char_vowel EQUALS FALSE THEN
                RETURN current_char
            END IF
        END IF

        DECREMENT index BY 1
    END WHILE

    RETURN EMPTY STRING
END FUNCTION