FUNCTION how_many_times WITH PARAMETERS string AS STRING, substring AS STRING RETURNS INTEGER
    SET times TO 0
    SET string_length TO CALL length OF string WITH NO ARGUMENTS
    SET substring_length TO CALL length OF substring WITH NO ARGUMENTS
    SET limit TO string_length MINUS substring_length PLUS 1

    FOR i IN RANGE FROM 0 TO limit MINUS 1
        SET match_substring TO EMPTY STRING
        FOR j IN RANGE FROM 0 TO substring_length MINUS 1
            SET current_char TO CALL character AT INDEX i PLUS j OF string
            SET match_substring TO CONCATENATE match_substring WITH current_char
        END FOR

        IF match_substring EQUALS substring THEN
            SET times TO times PLUS 1
        END IF
    END FOR

    RETURN times