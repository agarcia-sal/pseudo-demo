FUNCTION separate_paren_groups(paren_string AS STRING) RETURNS LIST OF STRING
    SET result TO empty list
    SET current_string TO empty list
    SET current_depth TO zero

    FOR EACH character IN paren_string
        IF character EQUALS open parenthesis
            INCREMENT current_depth BY one
            APPEND character TO current_string
        ELSE IF character EQUALS close parenthesis
            DECREMENT current_depth BY one
            APPEND character TO current_string

            IF current_depth EQUALS zero
                APPEND concatenation of all elements in current_string TO result
                CLEAR current_string

    RETURN result