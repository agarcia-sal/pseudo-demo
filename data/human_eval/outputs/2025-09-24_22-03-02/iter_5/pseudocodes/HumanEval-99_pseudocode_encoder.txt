FUNCTION closest_integer(value)
    IMPORT floor, ceil FROM math

    IF value CONTAINS EXACTLY ONE PERIOD
        WHILE last character of value IS '0'
            SET value TO all characters of value EXCEPT the last one

    SET num TO float conversion of value

    IF last two characters of value ARE '.5'
        IF num IS GREATER THAN zero
            SET res TO ceil of num
        ELSE
            SET res TO floor of num
    ELSE IF length of value IS GREATER THAN zero
        SET res TO integer conversion of rounded num
    ELSE
        SET res TO zero

    RETURN res