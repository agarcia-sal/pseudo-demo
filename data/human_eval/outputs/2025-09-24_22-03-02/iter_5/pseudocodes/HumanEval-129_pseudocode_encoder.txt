FUNCTION minPath(grid, k)
    SET n TO length of grid
    SET val TO n times n plus one

    FOR i FROM zero TO n minus one
        FOR j FROM zero TO n minus one
            IF grid at row i column j EQUALS one THEN
                SET temp TO empty list

                IF i NOT EQUALS zero THEN
                    APPEND grid at row i minus one column j TO temp

                IF j NOT EQUALS zero THEN
                    APPEND grid at row i column j minus one TO temp

                IF i NOT EQUALS n minus one THEN
                    APPEND grid at row i plus one column j TO temp

                IF j NOT EQUALS n minus one THEN
                    APPEND grid at row i column j plus one TO temp

                SET val TO minimum value in temp

    SET ans TO empty list

    FOR i FROM zero TO k minus one
        IF i modulo two EQUALS zero THEN
            APPEND one TO ans
        ELSE
            APPEND val TO ans

    RETURN ans