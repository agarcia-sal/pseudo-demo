FUNCTION separate_paren_groups(paren_string: STRING) RETURNS LIST OF STRING
    SET result TO LIST WITH ELEMENTS EMPTY
    SET current_string TO LIST WITH ELEMENTS EMPTY
    SET current_depth TO 0
    FOR index FROM 0 TO LENGTH OF paren_string MINUS 1
        SET c TO ELEMENT AT index IN paren_string
        IF c EQUALS '(' THEN
            INCREMENT current_depth BY 1
            CALL APPEND OF current_string WITH ARGUMENTS c
        ELSE IF c EQUALS ')' THEN
            DECREMENT current_depth BY 1
            CALL APPEND OF current_string WITH ARGUMENTS c
            IF current_depth EQUALS 0 THEN
                SET joined_string TO EMPTY STRING
                FOR j FROM 0 TO LENGTH OF current_string MINUS 1
                    CONCATENATE joined_string WITH ELEMENT AT j IN current_string
                CALL APPEND OF result WITH ARGUMENTS joined_string
                CALL CLEAR OF current_string
    RETURN result
END FUNCTION