FUNCTION closest_integer(value: STRING)
    IMPORT floor FROM math
    IMPORT ceil FROM math
    SET dot_count TO 0
    FOR index FROM 0 TO LENGTH OF value MINUS 1
        IF ELEMENT AT index IN value EQUALS '.'
            INCREMENT dot_count BY 1
    IF dot_count EQUALS 1
        WHILE LENGTH OF value GREATER THAN 0 AND ELEMENT AT LENGTH OF value MINUS 1 IN value EQUALS '0'
            SET value TO SUBSTRING OF value FROM 0 TO LENGTH OF value MINUS 1
    SET num TO CONVERT value TO FLOAT
    IF LENGTH OF value GREATER THAN OR EQUAL TO 2
        SET last_two_chars TO CONCATENATE ELEMENT AT LENGTH OF value MINUS 2 IN value AND ELEMENT AT LENGTH OF value MINUS 1 IN value
    ELSE
        SET last_two_chars TO EMPTY STRING
    IF last_two_chars EQUALS '.5'
        IF num GREATER THAN 0
            SET res TO CALL ceil WITH ARGUMENTS num
        ELSE
            SET res TO CALL floor WITH ARGUMENTS num
    ELSE
        IF LENGTH OF value GREATER THAN 0
            SET res TO CONVERT CALL round WITH ARGUMENTS num TO INTEGER
        ELSE
            SET res TO 0
    RETURN res
END FUNCTION