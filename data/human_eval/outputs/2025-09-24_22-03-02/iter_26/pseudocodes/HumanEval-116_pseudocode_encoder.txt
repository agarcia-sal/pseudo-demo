FUNCTION sort_array(arr)
    SET sorted_arr TO CALL sorted WITH ARGUMENTS arr
    SET sorted_by_ones TO CALL sorted WITH ARGUMENTS sorted_arr AND KEY FUNCTION x:
        SET binary_representation TO CALL bin WITH ARGUMENTS x
        SET binary_string TO SUBSTRING OF binary_representation FROM INDEX 2 TO END
        SET count_ones TO 0
        FOR index FROM 0 TO LENGTH OF binary_string MINUS 1
            IF ELEMENT AT index IN binary_string EQUALS '1'
                INCREMENT count_ones BY 1
        RETURN count_ones
    RETURN sorted_by_ones
END FUNCTION