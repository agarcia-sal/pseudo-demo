FUNCTION vowels_count WITH PARAMETER s  
    SET vowels TO STRING "aeiouAEIOU"  
    SET n_vowels TO 0  
    SET i TO 0  
    WHILE i LESS THAN LENGTH OF s  
        IF CALL s AT INDEX i EQUALS ANY CHARACTER IN vowels  
            INCREMENT n_vowels BY 1  
        END IF  
        INCREMENT i BY 1  
    END WHILE  
    IF CALL s AT INDEX LENGTH OF s MINUS 1 EQUALS CHARACTER 'y' OR CALL s AT INDEX LENGTH OF s MINUS 1 EQUALS CHARACTER 'Y'  
        INCREMENT n_vowels BY 1  
    END IF  
    RETURN n_vowels  
END FUNCTION