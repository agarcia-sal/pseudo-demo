FUNCTION max_fill(grid, capacity)
    IMPORT math
    SET total_lowerings TO 0
    SET index_row TO 0
    WHILE index_row LESS THAN LENGTH OF grid
        SET current_row TO grid AT index_row
        SET sum_in_row TO 0
        SET index_element TO 0
        WHILE index_element LESS THAN LENGTH OF current_row
            SET sum_in_row TO sum_in_row PLUS current_row AT index_element
            INCREMENT index_element BY 1
        END WHILE
        SET times TO CALL math.ceil WITH sum_in_row DIVIDED BY capacity
        SET total_lowerings TO total_lowerings PLUS times
        INCREMENT index_row BY 1
    END WHILE
    RETURN total_lowerings
END FUNCTION