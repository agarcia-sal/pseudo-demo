FUNCTION separate_paren_groups(paren_string : str) RETURNS List OF str
    SET result TO LIST WITH ELEMENTS EMPTY
    SET current_string TO LIST WITH ELEMENTS EMPTY
    SET current_depth TO 0

    FOR index FROM 0 TO LENGTH OF paren_string MINUS 1
        SET c TO paren_string AT index
        IF c EQUALS '(' THEN
            INCREMENT current_depth BY 1
            CALL current_string.APPEND WITH ARGUMENT c
        ELSE IF c EQUALS ')' THEN
            DECREMENT current_depth BY 1
            CALL current_string.APPEND WITH ARGUMENT c

            IF current_depth EQUALS 0 THEN
                SET joined_string TO EMPTY STRING
                FOR join_index FROM 0 TO LENGTH OF current_string MINUS 1
                    CONCATENATE joined_string WITH current_string AT join_index
                END FOR
                CALL result.APPEND WITH ARGUMENT joined_string
                CALL current_string.CLEAR
            END IF
        END IF
    END FOR

    RETURN result