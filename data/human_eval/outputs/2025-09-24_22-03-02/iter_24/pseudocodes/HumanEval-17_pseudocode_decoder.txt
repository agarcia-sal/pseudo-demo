FUNCTION parse_music WITH PARAMETER music_string AS str RETURNS List OF int
    SET note_map TO DICTIONARY WITH ELEMENTS 'o' EQUALS 4, 'o|' EQUALS 2, '.|' EQUALS 1
    SET tokens TO CALL SPLIT ON music_string WITH ARGUMENT ' '
    SET result TO LIST WITH ELEMENTS EMPTY
    FOR index FROM 0 TO LENGTH OF tokens MINUS 1
        SET x TO tokens AT index
        IF x NOT EQUAL TO EMPTY STRING
            CALL APPEND ON result WITH ARGUMENT note_map AT KEY x
        END IF
    END FOR
    RETURN result
END FUNCTION