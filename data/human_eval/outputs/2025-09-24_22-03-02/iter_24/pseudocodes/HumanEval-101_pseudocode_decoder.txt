FUNCTION words_string(s)
    IF s EQUALS EMPTY STRING THEN
        RETURN LIST WITH ELEMENTS EMPTY
    END IF

    SET s_list TO LIST WITH ELEMENTS EMPTY

    SET index TO 0
    WHILE index LESS THAN LENGTH OF s
        SET letter TO s AT POSITION index
        IF letter EQUALS COMMA THEN
            CALL APPEND WITH ARGUMENTS s_list AND ELEMENT SPACE CHARACTER
        ELSE
            CALL APPEND WITH ARGUMENTS s_list AND ELEMENT letter
        END IF
        INCREMENT index BY ONE
    END WHILE

    SET joined_string TO EMPTY STRING
    SET index TO 0
    WHILE index LESS THAN LENGTH OF s_list
        SET joined_string TO CONCATENATE joined_string AND s_list AT POSITION index
        INCREMENT index BY ONE
    END WHILE

    SET result TO LIST WITH ELEMENTS EMPTY
    SET current_word TO EMPTY STRING
    SET index TO 0
    WHILE index LESS THAN LENGTH OF joined_string
        SET current_character TO joined_string AT POSITION index
        IF current_character EQUALS SPACE CHARACTER THEN
            IF current_word NOT EQUALS EMPTY STRING THEN
                CALL APPEND WITH ARGUMENTS result AND ELEMENT current_word
                SET current_word TO EMPTY STRING
            END IF
        ELSE
            SET current_word TO CONCATENATE current_word AND current_character
        END IF
        INCREMENT index BY ONE
    END WHILE
    IF current_word NOT EQUALS EMPTY STRING THEN
        CALL APPEND WITH ARGUMENTS result AND ELEMENT current_word
    END IF

    RETURN result
END FUNCTION