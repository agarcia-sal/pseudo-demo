Translate the given pseudocode into correct, idiomatic Python code strictly preserving all original function and class names, signatures (including parameter names and return types), and class/object structures exactly as given. Your implementation must:

- Include all necessary imports from Python’s standard library or built-in modules to prevent runtime errors (e.g., `import math`, `import copy`, `import random`, etc.) based on the pseudocode’s operations.
- Use efficient, clean, and Pythonic constructs ensuring readability and optimal performance.
- Handle any implied or typical edge cases that are natural from the pseudocode description to avoid runtime exceptions.
- Avoid adding any explanations, comments, or text outside the code.
- Never alter function/class signatures or add/remove parameters unless explicitly instructed in pseudocode.
- Ensure the output code runs successfully and efficiently within a 5-second timeout on typical test inputs.

Enclose your entire output strictly within a single Python code block formatted exactly as follows:

```python
# Your translated Python code here
```

Only output this Python code block—no additional text, headings, or separators.