FUNCTION max_fill(grid, capacity)
    IMPORT math

    SET total_times TO 0

    FOR EACH arr IN grid
        SET water_units TO SUM of arr
        SET times_for_well TO math ceiling of (water_units divided by capacity)
        INCREMENT total_times BY times_for_well
    END FOR

    RETURN total_times
END FUNCTION