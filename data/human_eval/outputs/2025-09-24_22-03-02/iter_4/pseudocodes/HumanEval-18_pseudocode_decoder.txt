FUNCTION how_many_times(string AS STRING, substring AS STRING) RETURNS INTEGER
    SET times TO 0

    FOR i FROM 0 TO LENGTH(string) MINUS LENGTH(substring) PLUS 1 EXCLUSIVE
        IF SUBSTRING(string, i, i PLUS LENGTH(substring)) EQUALS substring THEN
            SET times TO times PLUS 1
        END IF
    END FOR

    RETURN times
END FUNCTION