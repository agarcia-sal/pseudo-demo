FUNCTION max_fill(grid, capacity)
    IMPORT math
    SET total_times TO 0
    FOR EACH arr IN grid
        SET water_units TO 0
        FOR EACH unit IN arr
            SET water_units TO water_units PLUS unit
        SET times_for_well TO CALL math.ceil WITH water_units DIVIDED BY capacity
        SET total_times TO total_times PLUS times_for_well
    RETURN total_times