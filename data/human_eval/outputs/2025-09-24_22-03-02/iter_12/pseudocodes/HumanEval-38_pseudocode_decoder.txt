FUNCTION encode_cyclic WITH PARAMETER s
    SET groups TO EMPTY LIST
    FOR i FROM 0 TO INTEGER DIVISION OF (LENGTH OF s PLUS 2) BY 3 MINUS 1
        APPEND SUBSTRING OF s FROM (3 MULTIPLY i) TO MINIMUM OF (3 MULTIPLY i PLUS 3) AND LENGTH OF s TO groups
    SET groups TO EMPTY LIST
    FOR EACH group IN groups
        IF LENGTH OF group EQUALS 3
            APPEND SUBSTRING OF group FROM INDEX 1 TO END CONCATENATED WITH FIRST CHARACTER OF group TO groups
        ELSE
            APPEND group TO groups
    SET result TO EMPTY STRING
    FOR EACH group IN groups
        CONCATENATE group TO result
    RETURN result

FUNCTION decode_cyclic WITH PARAMETER s
    RETURN CALL encode_cyclic WITH ARGUMENT CALL encode_cyclic WITH ARGUMENT s