FUNCTION words_string(s)
    IF s EQUALS EMPTY STRING THEN
        RETURN LIST WITH ELEMENTS EMPTY
    END IF

    SET s_list TO LIST WITH ELEMENTS EMPTY

    FOR index FROM 0 TO LENGTH OF s MINUS 1
        SET letter TO s AT index
        IF letter EQUALS COMMA THEN
            APPEND SPACE TO s_list
        ELSE
            APPEND letter TO s_list
        END IF
    END FOR

    SET joined_string TO EMPTY STRING
    FOR index FROM 0 TO LENGTH OF s_list MINUS 1
        CONCATENATE joined_string WITH s_list AT index AND SET TO joined_string
    END FOR

    SET result_list TO LIST WITH ELEMENTS EMPTY
    SET current_word TO EMPTY STRING

    FOR index FROM 0 TO LENGTH OF joined_string MINUS 1
        SET current_char TO joined_string AT index
        IF current_char EQUALS SPACE THEN
            IF current_word NOT EQUALS EMPTY STRING THEN
                APPEND current_word TO result_list
                SET current_word TO EMPTY STRING
            END IF
        ELSE
            CONCATENATE current_word WITH current_char AND SET TO current_word
        END IF
    END FOR

    IF current_word NOT EQUALS EMPTY STRING THEN
        APPEND current_word TO result_list
    END IF

    RETURN result_list
END FUNCTION