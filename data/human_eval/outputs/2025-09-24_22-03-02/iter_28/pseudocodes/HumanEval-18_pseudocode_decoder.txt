FUNCTION how_many_times WITH PARAMETERS string OF TYPE str, substring OF TYPE str RETURNS int
    SET times TO 0
    SET length_string TO CALL len WITH ARGUMENT string
    SET length_substring TO CALL len WITH ARGUMENT substring
    SET max_index TO length_string MINUS length_substring PLUS 1
    FOR i FROM 0 TO max_index MINUS 1
        SET slice TO CALL string SLICE FROM i TO i PLUS length_substring MINUS 1
        SET is_equal TO slice EQUALS substring
        IF is_equal EQUALS TRUE
            INCREMENT times BY 1
        ENDIF
    ENDFOR
    RETURN times