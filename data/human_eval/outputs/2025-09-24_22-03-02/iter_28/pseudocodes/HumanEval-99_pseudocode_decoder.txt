FUNCTION closest_integer(value)
    IMPORT floor FROM math
    IMPORT ceil FROM math

    SET dot_count TO 0
    FOR index FROM 0 TO LENGTH OF value MINUS 1
        IF value AT index EQUALS '.'
            INCREMENT dot_count
    IF dot_count EQUALS 1
        WHILE value AT LENGTH OF value MINUS 1 EQUALS '0'
            SET value TO SUBSTRING OF value FROM START TO LENGTH OF value MINUS 1

    SET num TO CALL float WITH ARGUMENT value

    IF LENGTH OF value GREATER THAN OR EQUAL TO 2
        SET last_two_chars TO SUBSTRING OF value FROM LENGTH OF value MINUS 2 TO LENGTH OF value
    ELSE
        SET last_two_chars TO EMPTY STRING

    IF last_two_chars EQUALS '.5'
        IF num GREATER THAN 0
            SET res TO CALL ceil WITH ARGUMENT num
        ELSE
            SET res TO CALL floor WITH ARGUMENT num
    ELSE IF LENGTH OF value GREATER THAN 0
        SET rounded_num TO CALL round WITH ARGUMENT num
        SET res TO CALL int WITH ARGUMENT rounded_num
    ELSE
        SET res TO 0

    RETURN res