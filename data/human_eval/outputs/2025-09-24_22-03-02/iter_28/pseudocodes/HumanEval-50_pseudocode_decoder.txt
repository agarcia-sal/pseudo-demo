FUNCTION encode_shift WITH PARAMETER s OF TYPE STRING
    SET result TO EMPTY STRING
    SET index TO ZERO
    WHILE index LESS THAN LENGTH OF s
        SET ch TO CHARACTER AT POSITION index IN s
        SET code TO ORDINAL VALUE OF ch
        SET base TO ORDINAL VALUE OF CHARACTER "a"
        SET shifted_code TO ((code PLUS FIVE MINUS base) MODULO TWENTY SIX) PLUS base
        SET shifted_char TO CHARACTER REPRESENTED BY shifted_code
        CONCATENATE shifted_char TO result
        INCREMENT index BY ONE
    END WHILE
    RETURN result
END FUNCTION

FUNCTION decode_shift WITH PARAMETER s OF TYPE STRING
    SET result TO EMPTY STRING
    SET index TO ZERO
    WHILE index LESS THAN LENGTH OF s
        SET ch TO CHARACTER AT POSITION index IN s
        SET code TO ORDINAL VALUE OF ch
        SET base TO ORDINAL VALUE OF CHARACTER "a"
        SET shifted_code TO ((code MINUS FIVE MINUS base) MODULO TWENTY SIX) PLUS base
        SET shifted_char TO CHARACTER REPRESENTED BY shifted_code
        CONCATENATE shifted_char TO result
        INCREMENT index BY ONE
    END WHILE
    RETURN result
END FUNCTION