FUNCTION vowels_count WITH PARAMETER s
    SET vowels TO STRING "aeiouAEIOU"
    SET n_vowels TO 0
    FOR i FROM 0 TO LENGTH OF s MINUS 1
        SET c TO CHARACTER AT INDEX i OF s
        IF c IS IN vowels
            INCREMENT n_vowels BY 1
    IF CHARACTER AT INDEX LENGTH OF s MINUS 1 OF s EQUALS LOWERCASE LETTER "y" OR CHARACTER AT INDEX LENGTH OF s MINUS 1 OF s EQUALS UPPERCASE LETTER "Y"
        INCREMENT n_vowels BY 1
    RETURN n_vowels