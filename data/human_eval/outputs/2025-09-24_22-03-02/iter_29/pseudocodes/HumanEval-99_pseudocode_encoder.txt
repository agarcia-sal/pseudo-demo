FUNCTION closest_integer(value STRING) RETURNS INTEGER
    IMPORT floor FROM math
    IMPORT ceil FROM math

    IF CALL value.count WITH ARGUMENT '.' EQUALS 1 THEN
        WHILE CALL value.GET CHARACTER AT POSITION (CALL value.LENGTH MINUS 1) EQUALS '0' DO
            SET value TO CALL value.SUBSTRING WITH ARGUMENTS 0 TO (CALL value.LENGTH MINUS 1)
        END WHILE
    END IF

    SET num TO CALL float WITH ARGUMENT value

    IF CALL value.GET SUBSTRING WITH ARGUMENTS (CALL value.LENGTH MINUS 2) TO CALL value.LENGTH EQUALS '.5' THEN
        IF num GREATER THAN 0 THEN
            SET res TO CALL ceil WITH ARGUMENT num
        ELSE
            SET res TO CALL floor WITH ARGUMENT num
        END IF
    ELSE IF CALL value.LENGTH GREATER THAN 0 THEN
        SET res TO CALL round WITH ARGUMENT num
        SET res TO CALL int WITH ARGUMENT res
    ELSE
        SET res TO 0
    END IF

    RETURN res
END FUNCTION