FUNCTION minPath WITH PARAMETERS grid, k
    SET n TO CALL len WITH ARGUMENTS grid
    SET val TO n MULTIPLY n PLUS 1
    FOR i FROM 0 TO n MINUS 1 DO
        FOR j FROM 0 TO n MINUS 1 DO
            IF grid AT INDEX i AT INDEX j EQUALS 1 THEN
                SET temp TO LIST WITH ELEMENTS EMPTY
                IF i NOT EQUAL TO 0 THEN
                    CALL APPEND ON temp WITH ARGUMENTS grid AT INDEX i MINUS 1 AT INDEX j
                END IF
                IF j NOT EQUAL TO 0 THEN
                    CALL APPEND ON temp WITH ARGUMENTS grid AT INDEX i AT INDEX j MINUS 1
                END IF
                IF i NOT EQUAL TO n MINUS 1 THEN
                    CALL APPEND ON temp WITH ARGUMENTS grid AT INDEX i PLUS 1 AT INDEX j
                END IF
                IF j NOT EQUAL TO n MINUS 1 THEN
                    CALL APPEND ON temp WITH ARGUMENTS grid AT INDEX i AT INDEX j PLUS 1
                END IF
                SET val TO CALL MINIMUM FUNCTION WITH ARGUMENTS temp
            END IF
        END FOR
    END FOR
    SET ans TO LIST WITH ELEMENTS EMPTY
    FOR i FROM 0 TO k MINUS 1 DO
        IF i MODULO 2 EQUALS 0 THEN
            CALL APPEND ON ans WITH ARGUMENTS 1
        ELSE
            CALL APPEND ON ans WITH ARGUMENTS val
        END IF
    END FOR
    RETURN ans
END FUNCTION