FUNCTION parse_music WITH PARAMETER music_string OF TYPE str RETURNS List[int]
    SET note_map TO DICTIONARY WITH ELEMENTS 'o' EQUALS 4, 'o|' EQUALS 2, '.|' EQUALS 1
    SET split_notes TO CALL music_string SPLIT WITH ARGUMENT ' '
    SET result TO LIST WITH ELEMENTS EMPTY
    FOR index FROM 0 TO LENGTH OF split_notes MINUS 1
        SET x TO split_notes AT index
        IF x NOT EQUAL TO EMPTY STRING
            APPEND note_map AT KEY x TO result
    RETURN result