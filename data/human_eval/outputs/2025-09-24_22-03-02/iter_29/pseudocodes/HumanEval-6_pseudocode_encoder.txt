FUNCTION parse_nested_parens WITH PARAMETER paren_string OF TYPE str RETURNS List OF int
    FUNCTION parse_paren_group WITH PARAMETER s RETURNS int
        SET depth TO 0
        SET max_depth TO 0
        FOR index FROM 0 TO LENGTH OF s MINUS 1
            SET c TO s AT index
            IF c EQUALS '(' THEN
                SET depth TO depth PLUS 1
                IF depth GREATER THAN max_depth THEN
                    SET max_depth TO depth
                END IF
            ELSE
                SET depth TO depth MINUS 1
            END IF
        END FOR
        RETURN max_depth
    END FUNCTION
    SET result TO LIST WITH ELEMENTS EMPTY
    SET parts TO LIST WITH ELEMENTS EMPTY
    SET start_index TO 0
    FOR index FROM 0 TO LENGTH OF paren_string MINUS 1
        SET current_char TO paren_string AT index
        IF current_char EQUALS ' ' THEN
            SET substring TO SUBSTRING OF paren_string FROM start_index TO index MINUS 1
            IF substring NOT EQUAL TO EMPTY STRING THEN
                APPEND substring TO parts
            END IF
            SET start_index TO index PLUS 1
        END IF
    END FOR
    SET substring TO SUBSTRING OF paren_string FROM start_index TO LENGTH OF paren_string MINUS 1
    IF substring NOT EQUAL TO EMPTY STRING THEN
        APPEND substring TO parts
    END IF
    FOR index FROM 0 TO LENGTH OF parts MINUS 1
        SET x TO parts AT index
        SET value TO CALL parse_paren_group WITH ARGUMENT x
        APPEND value TO result
    END FOR
    RETURN result
END FUNCTION