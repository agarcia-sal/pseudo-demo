FUNCTION vowels_count WITH PARAMETER s
    SET vowels TO STRING "aeiouAEIOU"
    SET n_vowels TO 0
    SET i TO 0
    WHILE i LESS THAN LENGTH OF s
        SET c TO CHARACTER AT INDEX i OF s
        IF c IN vowels EQUALS TRUE
            INCREMENT n_vowels BY 1
        ENDIF
        INCREMENT i BY 1
    ENDWHILE
    IF CHARACTER AT INDEX (LENGTH OF s MINUS 1) OF s EQUALS 'y' OR CHARACTER AT INDEX (LENGTH OF s MINUS 1) OF s EQUALS 'Y'
        INCREMENT n_vowels BY 1
    ENDIF
    RETURN n_vowels