FUNCTION separate_paren_groups WITH PARAMETER paren_string OF TYPE str RETURNS List OF str
    SET result TO LIST WITH ELEMENTS EMPTY
    SET current_string TO LIST WITH ELEMENTS EMPTY
    SET current_depth TO 0

    FOR index FROM 0 TO LENGTH OF paren_string MINUS 1
        SET c TO paren_string AT index

        IF c EQUALS '('
            INCREMENT current_depth BY 1
            APPEND c TO current_string
        ELSE IF c EQUALS ')'
            DECREMENT current_depth BY 1
            APPEND c TO current_string

            IF current_depth EQUALS 0
                SET joined_string TO EMPTY STRING
                FOR j FROM 0 TO LENGTH OF current_string MINUS 1
                    CONCATENATE current_string AT j TO joined_string
                APPEND joined_string TO result
                SET current_string TO LIST WITH ELEMENTS EMPTY

    RETURN result