FUNCTION sort_array WITH PARAMETER arr
    SET sorted_by_value TO CALL sorted WITH ARGUMENT arr
    SET result TO CALL sorted WITH ARGUMENT sorted_by_value AND KEY FUNCTION
        FUNCTION WITH PARAMETER x
            SET binary_representation TO CALL bin WITH ARGUMENT x
            SET binary_string TO SUBSTRING OF binary_representation FROM INDEX 2 TO END
            SET count_ones TO 0
            SET index TO 0
            WHILE index LESS THAN LENGTH OF binary_string
                IF CHARACTER AT binary_string[index] EQUALS '1'
                    INCREMENT count_ones BY 1
                END IF
                INCREMENT index BY 1
            END WHILE
            RETURN count_ones
        END FUNCTION
    RETURN result