FUNCTION anti_shuffle(s)
    SET split_words TO LIST WITH ELEMENTS EMPTY
    SET current_word TO EMPTY STRING
    SET split_words TO LIST WITH ELEMENTS EMPTY
    SET index TO 0
    SET length_s TO LENGTH OF s
    WHILE index LESS THAN length_s
        IF CHARACTER AT s AT index EQUALS SPACE
            APPEND current_word TO split_words
            APPEND SPACE TO split_words
            SET current_word TO EMPTY STRING
        ELSE
            CONCATENATE CHARACTER AT s AT index TO current_word
        INCREMENT index BY 1
    IF current_word NOT EQUAL TO EMPTY STRING
        APPEND current_word TO split_words
    SET result TO EMPTY STRING
    SET i TO 0
    SET length_split TO LENGTH OF split_words
    WHILE i LESS THAN length_split
        IF split_words AT i EQUALS SPACE
            CONCATENATE SPACE TO result
        ELSE
            SET characters_list TO LIST WITH ELEMENTS EMPTY
            SET j TO 0
            SET current_string TO split_words AT i
            SET length_current_string TO LENGTH OF current_string
            WHILE j LESS THAN length_current_string
                APPEND CHARACTER AT current_string AT j TO characters_list
                INCREMENT j BY 1
            SET sorted_list TO LIST WITH ELEMENTS EMPTY
            WHILE LENGTH OF characters_list GREATER THAN 0
                SET min_char TO CHARACTER AT characters_list AT 0
                SET min_index TO 0
                SET k TO 1
                SET length_characters_list TO LENGTH OF characters_list
                WHILE k LESS THAN length_characters_list
                    IF CHARACTER AT characters_list AT k LESS THAN min_char
                        SET min_char TO CHARACTER AT characters_list AT k
                        SET min_index TO k
                    INCREMENT k BY 1
                APPEND min_char TO sorted_list
                REMOVE ELEMENT AT min_index FROM characters_list
            SET sorted_word TO EMPTY STRING
            SET m TO 0
            SET length_sorted_list TO LENGTH OF sorted_list
            WHILE m LESS THAN length_sorted_list
                CONCATENATE ELEMENT AT sorted_list AT m TO sorted_word
                INCREMENT m BY 1
            CONCATENATE sorted_word TO result
        INCREMENT i BY 1
    RETURN result