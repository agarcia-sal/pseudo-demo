FUNCTION valid_date(date)
    TRY
        SET date TO CALL strip ON date
        SET split_date TO CALL split ON date WITH ARGUMENTS DASH
        SET month TO CALL int ON split_date AT INDEX ZERO
        SET day TO CALL int ON split_date AT INDEX ONE
        SET year TO CALL int ON split_date AT INDEX TWO
        IF month LESS THAN 1 OR month GREATER THAN 12 THEN
            RETURN False
        END IF
        SET allowed_months_31 TO LIST WITH ELEMENTS 1,3,5,7,8,10,12
        SET allowed_months_30 TO LIST WITH ELEMENTS 4,6,9,11
        IF (CALL contains ON allowed_months_31 WITH month) AND (day LESS THAN 1 OR day GREATER THAN 31) THEN
            RETURN False
        END IF
        IF (CALL contains ON allowed_months_30 WITH month) AND (day LESS THAN 1 OR day GREATER THAN 30) THEN
            RETURN False
        END IF
        IF month EQUALS 2 AND (day LESS THAN 1 OR day GREATER THAN 29) THEN
            RETURN False
        END IF
    EXCEPT
        RETURN False
    END TRY
    RETURN True
END FUNCTION