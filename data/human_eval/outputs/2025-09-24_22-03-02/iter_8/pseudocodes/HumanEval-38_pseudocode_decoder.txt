FUNCTION encode_cyclic(INPUT s AS STRING) RETURNS STRING
    SET groups TO EMPTY LIST
    FOR i FROM 0 TO INTEGER_DIVIDE(LENGTH OF s PLUS 2, 3) MINUS 1 DO
        SET start_index TO 3 MULTIPLIED BY i
        SET end_index TO MINIMUM OF (3 MULTIPLIED BY i PLUS 3) AND LENGTH OF s
        APPEND SUBSTRING OF s FROM start_index TO end_index TO groups
    END FOR

    SET encoded_groups TO EMPTY LIST
    FOR EACH group IN groups DO
        IF LENGTH OF group IS EQUAL TO 3 THEN
            APPEND CONCATENATION OF SUBSTRING OF group FROM INDEX 1 TO END AND FIRST CHARACTER OF group TO encoded_groups
        ELSE
            APPEND group TO encoded_groups
        END IF
    END FOR

    RETURN CONCATENATION OF ALL STRINGS IN encoded_groups
END FUNCTION


FUNCTION decode_cyclic(INPUT s AS STRING) RETURNS STRING
    RETURN encode_cyclic(encode_cyclic(s))
END FUNCTION