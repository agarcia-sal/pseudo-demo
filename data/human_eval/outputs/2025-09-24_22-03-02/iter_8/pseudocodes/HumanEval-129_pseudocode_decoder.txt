FUNCTION minPath(grid, k)
    SET n TO LENGTH OF grid
    SET val TO n TIMES n PLUS 1

    FOR i FROM 0 TO n MINUS 1
        FOR j FROM 0 TO n MINUS 1
            IF grid AT i AT j EQUALS 1 THEN
                SET temp TO EMPTY LIST

                IF i IS NOT 0 THEN
                    APPEND grid AT (i MINUS 1) AT j TO temp

                IF j IS NOT 0 THEN
                    APPEND grid AT i AT (j MINUS 1) TO temp

                IF i IS NOT (n MINUS 1) THEN
                    APPEND grid AT (i PLUS 1) AT j TO temp

                IF j IS NOT (n MINUS 1) THEN
                    APPEND grid AT i AT (j PLUS 1) TO temp

                SET val TO MINIMUM VALUE IN temp

    SET ans TO EMPTY LIST
    FOR i FROM 0 TO k MINUS 1
        IF i MODULO 2 EQUALS 0 THEN
            APPEND 1 TO ans
        ELSE
            APPEND val TO ans

    RETURN ans