FUNCTION how_many_times WITH PARAMETERS string AS STRING, substring AS STRING RETURNS INTEGER
    SET times TO 0

    FOR i FROM 0 TO LENGTH OF string MINUS LENGTH OF substring INCLUSIVE
        IF SUBSTRING OF string FROM i TO i PLUS LENGTH OF substring EQUALS substring THEN
            SET times TO times PLUS 1
        END IF
    END FOR

    RETURN times
END FUNCTION