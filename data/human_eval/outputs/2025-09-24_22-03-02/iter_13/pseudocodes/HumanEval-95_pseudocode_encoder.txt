FUNCTION check_dict_case(dict)  
    IF LENGTH OF dict KEYS EQUALS 0 THEN  
        RETURN False  
    ELSE  
        SET state TO "start"  
        FOR EACH key IN dict KEYS  
            IF key IS NOT INSTANCE OF string THEN  
                SET state TO "mixed"  
                BREAK  
            END IF  
            IF state EQUALS "start" THEN  
                IF key IS ALL UPPERCASE THEN  
                    SET state TO "upper"  
                ELSE IF key IS ALL LOWERCASE THEN  
                    SET state TO "lower"  
                ELSE  
                    BREAK  
                END IF  
            ELSE IF (state EQUALS "upper" AND key IS NOT ALL UPPERCASE) OR (state EQUALS "lower" AND key IS NOT ALL LOWERCASE) THEN  
                SET state TO "mixed"  
                BREAK  
            ELSE  
                BREAK  
            END IF  
        END FOR  
        RETURN state EQUALS "upper" OR state EQUALS "lower"  
    END IF