FUNCTION minPath(grid, k)
    SET n TO LENGTH OF grid
    SET val TO n MULTIPLY n PLUS 1
    FOR i FROM 0 TO n MINUS 1 INCLUSIVE
        FOR j FROM 0 TO n MINUS 1 INCLUSIVE
            IF ELEMENT AT INDEX i IN grid ELEMENT AT INDEX j EQUALS 1
                SET temp TO EMPTY LIST
                IF i NOT EQUAL TO 0
                    APPEND ELEMENT AT INDEX i MINUS 1 IN grid ELEMENT AT INDEX j TO temp
                IF j NOT EQUAL TO 0
                    APPEND ELEMENT AT INDEX i IN grid ELEMENT AT INDEX j MINUS 1 TO temp
                IF i NOT EQUAL TO n MINUS 1
                    APPEND ELEMENT AT INDEX i PLUS 1 IN grid ELEMENT AT INDEX j TO temp
                IF j NOT EQUAL TO n MINUS 1
                    APPEND ELEMENT AT INDEX i IN grid ELEMENT AT INDEX j PLUS 1 TO temp
                SET val TO MINIMUM OF temp
    SET ans TO EMPTY LIST
    FOR i FROM 0 TO k MINUS 1 INCLUSIVE
        IF i MODULO 2 EQUALS 0
            APPEND 1 TO ans
        ELSE
            APPEND val TO ans
    RETURN ans