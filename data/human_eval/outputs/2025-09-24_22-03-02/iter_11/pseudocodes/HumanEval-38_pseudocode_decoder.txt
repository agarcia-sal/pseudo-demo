FUNCTION encode_cyclic WITH PARAMETER s
    SET groups TO EMPTY LIST
    FOR i FROM ZERO TO (LENGTH OF s PLUS TWO) DIVIDED BY THREE MINUS ONE
        APPEND TO groups THE SUBSTRING OF s FROM INDEX THREE MULTIPLY i TO MINIMUM OF THREE MULTIPLY i PLUS THREE AND LENGTH OF s
    SET groups TO EMPTY LIST
    FOR EACH group IN groups
        IF LENGTH OF group EQUALS THREE
            APPEND TO groups CONCATENATE SUBSTRING OF group FROM INDEX ONE TO END WITH SUBSTRING OF group FROM INDEX ZERO TO ONE
        ELSE
            APPEND group TO groups
    SET result TO EMPTY STRING
    FOR EACH group IN groups
        CONCATENATE result WITH group
    RETURN result

FUNCTION decode_cyclic WITH PARAMETER s
    RETURN CALL encode_cyclic WITH ARGUMENT CALL encode_cyclic WITH ARGUMENT s