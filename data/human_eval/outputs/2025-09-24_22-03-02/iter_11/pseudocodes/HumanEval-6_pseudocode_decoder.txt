FUNCTION parse_nested_parens WITH PARAMETER paren_string
    FUNCTION parse_paren_group WITH PARAMETER s
        SET depth TO 0
        SET max_depth TO 0
        FOR EACH c IN s
            IF c EQUALS OPENING PARENTHESIS
                SET depth TO depth PLUS 1
                SET max_depth TO MAXIMUM OF depth AND max_depth
            ELSE
                SET depth TO depth MINUS 1
        RETURN max_depth
    SET result TO EMPTY LIST
    FOR EACH x IN SPLIT paren_string BY SPACE
        IF x IS NOT EMPTY
            APPEND CALL parse_paren_group WITH x TO result
    RETURN result