FUNCTION check_dict_case dict
    IF LENGTH OF dict KEYS EQUALS 0
        RETURN False
    ELSE
        SET state TO "start"
        FOR key IN dict KEYS
            IF key IS NOT INSTANCE OF STRING
                SET state TO "mixed"
                BREAK
            IF state EQUALS "start"
                IF key IS UPPERCASE
                    SET state TO "upper"
                ELSE IF key IS LOWERCASE
                    SET state TO "lower"
                ELSE
                    BREAK
            ELSE IF (state EQUALS "upper" AND key IS NOT UPPERCASE) OR (state EQUALS "lower" AND key IS NOT LOWERCASE)
                SET state TO "mixed"
                BREAK
            ELSE
                BREAK
        RETURN state EQUALS "upper" OR state EQUALS "lower"