```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    SET total_lowerings TO 0
    FOR each single_well IN grid
        SET units_of_water TO SUM OF single_well
        SET times_to_lower_bucket TO math.ceil(units_of_water DIVIDED BY capacity)
        INCREMENT total_lowerings BY times_to_lower_bucket
    END FOR
    RETURN total_lowerings
END FUNCTION
```