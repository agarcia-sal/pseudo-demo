```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    RETURN SUM OF [math ceiling of (SUM OF each row IN grid DIVIDED BY capacity)]
END FUNCTION
```