FUNCTION fib4(n: INTEGER) RETURNS INTEGER
    INITIALIZE results TO [0, 0, 2, 0]

    IF n < 4 THEN
        RETURN results[n]
    END IF

    FOR i FROM 4 TO n DO
        SET next_value TO results[-1] + results[-2] + results[-3] + results[-4]
        APPEND next_value TO results
        REMOVE first element FROM results
    END FOR

    RETURN results[-1]
END FUNCTION