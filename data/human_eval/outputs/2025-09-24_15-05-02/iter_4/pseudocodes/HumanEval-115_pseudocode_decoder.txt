FUNCTION max_fill(grid, capacity)
    INITIALIZE total_lowerings TO 0

    FOR EACH well IN grid
        CALCULATE water_units AS SUM of elements in well
        CALCULATE lowers_needed AS CEILING of (water_units DIVIDED BY capacity)
        ADD lowers_needed TO total_lowerings
    END FOR

    RETURN total_lowerings
END FUNCTION