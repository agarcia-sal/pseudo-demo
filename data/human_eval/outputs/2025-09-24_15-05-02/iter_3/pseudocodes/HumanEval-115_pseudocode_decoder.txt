FUNCTION max_fill(grid, capacity)
    IMPORT math

    SET total_lowerings TO 0

    FOR each well_row IN grid DO
        SET water_units TO 0

        FOR each unit IN well_row DO
            ADD unit TO water_units
        END FOR

        SET lowers_for_well TO math.ceil(water_units / capacity)
        ADD lowers_for_well TO total_lowerings
    END FOR

    RETURN total_lowerings
END FUNCTION