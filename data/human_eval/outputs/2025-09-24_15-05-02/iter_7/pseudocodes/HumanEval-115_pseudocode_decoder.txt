```
FUNCTION max_fill(grid, capacity)
    SET total_lowerings TO 0
    FOR each well_row IN grid
        SET total_water_units TO SUM OF well_row
        SET lowers_needed TO CEILING OF (total_water_units DIVIDED BY capacity)
        INCREMENT total_lowerings BY lowers_needed
    RETURN total_lowerings
END FUNCTION
```