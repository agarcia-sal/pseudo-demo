FUNCTION parse_nested_parens(paren_string)
    FUNCTION parse_paren_group(s)
        SET depth TO 0
        SET max_depth TO 0
        FOR each character c IN s
            IF c EQUALS '('
                INCREMENT depth BY 1
                SET max_depth TO MAXIMUM OF depth AND max_depth
            ELSE
                DECREMENT depth BY 1
            END IF
        END FOR
        RETURN max_depth
    END FUNCTION

    SET groups TO RESULT OF SPLITTING paren_string BY SPACE CHARACTER
    SET result_list TO EMPTY LIST
    FOR each group IN groups
        IF group IS NOT EMPTY
            SET max_depth_of_group TO parse_paren_group(group)
            APPEND max_depth_of_group TO result_list
        END IF
    END FOR
    RETURN result_list
END FUNCTION