FUNCTION largest_prime_factor(n: INTEGER) RETURNS INTEGER
    FUNCTION is_prime(k: INTEGER) RETURNS BOOLEAN
        IF k < 2 THEN
            RETURN FALSE
        END IF
        FOR i FROM 2 TO k - 1 DO
            IF k MOD i = 0 THEN
                RETURN FALSE
            END IF
        END FOR
        RETURN TRUE
    END FUNCTION

    SET largest TO 1
    FOR j FROM 2 TO n DO
        IF n MOD j = 0 AND is_prime(j) THEN
            SET largest TO MAXIMUM(largest, j)
        END IF
    END FOR
    RETURN largest
END FUNCTION