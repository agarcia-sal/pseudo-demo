```
FUNCTION max_fill(grid, capacity)
    INITIALIZE total_uses TO 0

    FOR EACH well IN grid
        CALCULATE units_of_water AS sum of elements in well
        CALCULATE uses_for_well AS ceiling of (units_of_water divided by capacity)
        INCREMENT total_uses BY uses_for_well
    END FOR

    RETURN total_uses
END FUNCTION
```