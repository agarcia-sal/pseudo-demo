```
FUNCTION max_fill(grid, capacity)
    SET total_lowerings TO 0
    FOR each well IN grid
        SET water_units TO SUM OF elements IN well
        SET lowerings_for_well TO CEILING OF (water_units DIVIDED BY capacity)
        INCREMENT total_lowerings BY lowerings_for_well
    RETURN total_lowerings
END FUNCTION
```