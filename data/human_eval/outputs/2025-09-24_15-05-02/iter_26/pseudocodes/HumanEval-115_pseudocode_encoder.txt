```
FUNCTION max_fill(grid_of_lists_of_zeros_and_ones, capacity)
    RETURN SUM OF CEILING OF (SUM OF units_of_water IN each well_row DIVIDED BY capacity) FOR EACH well_row IN grid_of_lists_of_zeros_and_ones
END FUNCTION
```