```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    SET total_bucket_uses TO 0
    FOR each well_row IN grid
        SET units_of_water TO SUM OF well_row
        SET bucket_uses_for_well TO math CEILING OF (units_of_water DIVIDED BY capacity)
        INCREMENT total_bucket_uses BY bucket_uses_for_well
    END FOR
    RETURN total_bucket_uses
END FUNCTION
```