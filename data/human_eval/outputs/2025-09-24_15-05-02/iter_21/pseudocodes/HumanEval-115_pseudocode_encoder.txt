```
FUNCTION max_fill(grid, capacity)
    SET total_operations TO 0
    FOR each well IN grid
        SET water_units TO SUM OF well
        SET lowers_needed TO CEILING OF (water_units DIVIDED BY capacity)
        INCREMENT total_operations BY lowers_needed
    RETURN total_operations
END FUNCTION
```