CLASS Solution  
    FUNCTION minimizeStringValue(s)  
        IMPORT the functionality to count elements as Counter  
        
        SET letter_count TO the count of each character in s  
        REMOVE the entry for the character question mark from letter_count if it exists  
        
        SET question_marks TO an empty list  
        FOR each position i AND corresponding character char IN s  
            IF char EQUALS question mark THEN  
                APPEND i TO question_marks  
            END IF  
        END FOR  
        
        SET replacement_chars TO an empty list  
        
        FOR each element IN question_marks  
            SET min_count TO positive infinity  
            SET min_char TO nothing  
            FOR each character char IN the sequence of lowercase alphabet letters from a to z  
                IF the count of char in letter_count WITH default zero IS LESS THAN min_count THEN  
                    SET min_count TO the count of char in letter_count WITH default zero  
                    SET min_char TO char  
                END IF  
            END FOR  
            APPEND min_char TO replacement_chars  
            SET the count of min_char in letter_count TO the count of min_char in letter_count WITH default zero PLUS one  
        END FOR  
        
        SORT replacement_chars in ascending lexicographical order  
        
        SET s_list TO the list of characters in s  
        
        FOR each index AND corresponding char IN the pairs formed by question_marks and replacement_chars  
            SET the element at position index of s_list TO char  
        END FOR  
        
        RETURN the string formed by concatenating all elements of s_list  
    END FUNCTION  
END CLASS