CLASS Solution  
    FUNCTION subsequencePairCount(nums)  
        SET MOD TO one billion and seven  
        SET maxNum TO the maximum element of nums  
        SET dp TO two dimensional list of zeros with dimensions maxNum plus one by maxNum plus one  
        SET element at position zero and zero of dp TO one  

        FOR each num IN nums  
            SET newDp TO two dimensional list of zeros with dimensions maxNum plus one by maxNum plus one  
            FOR x FROM zero TO maxNum inclusive  
                FOR y FROM zero TO maxNum inclusive  
                    INCREMENT element at position x and y of newDp BY element at position x and y of dp  
                    SET element at position x and y of newDp TO the remainder of element at position x and y of newDp DIVIDED BY MOD  
                    SET newX TO greatest common divisor of x and num  
                    INCREMENT element at position newX and y of newDp BY element at position x and y of dp  
                    SET element at position newX and y of newDp TO the remainder of element at position newX and y of newDp DIVIDED BY MOD  
                    SET newY TO greatest common divisor of y and num  
                    INCREMENT element at position x and newY of newDp BY element at position x and y of dp  
                    SET element at position x and newY of newDp TO the remainder of element at position x and newY of newDp DIVIDED BY MOD  
                END FOR  
            END FOR  
            ASSIGN dp TO newDp  
        END FOR  

        SET result TO zero  
        FOR g FROM one TO maxNum inclusive  
            INCREMENT result BY element at position g and g of dp  
        END FOR  
        SET result TO the remainder of result DIVIDED BY MOD  
        RETURN result  
    END FUNCTION  
END CLASS