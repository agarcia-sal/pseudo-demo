CLASS Solution  
    FUNCTION gcdValues(nums, queries)  
        SET mx TO the maximum element in nums  
        SET cnt TO a new counter object counting elements in nums  
        SET cnt_g TO a list of zeros with length mx PLUS one  
        FOR i FROM mx DOWN TO one  
            SET v TO zero  
            FOR j FROM i TO mx IN STEPS OF i  
                INCREMENT v BY the count element at position j in cnt  
                DECREMENT element at position i in cnt_g BY the element at position j in cnt_g  
            END FOR  
            INCREMENT element at position i in cnt_g BY v MULTIPLIED BY v MINUS one DIVIDED BY two  
        END FOR  
        SET s TO the accumulation of elements in cnt_g  
        SET result TO an empty list  
        FOR each q IN queries  
            APPEND the position returned by bisect right of s and q TO result  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS