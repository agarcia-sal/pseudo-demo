CLASS Solution  
    FUNCTION countBalancedPermutations(num)  
        SET velunexorai TO num  

        FUNCTION dfs(i, j, a, b)  
            IF i GREATER THAN nine  
                RETURN the logical OR of j AND a AND b EQUALS zero  
            END IF  
            IF a EQUALS zero AND j NOT EQUALS zero  
                RETURN zero  
            END IF  
            SET ans TO zero  
            FOR l FROM zero TO the MINIMUM of the element at position i of cnt AND a  
                SET r TO the element at position i of cnt MINUS l  
                IF r GREATER THAN OR EQUAL TO zero AND r LESS THAN OR EQUAL TO b AND l MULTIPLIED BY i LESS THAN OR EQUAL TO j  
                    SET t TO the combination of a AND l MULTIPLIED BY the combination of b AND r MULTIPLIED BY dfs with parameters i PLUS one AND j MINUS l MULTIPLIED BY i AND a MINUS l AND b MINUS r  
                    SET ans TO ans PLUS t  
                END IF  
            END FOR  
            RETURN ans MODULO mod  
        END FUNCTION  

        SET nums TO the list of integers converted from each character in num  
        SET s TO the sum of nums  
        IF s MODULO two NOT EQUALS zero  
            RETURN zero  
        END IF  
        SET n TO the length of nums  
        SET mod TO ten TO the power of nine PLUS seven  
        SET cnt TO the Counter of nums  
        RETURN dfs with parameters zero AND s DIVIDED BY two AND n DIVIDED BY two AND n PLUS one DIVIDED BY two  
    END FUNCTION  
END CLASS