CLASS Solution  
    FUNCTION countOfPairs(nums)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF nums  
        SET max_val TO the MAXIMUM element IN nums  
        
        INITIALIZE dp AS a three dimensional list of zeroes WITH dimensions n PLUS one BY max_val PLUS one BY max_val PLUS one  
        
        FOR j FROM zero TO the element at position zero of nums  
            SET the element at position one then position j then position (element at position zero of nums MINUS j) of dp TO one  
        END FOR  
        
        FOR i FROM two TO n  
            FOR j FROM zero TO the element at position i MINUS one of nums  
                FOR k FROM zero TO the element at position i MINUS one of nums  
                    IF j PLUS k EQUALS the element at position i MINUS one of nums THEN  
                        FOR prev_j FROM zero TO j  
                            FOR prev_k FROM k TO max_val  
                                SET the element at position i then position j then position k of dp TO the element at position i then position j then position k of dp PLUS the element at position i MINUS one then position prev_j then position prev_k of dp  
                                SET the element at position i then position j then position k of dp TO the remainder of the element at position i then position j then position k of dp DIVIDED BY MOD  
                            END FOR  
                        END FOR  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        SET result TO zero  
        FOR j FROM zero TO max_val  
            FOR k FROM zero TO max_val  
                SET result TO result PLUS the element at position n then position j then position k of dp  
                SET result TO the remainder of result DIVIDED BY MOD  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS