CLASS Solution  
    FUNCTION countSubmatrices(grid, k)  
        IF grid EQUALS no value OR element at position zero of grid EQUALS no value  
            RETURN zero  
        END IF  
        SET m TO the number of elements in grid  
        SET n TO the number of elements in element at position zero of grid  
        SET prefix_sum TO a list with m elements each being a list with n elements each set to zero  
        SET count TO zero  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF i EQUALS zero AND j EQUALS zero  
                    SET element at position j of element at position i of prefix_sum TO element at position j of element at position i of grid  
                ELSE IF i EQUALS zero  
                    SET element at position j of element at position i of prefix_sum TO element at position j MINUS one of element at position i of prefix_sum PLUS element at position j of element at position i of grid  
                ELSE IF j EQUALS zero  
                    SET element at position j of element at position i of prefix_sum TO element at position j of element at position i MINUS one of prefix_sum PLUS element at position j of element at position i of grid  
                ELSE  
                    SET element at position j of element at position i of prefix_sum TO element at position j of element at position i MINUS one of prefix_sum PLUS element at position j MINUS one of element at position i of prefix_sum MINUS element at position j MINUS one of element at position i MINUS one of prefix_sum PLUS element at position j of element at position i of grid  
                END IF  
                IF element at position j of element at position i of prefix_sum LESS THAN OR EQUAL TO k  
                    INCREMENT count BY one  
                END IF  
            END FOR  
        END FOR  
        RETURN count  
    END FUNCTION  
END CLASS