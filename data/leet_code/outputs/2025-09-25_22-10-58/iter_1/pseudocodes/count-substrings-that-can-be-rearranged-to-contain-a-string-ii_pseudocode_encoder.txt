CLASS Solution  
    FUNCTION validSubstringCount(word1, word2)  
        IMPORT the Counter functionality from the collections module  
        
        SET word2_count TO the frequency mapping of each character in word2 using Counter  
        SET window_count TO an empty frequency mapping using Counter  
        SET required TO the number of unique characters in word2_count  
        SET formed TO zero  
        SET left TO zero  
        SET valid_substrings TO zero  
        
        FOR right FROM zero TO the length of word1 MINUS one  
            SET char TO the character at position right of word1  
            INCREMENT the count of char in window_count BY one  
            
            IF char is contained in word2_count AND the count of char in window_count EQUALS the count of char in word2_count THEN  
                INCREMENT formed BY one  
            END IF  
            
            WHILE formed EQUALS required AND the difference of right PLUS one MINUS left IS GREATER THAN OR EQUAL TO the length of word2 DO  
                INCREMENT valid_substrings BY the difference of the length of word1 MINUS right  
                SET char_left TO the character at position left of word1  
                DECREMENT the count of char_left in window_count BY one  
                
                IF char_left is contained in word2_count AND the count of char_left in window_count IS LESS THAN the count of char_left in word2_count THEN  
                    DECREMENT formed BY one  
                END IF  
                
                INCREMENT left BY one  
            END WHILE  
        END FOR  
        
        RETURN valid_substrings  
    END FUNCTION  
END CLASS