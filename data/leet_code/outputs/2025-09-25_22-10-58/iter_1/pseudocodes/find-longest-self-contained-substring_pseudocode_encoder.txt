CLASS Solution  
    FUNCTION maxSubstringLength(s)  
        SET full_count TO the frequency count of each character in the input string s  
        SET max_length TO negative one  
        FOR index i FROM zero TO the length of s MINUS one  
            SET current_count TO an empty frequency count  
            FOR index j FROM i TO the length of s MINUS one  
                INCREMENT the frequency count of the character at position j of s IN current_count BY one  
                SET is_self_contained TO true  
                FOR each character char IN the keys of current_count  
                    IF the frequency count of char in current_count LESS THAN the frequency count of char in full_count  
                        SET is_self_contained TO false  
                        BREAK the inner loop  
                    END IF  
                END FOR  
                IF is_self_contained EQUALS true AND the count of keys in current_count LESS THAN the count of keys in full_count  
                    SET max_length TO the maximum value BETWEEN max_length AND the difference j MINUS i PLUS one  
                END IF  
            END FOR  
        END FOR  
        RETURN max_length  
    END FUNCTION  
END CLASS