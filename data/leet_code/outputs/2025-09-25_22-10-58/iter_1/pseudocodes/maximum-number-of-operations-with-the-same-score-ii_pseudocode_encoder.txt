CLASS Solution  
    FUNCTION maxOperations(nums)  
        FUNCTION dfs(l, r, prev_score, memo)  
            IF l GREATER THAN OR EQUAL TO r  
                RETURN zero  
            END IF  
            IF tuple of l r prev_score EXISTS IN memo  
                RETURN value at tuple of l r prev_score IN memo  
            END IF  
            SET max_ops TO zero  
            IF element at position l of nums PLUS element at position l PLUS one of nums EQUALS prev_score  
                SET max_ops TO maximum of max_ops AND one PLUS dfs of l PLUS two r prev_score memo  
            END IF  
            IF element at position r of nums PLUS element at position r MINUS one of nums EQUALS prev_score  
                SET max_ops TO maximum of max_ops AND one PLUS dfs of l r MINUS two prev_score memo  
            END IF  
            IF element at position l of nums PLUS element at position r of nums EQUALS prev_score  
                SET max_ops TO maximum of max_ops AND one PLUS dfs of l PLUS one r MINUS one prev_score memo  
            END IF  
            SET tuple of l r prev_score IN memo TO max_ops  
            RETURN max_ops  
        END FUNCTION  
        RETURN maximum of  
            one PLUS dfs of two length of nums MINUS one nums at position zero PLUS nums at position one empty dictionary  
            one PLUS dfs of zero length of nums MINUS three nums at position last MINUS one PLUS nums at position last empty dictionary  
            one PLUS dfs of one length of nums MINUS two nums at position zero PLUS nums at position last empty dictionary  
    END FUNCTION  
END CLASS