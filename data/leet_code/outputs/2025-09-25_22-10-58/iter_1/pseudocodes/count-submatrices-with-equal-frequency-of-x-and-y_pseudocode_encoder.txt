CLASS Solution  
    FUNCTION numberOfSubmatrices(grid)  
        IF grid EQUALS empty OR the element at position zero of grid EQUALS empty  
            RETURN zero  
        END IF  
        SET rows TO the LENGTH OF grid  
        SET cols TO the LENGTH OF the element at position zero of grid  
        INITIALIZE prefix_sum TO a two dimensional collection from position zero TO rows PLUS one each containing a list from position zero TO cols PLUS one each containing a list of two zeros  
        FOR i FROM one TO rows  
            FOR j FROM one TO cols  
                SET element at position zero of the element at position j of the element at position i of prefix_sum TO the element at position zero of the element at position j of the element at position i MINUS one of prefix_sum PLUS the element at position zero of the element at position j MINUS one of the element at position i of prefix_sum MINUS the element at position zero of the element at position j MINUS one of the element at position i MINUS one of prefix_sum  
                SET element at position one of the element at position j of the element at position i of prefix_sum TO the element at position one of the element at position j of the element at position i MINUS one of prefix_sum PLUS the element at position one of the element at position j MINUS one of the element at position i of prefix_sum MINUS the element at position one of the element at position j MINUS one of the element at position i MINUS one of prefix_sum  
                IF the element at position i MINUS one of grid EQUALS the element at position j MINUS one of the element at position i MINUS one of grid EQUALS the character X  
                    INCREMENT element at position zero of the element at position j of the element at position i of prefix_sum BY one  
                ELSE IF the element at position i MINUS one of grid EQUALS the element at position j MINUS one of the element at position i MINUS one of grid EQUALS the character Y  
                    INCREMENT element at position one of the element at position j of the element at position i of prefix_sum BY one  
                END IF  
            END FOR  
        END FOR  
        SET count TO zero  
        FOR i FROM one TO rows  
            FOR j FROM one TO cols  
                SET x_count TO element at position zero of the element at position j of the element at position i of prefix_sum  
                SET y_count TO element at position one of the element at position j of the element at position i of prefix_sum  
                IF x_count GREATER THAN zero AND x_count EQUALS y_count  
                    INCREMENT count BY one  
                END IF  
            END FOR  
        END FOR  
        RETURN count  
    END FUNCTION  
END CLASS