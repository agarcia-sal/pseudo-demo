CLASS Solution  
    FUNCTION numberOfStableArrays(zero, one, limit)  
        SET MODULO_VALUE TO ten RAISED TO THE power of nine PLUS one  
        
        FUNCTION dp(zeros_left, ones_left, last_character, last_run_length)  
            IF zeros_left EQUALS zero AND ones_left EQUALS zero THEN  
                RETURN one  
            END IF  
            IF zeros_left LESS THAN zero OR ones_left LESS THAN zero THEN  
                RETURN zero  
            END IF  
            
            SET result_accumulator TO zero  
            
            IF last_character NOT EQUALS zero OR last_run_length LESS THAN limit THEN  
                SET increment_value TO CALL dp WITH  
                    zeros_left MINUS one  
                    ones_left  
                    zero  
                    IF last_character EQUALS zero THEN last_run_length PLUS one ELSE one  
                END IF  
                SET result_accumulator TO result_accumulator PLUS increment_value  
                SET result_accumulator TO result_accumulator MODULO MODULO_VALUE  
            END IF  
            
            IF last_character NOT EQUALS one OR last_run_length LESS THAN limit THEN  
                SET increment_value TO CALL dp WITH  
                    zeros_left  
                    ones_left MINUS one  
                    one  
                    IF last_character EQUALS one THEN last_run_length PLUS one ELSE one  
                END IF  
                SET result_accumulator TO result_accumulator PLUS increment_value  
                SET result_accumulator TO result_accumulator MODULO MODULO_VALUE  
            END IF  
            
            RETURN result_accumulator  
        END FUNCTION  
        
        RETURN CALL dp WITH zero ones_minus one negative one zero  
    END FUNCTION  
END CLASS