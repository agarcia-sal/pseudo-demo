CLASS Solution  
    FUNCTION numberOfSubstrings(s parameter, k parameter)  
        SET cnt TO an empty mapping that counts occurrences of elements  
        SET ans TO zero  
        SET l TO zero  
        FOR each position r AND character c AT position r OF s  
            INCREMENT the count of character c IN cnt BY one  
            WHILE there EXISTS character x IN cnt SUCH THAT the count of x IN cnt IS GREATER THAN OR EQUAL TO k  
                DECREMENT the count of character at position l OF s IN cnt BY one  
                IF the count of character at position l OF s IN cnt EQUALS zero  
                    REMOVE the character at position l OF s FROM cnt  
                END IF  
                INCREMENT l BY one  
            END WHILE  
            INCREMENT ans BY l  
        END FOR  
        RETURN ans  
    END FUNCTION  
END CLASS