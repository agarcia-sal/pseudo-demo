CLASS Solution  
    FUNCTION sumOfGoodSubsequences(nums)  
        SET mod TO one billion PLUS seven  
        ASSIGN reference TO empty map with default zero for f  
        ASSIGN reference TO empty map with default zero for g  
        
        FOR each element x IN nums  
            INCREMENT value at key x in g BY one  
            INCREMENT value at key x in f BY x  
            
            SET value at key x in f TO value at key x in f PLUS value at key x minus one in f PLUS value at key x minus one in g MULTIPLIED BY x  
            SET value at key x in f TO value at key x in f MODULO mod  
            SET value at key x in g TO value at key x in g PLUS value at key x minus one in g  
            SET value at key x in g TO value at key x in g MODULO mod  
            
            SET value at key x in f TO value at key x in f PLUS value at key x plus one in f PLUS value at key x plus one in g MULTIPLIED BY x  
            SET value at key x in f TO value at key x in f MODULO mod  
            SET value at key x in g TO value at key x in g PLUS value at key x plus one in g  
            SET value at key x in g TO value at key x in g MODULO mod  
        END FOR  
        
        SET total_sum TO zero  
        FOR each value v IN all values of f  
            INCREMENT total_sum BY v  
        END FOR  
        
        SET result TO total_sum MODULO mod  
        RETURN result  
    END FUNCTION  
END CLASS