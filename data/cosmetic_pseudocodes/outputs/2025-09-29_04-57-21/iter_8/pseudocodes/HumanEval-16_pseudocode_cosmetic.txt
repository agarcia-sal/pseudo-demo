```
FUNCTION count_distinct_characters(source_text)
  DECLARE unique_chars COLLECTION
  ASSIGN unique_chars TO EMPTY SET
  DECLARE idx TO 0
  WHILE idx < LENGTH(source_text) DO
    DECLARE current_char TO TO_LOWER(source_text[idx])
    IF NOT (current_char IN unique_chars) THEN
      ADD current_char TO unique_chars
    END IF
    INCREMENT idx BY 1
  END WHILE
  RETURN SIZE(unique_chars)
END FUNCTION
```