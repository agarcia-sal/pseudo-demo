```
FUNCTION closest_integer(value)
    IMPORT ceil, floor FROM math

    dotCount := 0
    idx := 0
    WHILE idx < LENGTH(value)
        IF value[idx] == '.'
            dotCount := dotCount + 1
        END IF
        idx := idx + 1
    END WHILE

    IF dotCount == 1 THEN
        LOOP
            IF LENGTH(value) == 0 OR value[LENGTH(value) - 1] != '0' THEN
                BREAK
            END IF
            value := SUBSTRING(value, 0, LENGTH(value) - 1)
        END LOOP
    END IF

    num := CAST_TO_FLOAT(value)

    lastTwo := ""
    IF LENGTH(value) >= 2 THEN
        lastTwo := SUBSTRING(value, LENGTH(value) - 2, 2)
    END IF

    IF lastTwo == ".5" THEN
        IF num > 0 THEN
            RETURN ceil(num)
        ELSE
            RETURN floor(num)
        END IF
    ELSE
        IF LENGTH(value) > 0 THEN
            RETURN ROUND(num)
        ELSE
            RETURN 0
        END IF
    END IF
END FUNCTION
```