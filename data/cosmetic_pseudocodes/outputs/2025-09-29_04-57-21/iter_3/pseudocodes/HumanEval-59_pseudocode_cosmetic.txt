```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        IF k < 2 THEN
            RETURN False
        END IF

        SET divisor TO 2
        WHILE divisor < k DO
            IF (k % divisor) = 0 THEN
                RETURN False
            END IF
            SET divisor TO divisor + 1
        END WHILE

        RETURN True
    END FUNCTION

    SET max_factor TO 1
    FOR candidate IN RANGE(2, n + 1) DO
        IF NOT ((n MOD candidate) <> 0) THEN
            IF is_prime(candidate) THEN
                IF candidate > max_factor THEN
                    SET max_factor TO candidate
                END IF
            END IF
        END IF
    END FOR

    RETURN max_factor
END FUNCTION
```