```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    total_fills ← 0
    FOR each row_element IN grid DO
        row_sum ← 0
        FOR each item IN row_element DO
            row_sum ← row_sum + item
        END FOR
        fill_count ← math.ceil(row_sum / capacity)
        total_fills ← total_fills + fill_count
    END FOR
    RETURN total_fills
END FUNCTION
```