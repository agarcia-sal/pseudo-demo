```
FUNCTION histogram(test_string)
  SET frequency_map TO new empty map
  SET letters_array TO SPLIT test_string BY " "
  SET peak_frequency TO -1

  SET idx TO 0
  WHILE idx < LENGTH(letters_array)
    SET current_char TO letters_array[idx]
    IF current_char != "" THEN
      SET count_occurrences TO 0
      SET jdx TO 0
      WHILE jdx < LENGTH(letters_array)
        IF letters_array[jdx] == current_char
          SET count_occurrences TO count_occurrences + 1
        SET jdx TO jdx + 1
      END WHILE
      IF count_occurrences > peak_frequency
        SET peak_frequency TO count_occurrences
      END IF
    END IF
    SET idx TO idx + 1
  END WHILE

  IF peak_frequency <= 0 THEN
    RETURN frequency_map
  END IF

  SET pos TO 0
  WHILE pos < LENGTH(letters_array)
    SET symbol TO letters_array[pos]
    IF symbol != "" THEN
      SET total_count TO 0
      SET counter TO 0
      WHILE counter < LENGTH(letters_array)
        IF letters_array[counter] == symbol THEN
          SET total_count TO total_count + 1
        END IF
        SET counter TO counter + 1
      END WHILE
      IF total_count == peak_frequency
        IF NOT frequency_map CONTAINS KEY symbol THEN
          SET frequency_map[symbol] TO peak_frequency
        END IF
      END IF
    END IF
    SET pos TO pos + 1
  END WHILE

  RETURN frequency_map
END FUNCTION
```