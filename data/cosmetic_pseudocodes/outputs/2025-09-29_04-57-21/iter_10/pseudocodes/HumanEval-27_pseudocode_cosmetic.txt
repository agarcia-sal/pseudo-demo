```
FUNCTION flip_case(input_string)
    SET result_string TO EMPTY_STRING
    SET position TO 0

    WHILE position < LENGTH(input_string)
        SET current_char TO CHARACTER_AT(input_string, position)
        
        IF current_char IS LOWERCASE
            APPEND TO result_string THE UPPERCASE OF current_char
        ELSE IF current_char IS UPPERCASE
            APPEND TO result_string THE LOWERCASE OF current_char
        ELSE
            APPEND TO result_string current_char
        END IF
        
        SET position TO position + 1
    END WHILE

    RETURN result_string
END FUNCTION
```