```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    total_count <- 0
    index <- 0
    WHILE index < LENGTH(grid)
        current_row <- grid[index]
        row_total <- 0
        position <- 0
        WHILE position < LENGTH(current_row)
            row_total <- row_total + current_row[position]
            position <- position + 1
        END WHILE
        total_count <- total_count + math.ceil(row_total / capacity)
        index <- index + 1
    END WHILE
    RETURN total_count
END FUNCTION
```