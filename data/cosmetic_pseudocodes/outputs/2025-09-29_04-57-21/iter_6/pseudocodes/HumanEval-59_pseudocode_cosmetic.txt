```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        IF k <= 1 THEN
            RETURN False
        ENDIF

        SET divisor TO 2
        WHILE divisor < k DO
            IF (k % divisor) == 0 THEN
                RETURN False
            ENDIF
            SET divisor TO divisor + 1
        ENDWHILE

        RETURN True
    END FUNCTION

    SET max_prime TO 1
    SET candidate TO 2
    WHILE candidate <= n DO
        IF (n % candidate == 0) THEN
            IF is_prime(candidate) THEN
                IF candidate > max_prime THEN
                    SET max_prime TO candidate
                ENDIF
            ENDIF
        ENDIF
        SET candidate TO candidate + 1
    ENDWHILE

    RETURN max_prime
END FUNCTION
```