```
FUNCTION histogram(test_string)
    INITIALIZE freq_map AS empty dictionary
    SPLIT test_string BY " " INTO tokens_list
    INITIALIZE highest_frequency TO 0

    DEFINE FUNCTION update_maximum(index)
        IF index EQUALS LENGTH OF tokens_list THEN RETURN
        LET element = tokens_list[index]
        LET element_count = COUNT occurrences OF element IN tokens_list
        IF element_count > highest_frequency AND element != ""
            highest_frequency = element_count
        CALL update_maximum(index + 1)
    END FUNCTION

    CALL update_maximum(0)

    IF highest_frequency <= 0 THEN RETURN freq_map

    DEFINE FUNCTION assign_frequency(index)
        IF index EQUALS LENGTH OF tokens_list THEN RETURN
        LET current_item = tokens_list[index]
        IF COUNT occurrences OF current_item IN tokens_list = highest_frequency
            freq_map[current_item] = highest_frequency
        assign_frequency(index + 1)
    END FUNCTION

    assign_frequency(0)

    RETURN freq_map
END FUNCTION
```