```
FUNCTION closest_integer(value)
    IMPORT floor, ceil FROM math

    IF (value CONTAINS '.') AND (COUNT OF '.' IN value EQUALS 1)
        REPEAT
            LET tail_char BE LAST CHARACTER OF value
            IF tail_char IS NOT '0' THEN BREAK
            SET value TO SUBSTRING OF value FROM START TO LENGTH(value)-1
        UNTIL FALSE
    END IF

    LET decimal_num BE CONVERT TO FLOAT(value)

    IF (LENGTH(value) >= 2) AND (SUBSTRING(value, LENGTH(value)-1, 2) EQUALS '.5')
        IF decimal_num > 0
            RETURN ceil(decimal_num)
        ELSE
            RETURN floor(decimal_num)
    ELSE IF LENGTH(value) > 0
        RETURN ROUND(decimal_num)
    ELSE
        RETURN 0
END FUNCTION
```