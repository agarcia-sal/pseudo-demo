```
FUNCTION flip_case(input_string)
    DEFINE FUNCTION toggle_case_rec(chars_list, position)
        IF position EQUALS LENGTH(chars_list) THEN
            RETURN EMPTY_STRING
        END IF

        LET current_char = chars_list[position]

        IF current_char IS UPPERCASE THEN
            LET toggled_char = TO_LOWERCASE(current_char)
        ELSE IF current_char IS LOWERCASE THEN
            LET toggled_char = TO_UPPERCASE(current_char)
        ELSE
            LET toggled_char = current_char
        END IF

        RETURN toggled_char CONCAT toggle_case_rec(chars_list, position + 1)
    END FUNCTION

    LET characters_array = TO_LIST(input_string)
    RETURN toggle_case_rec(characters_array, 0)
END FUNCTION
```