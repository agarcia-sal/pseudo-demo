```
FUNCTION vowels_count(string_input)
  SET vowel_chars TO "AEIOUaeiou"
  SET tally TO 0

  DEFINE FUNCTION count_vowels_at(index)
    IF index IS EQUAL TO LENGTH(string_input)
      RETURN 0
    END IF

    SET current_char TO string_input[index]
    SET increment TO 0
    IF current_char IN vowel_chars
      SET increment TO 1
    END IF

    RETURN increment + count_vowels_at(index + 1)
  END FUNCTION

  SET tally TO count_vowels_at(0)

  IF string_input[LENGTH(string_input) - 1] EQUALS 'Y' OR string_input[LENGTH(string_input) - 1] EQUALS 'y'
    SET tally TO tally + 1
  END IF

  RETURN tally
END FUNCTION
```