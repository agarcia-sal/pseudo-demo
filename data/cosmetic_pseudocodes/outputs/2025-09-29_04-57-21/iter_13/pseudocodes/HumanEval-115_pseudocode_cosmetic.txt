```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    FUNCTION helper(row_collection, cap, accumulator)
        IF row_collection IS EMPTY THEN
            RETURN accumulator
        END IF

        LET current_row = FIRST ELEMENT OF row_collection
        LET total_cells = 0
        FOR EACH unit IN current_row DO
            total_cells = total_cells + unit
        END FOR

        LET increment = math ceiling(total_cells / cap)
        RETURN helper(REST OF row_collection, cap, accumulator + increment)
    END FUNCTION

    RETURN helper(grid, capacity, 0)
END FUNCTION
```