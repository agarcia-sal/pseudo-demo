```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        IF k < 2 THEN RETURN False

        FUNCTION check_divisor(current)
            IF current = k THEN RETURN True
            IF k MOD current = 0 THEN RETURN False
            RETURN check_divisor(current + 1)
        END FUNCTION

        RETURN check_divisor(2)
    END FUNCTION

    SET max_factor TO 1

    FUNCTION find_largest_factor(candidate)
        IF candidate > n THEN RETURN max_factor

        IF n MOD candidate = 0 THEN
            IF is_prime(candidate) THEN
                IF candidate > max_factor THEN
                    SET max_factor = candidate
                END IF
            END IF
        END IF

        RETURN find_largest_factor(candidate + 1)
    END FUNCTION

    RETURN find_largest_factor(2)
END FUNCTION
```