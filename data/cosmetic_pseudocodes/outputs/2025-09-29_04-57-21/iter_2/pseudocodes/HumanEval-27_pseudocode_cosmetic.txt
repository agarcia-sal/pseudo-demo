```
FUNCTION flip_case(text)
  SET result TO EMPTY_STRING
  SET index TO 0
  WHILE index < LENGTH(text)
    SET character TO text[index]
    IF character >= 'a' AND character <= 'z' THEN
      SET result TO result + (character - 32)
    ELSE IF character >= 'A' AND character <= 'Z' THEN
      SET result TO result + (character + 32)
    ELSE
      SET result TO result + character
    END IF
    SET index TO index + 1
  END WHILE
  RETURN result
END FUNCTION
```