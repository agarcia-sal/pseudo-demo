```
FUNCTION closest_integer(input_str)
  IMPORT floor, ceil FROM math

  IF input_str CONTAINS '.' EXACTLY ONCE THEN
    REPEAT
      LET last_char = input_str[-1]
      IF last_char IS NOT '0' THEN BREAK
      SET input_str TO input_str[0 : LENGTH(input_str) - 1]
    UNTIL FALSE
  END IF

  LET numeric_val = FLOAT(input_str)

  SELECT
    WHEN input_str ENDS WITH '.5'
      IF numeric_val > 0 THEN
        RETURN ceil(numeric_val)
      ELSE
        RETURN floor(numeric_val)
      END IF
    WHEN LENGTH(input_str) > 0
      RETURN ROUND(numeric_val)
    OTHERWISE
      RETURN 0
  END SELECT
END FUNCTION
```