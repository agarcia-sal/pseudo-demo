```
FUNCTION largest_prime_factor(n)
  FUNCTION is_prime(k)
    IF NOT (k >= 2)
      RETURN False

    SET candidate TO 2
    WHILE candidate < k
      IF (0 = (k MOD candidate))
        RETURN False
      candidate = candidate + 1
    END WHILE
    
    RETURN True
  END FUNCTION

  SET record TO 1
  SET current_divisor TO 2
  WHILE current_divisor <= n
    IF (NOT ((n MOD current_divisor) != 0)) 
       AND (is_prime(current_divisor) = True)
      IF record < current_divisor
        record = current_divisor
      END IF
    END IF
    current_divisor = current_divisor + 1
  END WHILE

  RETURN record
END FUNCTION
```