```
FUNCTION encode(message)
  DEFINE vowelsStr = "aeiouAEIOU"
  CREATE shiftMap = EMPTY DICTIONARY
  INDEX counter = 0
  WHILE counter < LENGTH(vowelsStr)
    CHARACTER originalChar = vowelsStr[counter]
    CHARACTER shiftedChar = CHAR(ASCII(originalChar) + 2)
    ASSIGN shiftMap[originalChar] = shiftedChar
    INCREMENT counter
  END WHILE

  FUNCTION swapCase(inputStr)
    VARIABLE result = EMPTY STRING
    VARIABLE pos = 0
    LOOP UNTIL pos == LENGTH(inputStr)
      CHARACTER currentChar = inputStr[pos]
      IF currentChar == TOUPPER(currentChar)
        result = result + TOLOWER(currentChar)
      ELSE
        result = result + TOUPPER(currentChar)
      END IF
      INCREMENT pos
    END LOOP
    RETURN result
  END FUNCTION

  VARIABLE flippedMessage = swapCase(message)
  VARIABLE output = EMPTY STRING
  VARIABLE idx = 0
  FOR EACH ch IN flippedMessage
    IF ch IN shiftMap
      output = output + shiftMap[ch]
    ELSE
      output = output + ch
    END IF
    idx = idx + 1
  END FOR
  RETURN output
END FUNCTION
```