```
FUNCTION vowels_count(string_input)
  LET vowel_chars BE "AEIOUaeiou"
  LET count_vowels BE 0
  LET position BE 0

  WHILE position < LENGTH(string_input)
    LET current_char BE string_input[position]
    IF vowel_chars CONTAINS current_char
      count_vowels = count_vowels + 1
    END IF
    position = position + 1
  END WHILE

  LET last_index BE LENGTH(string_input) - 1
  IF last_index >= 0 AND NOT (string_input[last_index] != 'y' AND string_input[last_index] != 'Y')
    count_vowels = count_vowels + 1
  END IF

  RETURN count_vowels
END FUNCTION
```