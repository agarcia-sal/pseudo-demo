```
FUNCTION separate_paren_groups(string_of_parentheses)
    SET collected_substrings TO []
    SET temp_chars TO []
    SET depth_counter TO 0

    SET pos TO 0
    WHILE pos < LENGTH(string_of_parentheses)
        SET curr_char TO string_of_parentheses[pos]

        IF curr_char = '(' THEN
            SET depth_counter TO depth_counter + 1
            APPEND curr_char TO temp_chars
        ELSE IF curr_char = ')' THEN
            SET depth_counter TO depth_counter - 1
            APPEND curr_char TO temp_chars

            IF depth_counter = 0 THEN
                APPEND CONCATENATE(temp_chars) TO collected_substrings
                SET temp_chars TO []
            END IF
        END IF

        SET pos TO pos + 1
    END WHILE

    RETURN collected_substrings
END FUNCTION
```