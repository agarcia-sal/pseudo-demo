```
FUNCTION closest_integer(value)
    IMPORT floor, ceil FROM math

    SET decimalOccurrences TO 0
    FOR char IN value
        IF char == '.'
            SET decimalOccurrences TO decimalOccurrences + 1
        END IF
    END FOR

    IF decimalOccurrences == 1 THEN
        SET trimmedValue TO value
        WHILE LENGTH(trimmedValue) > 0 AND trimmedValue[LAST_INDEX(trimmedValue)] == '0'
            SET trimmedValue TO SUBSTRING(trimmedValue, 0, LENGTH(trimmedValue) - 1)
        END WHILE
        SET value TO trimmedValue
    END IF

    SET numericValue TO CAST(value AS FLOAT)

    IF LENGTH(value) >= 2 THEN
        SET tailChars TO SUBSTRING(value, LENGTH(value) - 2, 2)
    ELSE
        SET tailChars TO ""
    END IF

    IF tailChars == ".5" THEN
        IF numericValue > 0 THEN
            SET roundedResult TO ceil(numericValue)
        ELSE
            SET roundedResult TO floor(numericValue)
        END IF
    ELSE IF LENGTH(value) > 0 THEN
        SET roundedResult TO ROUND(numericValue)
    ELSE
        SET roundedResult TO 0
    END IF

    RETURN roundedResult
END FUNCTION
```