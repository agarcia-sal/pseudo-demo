```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    total_fill = 0
    FOR EACH row_data IN grid
        row_sum = 0
        idx = 0
        WHILE idx < LENGTH(row_data)
            row_sum = row_sum + row_data[idx]
            idx = idx + 1
        END WHILE
        fill_units = math.ceiling(row_sum / capacity)
        total_fill = total_fill + fill_units
    END FOR
    RETURN total_fill
END FUNCTION
```