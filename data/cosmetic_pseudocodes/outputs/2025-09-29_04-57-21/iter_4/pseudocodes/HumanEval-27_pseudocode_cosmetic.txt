```
FUNCTION flip_case(input_string)
    DECLARE output_chars AS EMPTY LIST
    DECLARE pos AS INTEGER
    SET pos = 0
    WHILE pos < LENGTH(input_string)
        DECLARE current_char AS CHARACTER
        SET current_char = input_string[pos]
        IF current_char IS LOWERCASE LETTER THEN
            APPEND TO output_chars THE UPPERCASE OF current_char
        ELSE IF current_char IS UPPERCASE LETTER THEN
            APPEND TO output_chars THE LOWERCASE OF current_char
        ELSE
            APPEND TO output_chars current_char
        END IF
        pos = pos + 1
    END WHILE
    RETURN CONCATENATE ALL ELEMENTS OF output_chars INTO STRING
END FUNCTION
```