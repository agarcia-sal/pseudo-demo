```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        IF NOT (k >= 2)
            RETURN False
        SET candidate TO 2
        WHILE candidate < k
            IF (0 = k MOD candidate)
                RETURN False
            SET candidate TO candidate + 1
        RETURN True
    END FUNCTION

    SET max_prime TO 1
    SET divisor TO 2
    WHILE divisor <= n
        IF (0 = n MOD divisor) AND is_prime(divisor)
            IF max_prime < divisor
                SET max_prime TO divisor
        SET divisor TO divisor + 1
    RETURN max_prime
END FUNCTION
```