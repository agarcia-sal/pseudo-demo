```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    LET total_rows_find = 0
    LET running_sum = 0

    DEFINE helper(row_list, index)
        IF NOT (index < LENGTH(row_list)) THEN
            RETURN 0
        ENDIF
        LET current_row = row_list[index]
        LET row_sum = 0
        FOR element IN current_row DO
            SET row_sum = row_sum + element
        ENDFOR
        LET partial = math.ceil(row_sum / capacity)
        RETURN partial + helper(row_list, index + 1)
    ENDDEFINE

    LET total_rows_find = helper(grid, 0)
    RETURN total_rows_find
END FUNCTION
```