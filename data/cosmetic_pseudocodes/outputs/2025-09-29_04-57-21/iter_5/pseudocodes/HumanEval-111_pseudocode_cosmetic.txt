```
FUNCTION histogram(test_string)
    DECLARE tally_map AS empty dictionary
    DECLARE tokens AS list obtained by splitting test_string at spaces
    DECLARE peak_frequency AS -1

    PROCEDURE scan_for_peak(index)
        IF index >= LENGTH(tokens) THEN RETURN
        DECLARE current_token = tokens[index]
        DECLARE current_count = 0

        FOR element IN tokens DO
            IF NOT (element == "") AND element == current_token THEN
                current_count = current_count + 1
            END IF
        END FOR

        IF current_count > peak_frequency THEN
            peak_frequency = current_count
        END IF

        scan_for_peak(index + 1)
    END PROCEDURE

    scan_for_peak(0)

    IF peak_frequency > 0 THEN
        DECLARE position = 0
        WHILE position < LENGTH(tokens) DO
            DECLARE candidate = tokens[position]
            DECLARE candidate_count = 0

            FOR element IN tokens DO
                IF (element != "") AND (candidate == element) THEN
                    candidate_count = candidate_count + 1
                END IF
            END FOR

            IF candidate_count == peak_frequency THEN
                tally_map[candidate] = peak_frequency
            END IF

            position = position + 1
        END WHILE
    END IF

    RETURN tally_map
END FUNCTION
```