```
FUNCTION histogram(test_string)
  DECLARE freq_map AS empty dictionary
  DECLARE letters_list AS SPLIT test_string BY " "
  DECLARE top_count AS 0
  DECLARE idx AS 0

  WHILE idx < LENGTH(letters_list)
    DECLARE current_char AS letters_list[idx]
    DECLARE count_current AS 0
    DECLARE inner_idx AS 0

    IF current_char == ""
      SET idx TO idx + 1
      CONTINUE
    END IF

    WHILE inner_idx < LENGTH(letters_list)
      IF letters_list[inner_idx] == current_char
        SET count_current TO count_current + 1
      END IF
      SET inner_idx TO inner_idx + 1
    END WHILE

    IF NOT (count_current <= top_count)
      SET top_count TO count_current
    END IF
    SET idx TO idx + 1
  END WHILE

  IF top_count > 0
    DECLARE pos AS 0
    WHILE pos < LENGTH(letters_list)
      DECLARE letter_candidate AS letters_list[pos]
      DECLARE frequency AS 0
      DECLARE scan AS 0

      WHILE scan < LENGTH(letters_list)
        IF letters_list[scan] == letter_candidate
          SET frequency TO frequency + 1
        END IF
        SET scan TO scan + 1
      END WHILE

      IF frequency == top_count
        freq_map[letter_candidate] = top_count
      END IF
      SET pos TO pos + 1
    END WHILE
  END IF

  RETURN freq_map
END FUNCTION
```