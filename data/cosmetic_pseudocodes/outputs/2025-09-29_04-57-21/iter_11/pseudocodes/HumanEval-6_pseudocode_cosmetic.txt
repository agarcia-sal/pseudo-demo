```
FUNCTION parse_nested_parens(parentheses_string)
    FUNCTION parse_paren_group(group_string)
        SET depth_counter = 0
        SET highest_level = 0
        SET idx = 0
        WHILE idx < LENGTH(group_string)
            LET ch = group_string[idx]
            IF NOT (ch != '(')
                LET depth_counter = depth_counter + 1
                IF depth_counter > highest_level
                    SET highest_level = depth_counter
                END IF
            ELSE
                SET depth_counter = depth_counter - 1
            END IF
            SET idx = idx + 1
        END WHILE
        RETURN highest_level
    END FUNCTION

    LET segments = []
    LET buffer = ""
    LET pos = 0
    WHILE pos <= LENGTH(parentheses_string)
        IF pos == LENGTH(parentheses_string) OR parentheses_string[pos] == ' '
            IF buffer != ""
                APPEND buffer TO segments
                SET buffer = ""
            END IF
        ELSE
            SET buffer = buffer + parentheses_string[pos]
        END IF
        SET pos = pos + 1
    END WHILE

    LET results = []
    LET i = 0
    WHILE i < LENGTH(segments)
        LET segment = segments[i]
        IF segment != ""
            APPEND parse_paren_group(segment) TO results
        END IF
        SET i = i + 1
    END WHILE

    RETURN results
END FUNCTION
```