```
FUNCTION histogram(test_string)
    LET frequency_map BE a new empty map
    LET letters_list BE SPLIT test_string USING " "
    LET top_frequency BE -1
    LET idx BE 0

    WHILE idx < LENGTH OF letters_list
        LET current_letter BE letters_list[idx]
        LET current_count BE 0
        LET inner_idx BE 0

        WHILE inner_idx < LENGTH OF letters_list
            IF letters_list[inner_idx] == current_letter THEN
                current_count = current_count + 1
            END IF
            inner_idx = inner_idx + 1
        END WHILE

        IF current_count > top_frequency AND current_letter != ""
            top_frequency = current_count
        END IF

        idx = idx + 1
    END WHILE

    IF top_frequency <= 0 THEN
        RETURN frequency_map
    END IF

    LET position BE 0
    WHILE position < LENGTH OF letters_list
        LET candidate_letter BE letters_list[position]
        LET tally BE 0

        LET scan_pos BE 0
        WHILE scan_pos < LENGTH OF letters_list
            IF letters_list[scan_pos] == candidate_letter THEN
                tally = tally + 1
            END IF
            scan_pos = scan_pos + 1
        END WHILE

        IF tally == top_frequency THEN
            frequency_map[candidate_letter] = top_frequency
        END IF

        position = position + 1
    END WHILE

    RETURN frequency_map
END FUNCTION
```