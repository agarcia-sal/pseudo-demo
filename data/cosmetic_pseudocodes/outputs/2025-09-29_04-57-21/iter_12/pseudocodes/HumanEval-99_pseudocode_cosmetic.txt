```
FUNCTION closest_integer(value)
    IMPORT floor, ceil FROM math

    VAR dotCount <- 0
    FOR EACH ch IN value DO
        IF ch == '.' THEN
            dotCount <- dotCount + 1
    END FOR

    IF dotCount == 1 THEN
        VAR idx <- LENGTH(value) - 1
        WHILE idx >= 0 AND value[idx] == '0' DO
            value <- SUBSTRING(value, 0, idx)
            idx <- idx - 1
        END WHILE
    END IF

    VAR number <- FLOAT(value)

    SWITCH TRUE DO
        CASE LENGTH(value) == 0:
            RETURN 0
        CASE LENGTH(value) >= 2 AND SUBSTRING(value, LENGTH(value) - 2, LENGTH(value)) == '.5':
            IF number > 0 THEN
                RETURN ceil(number)
            ELSE
                RETURN floor(number)
            END IF
        DEFAULT:
            RETURN ROUND(number)
    END SWITCH
END FUNCTION
```