```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    total_cells = 0
    index = 0
    acc = 0
    WHILE index < LENGTH(grid)
        row_total = 0
        FOR element IN grid[index]
            row_total = row_total + element
        END FOR
        acc = acc + math.ceil(row_total / capacity)
        index = index + 1
    END WHILE
    RETURN acc
END FUNCTION
```