```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    SET total_fill TO 0
    FOR EACH row_element IN grid
        SET row_sum TO 0
        FOR EACH cell_value IN row_element
            row_sum = row_sum + cell_value
        END FOR
        total_fill = total_fill + math.ceil(row_sum / capacity)
    END FOR
    RETURN total_fill
END FUNCTION
```