```
FUNCTION flip_case(input_string) 
    SET converted_chars TO EMPTY LIST
    SET idx TO 0

    WHILE idx < LENGTH(input_string)
        SET current_char TO input_string[idx]
        IF current_char >= 'a' AND current_char <= 'z'
            APPEND TO converted_chars TO UPPERCASE(current_char)
        ELSE IF current_char >= 'A' AND current_char <= 'Z'
            APPEND TO converted_chars TO LOWERCASE(current_char)
        ELSE
            APPEND TO converted_chars TO current_char
        END IF
        SET idx TO idx + 1
    END WHILE

    RETURN CONCATENATE converted_chars INTO STRING
END FUNCTION
```