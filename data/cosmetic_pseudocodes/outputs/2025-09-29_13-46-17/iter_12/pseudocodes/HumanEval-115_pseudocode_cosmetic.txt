```
FUNCTION max_fill(grid, capacity)
 
  λξ𝜃 ← LAMBDA φσσΥ:  
      (φσσΥ + ∼(∼capacity) - ∼1) DIVIDED_BY capacity
              ⊳ ceiling via integer arithmetic without math

  RETURN FOLDLEFT(λ(ω₁,ψ₁) → ω₁ + ξ𝜃(ψ₁), 0, MAP(λρρ: FOLDLEFT(λ(α,β): α + β, 0, ρ), grid))
END FUNCTION
```