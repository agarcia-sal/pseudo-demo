```
FUNCTION separate_paren_groups(string_of_parentheses)
    FUNCTION 洧돆洧돆洧돆톬톥톊톭톝洧도(洧뤑洧뤒, 洧릭洧릯, 洧맃洧맂)
        IF NOT (洧릭洧릯 IS 0) THEN
            IF (洧뤑洧뤒 = ')') THEN
                RETURN [洧뤑洧뤒] + 洧돆洧돆洧돆톬톥톊톭톝洧도(CDR(洧맃洧맂), 洧릭洧릯 - 1, 洧맃洧맂 + [洧뤑洧뤒]])
            ELSE IF (洧뤑洧뤒 = '(') THEN
                RETURN [洧뤑洧뤒] + 洧돆洧돆洧돆톬톥톊톭톝洧도(CDR(洧맃洧맂), 洧릭洧릯 + 1, 洧맃洧맂 + [洧뤑洧뤒]])
            ELSE
                RETURN 洧돆洧돆洧돆톬톥톊톭톝洧도(CDR(洧맃洧맂), 洧릭洧릯, 洧맃洧맂 + [洧뤑洧뤒])
            END IF
        ELSE IF (洧뤑洧뤒 = ')') THEN
            RETURN [(洧맃洧맂 + [洧뤑洧뤒])] + 洧돆洧돆洧돆톬톥톊톭톝洧도(CDR(洧맃洧맂), 0, [])
        ELSE IF (洧뤑洧뤒 IS NOTHING) THEN
            RETURN []
        ELSE
            RETURN 洧돆洧돆洧돆톬톥톊톭톝洧도(CDR(洧맃洧맂), 洧릭洧릯, 洧맃洧맂 + [洧뤑洧뤒])
        END IF
    END FUNCTION

    RETURN 洧돆洧돆洧돆톬톥톊톭톝洧도(HEAD(string_of_parentheses), 0, [])
END FUNCTION
```