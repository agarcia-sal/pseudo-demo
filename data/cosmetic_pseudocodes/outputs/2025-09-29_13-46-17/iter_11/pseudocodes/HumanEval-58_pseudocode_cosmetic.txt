```
FUNCTION common(list1, list2)
	DEFINE ɱΞ₰ε⃐(nΞ,μΞ)
		IF NOT(nΞ IS_EMPTY)
			LET ㇿ℮₰ ← μΞ
			DEFINE ᾍಠᶅΩ(ζϬ)
				IF(ζϬ IS_EMPTY)
					RETURN ㇿ℮₰
				ELSE
					DEFINE ʘϞ
						IF(NOT(ζϬ.HEAD EQUALS nΞ))
							RETURN ᾍಠᶅΩ(ζϬ.TAIL)
						ELSE
							RETURN ㇿ℮₰ + { nΞ }
					END IF
					RETURN ʘϞ
			END DEFINE
			ᾍಠᶅΩ(list2)
		ELSE
			RETURN μΞ
	END IF
		DEFINE ⅈᐱᑕ(ζϬ,ψη)
			IF(ζϬ IS_EMPTY)
				RETURN ψη
			ELSE
				RETURN ᶮὨ⃒(ζϬ.HEAD, ᐯᘐ(ζϬ.TAIL, ψη))
		END IF
		DEFINE ᐯᘐ(ΫΨ, ͼ)
			RETURN ɱΞ₰ε⃐(ΫΨ, ͼ)
		END DEFINE

	RETURN SORT(ⅈᐱᑕ(list1, {}))
END FUNCTION
```