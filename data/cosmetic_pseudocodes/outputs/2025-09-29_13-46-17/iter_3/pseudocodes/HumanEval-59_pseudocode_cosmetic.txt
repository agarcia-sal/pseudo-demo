```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        IF NOT (k >= 2) THEN RETURN False
        RETURN check_divisor(2, k)

        FUNCTION check_divisor(dividend, limit)
            IF dividend = limit THEN RETURN True
            IF (limit MOD dividend) = 0 THEN RETURN False
            RETURN check_divisor(dividend + 1, limit)
        END FUNCTION
    END FUNCTION

    FUNCTION find_largest(divisor, limit, currentMax)
        IF divisor > limit THEN RETURN currentMax
        IF (limit MOD divisor = 0) THEN
            IF is_prime(divisor) THEN
                RETURN find_largest(divisor + 1, limit, 
                    (IF divisor > currentMax THEN divisor ELSE currentMax))
            END IF
        END IF
        RETURN find_largest(divisor + 1, limit, currentMax)
    END FUNCTION

    RETURN find_largest(2, n, 1)
END FUNCTION
```