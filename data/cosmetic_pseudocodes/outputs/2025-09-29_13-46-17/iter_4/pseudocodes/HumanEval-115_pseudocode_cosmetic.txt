```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    DEFINE function accumulate_rows(rows_list, accum_value)
        IF rows_list IS EMPTY THEN
            RETURN accum_value
        ELSE
            LET current_row_sum = 0
            FOR EACH element IN rows_list[0]
                SET current_row_sum = current_row_sum + element
            END FOR
            LET quotient = current_row_sum / capacity
            LET ceiling_val = math.ceiling(quotient)
            RETURN accumulate_rows(rows_list[1:], accum_value + ceiling_val)
        END IF
    END DEFINE
    RETURN accumulate_rows(grid, 0)
END FUNCTION
```