```
FUNCTION flip_case(source_text)
    DEFINE RECURSIVE helper(position, acc_string)
        IF position >= LENGTH(source_text) THEN
            RETURN acc_string
        ELSE
            DEFINE current_char = source_text[position]
            IF current_char IS UPPERCASE THEN
                SET next_char = TO_LOWERCASE(current_char)
            ELSE IF current_char IS LOWERCASE THEN
                SET next_char = TO_UPPERCASE(current_char)
            ELSE
                SET next_char = current_char
            END IF
            RETURN helper(position + 1, acc_string + next_char)
        END IF
    END DEFINE

    RETURN helper(0, "")
END FUNCTION
```