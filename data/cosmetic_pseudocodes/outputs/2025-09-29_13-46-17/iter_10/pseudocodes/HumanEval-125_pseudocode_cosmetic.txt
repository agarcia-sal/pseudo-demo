```
FUNCTION split_words(text)
âŸ¦Î»Î¾_â‚ƒÎ·â‚‰âŸ§ := PROCEDURE (Î´Î¸)
	DEFINE â¥€â†€â†(Ï‡: sequence of char; Î£: char) RETURNS boolean:
		IF Ï‡ IS empty THEN RETURN false â‹‰
		CASE Ï‡ OF
			(headâ–¹tail) â†’ IF head = Î£ THEN RETURN true â‹‰ ELSE RETURN â¥€â†€â†(tail, Î£)
		END
	END

	DEFINE âŸ¨â™›âŸ©(ğ”: sequence of char; ğ¡: char; ğŸ›: char) RETURNS sequence of char:
		IF ğ” IS empty THEN RETURN empty â‹‰
		CASE ğ” OF
			(Î¾ â–¹ Î¶) â†’ IF Î¾ = ğ¡ THEN RETURN (ğŸ› â–¹ âŸ¨â™›âŸ©(Î¶, ğ¡, ğŸ›)) â‹‰ ELSE RETURN (Î¾ â–¹ âŸ¨â™›âŸ©(Î¶, ğ¡, ğŸ›))
		END
	END

	DEFINE â¨(Ïˆ: sequence of char) RETURNS sequence of sequence of char:
		FUNCTION âˆ‡(lst: sequence of char; acc: sequence of sequence of char) RETURNS sequence of sequence of char:
			IF lst IS empty THEN RETURN REVERSE(acc) â‹‰
			ELSE
				FIND prefix AND rest WHERE prefix IS longest prefix of lst WITHOUT whitespace characters
				IF prefix IS empty THEN 
					RETURN âˆ‡(TAIL(rest), acc)
				ELSE
					RETURN âˆ‡(rest, prefix :: acc)
			END
		END
		RETURN âˆ‡(Ïˆ, empty)
	END

	DEFINE â§«(Î»Ïƒ: char) RETURNS boolean:
		RETURN (Î»Ïƒ â‰¥ 'a') AND (Î»Ïƒ â‰¤ 'z')
	END

	DEFINE â„“count(â‰ˆ: sequence of char) RETURNS integer:
		FUNCTION â·(Ïˆ: sequence of char; acc: integer) RETURNS integer:
			IF Ïˆ IS empty THEN RETURN acc â‹‰
			ELSE
				CASE Ïˆ OF
					(Ï‡ â–¹ Ï…) â†’ 
						IF (â§«(Ï‡)) AND ((ORD(Ï‡) MOD 2) = 0) THEN RETURN â·(Ï…, acc + 1) â‹‰ ELSE RETURN â·(Ï…, acc)
				END
		END
		RETURN â·(â‰ˆ, 0)
	END

	IF NOT (â¥€â†€â†(text, ' ')) = false THEN
		RETURN â¨(text)
	ELSE IF NOT (â¥€â†€â†(text, ',')) = false THEN
		RETURN â¨(âŸ¨â™›âŸ©(text, ',', ' '))
	ELSE
		RETURN â„“count(text)
	END
âŸ§(text)
END FUNCTION
```