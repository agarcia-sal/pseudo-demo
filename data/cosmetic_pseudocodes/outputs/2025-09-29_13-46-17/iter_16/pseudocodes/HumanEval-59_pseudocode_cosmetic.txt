```
FUNCTION largest_prime_factor(n)
  FUNCTION is_prime(k)
    FUNCTION β(ω, ξ)
      IF NOT (ω GREATER THAN 1) THEN RETURN FALSE
      FUNCTION µ(τ, ρ, σ)
        IF τ GREATER THAN ρ THEN RETURN TRUE
        IF k MODULO τ EQUALS 0 THEN RETURN FALSE
        RETURN µ(tau_plus_one(τ), ρ, σ)
      END FUNCTION
      RETURN µ(2, k MINUS 1, 0)
    END FUNCTION
    RETURN β(k,0)
  END FUNCTION

  FUNCTION φ(α, υ)
    IF α GREATER THAN n THEN RETURN υ
    IF (n MODULO α EQUALS 0) AND is_prime(alpha) THEN
      RETURN φ(alpha_plus_one(α), MAX(υ, α))
    ELSE
      RETURN φ(alpha_plus_one(α), υ)
  END FUNCTION

  FUNCTION alpha_plus_one(z)
    RETURN z PLUS 1
  END FUNCTION

  RETURN φ(2,1)
END FUNCTION
```