FUNCTION flip_case(input_string)
	PROCEDURE υλξθζλφψφρξσχκπ(ζγθβψ, χλφρπω)
		IF (χλφρπω >= LENGTH(ζγθβψ)) GOTO Ϟφλεμθσ
		BEGIN
			απωχρλφ := ζγθβψ[χλφρπω]
			IF ((απωχρλφ >= 'a') AND (απωχρλφ <= 'z')) THEN υλρφησγδ := CHAR(ORD(απωχρλφ) - 32)
			ELSE IF ((απωχρλφ >= 'A') AND (απωχρλφ <= 'Z')) THEN υλρφησγδ := CHAR(ORD(απωχρλφ) + 32)
			ELSE υλρφησγδ := απωχρλφ
			ζγθβψ_new := ζγθβψ[0:χλφρπω] + υλρφησγδ + ζγθβψ[χλφρπω+1:LENGTH(ζγθβψ)]
			υλξθζλφψφρξσχκπ(ζγθβψ_new, χλφρπω + 1)
		END
	Ϟφλεμθσ:
	RETURN ζγθβψ
	END PROCEDURE

	RETURN υλξθζλφψφρξσχκπ(input_string, 0)
END FUNCTION