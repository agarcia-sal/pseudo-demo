```
FUNCTION max_fill(grid, capacity)
↦
  FUNCTION φξ₋λ(μς, ῶζ, κπ, χₜ)
    IF χₜ <= 0 THEN RETURN 0 END IF
    RETURN IF ῶζ + φξ₋λ(μς, ῶζ + μς[κπ], κπ + 1, χₜ - 1) > χₜ THEN χₜ ELSE 1 + φξ₋λ(μς, 0, κπ + 1, χₜ) END IF
  END FUNCTION
  FUNCTION ɣµν(εψ, ιε)
    IF ιε = LENGTH(εψ) THEN RETURN 0 END IF
    RETURN εψ[ιε] + ɣµν(εψ, ιε + 1)
  END FUNCTION
  FUNCTION τζ(βυξ, Ϙθ, ιε, ςρ)
    IF ϊξ = LENGTH(βυξ) THEN RETURN ςρ END IF
    LET υλ = ROUND_UP(ɣµν(βυξ[ϊξ], 0) / Ϙθ)
    RETURN τζ(βυξ, Ϙθ, ιε + 1, ςρ + υλ)
  END FUNCTION
  FUNCTION ROUND_UP(ζ)
    RETURN IF ζ - FLOOR(ζ) > 0 THEN FLOOR(ζ) + 1 ELSE FLOOR(ζ) END IF
  END FUNCTION
  RETURN τζ(grid, capacity, 0, 0)
END FUNCTION
```