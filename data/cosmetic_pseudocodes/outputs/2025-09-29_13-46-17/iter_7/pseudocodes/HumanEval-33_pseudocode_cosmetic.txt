```
FUNCTION sort_third(ghY9Wq)
	DEFINE R5eFZ ON (LdWx)
		IF LdWx EQUALS EMPTY_QUEUE THEN RETURN EMPTY_QUEUE
		LET NxK9ydz BE DEQUEUE(LdWx)
		LET hxi7VcR BE R5eFZ(LdWx)
		RETURN ENQUEUE(hxi7VcR, NxK9ydz)
	END

	DEFINE vQUtpWf ON (vQqC, i, XsN)
		IF i >= LENGTH(vQqC) THEN RETURN XsN
		LET fLPfMb4 BE vQqC[i]
		LET wMuKz BE (i MOD 3 == 0) ? APPEND(XsN, fLPfMb4) : XsN
		RETURN vQUtpWf(vQqC, i + 1, wMuKz)
	END

	DEFINE Q3VtUw ON (Yn0c)
		IF Yn0c EQUALS EMPTY_LIST THEN RETURN EMPTY_LIST
		LET y2f30Hy BE HEAD(Yn0c)
		LET jD8TyR NO = TAIL(Yn0c)
		LET iR7vzF BE Q3VtUw(jD8TyR)
		IF y2f30Hy <= HEAD(iR7vzF) OR iR7vzF EQUALS EMPTY_LIST
			RETURN CONS(y2f30Hy, iR7vzF)
		ELSE
			RETURN CONS(HEAD(iR7vzF), Q3VtUw(CONS(y2f30Hy, TAIL(iR7vzF))))
		END
	END

	DEFINE uiF7 ON (uPqw, aEMXT, tR8v)
		IF aEMXT >= LENGTH(uPqw) THEN RETURN tR8v
		LET oC9XzN BE uPqw[aEMXT]
		LET r7hAG = (aEMXT MOD 3 == 0) ? tR8v APPENDED WITH oC9XzN : tR8v
		RETURN uiF7(uPqw, aEMXT + 1, r7hAG)
	END

	DEFINE D7h0u3 ON (Zsm, TQf)
		IF TQf >= LENGTH(Zsm) THEN RETURN Zsm
		LET YD1Vc BE TQf MOD 3
		IF NOT (YD1Vc != 0)
			LET mknOsr BE Zsm
			SET mknOsr[TQf] TO HEAD(TAIL(uiF7)
		END
		RETURN D7h0u3(Zsm, TQf + 1)
	END

	LET xRs0p TO COPY(ghY9Wq)
	LET SeZ3wq TO uiF7(xRs0p, 0, [])
	LET B48Zu TO Q3VtUw(SeZ3wq)
	LET V5oXl TO D7h0u3(xRs0p, 0)
	RETURN V5oXl
END FUNCTION
```