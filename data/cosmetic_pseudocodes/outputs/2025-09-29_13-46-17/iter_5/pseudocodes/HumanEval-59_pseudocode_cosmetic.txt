```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        SET _flagZebra TO True
        IF NOT (k >= 2) THEN 
            _flagZebra = False
        ELSE
            SET alphaIndex TO 2
            WHILE (alphaIndex < k) AND _flagZebra DO
                IF (k - (k DIV alphaIndex) * alphaIndex) = 0 THEN
                    _flagZebra = False
                END IF
                SET alphaIndex TO alphaIndex + 1
            END WHILE
        END IF
        RETURN _flagZebra
    END FUNCTION

    SET accumulator_qwerty TO 1
    SET iterator_sith TO 2

    WHILE iterator_sith <= n DO
        IF ((n - (n DIV iterator_sith) * iterator_sith) = 0) THEN
            IF (True = is_prime(iterator_sith)) THEN
                IF (accumulator_qwerty <= iterator_sith) THEN
                    SET accumulator_qwerty TO accumulator_qwerty + (iterator_sith - accumulator_qwerty)
                END IF
            END IF
        END IF
        SET iterator_sith TO iterator_sith + 1
    END WHILE

    RETURN accumulator_qwerty
END FUNCTION
```