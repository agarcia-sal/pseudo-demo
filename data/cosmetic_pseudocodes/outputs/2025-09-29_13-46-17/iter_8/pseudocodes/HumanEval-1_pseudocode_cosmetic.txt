```
FUNCTION separate_paren_groups(string_of_parentheses)
    FUNCTION qzvof(rbptn, hwkcq, nxnfi, atyja)
        IF atyja >= LENGTH(rbptn) THEN
            RETURN hwkcq
        END IF

        IF rbptn[atyja] = '(' THEN
            SET nwmlv = nxnfi + 1
            SET kloex = hwkcq + [rbptn[atyja]]
            RETURN qzvof(rbptn, kloex, nwmlv, atyja + 1)
        ELSE IF rbptn[atyja] = ')' THEN
            SET nwmlv = nxnfi + -1
            SET kloex = hwkcq + [rbptn[atyja]]

            IF nwmlv = 0 THEN
                RETURN [hwkcq + [rbptn[atyja]]] + qzvof(rbptn, [], 0, atyja + 1)
            ELSE
                RETURN qzvof(rbptn, kloex, nwmlv, atyja + 1)
            END IF
        ELSE
            RETURN qzvof(rbptn, hwkcq, nxnfi, atyja + 1)
        END IF
    END FUNCTION

    RETURN qzvof(string_of_parentheses, [], 0, 0)
END FUNCTION
```