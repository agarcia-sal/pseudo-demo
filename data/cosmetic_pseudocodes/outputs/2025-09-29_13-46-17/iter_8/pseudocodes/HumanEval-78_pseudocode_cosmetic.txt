```
FUNCTION hex_key(string_num)
  DEFINE count_accumulator(acc, curr) =
    IF NOT (curr == '2' OR curr == '3' OR curr == '5' OR curr == '7' OR curr == 'B' OR curr == 'D')
      THEN acc
      ELSE acc + 1

  DEFINE recurse_count(seq, pos, acc) =
    IF pos >= LENGTH(seq)
      THEN acc
      ELSE recurse_count(seq, pos + 1, count_accumulator(acc, seq[pos]))

  RETURN recurse_count(string_num, 0, 0)
END FUNCTION
```