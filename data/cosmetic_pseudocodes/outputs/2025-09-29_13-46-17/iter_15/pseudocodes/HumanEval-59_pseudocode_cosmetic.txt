```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
      FUNCTION F(v, C)
        IF NOT (v >= 2)
          RETURN False
        IF C > v - 1
          RETURN True
        IF NOT ((v MOD C) != 0)
          RETURN False
        RETURN F(v, C + 1)
      END FUNCTION
      RETURN F(k, 2)
    END FUNCTION

    FUNCTION G(x, Y, Z)
      IF x > n
        RETURN Z
      IF ((n MOD x) = 0) AND (is_prime(x) = True)
        RETURN G(x + 1, Y, (IF Z > x THEN Z ELSE x))
      ELSE
        RETURN G(x + 1, Y, Z)
    END FUNCTION
    RETURN G(2, 0, 1)
END FUNCTION
```