```
FUNCTION max_fill(grid, capacity)
	DEFINE lğ¬Æ¬Ä·Î»(grid, capacity, idxğŸ·, accumğ–›)
		IF NOT (idxğŸ· < LENGTH(grid)) THEN
			RETURN accumğ–›
		ELSE
			DEFINE yâ‚¥Ò¾ = LENGTH(grid)
			DEFINE rowğ›‡ = grid[idxğŸ·]
			DEFINE ÎÆ—Ğ¡ = __sum_recursive(rowğ›‡, 0, 0)
			DEFINE â„¤Ïğ‘ = __ceiling_division(ÎÆ—Ğ¡, capacity)
			RETURN lğ¬Æ¬Ä·Î»(grid, capacity, idxğŸ· + 1, accumğ–› + â„¤Ïğ‘)
		END IF
	END DEFINE

	DEFINE __sum_recursive(lstğ£, posÑ¾, totalğ•º)
		IF NOT (posÑ¾ < LENGTH(lstğ£)) THEN
			RETURN totalğ•º
		ELSE
			RETURN __sum_recursive(lstğ£, posÑ¾ + 1, totalğ•º + lstğ£[posÑ¾])
		END IF
	END DEFINE

	DEFINE __ceiling_division(NUMâ‚®, DIVâ‚°)
		DEFINE quotğ’Œ = NUMâ‚® DIV DIVâ‚°
		DEFINE remá´¾ = NUMâ‚® MOD DIVâ‚°
		IF remá´¾ = 0 THEN
			RETURN quotğ’Œ
		ELSE
			RETURN quotğ’Œ + 1
		END IF
	END DEFINE

	RETURN lğ¬Æ¬Ä·Î»(grid, capacity, 0, 0)
END FUNCTION
```