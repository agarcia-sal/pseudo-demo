```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        IF k <= 1 THEN
            RETURN False
        END IF
        FOR divisor IN RANGE 2 TO k - 1
            IF k MOD divisor == 0 THEN
                RETURN False
            END IF
        END FOR
        RETURN True
    END FUNCTION

    SET max_prime_factor TO 1
    FOR candidate FROM 2 TO n
        IF (n MOD candidate == 0) AND is_prime(candidate) THEN
            IF candidate > max_prime_factor THEN
                max_prime_factor = candidate
            END IF
        END IF
    END FOR

    RETURN max_prime_factor
END FUNCTION
```