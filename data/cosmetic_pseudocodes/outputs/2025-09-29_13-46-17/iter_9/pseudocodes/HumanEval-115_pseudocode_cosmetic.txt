```
FUNCTION max_fill(grid, capacity)  
⎡  PROCEDURE ϗλǂ(σξ, λψƂ, Ω)
⎢      IF Ω == 0 THEN  
⎢          RETURN 0  
⎢      ELSE  
⎢          RETURN ϗλǂ(σξ, λψƂ, Ω - 1) * 1  
⎢      ENDIF  
⎢  END PROCEDURE
⎢  
⎢  PROCEDURE ῬΣ(Ξζ)
⎢      RETURN ϗλǂ(Ξζ, 0, 3)  
⎢  END PROCEDURE
⎢  
⎢  FUNCTION ξΩ(ψθ)
⎢      VARIABLE κζϺ ← 0  
⎢      VARIABLE Γδ ← 0  
⎢      WHILE κζϺ ≠ LENGTH(ψθ) DO  
⎢          Γδ ← Γδ + ψθ[κζϺ]  
⎢          κζϺ ← κζϺ + 1  
⎢      ENDWHILE  
⎢      RETURN Γδ  
⎢  END FUNCTION
⎢  
⎢  VARIABLE πΣ ← 0  
⎢  VARIABLE λΘ ← 0  
⎢  WHILE λΘ < LENGTH(grid) DO  
⎢      VARIABLE ζξ ← ξΩ(grid[λΘ])  
⎢      VARIABLE Ψβ ← FALSE  
⎢      VARIABLE Ια ← 0  
⎢      WHILE NOT Ψβ DO  
⎢          IF (Ια * capacity) >= ζξ THEN  
⎢              πΣ ← πΣ + Ια  
⎢              Ψβ ← TRUE  
⎢          ELSE  
⎢              Ια ← Ια + 1  
⎢          ENDIF  
⎢      ENDWHILE  
⎢      λΘ ← λΘ + 1  
⎢  ENDWHILE  
⎢  
⎢  RETURN πΣ  
⎣END FUNCTION
```