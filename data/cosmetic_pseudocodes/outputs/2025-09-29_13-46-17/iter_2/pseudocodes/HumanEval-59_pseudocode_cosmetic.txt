```
FUNCTION largest_prime_factor(n)
  FUNCTION is_prime(k)
    IF NOT (k >= 2) THEN RETURN False
    FUNCTION check_divisor(i)
      IF i = k THEN RETURN True
      IF k MOD i = 0 THEN RETURN False
      RETURN check_divisor(i + 1)
    END FUNCTION
    RETURN check_divisor(2)
  END FUNCTION

  largest_factor <- 1
  FUNCTION find_factor(candidate)
    IF candidate > n THEN RETURN largest_factor
    IF (n MOD candidate = 0) AND is_prime(candidate) THEN
      largest_factor <- (CASE WHEN candidate > largest_factor THEN candidate ELSE largest_factor END)
    RETURN find_factor(candidate + 1)
  END FUNCTION

  RETURN find_factor(2)
END FUNCTION
```