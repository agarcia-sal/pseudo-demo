CLASS Solution  
	FUNCTION minValidStrings(words, target)  
		DEFINE alpha AS EMPTY SET  
		SET m TO 1  
		WHILE m <= LENGTH(words) DO  
			SET beta TO words[m]  
			SET x TO 1  
			REPEAT  
				IF x > LENGTH(beta) THEN  
					BREAK  
				END IF  
				SET gamma TO EMPTY STRING  
				SET y TO 1  
				WHILE y <= x DO  
					SET gamma TO CONCAT(gamma, beta[y])  
					SET y TO y + 1  
				END WHILE  
				ADD gamma TO alpha  
				SET x TO x + 1  
			END REPEAT  
			SET m TO m + 1  
		END WHILE  
		SET z TO LENGTH(target)  
		CREATE dp ARRAY OF SIZE (z + 1) FILLED WITH (1.0 / 0.0)  
		SET dp[0] TO 0  
		SET i TO 1  
		REPEAT  
			IF i > z THEN  
				BREAK  
			END IF  
			SET j TO 1  
			WHILE j <= i DO  
				SET delta TO EMPTY STRING  
				FOR k FROM j TO i DO  
					SET delta TO CONCAT(delta, target[k])  
				END FOR  
				IF delta IN alpha THEN  
					SET candidate TO dp[j - 1] + 1  
					IF dp[i] > candidate THEN  
						SET dp[i] TO candidate  
					END IF  
				END IF  
				SET j TO j + 1  
			END WHILE  
			SET i TO i + 1  
		END REPEAT  
		IF dp[z] != (1.0 / 0.0) THEN  
			RETURN dp[z]  
		ELSE  
			RETURN -1  
		END IF  
	END FUNCTION  
END CLASS