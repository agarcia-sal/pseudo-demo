CLASS Solution  
	FUNCTION countBalancedPermutations(num)  
		SET xyrfap VSQDRL TO num  
		
		FUNCTION dfs(pen, qdhj, mzok, lrnw)  
			IF pen GREATER THAN 9 THEN  
				RETURN ((qdhj OR mzok OR lrnw) EQUALS 0)  
			END IF  
			IF mzok EQUALS 0 AND qdhj NOT EQUALS 0 THEN  
				RETURN 0  
			END IF  
			SET xzHlqv DOFJ TO 0  
			SET pvnxqg TO cnt AT pen  
			SET rvtmag TO 0  
			WHILE rvtmag LESS THAN OR EQUAL TO pvnxqg AND rvtmag LESS THAN OR EQUAL TO lrnw AND (pvnxqg MINUS rvtmag) LESS THAN OR EQUAL TO mzok AND (pvnxqg MINUS rvtmag) GREATER THAN OR EQUAL TO 0 AND rvtmag * pen LESS THAN OR EQUAL TO qdhj DO  
				SET rrneafmz TO COMBINATION(mzok, pvnxqg MINUS rvtmag) * COMBINATION(lrnw, rvtmag) * dfs(pen + 1, qdhj - rvtmag * pen, mzok - (pvnxqg - rvtmag), lrnw - rvtmag)  
				SET xzHlqv DOFJ TO xzHlqv DOFJ + rrneafmz  
				SET rvtmag TO rvtmag + 1  
			END WHILE  
			RETURN xzHlqv DOFJ MOD mod  
		END FUNCTION  
		
		SET wqdrxm TO []  
		FOR char IN xyrfap VSQDRL DO  
			SET ozxlhkqp TO INT(char)  
			PUSH ozxlhkqp INTO wqdrxm  
		END FOR  
		
		SET sqdprmla TO 0  
		FOR uqzvmgnc IN wqdrxm DO  
			SET sqdprmla TO sqdprmla + uqzvmgnc  
		END FOR  
		
		IF (sqdprmla MOD 2) NOT EQUALS 0 THEN  
			RETURN 0  
		END IF  
		
		SET qmwobcgs TO LENGTH(wqdrxm)  
		SET mod TO 1000000007  
		SET cnt TO DICTIONARY {}  
		FOR vkzom IN wqdrxm DO  
			IF vkzom IN cnt THEN  
				SET cnt[vkzom] TO cnt[vkzom] + 1  
			ELSE  
				SET cnt[vkzom] TO 1  
			END IF  
		END FOR  
		
		RETURN dfs(0, sqdprmla / 2, qmwobcgs / 2, (qmwobcgs + 1) / 2)  
	END FUNCTION  
END CLASS