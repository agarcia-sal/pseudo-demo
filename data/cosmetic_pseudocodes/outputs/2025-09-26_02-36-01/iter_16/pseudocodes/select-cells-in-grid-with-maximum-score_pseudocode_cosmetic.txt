CLASS Solution  
    FUNCTION maxScore(grid)  
        FUNCTION backtrack(h, ql, gk)  
            IF h = LENGTH(grid) THEN  
                IF max_sum < gk THEN  
                    max_sum = gk  
                END IF  
                RETURN  
            END IF  
            backtrack(h + 1, ql, gk)  
            INDEX = 0  
            WHILE INDEX < LENGTH(grid[h]) DO  
                ITEM = grid[h][INDEX]  
                IF NOT ITEM IN ql THEN  
                    ADD ITEM TO ql  
                    backtrack(h + 1, ql, gk + ITEM)  
                    REMOVE ITEM FROM ql  
                END IF  
                INDEX = INDEX + 1  
            END WHILE  
        END FUNCTION  
        IDX = 0  
        WHILE IDX < LENGTH(grid) DO  
            ROW = grid[IDX]  
            NEW_ROW = []  
            FOR J = 0 TO LENGTH(ROW)-1 DO  
                MAX_ITEM = ROW[0]  
                K = 1  
                WHILE K < LENGTH(ROW) DO  
                    IF ROW[K] > MAX_ITEM THEN  
                        MAX_ITEM = ROW[K]  
                    END IF  
                    K = K + 1  
                END WHILE  
                NEW_ROW = NEW_ROW + [MAX_ITEM]  
                REMOVE MAX_ITEM FROM ROW ONCE  
            END FOR  
            grid[IDX] = NEW_ROW  
            IDX = IDX + 1  
        END WHILE  
        max_sum = 0 + (0 * 0)  
        backtrack(0, {}, 0)  
        RETURN max_sum  
    END FUNCTION  
END CLASS