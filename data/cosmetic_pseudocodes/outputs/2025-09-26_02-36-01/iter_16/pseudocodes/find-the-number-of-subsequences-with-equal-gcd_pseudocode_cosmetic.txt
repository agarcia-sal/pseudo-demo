CLASS Solution 
  FUNCTION subsequencePairCount(nums) 
    LET A To 1000000007
    LET B To 0
    FOR C IN nums
      IF C > B THEN B = C
    END FOR

    FUNCTION gcd(E, F)
      WHILE F ≠ 0
        LET G To F
        LET F To E % F
        LET E To G
      END WHILE
      RETURN E
    END FUNCTION

    LET H TO list of (B+1) lists, each containing (B+1) zeros
    H[0][0] = 1

    FOR I FROM 0 TO LENGTH(nums) - 1
      LET J TO list of (B+1) lists, each containing (B+1) zeros

      LET K TO 0
      WHILE K ≤ B
        LET L TO 0
        WHILE L ≤ B
          J[K][L] = (J[K][L] + H[K][L]) % A

          LET M TO gcd(K, nums[I])
          J[M][L] = (J[M][L] + H[K][L]) % A

          LET N TO gcd(L, nums[I])
          J[K][N] = (J[K][N] + H[K][L]) % A

          L = L + 1
        END WHILE
        K = K + 1
      END WHILE

      H = J
    END FOR

    LET O TO 0
    LET P TO 1
    WHILE P ≤ B
      O = O + H[P][P]
      P = P + 1
    END WHILE

    RETURN O % A
  END FUNCTION
END CLASS