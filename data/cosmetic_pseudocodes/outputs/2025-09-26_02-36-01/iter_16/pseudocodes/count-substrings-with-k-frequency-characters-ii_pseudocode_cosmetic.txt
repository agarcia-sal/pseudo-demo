CLASS Solution
[
    FUNCTION numberOfSubstrings(s parameter, k parameter)
    {
        DEFINE dictCounter AS empty map defaulting to zero
        SET totalSubstrings TO 0
        SET indexStart TO 0
        SET indexEnd TO 0

        WHILE indexEnd < LENGTH(s)
        {
            LET charCurrent BE s[indexEnd]
            SET dictCounter[charCurrent] TO dictCounter[charCurrent] + 1

            LOOP
            {
                LET hasCharExceedingK BE false
                FOR EACH keyChar IN dictCounter KEYS
                {
                    IF dictCounter[keyChar] >= k THEN
                    {
                        SET hasCharExceedingK TO true
                        BREAK
                    }
                }
                IF NOT hasCharExceedingK THEN BREAK

                LET charStart BE s[indexStart]
                SET dictCounter[charStart] TO dictCounter[charStart] - 1

                IF dictCounter[charStart] == 0 THEN
                    DELETE dictCounter[charStart]
                END IF

                SET indexStart TO indexStart + 1
            }

            SET totalSubstrings TO totalSubstrings + indexStart
            SET indexEnd TO indexEnd + 1
        }

        RETURN totalSubstrings
    }
]