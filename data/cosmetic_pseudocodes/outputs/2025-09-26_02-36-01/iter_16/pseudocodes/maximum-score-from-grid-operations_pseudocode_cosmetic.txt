CLASS Solution
  FUNCTION maximumScore(grid)
        SET v1 TO LENGTH OF grid
        SET v2 TO a list of LENGTH v1 PLUS 1, EACH ELEMENT zero
        SET v3 TO a list of LENGTH v1 PLUS 1, EACH ELEMENT zero
        SET v4 TO a matrix of DIMENSIONS v1 BY v1 PLUS 1, FILLED WITH zero

        SET m TO zero
        WHILE m < v1
            SET n TO zero
            WHILE n < v1
                SET tmp1 TO v4[n + 1][m]
                SET tmp2 TO v4[n][m]
                SET tmp3 TO grid[m][n]
                SET v4[n + 1][m] TO tmp1 - tmp2 + tmp3
                SET n TO n + 1
            END WHILE
            SET m TO m + 1
        END WHILE

        SET p TO 1
        REPEAT 
            IF NOT (p < v1) THEN BREAK
            SET a1 TO a list of LENGTH v1 PLUS 1, INITIALIZED TO zero
            SET a2 TO a list of LENGTH v1 PLUS 1, INITIALIZED TO zero

            SET r TO 0
            WHILE r <= v1
                SET s TO 0
                WHILE s <= v1
                    IF r > s THEN
                        SET delta1 TO v4[r][p - 1] - v4[s][p - 1]
                        SET cond1 TO a1[r]
                        SET cond2 TO v3[s]
                        IF cond1 < cond2 + delta1 THEN a1[r] = cond2 + delta1
                        SET cond3 TO a2[r]
                        IF cond3 < cond2 + delta1 THEN a2[r] = cond2 + delta1
                    ELSE
                        SET delta2 TO v4[s][p] - v4[r][p]
                        SET cond4 TO a1[r]
                        SET cond5 TO v2[s]
                        IF cond4 < cond5 + delta2 THEN a1[r] = cond5 + delta2
                        SET cond6 TO a2[r]
                        IF cond6 < cond5 THEN a2[r] = cond5
                    END IF
                    SET s TO s + 1
                END WHILE
                SET r TO r + 1
            END WHILE

            SET v2 TO a1
            SET v3 TO a2
            SET p TO p + 1
        END REPEAT

        SET maxVal TO v2[0]
        SET idx TO 1
        WHILE idx <= v1
            IF maxVal < v2[idx] THEN maxVal = v2[idx]
            SET idx TO idx + 1
        END WHILE
        RETURN maxVal
    END FUNCTION
END CLASS