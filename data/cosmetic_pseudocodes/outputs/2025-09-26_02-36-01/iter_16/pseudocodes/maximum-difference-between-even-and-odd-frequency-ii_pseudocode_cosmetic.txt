CLASS Solution
    FUNCTION maxDifference WITH PARAMETERS s k
        SET xwzfp TO negative infinity
        SET mqvjzr TO EMPTY LIST
        SET frsku TO ["zero", "one", "two", "three", "four"]
        FOR ekuh IN frsku
            FOR gbay IN frsku
                IF ekuh != gbay THEN
                    APPEND (ekuh, gbay) TO mqvjzr
                END IF
            END FOR
        END FOR

        FOR fmxt, baga IN mqvjzr
            SET iczolq TO DEFAULT DICTIONARY WITH DEFAULT infinity
            SET zvya TO LIST WITH ONE ELEMENT 0
            SET nskfw TO LIST WITH ONE ELEMENT 0
            SET ykrcpn TO 0

            FOR zrce, ejldq IN ENUMERATE(s)
                IF ejldq == fmxt THEN
                    SET jtfwpl TO zvya[-1] + 1
                ELSE
                    SET jtfwpl TO 0
                END IF
                APPEND jtfwpl TO zvya

                IF ejldq == baga THEN
                    SET sdvl TO nskfw[-1] + 1
                ELSE
                    SET sdvl TO 0
                END IF
                APPEND sdvl TO nskfw

                WHILE ((zrce - ykrcpn + 1) >= k) AND (zvya[ykrcpn] < zvya[-1]) AND (nskfw[ykrcpn] < nskfw[-1])
                    SET fynluz TO ( (zvya[ykrcpn] MOD 2), (nskfw[ykrcpn] MOD 2) )
                    IF iczolq[fynluz] > (zvya[ykrcpn] - nskfw[ykrcpn]) THEN
                        SET iczolq[fynluz] TO (zvya[ykrcpn] - nskfw[ykrcpn])
                    END IF
                    SET ykrcpn TO ykrcpn + 1
                END WHILE

                SET ikzvnq TO ( (1 - (zvya[-1] MOD 2)), (nskfw[-1] MOD 2) )
                SET gtvsju TO (zvya[-1] - nskfw[-1]) - iczolq[ikzvnq]
                IF gtvsju > xwzfp THEN
                    SET xwzfp TO gtvsju
                END IF
            END FOR
        END FOR

        RETURN xwzfp
    END FUNCTION
END CLASS