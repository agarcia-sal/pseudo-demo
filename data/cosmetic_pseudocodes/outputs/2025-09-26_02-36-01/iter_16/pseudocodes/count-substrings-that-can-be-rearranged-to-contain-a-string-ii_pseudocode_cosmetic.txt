CLASS Solution
    FUNCTION validSubstringCount(word1, word2)
        IMPORT the Counter functionality from the collections module

        SET ziprmxv TO the frequency mapping of each character in word2 using Counter
        SET mfbnsip TO an empty frequency mapping using Counter
        SET ntlovuq TO the number of unique characters in ziprmxv
        SET ykqzas TO zero
        SET pnhodrw TO zero
        SET wltuscb TO zero

        SET ckoal to zero
        WHILE ckoal ≤ (LENGTH(word1) - 1) DO
            SET qzmnre TO word1[ckoal]
            INCREMENT mfbnsip[qzmnre] BY 1

            IF (qzmnre IN ziprmxv) AND (mfbnsip[qzmnre] = ziprmxv[qzmnre]) THEN
                ykqzas ← ykqzas + 1
            END IF

            WHILE (ykqzas = ntlovuq) AND ((ckoal + 1 - pnhodrw) ≥ LENGTH(word2))
                SET hksoz TO LENGTH(word1) - ckoal
                wltuscb ← wltuscb + hksoz

                SET jmure TO word1[pnhodrw]
                DECREMENT mfbnsip[jmure] BY 1

                IF (jmure IN ziprmxv) AND (mfbnsip[jmure] < ziprmxv[jmure]) THEN
                    ykqzas ← ykqzas - 1
                END IF

                pnhodrw ← pnhodrw + 1
            END WHILE

            ckoal ← ckoal + 1
        END WHILE

        RETURN wltuscb
    END FUNCTION
END CLASS