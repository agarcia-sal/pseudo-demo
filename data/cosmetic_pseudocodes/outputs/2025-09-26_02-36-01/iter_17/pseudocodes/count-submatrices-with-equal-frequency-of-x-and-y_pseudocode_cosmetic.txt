CLASS Solution
    FUNCTION numberOfSubmatrices(grid)
        IF NOT (grid LENGTH GREATER THAN 0 AND grid AT 0 LENGTH GREATER THAN 0)
            RETURN 0
        END IF

        SET a TO grid LENGTH
        SET b TO grid AT 0 LENGTH
        INITIALIZE c TO a + 1
        INITIALIZE d TO b + 1
        INITIALIZE e TO ARRAY OF SIZE c FILLED WITH EMPTY ARRAYS
        FOR f FROM 0 TO c - 1
            SET e AT f TO ARRAY OF SIZE d
            FOR g FROM 0 TO d - 1
                SET e AT f AT g TO [0, 0]
            END FOR
        END FOR

        SET h TO 1
        WHILE h <= a
            SET i TO 1
            WHILE i <= b
                SET v0 TO e AT h AT (i - 1) AT 0
                SET v1 TO e AT (h - 1) AT i AT 0
                SET v2 TO e AT (h - 1) AT (i - 1) AT 0
                SET e AT h AT i AT 0 TO v0 + v1 - v2

                SET w0 TO e AT h AT (i - 1) AT 1
                SET w1 TO e AT (h - 1) AT i AT 1
                SET w2 TO e AT (h - 1) AT (i - 1) AT 1
                SET e AT h AT i AT 1 TO w0 + w1 - w2

                SET p TO grid AT (h - 1) AT (i - 1)
                IF p EQUALS 'X'
                    SET e AT h AT i AT 0 TO e AT h AT i AT 0 + 1
                ELSE
                    IF p EQUALS 'Y'
                        SET e AT h AT i AT 1 TO e AT h AT i AT 1 + 1
                    END IF
                END IF
                SET i TO i + 1
            END WHILE
            SET h TO h + 1
        END WHILE

        SET m TO 0
        SET n TO 1
        WHILE n <= a
            SET o TO 1
            WHILE o <= b
                SET s TO e AT n AT o AT 0
                SET t TO e AT n AT o AT 1
                IF s GREATER THAN 0 AND s EQUALS t
                    SET m TO m + 1
                END IF
                SET o TO o + 1
            END WHILE
            SET n TO n + 1
        END WHILE

        RETURN m
    END FUNCTION
END CLASS