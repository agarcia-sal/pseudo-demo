CLASS Solution
    FUNCTION countBalancedPermutations(num)
        SET dupoxtiqka TO num

        FUNCTION dfs(u, v, w, x)
            IF u > 9 THEN
                RETURN (v OR w OR x) == 0
            END IF
            IF w == 0 AND v != 0 THEN
                RETURN 0
            END IF
            SET ygvarob TO 0
            SET riw AS 0
            WHILE riw <= cnt[u] AND riw <= w
                SET ezh TO cnt[u] - riw
                IF ezh >= 0 AND ezh <= x AND riw * u <= v THEN
                    SET tpzo TO comb(w, riw) * comb(x, ezh) * dfs(u + 1, v - riw * u, w - riw, x - ezh)
                    SET ygvarob TO ygvarob + tpzo
                END IF
                SET riw TO riw + 1
            END WHILE
            RETURN ygvarob MOD mod
        END FUNCTION

        FUNCTION comb(a, b)
            IF b == 0 OR b == a THEN
                RETURN 1
            END IF
            SET c1 TO 1
            SET c2 TO 1
            SET idx TO 1
            WHILE idx <= b
                SET c1 TO c1 * (a - idx + 1)
                SET c2 TO c2 * idx
                SET idx TO idx + 1
            END WHILE
            RETURN c1 / c2
        END FUNCTION

        SET kturossi TO []
        FOR celchar IN dupoxtiqka
            SET kturossi APPEND TO INTEGER(celchar)
        END FOR

        SET ghum TO 0
        FOR el IN kturossi
            SET ghum TO ghum + el
        END FOR

        IF (ghum MOD 2) != 0 THEN
            RETURN 0
        END IF

        SET gzak TO LENGTH(kturossi)
        SET mod TO (10 ^ 9) + 7

        SET cnt TO EMPTY MAP
        FOR val IN kturossi
            IF val NOT IN cnt THEN
                SET cnt[val] TO 0
            END IF
            SET cnt[val] TO cnt[val] + 1
        END FOR

        RETURN dfs(0, ghum / 2, gzak / 2, (gzak + 1) / 2)
    END FUNCTION
END CLASS