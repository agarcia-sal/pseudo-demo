CLASS Solution  
    FUNCTION numberOfStableArrays(zero zero, one one, limit limit) RETURNS integer  
        SET M TO 10 * 10 * 10 * 10 * 10 * 10 * 10 * 10 * 10 + 1  
  
        FUNCTION dp(zcount zcount, ocount ocount, lastVal lastVal, streak streak) RETURNS integer  
            IF (zcount = 0) AND (ocount = 0) THEN  
                RETURN one  
            END IF  
  
            IF (zcount < 0) OR (ocount < 0) THEN  
                RETURN zero  
            END IF  
  
            SET accumulator TO 0  
  
            IF lastVal = zero THEN  
                IF streak < limit THEN  
                    accumulator = accumulator + dp(zcount - one, ocount, zero, streak + one)  
                END IF  
                accumulator = accumulator + dp(zcount, ocount - one, one, one)  
            ELSE  
                IF zcount > zero THEN  
                    accumulator = accumulator + dp(zcount - one, ocount, zero, one)  
                END IF  
                IF streak < limit THEN  
                    accumulator = accumulator + dp(zcount, ocount - one, one, streak + one)  
                END IF  
            END IF  
  
            RETURN accumulator MOD M  
        END FUNCTION  
  
        RETURN dp(zero, one - one, zero, zero)  
    END FUNCTION  
END CLASS