CLASS Solution  
    FUNCTION maximumSubarraySum(nums k)  
        DECLARE wiohae AS empty dictionary  
        DECLARE qawmsl AS -999999999999999  
        DECLARE zrxkpv AS 0  
        
        SET i TO 0  
        WHILE i < LENGTH(nums)  
            DECLARE atgpae AS nums[i]  
            
            IF wiohae HAS KEY atgpae - k THEN  
                IF qawmsl < (zrxkpv - wiohae[atgpae - k] + atgpae) THEN  
                    SET qawmsl TO zrxkpv - wiohae[atgpae - k] + atgpae  
                END IF  
            END IF  
            
            IF wiohae HAS KEY atgpae + k THEN  
                IF qawmsl < (zrxkpv - wiohae[atgpae + k] + atgpae) THEN  
                    SET qawmsl TO zrxkpv - wiohae[atgpae + k] + atgpae  
                END IF  
            END IF  
            
            IF wiohae HAS KEY atgpae THEN  
                IF wiohae[atgpae] > zrxkpv THEN  
                    SET wiohae[atgpae] TO zrxkpv  
                END IF  
            ELSE  
                SET wiohae[atgpae] TO zrxkpv  
            END IF  
            
            SET zrxkpv TO zrxkpv + atgpae  
            
            SET i TO i + 1  
        END WHILE  
        
        IF qawmsl != -999999999999999 THEN  
            RETURN qawmsl  
        ELSE  
            RETURN 0  
        END IF  
    END FUNCTION  
END CLASS