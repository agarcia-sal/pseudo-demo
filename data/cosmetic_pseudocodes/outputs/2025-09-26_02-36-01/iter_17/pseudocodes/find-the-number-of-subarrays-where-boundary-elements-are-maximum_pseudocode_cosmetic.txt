CLASS Solution
    FUNCTION numberOfSubarrays(nums)
        ASSIGN mapIndices TO an empty dictionary with default value as a list
        
        ASSIGN posCounter TO 0
        WHILE posCounter < LENGTH(nums)
            IF NOT mapIndices CONTAINS nums[posCounter]
                ASSIGN mapIndices[nums[posCounter]] TO empty list
            END IF
            APPEND posCounter TO mapIndices[nums[posCounter]]
            ASSIGN posCounter TO posCounter + 1
        END WHILE

        ASSIGN totalCount TO 0
        FOR EACH keyVal IN KEYS(mapIndices)
            ASSIGN idxList TO mapIndices[keyVal]
            ASSIGN lenIdx TO LENGTH(idxList)
            
            ASSIGN outerIdx TO 0
            REPEAT
                IF outerIdx >= lenIdx THEN BREAK END IF
                
                ASSIGN innerIdx TO outerIdx
                REPEAT
                    IF innerIdx >= lenIdx THEN BREAK END IF
                    
                    ASSIGN startPos TO idxList[outerIdx]
                    ASSIGN endPos TO idxList[innerIdx]
                    
                    ASSIGN subArray TO EMPTY LIST
                    FOR pos FROM startPos TO endPos
                        APPEND nums[pos] TO subArray
                    END FOR
                    
                    ASSIGN maxVal TO subArray[0]
                    ASSIGN subIdx TO 1
                    WHILE subIdx < LENGTH(subArray)
                        IF subArray[subIdx] > maxVal THEN
                            ASSIGN maxVal TO subArray[subIdx]
                        END IF
                        ASSIGN subIdx TO subIdx + 1
                    END WHILE
                    
                    IF maxVal = nums[startPos] THEN
                        ASSIGN totalCount TO totalCount + 1
                    END IF
                    
                    ASSIGN innerIdx TO innerIdx + 1
                UNTIL FALSE
                
                ASSIGN outerIdx TO outerIdx + 1
            UNTIL FALSE
        END FOR

        RETURN totalCount
    END FUNCTION
END CLASS