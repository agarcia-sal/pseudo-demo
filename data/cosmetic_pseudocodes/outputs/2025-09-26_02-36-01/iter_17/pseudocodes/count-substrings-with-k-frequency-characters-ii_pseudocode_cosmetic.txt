CLASS Solution  
    FUNCTION numberOfSubstrings(s parameter, k parameter)  
        INITIALIZE freqMap AS empty mapping  
        INITIALIZE result AS 0  
        INITIALIZE startIdx AS 0  
        SET currentIdx TO 0  
        WHILE currentIdx LESS THAN LENGTH OF s  
            SET currentChar TO CHARACTER AT INDEX currentIdx OF s  
            IF currentChar NOT IN freqMap THEN  
                ASSIGN freqMap[currentChar] TO 0  
            END IF  
            ASSIGN freqMap[currentChar] TO freqMap[currentChar] + 1  
            SET conditionMet TO FALSE  
            FOR EACH keyChar IN KEYS OF freqMap DO  
                IF freqMap[keyChar] GREATER THAN OR EQUAL TO k THEN  
                    ASSIGN conditionMet TO TRUE  
                    BREAK  
                END IF  
            END FOR  
            WHILE conditionMet IS TRUE  
                SET removeChar TO CHARACTER AT INDEX startIdx OF s  
                ASSIGN freqMap[removeChar] TO freqMap[removeChar] - 1  
                IF freqMap[removeChar] EQUALS 0 THEN  
                    DELETE freqMap[removeChar]  
                END IF  
                ASSIGN startIdx TO startIdx + 1  
                SET conditionMet TO FALSE  
                FOR EACH keyChar IN KEYS OF freqMap DO  
                    IF freqMap[keyChar] GREATER THAN OR EQUAL TO k THEN  
                        ASSIGN conditionMet TO TRUE  
                        BREAK  
                    END IF  
                END FOR  
            END WHILE  
            ASSIGN result TO result + startIdx  
            ASSIGN currentIdx TO currentIdx + 1  
        END WHILE  
        RETURN result  
    END FUNCTION  
END CLASS