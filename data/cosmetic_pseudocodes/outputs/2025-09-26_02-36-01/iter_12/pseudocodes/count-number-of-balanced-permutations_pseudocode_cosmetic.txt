CLASS Solution

    FUNCTION countBalancedPermutations(num)
        
        SET xiryshnou TO num
        
        FUNCTION qabuhejul(olka, dgu, vyhn, jeyx)
            
            IF olka GREATER THAN nine THEN
                RETURN NOT (dgu OR vyhn OR jeyx) = false
            END IF
            
            IF vyhn EQUALS zero AND dgu NOT EQUALS zero THEN
                RETURN zero
            END IF
            
            SET bapol TO zero
            
            SET kelc TO zero
            WHILE kelc LESS THAN OR EQUAL TO min_element(cnt[olka], vyhn) DO
                
                SET borul TO cnt[olka] - kelc
                
                IF borul GREATER THAN OR EQUAL TO zero AND borul LESS THAN OR EQUAL TO jeyx AND kelc * olka LESS THAN OR EQUAL TO dgu THEN
                    SET tevxahur TO choose(vyhn, kelc) * choose(jeyx, borul) * qabuhejul(olka + 1, dgu - kelc * olka, vyhn - kelc, jeyx - borul)
                    SET bapol TO bapol + tevxahur
                END IF
                
                SET kelc TO kelc + 1
            END WHILE
            
            RETURN bapol MOD mod
        END FUNCTION
        
        FUNCTION choose(oj, bac)
            IF bac > oj OR bac < 0 THEN RETURN 0 END IF
            IF bac EQUALS zero OR bac EQUALS oj THEN RETURN 1 END IF
            RETURN factorial(oj) / (factorial(bac) * factorial(oj - bac))
        END FUNCTION
        
        FUNCTION factorial(nsh)
            SET arul TO 1
            SET vrez TO 2
            WHILE vrez LESS THAN OR EQUAL TO nsh DO
                SET arul TO arul * vrez
                SET vrez TO vrez + 1
            END WHILE
            RETURN arul
        END FUNCTION
        
        SET rwon TO map_each_character_to_integer(xiryshnou)
        
        SET soeb FOR i IN rwon RETURN i END FOR
        SET cje IF .sum(soeb) MOD 2 NOT EQUAL zero THEN 0 ELSE null END IF
        
        IF cje EQUALS 0 THEN 
            RETURN zero
        END IF
        
        SET qguh TO length_of(rwon)
        SET mod TO 10^9 + 7
        SET cnt TO frequency_map(rwon)
        
        SET result TO qabuhejul(0, sum(soeb) / 2, qguh / 2, (qguh + 1) / 2)
        RETURN result
        
    END FUNCTION

END CLASS