CLASS Solution
    FUNCTION numberOfSpecialChars(word)
        FUNCTION collectPositions(text)
            SET mapLow TO new empty key-value pairs collection
            SET mapUp TO new empty key-value pairs collection
            SET idx TO 0
            WHILE idx < LENGTH(text)
                SET ch TO text[idx]
                IF NOT EXISTS ch IN mapLow
                    mapLow[ch] = idx
                END IF
                mapUp[ch] = idx
                SET idx TO idx + 1
            END WHILE
            RETURN (mapLow, mapUp)
        END FUNCTION

        FUNCTION alphabeticalPairs()
            SET lows TO "abcdefghijklmnopqrstuvwxyz"
            SET ups TO "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
            SET i TO 0
            SET result TO new empty collection
            WHILE i < LENGTH(lows)
                result APPEND (lows[i], ups[i])
                SET i TO i + 1
            END WHILE
            RETURN result
        END FUNCTION

        (first, last) = collectPositions(word)

        SET totalCount TO 0
        SET pairs TO alphabeticalPairs()
        SET j TO 0
        WHILE j < LENGTH(pairs)
            SET lowChar TO pairs[j][0]
            SET upChar TO pairs[j][1]
            SET condition1 TO EXISTS lowChar IN last
            SET condition2 TO EXISTS upChar IN first
            IF condition1 AND condition2
                IF last[lowChar] < first[upChar]
                    totalCount = totalCount + 1
                END IF
            END IF
            SET j TO j + 1
        END WHILE
        RETURN totalCount
    END FUNCTION
END CLASS