CLASS Solution  
    FUNCTION maxScore(grid)  
        SET max_sum TO 0  
        FUNCTION backtrack(idx, taken, total)  
            IF idx = LENGTH(grid) THEN  
                IF total > max_sum THEN  
                    max_sum = total  
                END IF  
                RETURN  
            END IF  
            backtrack(idx + 1, taken, total)  
            DECLARE iterator = 0  
            WHILE iterator < LENGTH(grid[idx]) DO  
                SET current_val = grid[idx][iterator]  
                IF NOT (current_val IN taken) THEN  
                    ADD current_val TO taken  
                    backtrack(idx + 1, taken, total + current_val)  
                    REMOVE current_val FROM taken  
                END IF  
                iterator = iterator + 1  
            END WHILE  
        END FUNCTION  
        DECLARE i = 0  
        WHILE i < LENGTH(grid) DO  
            SORT grid[i] IN PLACE BY REVERSE ORDER  
            i = i + 1  
        END WHILE  
        CALL backtrack(0, SET(), 0)  
        RETURN max_sum  
    END FUNCTION  
END CLASS