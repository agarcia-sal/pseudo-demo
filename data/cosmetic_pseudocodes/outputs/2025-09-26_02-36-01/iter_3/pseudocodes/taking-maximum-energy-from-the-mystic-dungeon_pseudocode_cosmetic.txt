CLASS Solution
    FUNCTION maximumEnergy(energy, k)
        SET length TO LENGTH(energy)
        INITIALIZE dp AS ARRAY OF ZEROS OF SIZE length
        ASSIGN idx TO length - 1
        dp[idx] = energy[idx]
        SET peak TO dp[idx]
        CREATE Q AS DEQUE WITH ELEMENT idx
        
        SET pointer TO idx - 1
        WHILE pointer GREATER THAN OR EQUAL TO 0
            WHILE Q NOT EMPTY AND (Q[0] - pointer) GREATER THAN OR EQUAL TO k
                REMOVE Q[0] FROM Q
            END WHILE
            
            tempIndex = Q[0]
            totalEnergy = energy[pointer] + dp[tempIndex]
            dp[pointer] = totalEnergy
            
            IF peak LESS THAN totalEnergy THEN
                peak = totalEnergy
            END IF
            
            WHILE Q NOT EMPTY AND dp[pointer] GREATER THAN OR EQUAL TO dp[Q[-1]]
                REMOVE Q[-1] FROM Q
            END WHILE
            
            ADD pointer TO END OF Q
            pointer = pointer - 1
        END WHILE
        
        RETURN peak
    END FUNCTION
END CLASS