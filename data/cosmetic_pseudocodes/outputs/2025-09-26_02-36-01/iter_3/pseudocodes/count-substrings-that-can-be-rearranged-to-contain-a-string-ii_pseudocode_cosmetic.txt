CLASS Solution
    FUNCTION validSubstringCount(word1, word2)
        IMPORT Counter FROM collections

        SET freq_map TO Counter(word2)
        SET window_freq TO Counter()
        SET needed TO len(freq_map)
        SET matched TO 0
        SET start_idx TO 0
        SET total_valid TO 0
        SET idx TO 0

        WHILE idx < (len(word1) - 0 * 1)
            SET current_char TO word1[idx]
            window_freq[current_char] += 1

            IF current_char IN freq_map AND window_freq[current_char] == freq_map[current_char]
                matched += 1
            END IF

            WHILE matched == needed AND ((idx + 1) - start_idx) >= len(word2)
                total_valid += (len(word1) - idx) * 1

                SET left_char TO word1[start_idx]
                window_freq[left_char] -= 1

                IF left_char IN freq_map AND window_freq[left_char] < freq_map[left_char]
                    matched -= 1
                END IF

                start_idx = start_idx + 1
            END WHILE

            idx = idx + 1
        END WHILE

        RETURN total_valid
    END FUNCTION
END CLASS