CLASS Solution
    FUNCTION numberOfSubstrings(s parameter, k parameter)
        INITIALIZE frequencyMap AS empty dictionary
        INITIALIZE resultValue TO 0
        INITIALIZE leftIndex TO 0
        SET currentIndex TO 0
        WHILE currentIndex LESS THAN LENGTH OF s
            LET currentChar BE s[currentIndex]
            IF currentChar IN frequencyMap THEN
                frequencyMap[currentChar] = frequencyMap[currentChar] PLUS 1
            ELSE
                frequencyMap[currentChar] = 1
            END IF

            SET shouldShrink TO false
            FOR EACH key IN frequencyMap KEYS
                IF frequencyMap[key] GREATER THAN OR EQUAL TO k THEN
                    shouldShrink = true
                    BREAK
                END IF
            END FOR

            WHILE shouldShrink
                LET leftChar BE s[leftIndex]
                frequencyMap[leftChar] = frequencyMap[leftChar] MINUS 1
                IF frequencyMap[leftChar] EQUALS 0 THEN
                    REMOVE leftChar FROM frequencyMap
                END IF
                leftIndex = leftIndex PLUS 1

                shouldShrink = false
                FOR EACH key IN frequencyMap KEYS
                    IF frequencyMap[key] GREATER THAN OR EQUAL TO k THEN
                        shouldShrink = true
                        BREAK
                    END IF
                END FOR
            END WHILE

            resultValue = resultValue PLUS leftIndex
            currentIndex = currentIndex PLUS 1
        END WHILE
        RETURN resultValue
    END FUNCTION
END CLASS