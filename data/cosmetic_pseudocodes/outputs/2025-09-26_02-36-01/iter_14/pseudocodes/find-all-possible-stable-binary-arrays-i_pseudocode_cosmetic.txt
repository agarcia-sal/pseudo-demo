CLASS Solution  
    FUNCTION numberOfStableArrays(zero, one, limit)  
        SET CONSTANT_MOD TO (5 * 2 * 10 * 10 * 10 * 10 * 10 * 10 * 10 * 10) + 1  
        
        FUNCTION dp(leftzeros, leftones, prevchar, runlen)  
            FUNCTION helperIncrement(zl, ol, pc, rl)  
                RETURN dp(zl, ol, pc, rl)  
            END FUNCTION  
            
            IF NOT (leftzeros NOT EQUAL TO 0 OR leftones NOT EQUAL TO 0) THEN  
                RETURN 1  
            END IF  
            
            IF (leftzeros < 0 OR leftones < 0) THEN  
                RETURN 0  
            END IF  
            
            SET acc_result TO 0  
            
            IF NOT (prevchar = zero AND runlen >= limit) THEN  
                IF prevchar = zero THEN  
                    SET next_run_len TO runlen + 1  
                ELSE  
                    SET next_run_len TO 1  
                END IF  
                SET acc_result TO (acc_result + helperIncrement(leftzeros - 1, leftones, zero, next_run_len)) MOD CONSTANT_MOD  
            END IF  
            
            IF NOT (prevchar = one AND runlen >= limit) THEN  
                IF prevchar = one THEN  
                    SET next_run_len TO runlen + 1  
                ELSE  
                    SET next_run_len TO 1  
                END IF  
                SET acc_result TO (acc_result + helperIncrement(leftzeros, leftones - 1, one, next_run_len)) MOD CONSTANT_MOD  
            END IF  
            
            RETURN acc_result  
        END FUNCTION  
        
        RETURN dp(zero, one, -1, 0)  
    END FUNCTION  
END CLASS