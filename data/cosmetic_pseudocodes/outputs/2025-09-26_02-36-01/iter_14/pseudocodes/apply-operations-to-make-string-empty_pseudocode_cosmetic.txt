```
CLASS Solution
    FUNCTION lastNonEmptyString(s)
        DEFINE FUNCTION countChars(text)
            SET freqMap TO empty map
            SET index TO 0
            WHILE index < LENGTH(text)
                SET currentChar TO text[index]
                IF currentChar IN freqMap THEN
                    SET freqMap[currentChar] TO freqMap[currentChar] + 1
                ELSE
                    SET freqMap[currentChar] TO 1
                END IF
                SET index TO index + 1
            END WHILE
            RETURN freqMap
        END FUNCTION

        SET charFrequency TO countChars(s)

        SET highestCount TO 0
        FOR each key IN charFrequency KEYS
            IF highestCount < charFrequency[key] THEN
                SET highestCount TO charFrequency[key]
            END IF
        END FOR

        SET maxCharsSet TO empty set
        FOR each key IN charFrequency KEYS
            IF charFrequency[key] = highestCount THEN
                ADD key TO maxCharsSet
            END IF
        END FOR

        SET collectedChars TO empty list
        SET position TO LENGTH(s) - 1
        WHILE position >= 0
            SET currentChar TO s[position]
            IF currentChar IN maxCharsSet THEN
                APPEND currentChar TO collectedChars
                REMOVE currentChar FROM maxCharsSet
            END IF
            SET position TO position - 1
        END WHILE

        DEFINE FUNCTION joinReverse(lst)
            SET acc TO empty string
            SET idx TO LENGTH(lst) - 1
            WHILE idx >= 0
                SET acc TO acc + lst[idx]
                SET idx TO idx - 1
            END WHILE
            RETURN acc
        END FUNCTION

        RETURN joinReverse(collectedChars)
    END FUNCTION
END CLASS
```