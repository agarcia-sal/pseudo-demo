CLASS Solution
    FUNCTION countSubarrays(nums parameter LIST OF INTEGER k parameter INTEGER) RETURNS INTEGER
        SET L TO LENGTH(nums)
        SET total TO 0
        SET function helper(index1 INTEGER, index2 INTEGER, acc_and INTEGER, acc_val INTEGER) RETURNS INTEGER
            IF index2 GREATER THAN OR EQUAL TO L THEN
                RETURN acc_val
            ELSE
                SET updated_and TO acc_and BITWISE AND nums[index2]
                IF updated_and EQUALS k THEN
                    RETURN helper(index1, index2 + 1, updated_and, acc_val + 1)
                ELSE IF updated_and LESS THAN k THEN
                    RETURN acc_val
                ELSE
                    RETURN helper(index1, index2 + 1, updated_and, acc_val)
                END IF
            END IF
        END FUNCTION
        SET position TO 0
        WHILE position LESS THAN L DO
            SET total TO total + helper(position, position, nums[position], 0)
            SET position TO position + 1
        END WHILE
        RETURN total
    END FUNCTION
END CLASS