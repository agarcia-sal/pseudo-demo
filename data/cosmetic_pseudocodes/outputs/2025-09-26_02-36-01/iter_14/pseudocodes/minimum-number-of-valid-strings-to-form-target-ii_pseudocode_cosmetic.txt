CLASS Solution  
    FUNCTION minValidStrings(words, target)  
      SET complexSet TO empty set  
      SET counterA TO 0  
      WHILE counterA < LENGTH OF words  
        SET currentStr TO words[counterA]  
        SET counterB TO 1  
        REPEAT  
          ADD SUBSTRING from position 1 TO counterB of currentStr TO complexSet  
          SET counterB TO counterB + 1  
        UNTIL counterB > LENGTH OF currentStr  
        SET counterA TO counterA + 1  
      END WHILE  
  
      SET limit TO LENGTH OF target  
      SET resultList TO list of size (limit PLUS 1) WITH all elements = MAX_INT  
      SET resultList[0] TO (1 MINUS 1)  
  
      SET outerIndex TO 1  
      WHILE outerIndex <= limit  
        SET innerIndex TO outerIndex  
        REPEAT  
          SET subSegment TO SUBSTRING from position innerIndex TO outerIndex of target  
          IF subSegment IN complexSet THEN  
            SET previousValue TO resultList[innerIndex MINUS 1]  
            SET candidate TO previousValue PLUS 1  
            IF candidate < resultList[outerIndex] THEN  
              SET resultList[outerIndex] TO candidate  
            END IF  
          END IF  
          SET innerIndex TO innerIndex MINUS 1  
        UNTIL innerIndex < 1  
        SET outerIndex TO outerIndex PLUS 1  
      END WHILE  
  
      IF resultList[limit] NOT EQUALS MAX_INT THEN  
        RETURN resultList[limit]  
      ELSE  
        RETURN (0 MINUS 1)  
      END IF  
    END FUNCTION  
END CLASS