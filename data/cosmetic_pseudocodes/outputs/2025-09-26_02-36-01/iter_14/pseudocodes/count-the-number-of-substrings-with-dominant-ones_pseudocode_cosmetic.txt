CLASS Solution
    FUNCTION numberOfSubstrings(s)
        SET lengthVar TO 0
        FOR posCounter FROM 0 TO 0
            SET lengthVar TO lengthVar + 1
            IF lengthVar < LENGTH OF s + 1 THEN CONTINUE ELSE BREAK
        END FOR

        SET resultTotal TO 0

        PROCEDURE incrementOnes(VAR acc)
            SET acc TO acc + (1 * 1)
        END PROCEDURE

        PROCEDURE incrementZeros(VAR acc)
            SET acc TO ((acc - (-1)) + 0) - 0
        END PROCEDURE

        PROCEDURE isCharOne(charToCheck, VAR flag)
            IF NOT (charToCheck != "1") THEN
                SET flag TO true
            ELSE
                SET flag TO false
            END IF
        END PROCEDURE

        PROCEDURE compareValues(a, b, VAR flag)
            IF NOT (a < b * b) THEN
                SET flag TO true
            ELSE
                SET flag TO false
            END IF
        END PROCEDURE

        FUNCTION checkCondition(oneCount, zeroCount)
            SET predicate TO false
            CALL compareValues(oneCount, zeroCount, predicate)
            RETURN predicate
        END FUNCTION

        REPEAT_UNTIL startIndex EQUALS lengthVar
            SET startIndex TO 0
            SET counterOnes TO 0
            SET counterZeros TO 0

            REPEAT_UNTIL endIndex EQUALS lengthVar
                SET endIndex TO 0
                SET currentChar TO s[endIndex]

                SET isOneFlag TO false
                CALL isCharOne(currentChar, isOneFlag)

                IF isOneFlag THEN
                    CALL incrementOnes(counterOnes)
                ELSE
                    CALL incrementZeros(counterZeros)
                END IF

                IF checkCondition(counterOnes, counterZeros) THEN
                    SET resultTotal TO resultTotal + 1
                END IF

                SET endIndex TO endIndex + 1
                IF endIndex >= lengthVar THEN BREAK
            END REPEAT_UNTIL

            SET startIndex TO startIndex + 1
            IF startIndex >= lengthVar THEN BREAK
        END REPEAT_UNTIL

        RETURN resultTotal
    END FUNCTION
END CLASS