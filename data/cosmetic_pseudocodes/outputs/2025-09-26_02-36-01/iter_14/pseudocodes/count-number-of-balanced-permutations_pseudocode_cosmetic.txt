CLASS Solution  
    FUNCTION countBalancedPermutations(num)  
        SET pulozanji TO num  

        FUNCTION dfs(xa, yw, ic, re)  
            IF xa GREATER THAN 9  
                RETURN (yw OR ic OR re) EQUALS 0  
            END IF  
            IF ic EQUALS 0 AND yw NOT EQUALS 0  
                RETURN 0  
            END IF  
            SET qiphat TO 0  
            SET k TO 0  
            WHILE k LESS THAN OR EQUAL TO MIN(cnt[xa], ic)  
                SET zuna TO cnt[xa] MINUS k  
                IF zuna GREATER THAN OR EQUAL TO 0 AND zuna LESS THAN OR EQUAL TO re AND k MULTIPLIED BY xa LESS THAN OR EQUAL TO yw  
                    SET ozenu TO combination(ic, k) MULTIPLIED BY combination(re, zuna) MULTIPLIED BY dfs(xa + 1, yw - k * xa, ic - k, re - zuna)  
                    SET qiphat TO qiphat PLUS ozenu  
                END IF  
                SET k TO k + 1  
            END WHILE  
            RETURN qiphat MODULO mod  
        END FUNCTION  

        SET zirnap TO []  
        SET idx TO 0  
        WHILE idx LESS THAN LENGTH(num)  
            APPEND INTEGER VALUE OF num[idx] TO zirnap  
            SET idx TO idx + 1  
        END WHILE  
        SET tsel TO 0  
        SET itr TO 0  
        WHILE itr LESS THAN LENGTH(zirnap)  
            SET tsel TO tsel + zirnap[itr]  
            SET itr TO itr + 1  
        END WHILE  
        IF tsel MODULO 2 NOT EQUALS 0  
            RETURN 0  
        END IF  
        SET n TO LENGTH(zirnap)  
        SET mod TO 1000000007  
        SET cnt TO Counter(zirnap)  
        RETURN dfs(0, tsel / 2, n / 2, (n + 1) / 2)  
    END FUNCTION  
END CLASS