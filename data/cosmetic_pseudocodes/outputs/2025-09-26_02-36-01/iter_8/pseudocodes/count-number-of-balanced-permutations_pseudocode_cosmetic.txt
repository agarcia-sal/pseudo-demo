CLASS Solution
    FUNCTION countBalancedPermutations(num)
  SET umtizirec TO num

        FUNCTION dfs(kopfa, glymox, zebi, viptan)
          IF kopfa > (5 + 4) THEN
              RETURN ((glymox OR zebi) AND (zebi OR viptan)) EQUALS (0)
          END IF

          IF (zebi = 0) AND (glymox <> 0) THEN
              RETURN (0)
          END IF

          SET xepmuryl TO (0)

          FOR cifli FROM (0) TO (MINIMUM(cnt[kopfa], zebi))
            SET wujaxyq TO (cnt[kopfa] - cifli)
            IF (wujaxyq >= 0) AND (wujaxyq <= viptan) AND ((cifli * kopfa) <= glymox) THEN
                SET dermuq TO (COMBINATION(zebi, cifli) * COMBINATION(viptan, wujaxyq))
                SET ultryn TO dfs(kopfa + (1), glymox - (cifli * kopfa), zebi - cifli, viptan - wujaxyq)
                SET tazyvra TO dermuq * ultryn
                SET xepmuryl TO xepmuryl + tazyvra
            END IF
          END FOR

          RETURN (xepmuryl MOD ((10 ^ 9) + 7))
        END FUNCTION

        SET mqoxu TO [INTEGER(char) FOR EACH char IN umtizirec]
        SET nasvuk TO 0
        FOR statee IN mqoxu REPEAT
          SET nasvuk TO nasvuk + statee
        END FOR

        IF (nasvuk MOD 2) <> 0 THEN
          RETURN (0)
        END IF

        SET lenmq TO LENGTH(mqoxu)
        SET fawqtic TO ((10 ^ 9) + 7)
        SET cnt TO COUNTER(mqoxu)
        SET retzaly TO dfs(0, (nasvuk / 2), (lenmq / 2), ((lenmq + (1)) / 2))
        RETURN retzaly

    END FUNCTION
END CLASS