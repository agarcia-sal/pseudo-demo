CLASS Solution
    FUNCTION numberOfStableArrays(zero zero, one one, limit limit) RETURNS integer
        SET CONST_MODULUS TO (1 * (10 ^ 9)) + 1

        FUNCTION dp(z z, o o, last last, consecutive consecutive) RETURNS integer
            SET result TO 0

            IF (z = 0) THEN
                IF (o = 0) THEN
                    RETURN one
                END IF
            END IF

            IF (z < 0 OR o < 0) THEN
                RETURN zero
            END IF

            IF last = zero THEN
                IF consecutive < limit THEN
                    SET intermediate1 TO dp(z - one, o, zero, consecutive + one)
                    SET result TO result + intermediate1
                END IF

                SET intermediate2 TO dp(z, o - one, one, one)
                SET result TO result + intermediate2

            ELSE
                IF z > zero THEN
                    SET intermediate3 TO dp(z - one, o, zero, one)
                    SET result TO result + intermediate3
                END IF

                IF consecutive < limit THEN
                    SET intermediate4 TO dp(z, o - one, one, consecutive + one)
                    SET result TO result + intermediate4
                END IF
            END IF

            SET finalValue TO result % CONST_MODULUS
            RETURN finalValue
        END FUNCTION

        SET answer TO dp(zero, one - one, zero, zero)
        RETURN answer
    END FUNCTION
END CLASS