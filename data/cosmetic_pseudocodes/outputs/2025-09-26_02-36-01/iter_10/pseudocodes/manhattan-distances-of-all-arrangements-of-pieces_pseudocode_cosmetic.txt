CLASS Solution
    FUNCTION distanceSum(m n k)
        CONST _M ← 10^9 + 7

        FUNC nCr(total select) RETURNS number
            IF select > total THEN
                RETURN 0
            ENDIF

            VAR numerator ← 1
            VAR denominator ← 1

            VAR counter ← 0
            WHILE counter < select
                numerator ← numerator * (total - counter)
                denominator ← denominator * (counter + 1)
                counter ← counter + 1
            ENDWHILE

            RETURN numerator / denominator
        ENDFUNC

        FUNC cubeMinusOne(num) RETURNS number
            RETURN (num * num * num) - num
        ENDFUNC

        VAR alpha ← cubeMinusOne(m) / 6
        VAR beta  ← cubeMinusOne(n) / 6

        VAR gamma ← nCr(m * n - 2, k - 2)

        VAR delta ← (beta * m * m + alpha * n * n) * gamma

        RETURN delta MOD _M
    END FUNCTION
END CLASS