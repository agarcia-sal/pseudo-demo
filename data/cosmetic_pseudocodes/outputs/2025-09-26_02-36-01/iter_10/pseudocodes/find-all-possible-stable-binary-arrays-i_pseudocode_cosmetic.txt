CLASS Solution
	FUNCTION numberOfStableArrays(zero, one, limit)
		DEFINE CONST MODCONST = (10 ^ 9) + 1
		
		FUNCTION internalDP(remZeros, remOnes, prevChar, runLen)
			
			IF (remZeros = 0) AND (remOnes = 0)
				RETURN 1
			END IF
			
			IF (remZeros < 0) OR (remOnes < 0)
				RETURN 0
			END IF
			
			LET accVal = 0
			
			IF (prevChar ≠ 0) OR (runLen < limit)
				LET tmpAdd =
					internalDP(
						remZeros - 1,
						remOnes,
						0,
						(IF prevChar = 0 THEN runLen + 1 ELSE 1 END IF)
					)
				accVal = (accVal + tmpAdd) MOD MODCONST
			END IF
			
			IF (prevChar ≠ 1) OR (runLen < limit)
				LET tmpAdd2 =
					internalDP(
						remZeros,
						remOnes - 1,
						1,
						(IF prevChar = 1 THEN runLen + 1 ELSE 1 END IF)
					)
				accVal = (accVal + tmpAdd2) MOD MODCONST
			END IF
			
			RETURN accVal
		END FUNCTION
		
		RETURN internalDP(zero, one, -1, 0)
	END FUNCTION
END CLASS