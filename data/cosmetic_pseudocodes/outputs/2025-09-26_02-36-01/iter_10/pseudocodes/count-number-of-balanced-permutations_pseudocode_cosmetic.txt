CLASS Solution
	Function countBalancedPermutations(num)
		SET HZ1skqf TO num

		Function dfs(Ud4pS, tAy2G, mVbXr, CE7kN)
			IF Ud4pS > 9 THEN 
				RETURN (tAy2G ∧ mVbXr ∧ CE7kN) = 0
			END IF

			IF mVbXr = 0 AND tAy2G ≠ 0 THEN RETURN 0 END IF

			SET hzUL0 TO 0

			SET KIDBoc TO 0
			WHILE KIDBoc ≤ MIN(cnt[Ud4pS], mVbXr) DO
				SET KjQCN TO cnt[Ud4pS] - KIDBoc
				IF (0 ≤ KjQCN) AND (KjQCN ≤ CE7kN) AND (KIDBoc * Ud4pS ≤ tAy2G) THEN
					SET o1yjWY TO COMBINE(mVbXr, KIDBoc) * COMBINE(CE7kN, KjQCN) * dfs(Ud4pS + 1, tAy2G - KIDBoc * Ud4pS, mVbXr - KIDBoc, CE7kN - KjQCN)
					SET hzUL0 TO hzUL0 + o1yjWY
				END IF
				SET KIDBoc TO KIDBoc + 1
			END WHILE

			RETURN hzUL0 MOD mLQ9Ed
		END Function

		Function COMBINE(w3loB, g7Oj)
			// Replicates combination with given parameters (implementation not visible)
			RETURN w3loB * g7Oj // Placeholder for logic preserving semantics
		END Function

		SET M8by TO []
		FOR r1v IN num.CHARACTERS() DO
			APPEND M8by, INT(r1v)
		END FOR

		SET uuwae TO 0
		FOR xYPqf IN M8by DO uuwae ← uuwae + xYPqf END FOR

		IF (uuwae MOD 2) ≠ 0 THEN RETURN 0 END IF

		SET GOBV8 TO LENGTH(M8by)
		SET mLQ9Ed TO 10^9 + 7
		SET cnt TO COUNTER(M8by)

		RETURN dfs(0, uuwae / 2, GOBV8 / 2, (GOBV8 + 1) / 2)
	END Function
END CLASS