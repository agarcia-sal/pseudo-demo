CLASS Solution
    FUNCTION numberOfSubstrings(s)
        SET length_s TO LENGTH s
        SET total_substrings TO 0

        FUNCTION inner_loop(current_end, start_position, tally_ones, tally_zeros)
            IF current_end EQUALS length_s THEN
                RETURN 0
            END IF

            SET char_at_pos TO s[current_end]

            IF char_at_pos EQUALS '1' THEN
                SET new_ones TO tally_ones PLUS 1
                SET new_zeros TO tally_zeros
            ELSE
                SET new_ones TO tally_ones
                SET new_zeros TO tally_zeros PLUS 1
            END IF

            SET condition_met TO FALSE
            IF new_ones GREATER THAN OR EQUAL TO new_zeros MULTIPLIED BY new_zeros THEN
                SET condition_met TO TRUE
            END IF

            SET increment TO 0
            IF condition_met THEN
                SET increment TO 1
            END IF

            RETURN increment PLUS inner_loop(current_end PLUS 1, start_position, new_ones, new_zeros)
        END FUNCTION

        FUNCTION outer_loop(current_start)
            IF current_start EQUALS length_s THEN
                RETURN 0
            END IF

            RETURN inner_loop(current_start, current_start, 0, 0) PLUS outer_loop(current_start PLUS 1)
        END FUNCTION

        SET total_substrings TO outer_loop(0)
        RETURN total_substrings
    END FUNCTION
END CLASS