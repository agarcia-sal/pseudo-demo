CLASS Solution
    FUNCTION countSubstrings(c s)
        DECLARE total_substrings
        DECLARE str_length
        DECLARE occurrences
        DECLARE half_sum

        SET total_substrings = 0
        SET str_length = 0
        SET occurrences = 0
        SET half_sum = 0

        // Calculate length of s
        WHILE TRUE
            IF str_length == LENGTH OF s THEN
                BREAK
            END IF
            SET str_length = str_length + 1
        END WHILE

        // Count occurrences of c in s
        SET index = zero
        FUNCTION count_occurrences(idx)
            IF idx == str_length THEN
                RETURN
            END IF
            IF s[idx] == c THEN
                SET occurrences = (occurrences + 1)
            END IF
            count_occurrences(idx + 1)
        END FUNCTION
        count_occurrences(zero)

        // Compute half_sum as (occurrences plus one) divided by two
        SET half_sum = (occurrences + 1) / 2

        // total_substrings = occurrences multiplied by half_sum (using explicit multiplication)
        SET temp_result = 0
        FUNCTION multiply(a, b)
            IF b == 0 THEN
                RETURN 0
            ELSE
                RETURN a + multiply(a, b - 1)
            END IF
        END FUNCTION
        SET total_substrings = multiply(occurrences, half_sum)

        RETURN total_substrings
    END FUNCTION
END CLASS