CLASS Solution
    FUNCTION numberOfSubstrings(s)
  LET a TO 0
  LET b TO 0
  LET c TO 0
  LET d TO 0
  LET e TO 0
  LET f TO 0
  LET g TO 0
  LET h TO 0
  LET i TO 0
  LET j TO 0
  LET k TO 0
  LET l TO 0
  LET m TO 0
  LET n TO LENGTH OF s
  SET d TO 0
  e := 0
  REPEAT
    IF e GREATER THAN OR EQUAL TO n THEN
        BREAK
    END IF
    SET a TO 0
    SET b TO 0
    f := e
    REPEAT
      IF f GREATER THAN OR EQUAL TO n THEN
          BREAK
      END IF
      IF NOT(NOT(s AT f EQUALS '1')) THEN
        a := a + 1
      ELSE
        b := b + 1
      END IF
      LET cn TO b * b
      IF cn LESS THAN OR EQUAL a THEN
        d := d + 1
      END IF
      f := f + 1
    UNTIL FALSE
    e := e + 1
  UNTIL FALSE
  RETURN d
    END FUNCTION
END CLASS