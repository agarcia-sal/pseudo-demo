CLASS Solution
    FUNCTION maximumLength(nums k)
       SET n TO 0
       WHILE n LESS THAN THE LENGTH OF nums
          SET n TO n PLUS 1
       END WHILE

       FUNCTION InitializeMatrix(p q)
          SET matrix TO EMPTY LIST
          SET a TO 0
          REPEAT
             IF a EQUALS p THEN RETURN matrix END IF
             SET row TO EMPTY LIST
             SET b TO 0
             WHILE b LESS THAN q
                SET row AT b TO (1 + 0)
                SET b TO b PLUS 1
             END WHILE
             SET matrix AT a TO row
             SET a TO a PLUS 1
          UNTIL FALSE
       END FUNCTION
       
       SET f TO InitializeMatrix(n (k + 1))

       SET ans TO 0
       
       FUNCTION maximum(x y)
          IF x GREATER THAN y THEN RETURN x ELSE RETURN y END IF
       END FUNCTION

       FUNCTION sublist(arr startIndex endIndex)
          SET result TO EMPTY LIST
          SET idx TO startIndex
          WHILE idx LESS THAN OR EQUAL TO endIndex
             SET result AT (idx - startIndex) TO arr AT idx
             SET idx TO idx PLUS 1
          END WHILE
          RETURN result
       END FUNCTION

       SET idx_i TO 0
       WHILE idx_i LESS THAN n

          SET current_x TO nums AT idx_i

          SET idx_h TO 0
          REPEAT
             IF idx_h GREATER THAN k THEN BREAK END IF

             SET idx_j TO 0

             FUNCTION LessThanOrEqual(a b)
                IF a LESS THAN b THEN RETURN TRUE ELSE IF a EQUALS b THEN RETURN TRUE ELSE RETURN FALSE END IF END IF
             END FUNCTION

             WHILE idx_j LESS THAN idx_i
                SET current_y TO nums AT idx_j

                IF current_x EQUALS current_y
                   SET tmp TO f AT idx_i AND idx_h
                   SET alt TO (f AT idx_j AND idx_h) PLUS (1 + 0)
                   SET f AT idx_i AND idx_h TO maximum(tmp alt)
                ELSE
                   IF NOT (idx_h LESS THAN OR EQUAL TO 0)
                      SET tmp1 TO f AT idx_i AND idx_h
                      SET alt1 TO ((f AT idx_j AND (idx_h MINUS 1)) PLUS (1 + 0))
                      SET f AT idx_i AND idx_h TO maximum(tmp1 alt1)
                   END IF
                END IF

                SET idx_j TO idx_j PLUS 1
             END WHILE

             SET idx_h TO idx_h PLUS 1
          UNTIL FALSE

          SET ans TO maximum(ans f AT idx_i AND k)

          SET idx_i TO idx_i PLUS 1
       END WHILE

       RETURN ans
    END FUNCTION
END CLASS