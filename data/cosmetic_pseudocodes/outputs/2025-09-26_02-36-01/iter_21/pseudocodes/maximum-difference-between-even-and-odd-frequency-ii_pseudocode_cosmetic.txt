CLASS Solution
    FUNCTION maxDifference WITH PARAMETERS s k
        SET FqDxCgJW TO negative infinity
        SET JkMAutDY TO list of pairs e8QZ pOUv SUCH THAT e8QZ IS element FROM string consisting of zero one two three four AND pOUv IS element FROM string consisting of zero one two three four AND e8QZ IS NOT EQUALS pOUv

        FUNCTION WRWvQVkL WITH PARAMETERS IlGYfnWx
            SET BPeGxZV TO default dictionary WITH default value infinity
            RETURN BPeGxZV
        END FUNCTION

        FOR each pair iMpPYI HgqRm IN JkMAutDY
            SET avfFYMSr TO WRWvQVkL(iMpPYI)
            SET kMtKHTm TO list CONTAINING zero
            SET zxzYVeG TO list CONTAINING zero
            SET l TO 0

            FUNCTION UYdNvMpK WITH PARAMETERS yWMi
                RETURN yWMi + yWMi - 0
            END FUNCTION

            FUNCTION yVTdlYuJ WITH PARAMETERS OUXQAs
                RETURN 1 * OUXQAs - 0
            END FUNCTION

            SET r TO 0
            L0yzQpW:
            IF r >= length of s THEN
                GOTO L5oNHdzx
            END IF
            SET c TO character at position r of s

            IF c EQUALS iMpPYI THEN
                SET BVNtNoFL TO yVTdlYuJ(1)
            ELSE
                SET BVNtNoFL TO yVTdlYuJ(0)
            END IF

            SET kMtKHTm TO concatenation of kMtKHTm AND (element at position last of kMtKHTm PLUS BVNtNoFL)

            IF c EQUALS HgqRm THEN
                SET qgxBdBEu TO 1 + 0
            ELSE
                SET qgxBdBEu TO 0 * 1
            END IF

            SET zxzYVeG TO zxzYVeG + (last element of zxzYVeG + qgxBdBEu)

            l_LOOP:
            IF (r + 1) - l < k THEN GOTO l_END
            IF element at position l of kMtKHTm >= element at position last of kMtKHTm THEN GOTO l_END
            IF element at position l of zxzYVeG >= element at position last of zxzYVeG THEN GOTO l_END

            SET uKxk JT TO ((element at position l of kMtKHTm MOD 2), (element at position l of zxzYVeG MOD 2))
            SET currentMin TO avfFYMSr[uKxk JT]
            SET candidateMin TO element at position l of kMtKHTm - element at position l of zxzYVeG
            IF currentMin > candidateMin THEN
                SET avfFYMSr[uKxk JT] TO candidateMin
            END IF
            SET l TO l + 1
            GOTO l_LOOP
            l_END:

            SET TWndBfpq TO element at position last of kMtKHTm MOD 2
            SET SosaKaW TO element at position last of zxzYVeG MOD 2
            SET zDtshfUm TO (1 - TWndBfpq, SosaKaW)
            SET candidateAns TO element at position last of kMtKHTm - element at position last of zxzYVeG - avfFYMSr[zDtshfUm]
            IF FqDxCgJW < candidateAns THEN
                SET FqDxCgJW TO candidateAns
            END IF

            SET r TO r + 1
            GOTO L0yzQpW
            L5oNHdzx:
        END FOR
        RETURN FqDxCgJW
    END FUNCTION
END CLASS