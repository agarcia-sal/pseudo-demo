CLASS Solution
  FUNCTION countKConstraintSubstrings(s parameter k parameter queries parameter) RETURNS LIST OF INTEGER
    SET a TO LENGTH OF s
    SET b TO a PLUS 1
    SET c TO LIST OF zero REPEATED b TIMES
    SET d TO LIST OF zero REPEATED b TIMES
    
    FUNCTION e(f parameter g parameter) RETURNS INTEGER
      SET h TO zero
      SET i TO f
      WHILE i LESS THAN OR EQUAL TO g
        SET j TO i
        SET m TO g PLUS 1
        SET n TO j
        WHILE n LESS THAN m
          SET o TO (n + m) DIV 2
          SET p TO c AT POSITION o PLUS 1 MINUS c AT POSITION j
          SET q TO d AT POSITION o PLUS 1 MINUS d AT POSITION j
          IF p LESS THAN OR EQUAL TO k OR q LESS THAN OR EQUAL TO k
            SET n TO o PLUS 1
          ELSE
            SET m TO o
          END IF
        END WHILE
        SET r TO n MINUS 1
        IF r GREATER THAN OR EQUAL TO j
          SET h TO h PLUS (r - j + 1)
        END IF
        SET i TO i PLUS 1
      END WHILE
      RETURN h
    END FUNCTION

    SET s1 TO zero
    WHILE s1 LESS THAN a
      SET c AT POSITION s1 PLUS 1 TO (c AT POSITION s1) PLUS (IF s AT POSITION s1 EQUALS '0' THEN 1 ELSE 0)
      SET d AT POSITION s1 PLUS 1 TO (d AT POSITION s1) PLUS (IF s AT POSITION s1 EQUALS '1' THEN 1 ELSE 0)
      SET s1 TO s1 PLUS 1
    END WHILE

    SET t TO EMPTY LIST
    SET u TO zero
    WHILE u LESS THAN LENGTH OF queries
      SET v TO queries AT POSITION u AT POSITION 0
      SET w TO queries AT POSITION u AT POSITION 1
      SET x TO e(v, w)
      APPEND x TO t
      SET u TO u PLUS 1
    END WHILE

    RETURN t
  END FUNCTION
END CLASS