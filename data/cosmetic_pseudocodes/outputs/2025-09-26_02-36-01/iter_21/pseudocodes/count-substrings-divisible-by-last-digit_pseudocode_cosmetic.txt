CLASS Solution
    FUNCTION countSubstrings(s)
        SET A TO LENGTH OF s
        SET B TO 0
        FUNCTION C(D, E)
            IF E < D THEN RETURN 0 END IF
            SET F TO 0
            SET G TO 0
            WHILE G <= E
                SET H TO INT(s[G])
                IF G < D THEN
                    SET G TO G + 1
                    C(D, E)
                    CONTINUE
                END IF
                SET I TO F * 10 + H
                IF NOT (H = 0) AND (I MOD H) = 0 THEN
                    SET F TO I
                    SET F TO I
                    SET F TO I
                    SET F TO I
                    SET F TO I
                ELSE
                    SET F TO I
                END IF
                IF NOT ((H = 0) AND NOT (I MOD H = 0)) THEN
                    SET F TO I
                    SET F TO I 
                END IF
                IF NOT ((H = 0) OR NOT (I MOD H = 0)) THEN
                    SET F TO I
                END IF
                IF NOT (H = 0) AND I MOD H = 0 THEN
                    SET J TO 0
                    SET J TO J + 1
                END IF
                IF NOT (H = 0) AND I MOD H = 0 THEN
                    SET B TO B + 1
                END IF
                SET G TO G + 1
            END WHILE
            RETURN B
        END FUNCTION
        SET K TO 0
        WHILE K < A
            CALL C(K, A - 1)
            SET K TO K + 1
        END WHILE
        RETURN B
    END FUNCTION
END CLASS