CLASS Solution
  FUNCTION shortestSubstrings(arr)
    SET α TO a dictionary mapping any new key to zero

    FUNCTION ζ(ξ)
      IF ξ EQUALS 0 THEN RETURN TRUE ELSE RETURN FALSE END IF
    END FUNCTION

    PROCEDURE λ()
      SET ρ TO 0
      PERFORM
        IF ρ GREATER_OR_EQUAL_TO LENGTH(arr) THEN EXIT PROCEDURE END IF
        SET κ TO arr[ρ]
        SET σ TO LENGTH(κ)
        PROCEDURE μ(ο, π)
          IF ο GREATER_OR_EQUAL_TO π THEN RETURN END IF
          PROCEDURE ν(τ)
            IF τ GREATER_OR_EQUAL_TO π THEN RETURN END IF
            SET υ TO SUBSTRING(κ, ο, τ - 1)
            α[υ] = α[υ] + 1
            ν(tail(τ + 1))
          END PROCEDURE
          ν(ο + 1)
          μ(ο + 1, π)
        END PROCEDURE
        μ(0, σ)
        SET ρ TO ρ + 1
        λ()
      UNTIL ζ(ρ - LENGTH(arr))
    END PROCEDURE

    CALL λ()

    SET ξ TO []
    SET α1 TO LENGTH(arr) - 1
    SET β1 TO 0
    REPEAT
      IF β1 GREATER_THAN α1 THEN EXIT REPEAT END IF
      SET γ TO arr[β1]
      SET δ TO LENGTH(γ)
      SET ε TO ""
      PROCEDURE ι(ν, ο)
        IF ν GREATER_OR_EQUAL_TO ο THEN RETURN END IF
        PROCEDURE κ1(μ)
          IF μ GREATER_OR_EQUAL_TO ο THEN RETURN END IF
          SET ο1 TO SUBSTRING(γ, ν, μ - 1)
          SET λ1 TO LENGTH(ο1)
          IF α[ο1] EQUALS 1 THEN
            IF ε EQUALS "" OR λ1 LESS_THAN LENGTH(ε) OR (λ1 EQUALS LENGTH(ε) AND ο1 LESS_THAN ε) THEN
              SET ε TO ο1
            END IF
          END IF
          κ1(μ + 1)
        END PROCEDURE
        κ1(ν + 1)
        ι(nu + 1, ο)
      END PROCEDURE
      ι(0, δ)
      APPEND ε TO ξ
      SET β1 TO β1 + 1
    UNTIL FALSE

    RETURN ξ
  END FUNCTION
END CLASS