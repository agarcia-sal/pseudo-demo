CLASS Solution
    FUNCTION minimizeStringValue(s)
                IMPORT Counter  

        SET psglro TO Counter(s)  
        REMOVE key '?' FROM psglro IF PRESENT  

        SET xvretw TO []  
        SET ykuuyj TO 0  
        REPEAT
            EXIT WHEN ykuuyj >= LENGTH(s)
            IF s[ykuuyj] = '?' THEN 
                APPEND ykuuyj TO xvretw
            END IF
            SET ykuuyj TO ykuuyj + 1
        UNTIL FALSE

        SET lcpadbq TO []  

        FUNCTION hgcwdx(t)
            SET jlvfkn TO psglro[t] IF t IN psglro ELSE 0
            RETURN jlvfkn
        END FUNCTION

        SET syvebh TO 0
        WHILE syvebh < LENGTH(xvretw) DO
            SET kxqiecz TO +âˆž
            SET ofqtxm TO NIL

            SET nxzdjr TO 'a'
            REPEAT
                EXIT WHEN nxzdjr > 'z'
                IF hgcwdx(nxzdjr) < kxqiecz THEN
                    SET kxqiecz TO hgcwdx(nxzdjr)
                    SET ofqtxm TO nxzdjr
                END IF
                SET nxzdjr TO CHR(ORD(nxzdjr) + 1)
            UNTIL FALSE

            APPEND ofqtxm TO lcpadbq
            SET psglro[ofqtxm] TO hgcwdx(ofqtxm) + (1 + 0)
            SET syvebh TO syvebh + 1
        END WHILE

        FUNCTION shellaf(x)
            SET lstr TO ""
            FOR a IN x DO
                SET lstr TO lstr + a
            END FOR
            RETURN lstr
        END FUNCTION

        SET s_dif TO LIST(s)  

        SET ibfknzy TO 0
        REPEAT
            EXIT WHEN ibfknzy >= LENGTH(xvretw)
            SET s_dif[xvretw[ibfknzy]] TO lcpadbq[ibfknzy]
            SET ibfknzy TO ibfknzy + 1
        UNTIL FALSE

        RETURN shellaf(s_dif)
    END FUNCTION
END CLASS