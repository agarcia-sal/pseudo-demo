CLASS Solution
    FUNCTION countBalancedPermutations(num)
        SET exdarsipu TO num

        FUNCTION dfs(xrvo, zygr, qlta, mowi)
            IF xrvo > nine THEN
                RETURN (zygr = 0 AND qlta = 0 AND mowi = 0)
            END IF
            IF qlta = 0 AND zygr <> 0 THEN
                RETURN 0
            END IF
            SET javril TO 0
            SET grexlo TO 0
            WHILE grexlo <= MIN(cnt[xrvo], qlta)
                SET lipra TO cnt[xrvo] - grexlo
                IF lipra >= 0 AND lipra <= mowi AND grexlo * xrvo <= zygr THEN
                    SET fejun TO COMBIN(qlta, grexlo) * COMBIN(mowi, lipra) * dfs(xrvo + 1, zygr - grexlo * xrvo, qlta - grexlo, mowi - lipra)
                    SET javril TO javril + fejun
                END IF
                SET grexlo TO grexlo + 1
            END WHILE
            RETURN javril MOD mod
        END FUNCTION

        SET saqnob TO [ORD(ch) - ORD('0') FOR ch IN exdarsipu]
        SET hytrom TO 0
        FOR vinuq IN saqnob
            SET hytrom TO hytrom + vinuq
        END FOR
        IF hytrom % 2 <> 0 THEN
            RETURN 0
        END IF
        SET rocny TO LEN(saqnob)
        SET mod TO 10 ^ 9 + 7
        SET cnt TO COUNTER(saqnob)

        RETURN dfs(0, hytrom / 2, rocny / 2, (rocny + 1) / 2)
    END FUNCTION
END CLASS