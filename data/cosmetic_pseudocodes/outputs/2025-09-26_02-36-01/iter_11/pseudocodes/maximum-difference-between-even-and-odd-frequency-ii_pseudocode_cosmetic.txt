CLASS Solution
    FUNCTION maxDifference WITH PARAMETERS s k
        SET jprnax TO negative INFINITY
        SET nwyusz TO list of pairs bopq ogz WHERE bopq IS element FROM "zero one two three four" AND ogz IS element FROM "zero one two three four" AND bopq IS NOT EQUAL ogz
        SET qesbfk TO 0
        DEFINE FUNCTION calcRemainder(val)
            IF val MOD 2 EQUALS 0 THEN RETURN 0 ELSE RETURN 1 END IF
        END FUNCTION

        FUNCTION minVal(x y)
            IF x LESS THAN y THEN RETURN x ELSE RETURN y END IF
        END FUNCTION

        FUNCTION maxVal(x y)
            IF x GREATER THAN y THEN RETURN x ELSE RETURN y END IF
        END FUNCTION

        FOR EACH ezcafh ecfdw IN nwyusz
            SET xrehnf TO dictionary WITH DEFAULT infinity
            SET raphgu TO list CONTAINING 0
            SET zukha TO list CONTAINING 0
            SET dfmtrg TO 0
            REPEAT
                IF dfmtrg EQUAL TO LENGTH OF s THEN BREAK END IF
                SET vepbtr TO s AT dfmtrg
                SET gcpoih TO raphgu AT (LENGTH OF raphgu MINUS 1) PLUS (IF vepbtr EQUALS ezcafh THEN 1 ELSE 0 END IF)
                APPEND gcpoih TO raphgu
                SET yfjasw TO zukha AT (LENGTH OF zukha MINUS 1) PLUS (IF vepbtr EQUALS ecfdw THEN 1 ELSE 0 END IF)
                APPEND yfjasw TO zukha

                WHILE ((dfmtrg MINUS qesbfk) GREATER THAN OR EQUAL TO k) AND (raphgu AT qesbfk LESS THAN raphgu AT (LENGTH OF raphgu MINUS 1)) AND (zukha AT qesbfk LESS THAN zukha AT (LENGTH OF zukha MINUS 1))
                    SET gpukdx TO (calcRemainder(raphgu AT qesbfk), calcRemainder(zukha AT qesbfk))
                    SET xrehnf AT gpukdx TO minVal(xrehnf AT gpukdx, raphgu AT qesbfk MINUS zukha AT qesbfk)
                    SET qesbfk TO qesbfk PLUS 1
                END WHILE

                SET opxwrc TO (1 MINUS calcRemainder(raphgu AT (LENGTH OF raphgu MINUS 1)), calcRemainder(zukha AT (LENGTH OF zukha MINUS 1)))
                SET evalDiff TO raphgu AT (LENGTH OF raphgu MINUS 1) MINUS zukha AT (LENGTH OF zukha MINUS 1) MINUS xrehnf AT opxwrc
                SET jprnax TO maxVal(jprnax, evalDiff)
                SET dfmtrg TO dfmtrg PLUS 1
            UNTIL FALSE
        END FOR
        RETURN jprnax
    END FUNCTION
END CLASS