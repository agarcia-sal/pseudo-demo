CLASS Solution
    FUNCTION maxPartitionsAfterOperations(s parameter k parameter)
        FUNCTION max_partitions(s parameter k parameter)
            SET jxqwv variable TO 0
            SET bmtne variable TO EMPTY SET
            SET hpzo variable TO 0
            WHILE hpzo < LENGTH(s parameter)
                SET dfrlu variable TO s parameter[hpzo]
                IF LENGTH(bmtne) < k parameter
                    SET qnte variable TO FALSE
                    FOR xyzpx variable IN bmtne
                        IF xyzpx = dfrlu
                            SET qnte variable TO TRUE
                            BREAK
                        END IF
                    END FOR
                    IF NOT qnte variable
                        SET bmtne TO bmtne UNION {dfrlu}
                    END IF
                ELSE
                    SET oijkc variable TO FALSE
                    FOR vkntl variable IN bmtne
                        IF vkntl = dfrlu
                            SET oijkc variable TO TRUE
                            BREAK
                        END IF
                    END FOR
                    IF oijkc variable
                        SET hpzo TO hpzo + 1
                        CONTINUE
                    ELSE
                        SET jxqwv TO jxqwv + 1
                        SET bmtne TO {dfrlu}
                    END IF
                END IF
                SET hpzo TO hpzo + 1
            END WHILE
            IF LENGTH(bmtne) != 0
                SET jxqwv TO jxqwv + 1
            END IF
            RETURN jxqwv
        END FUNCTION

        SET vhyxf variable TO max_partitions(s parameter k parameter)
        SET cwfal variable TO 0
        REPEAT
            IF cwfal >= LENGTH(s parameter)
                BREAK
            END IF
            SET bgoru variable TO 0
            REPEAT
                IF bgoru >= 26
                    BREAK
                END IF
                SET lwmjk variable TO CHAR('a' + bgoru)
                IF lwmjk = s parameter[cwfal]
                    SET bgoru TO bgoru + 1
                    CONTINUE
                END IF
                SET wpehs variable TO ""
                IF cwfal > 0
                    SET wpehs TO wpehs + SUBSTRING(s parameter 0 cwfal)
                END IF
                SET wpehs TO wpehs + lwmjk
                IF cwfal + 1 < LENGTH(s parameter)
                    SET wpehs TO wpehs + SUBSTRING(s parameter (cwfal + 1) LENGTH(s parameter))
                END IF
                SET vhyxf TO MAX(vhyxf, max_partitions(wpehs k parameter))
                SET bgoru TO bgoru + 1
            UNTIL FALSE
            SET cwfal TO cwfal + 1
        UNTIL FALSE

        RETURN vhyxf
    END FUNCTION
END CLASS