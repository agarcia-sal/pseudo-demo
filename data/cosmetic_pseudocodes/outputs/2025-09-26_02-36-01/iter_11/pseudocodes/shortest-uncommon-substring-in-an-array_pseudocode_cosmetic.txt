CLASS Solution
    FUNCTION shortestSubstrings(arr)
        SET vqr_ztb TO dictionary_with_default_zero()
        FUNCTION dictionary_with_default_zero()
            SET dct TO empty_dictionary()
            RETURN dct
        END FUNCTION

        SET mcn_kls TO 0
        FUNCTION length_of(string)
            SET pfx_rjg TO 0
            WHILE pfx_rjg < count_chars(string)
                SET pfx_rjg TO pfx_rjg + 1
            END WHILE
            RETURN pfx_rjg
        END FUNCTION

        SET xvy_nmp TO 0
        SET kvz_ycd TO 0
        SET sry_utg TO ""
        SET frc_axk TO ""
        SET answer TO empty_list()
        SET size_str TO 0

        FUNCTION substring_of(strng, start_idx, end_idx)
            SET res TO ""
            SET pos TO start_idx
            WHILE pos < end_idx
                SET res TO res + char_at(strng, pos)
                SET pos TO pos + 1
            END WHILE
            RETURN res
        END FUNCTION

        FUNCTION char_at(st, idx)
            RETURN st[idx]
        END FUNCTION

        SET itr0 TO 0
        WHILE itr0 < length_of(arr)
            SET cbl_jvr TO arr[itr0]
            SET len_agh TO length_of(cbl_jvr)
            SET itr1 TO 0
            WHILE itr1 < len_agh
                SET itr2 TO itr1 + 1
                WHILE itr2 <= len_agh
                    SET sbv_ocz TO substring_of(cbl_jvr, itr1, itr2)
                    IF exists_in_dictionary(vqr_ztb, sbv_ocz) THEN
                        SET vqr_ztb[sbv_ocz] TO vqr_ztb[sbv_ocz] + 1
                    ELSE
                        SET vqr_ztb[sbv_ocz] TO 1
                    END IF
                    SET itr2 TO itr2 + 1
                END WHILE
                SET itr1 TO itr1 + 1
            END WHILE
            SET itr0 TO itr0 + 1
        END WHILE

        SET jdh_bgi TO 0
        WHILE jdh_bgi < length_of(arr)
            SET ltg_won TO arr[jdh_bgi]
            SET uck_lph TO length_of(ltg_won)
            SET yxs_qmr TO ""
            SET ytg_wvf TO ""
            SET jrt_bnv TO 0
            WHILE jrt_bnv < uck_lph
                SET kxp_uls TO jrt_bnv + 1
                WHILE kxp_uls <= uck_lph
                    SET bzr_qfp TO substring_of(ltg_won, jrt_bnv, kxp_uls)
                    IF (get_dict_value_or_zero(vqr_ztb, bzr_qfp) = 1) THEN
                        IF (yxs_qmr = "") OR (length_of(bzr_qfp) < length_of(yxs_qmr)) OR ((length_of(bzr_qfp) = length_of(yxs_qmr)) AND (bzr_qfp < yxs_qmr)) THEN
                            SET yxs_qmr TO bzr_qfp
                        END IF
                    END IF
                    SET kxp_uls TO kxp_uls + 1
                END WHILE
                SET jrt_bnv TO jrt_bnv + 1
            END WHILE
            APPEND yxs_qmr TO answer
            SET jdh_bgi TO jdh_bgi + 1
        END WHILE

        RETURN answer
    END FUNCTION
END CLASS