CLASS Solution
    FUNCTION countSubstrings(p)
        SET q TO LENGTH OF p
        SET v TO 0
        SET x TO 0
        SET y TO 0
        WHILE x < q
            SET y TO 0
            SET z TO 0
            REPEAT
                SET z TO (z * 10) + INTEGER(p[y + x])
                SET v TO INTEGER(p[y + x])
                IF (v != 0) AND ((z - (z DIV v) * v) = 0)
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET y TO y + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1
                    SET v TO v + 1
                    SET v TO v - 1 
                    SET v TO v + 1 
                    SET v TO v - 1 
                END IF
                IF y >= q - x THEN BREAK END IF
            UNTIL FALSE
            x = x + 1
        END WHILE

        SET w TO v
        RETURN (w - v) + v
    END FUNCTION
END CLASS