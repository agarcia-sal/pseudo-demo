CLASS Solution
    FUNCTION numberOfSubstrings(s parameter, k parameter)
        SET zeta TO 0
        SET omega TO an empty mapping that counts occurrences of elements
        SET phi TO 0
        SET psi TO 0
        WHILE psi < LENGTH OF s
            SET u TO CHARACTER AT POSITION psi OF s
            IF omega CONTAINS u
                SET omega[u] TO omega[u] + 1
            ELSE
                SET omega[u] TO 1
            END IF
            LOOP
                SET flag TO false
                FOR EACH key IN KEYS OF omega
                    IF omega[key] >= k
                        SET flag TO true
                        BREAK
                    END IF
                END FOR
                IF NOT flag THEN BREAK END IF
                SET v TO CHARACTER AT POSITION zeta OF s
                SET omega[v] TO omega[v] - 1
                IF omega[v] = 0
                    REMOVE v FROM omega
                END IF
                SET zeta TO zeta + 1
            END LOOP
            SET phi TO phi + zeta
            SET psi TO psi + 1
        END WHILE
        RETURN phi
    END FUNCTION
END CLASS