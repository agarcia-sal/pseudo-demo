CLASS Solution  
    FUNCTION minimumSubstringsInPartition(s)  
        FUNCTION dfs(xz)  
            SET zk TO FALSE  
            IF (xz >= LENGTH(s)) THEN  
                SET zk TO TRUE  
            END IF  
            IF zk THEN  
                RETURN 0  
            END IF  
            SET qol TO Map WITH DEFAULT 0  
            SET mbr TO Map WITH DEFAULT 0  
            SET wte TO LENGTH(s) - xz  
            FOR yv FROM xz TO (LENGTH(s) - 1) DO  
                SET uqw TO s[yv]  
                IF uqw IN qol AND qol[uqw] != 0 THEN  
                    SET mbr[qol[uqw]] TO mbr[qol[uqw]] - 1  
                    IF mbr[qol[uqw]] == 0 THEN  
                        DELETE mbr[qol[uqw]]  
                    END IF  
                END IF  
                SET qol[uqw] TO qol[uqw] + 1  
                SET mbr[qol[uqw]] TO mbr[qol[uqw]] + 1  
                IF LENGTH(SET OF KEYS(mbr)) == 1 THEN  
                    SET fkp TO 1 + dfs(yv + 1)  
                    IF fkp < wte THEN  
                        SET wte TO fkp  
                    END IF  
                END IF  
            END FOR  
            RETURN wte  
        END FUNCTION  
        SET cde TO LENGTH(s)  
        RETURN dfs(0)  
    END FUNCTION  
END CLASS