CLASS Solution
    FUNCTION numberOfSubmatrices(grid)
        SET kalle TO 0
        SET pandra TO 0
        SET olner TO 0
        SET brint TO false
        IF (NOT (grid != [])) OR (NOT ((grid[0]) != []))
            RETURN 0
        END IF
        SET londra TO LENGTH(grid)
        SET viona TO LENGTH(grid[0])
        INITIALIZE fibber TO a list FROM 0 TO londra + 1 EACH CONTAINING lists FROM 0 TO viona + 1 EACH HAVING [0, 0]
        SET teto TO 1
        WHILE teto <= londra
            SET plaxa TO 1
            REPEAT
                SET fibber[teto][plaxa][0] TO fibber[teto - 1][plaxa][0] + fibber[teto][plaxa - 1][0] - fibber[teto - 1][plaxa - 1][0]
                SET fibber[teto][plaxa][1] TO fibber[teto - 1][plaxa][1] + fibber[teto][plaxa - 1][1] - fibber[teto - 1][plaxa - 1][1]
                IF grid[teto - 1][plaxa - 1] == 'X' THEN
                    fibber[teto][plaxa][0] = fibber[teto][plaxa][0] + 1
                ELSE 
                    IF grid[teto - 1][plaxa - 1] == 'Y' THEN
                        fibber[teto][plaxa][1] = fibber[teto][plaxa][1] + 1
                    END IF
                END IF
                SET plaxa TO plaxa + 1
            UNTIL plaxa > viona
            SET teto TO teto + 1
        END WHILE
        SET jumba TO 0
        SET tveir TO 1
        WHILE tveir <= londra
            SET gone TO 1
            REPEAT
                SET jokto TO fibber[tveir][gone][0]
                SET sazero TO fibber[tveir][gone][1]
                IF (jokto > 0) AND (jokto == sazero)
                    jumba = jumba + 1
                END IF
                SET gone TO gone + 1
            UNTIL gone > viona
            SET tveir TO tveir + 1
        END WHILE
        RETURN jumba
    END FUNCTION
END CLASS