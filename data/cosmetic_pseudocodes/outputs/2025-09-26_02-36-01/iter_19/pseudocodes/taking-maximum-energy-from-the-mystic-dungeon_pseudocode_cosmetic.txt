CLASS Solution
    FUNCTION maximumEnergy(energy, k)
        SET size TO LENGTH OF energy
        SET table TO an ARRAY of zeros with length size
        SET last_index TO size - 1
        SET table[last_index] TO energy[last_index]
        SET result TO table[last_index]
        INITIALIZE queue AS a new deque containing last_index

        INITIALIZE index TO last_index - 1
        WHILE index >= 0
            WHILE LENGTH OF queue > 0 AND (queue[0] - index) >= k
                REMOVE queue[0]
            END WHILE

            SET current_value TO energy[index] + table[queue[0]]
            SET table[index] TO current_value

            IF result < current_value THEN
                SET result TO current_value
            END IF

            WHILE LENGTH OF queue > 0 AND table[index] >= table[queue[-1]]
                REMOVE queue[-1]
            END WHILE

            APPEND index TO queue
            SET index TO index - 1
        END WHILE

        RETURN result
    END FUNCTION
END CLASS