CLASS Solution
    FUNCTION countPairsOfConnectableServers(edges, signalSpeed)
    
      SET alpha TO mapping defaulting to empty list
      FOR each triple x y z IN edges DO
        APPEND (y, z) TO alpha[x]
        APPEND (x, z) TO alpha[y]
      END FOR

      SET omega TO LENGTH(alpha)
      SET sigma TO LIST of omega zeros

      FUNCTION dfs(epsilon, delta, gamma, theta)
        IF (gamma MOD signalSpeed) = 0 THEN
          APPEND epsilon TO theta
        END IF

        SET phi TO 0

        FOR EACH (iota, kappa) IN alpha[epsilon] DO
          IF iota â‰  delta THEN
            SET phi TO phi + dfs(iota, epsilon, gamma + kappa, theta)
          END IF
        END FOR

        IF (gamma MOD signalSpeed) = 0 THEN RETURN phi + 1 ELSE RETURN phi END IF
      END FUNCTION

      FUNCTION count_pairs_through_c(lambda)
        SET chi TO empty list

        FOR EACH (mu, nu) IN alpha[lambda] DO
          SET psi TO empty list
          CALL dfs(mu, lambda, nu, psi)
          APPEND psi TO chi
        END FOR

        SET tau TO 0
        SET rho TO LENGTH(chi)

        FOR xi FROM 0 TO rho - 2 DO
          FOR upsilon FROM xi + 1 TO rho - 1 DO
            SET tau TO tau + LENGTH(chi[xi]) * LENGTH(chi[upsilon])
          END FOR
        END FOR

        RETURN tau
      END FUNCTION

      FOR zeta FROM 0 TO omega - 1 DO
        SET sigma[zeta] TO count_pairs_through_c(zeta)
      END FOR

      RETURN sigma
    END FUNCTION
END CLASS