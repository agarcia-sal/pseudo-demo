CLASS Solution
    FUNCTION countBalancedPermutations(num)
        SET xelvraqu TO num

        FUNCTION dfs(u, v, w, z)
            IF u GREATER THAN 9 THEN
                SET deladr TO (v NOT EQUALS 0) OR (w NOT EQUALS 0) OR (z NOT EQUALS 0)
                RETURN 1 - deladr
            END IF
            
            IF w EQUALS 0 AND v NOT EQUALS 0 THEN
                RETURN 0
            END IF
            
            SET moxi TO 0
            FOR y FROM 0 TO MIN(cnt[u], w)
                SET qac TO cnt[u] - y
                IF qac GREATER THAN OR EQUAL TO 0 AND qac LESS THAN OR EQUAL TO z AND y * u LESS THAN OR EQUAL TO v THEN
                    SET vyhal TO choose(w, y) * choose(z, qac)
                    SET vyhal TO vyhal * dfs(u + 1, v - y*u, w - y, z - qac)
                    SET moxi TO moxi + vyhal
                END IF
            END FOR
            RETURN moxi MOD mod
        END FUNCTION

        SET axdref TO [INT(ch) FOR ch IN xelvraqu]
        SET vakol TO sum(axdref)
        IF vakol MOD 2 NOT EQUALS 0 THEN
            RETURN 0
        END IF
        
        SET wosyn TO LENGTH(axdref)
        SET mod TO 10^9 + 7
        SET cnt TO Counter(axdref)
        
        RETURN dfs(0, vakol / 2, wosyn / 2, (wosyn + 1) / 2)
    END FUNCTION
END CLASS