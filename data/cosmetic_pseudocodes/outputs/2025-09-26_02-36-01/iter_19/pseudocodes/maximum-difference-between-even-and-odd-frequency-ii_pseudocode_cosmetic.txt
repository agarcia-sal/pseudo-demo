CLASS Solution
    FUNCTION maxDifference WITH PARAMETERS t u
        SET omega TO negative infinity
        SET couples TO list of pairs x y WHERE x IS element FROM string "zeroonetwothreefour" AND y IS element FROM string "zeroonetwothreefour" AND x IS NOT EQUALS y
        FOR every pair x y IN couples
            SET zeta TO default dictionary WITH default value infinity
            SET alpha TO list CONTAINING 0
            SET beta TO list CONTAINING 0
            SET delta TO 0
            FOR each pair psi phi OBTAINED BY enumerating characters of t
                SET rho TO last element of alpha
                SET sigma TO last element of beta
                IF phi EQUALS x THEN
                    SET xi TO rho + 1
                ELSE
                    SET xi TO 0
                END IF
                APPEND xi TO alpha
                IF phi EQUALS y THEN
                    SET upsilon TO sigma + 1
                ELSE
                    SET upsilon TO 0
                END IF
                APPEND upsilon TO beta
                WHILE (psi - delta + 1) >= u AND alpha[delta] < alpha[last element index of alpha] AND beta[delta] < beta[last element index of beta]
                    SET lambda TO (alpha[delta] MOD 2, beta[delta] MOD 2)
                    SET tau TO alpha[delta] - beta[delta]
                    IF lambda NOT IN zeta THEN
                        SET zeta[lambda] TO tau
                    ELSE
                        IF tau < zeta[lambda] THEN
                            SET zeta[lambda] TO tau
                        END IF
                    END IF
                    SET delta TO delta + 1
                END WHILE
                SET mu TO (1 - (alpha[last element index of alpha] MOD 2), beta[last element index of beta] MOD 2)
                SET chi TO alpha[last element index of alpha] - beta[last element index of beta] - zeta[mu]
                IF chi > omega THEN
                    SET omega TO chi
                END IF
            END FOR
        END FOR
        RETURN omega
    END FUNCTION
END CLASS