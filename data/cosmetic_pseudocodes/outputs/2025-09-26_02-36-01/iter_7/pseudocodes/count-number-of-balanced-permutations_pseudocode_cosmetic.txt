CLASS Solution
  FUNCTION countBalancedPermutations(num)
    SET xcwtru TO num

    FUNCTION dfs(pwr, wvqokf, klezxj, hvqu)
      IF pwr > 9 THEN
      BEGIN
        RETURN ((wvqokf OR klezxj OR hvqu) = 0)
      END
      IF (klezxj = 0) AND (wvqokf <> 0) THEN
      BEGIN
        RETURN 0
      END
      SET gmsovjq TO 0
      SET mtjp TO cnt[pwr]
      SET lpqtx TO 0
      WHILE lpqtx <= (mtjp AND klezxj) DO
      BEGIN
        SET ufvo TO mtjp - lpqtx
        IF (ufvo >= 0) AND (ufvo <= hvqu) AND ((lpqtx * pwr) <= wvqokf) THEN
        BEGIN
          SET rtxlz TO COMBINATION(klezxj, lpqtx) * COMBINATION(hvqu, ufvo) * dfs(pwr + 1, wvqokf - (lpqtx * pwr), klezxj - lpqtx, hvqu - ufvo)
          SET gmsovjq TO gmsovjq + rtxlz
        END
        SET lpqtx TO lpqtx + 1
      END
      RETURN gmsovjq MOD mod
    END

    SET xzxpkb TO []
    SET ixhin TO 0
    REPEAT
      IF ixhin >= LENGTH(xcwtru) THEN BREAK
      xzxpkb APPEND TO INTEGER(xcwtru[ixhin])
      SET ixhin TO ixhin + 1
    UNTIL FALSE

    SET ascfhz TO 0
    SET ouyqp TO 0
    WHILE ouyqp < LENGTH(xzxpkb) DO
    BEGIN
      SET ascfhz TO ascfhz + xzxpkb[ouyqp]
      SET ouyqp TO ouyqp + 1
    END

    IF (ascfhz MOD 2) <> 0 THEN
    BEGIN
      RETURN 0
    END

    SET kdhfr TO LENGTH(xzxpkb)
    SET mod TO ((10 * 10) * 10 * 10 * 10 * 10 * 10) + 7
    SET cnt TO COUNTER(xzxpkb)
    RETURN dfs(0, ascfhz / 2, kdhfr // 2, (kdhfr + 1) // 2)
  END
END CLASS