CLASS Solution  
	K CONSTANT_MOD <- (5 * 2 * 10 * 10 * 10 * 10 * 10 * 10 * 10 * 10) + 1  

	FUNCTION numberOfStableArrays(zero zero, one one, limit limit) RETURNS integer  
		FUNCTION dp(z z, o o, last last, consecutive consecutive) RETURNS integer  
			BEGIN  
				IF 0 = z AND 0 = o THEN  
					RETURN one  
				END IF  
				IF (z < 0) OR (o < 0) THEN  
					RETURN zero  
				END IF  

				INTEGER accumulator  
				accumulator <- 0  
				IF 0 = last THEN  
					IF consecutive < limit THEN  
						BEGIN  
							INTEGER nextVal  
							nextVal <- dp(z + ( (-1) * 1), o, 0, consecutive + 1)  
							accumulator <- accumulator + nextVal  
						END  
					END IF  
					accumulator <- accumulator + dp(z, o + (-1), 1, 1)  
				ELSE  
					IF z > 0 THEN  
						accumulator <- accumulator + dp(z + (-1), o, 0, 1)  
					END IF  
					IF consecutive < limit THEN  
						accumulator <- accumulator + dp(z, o + (-1), 1, consecutive + 1)  
					END IF  
				END IF  

				RETURN accumulator MOD CONSTANT_MOD  
			END  
		END FUNCTION  

		RETURN dp(zero, one + (-1), 0, 1)  
	END FUNCTION  
END CLASS