CLASS Solution
    FUNCTION maxDifference WITH PARAMETERS s k
        SET Wd TO negative integer minimum
        SET ZI TO ["zero","one","two","three","four"]
        SET QR TO empty LIST
        FOR idx1 FROM 0 TO length of ZI MINUS 1
            FOR idx2 FROM 0 TO length of ZI MINUS 1
                IF idx1 NOT EQUAL TO idx2 THEN
                    APPEND (ZI[idx1], ZI[idx2]) TO QR
                END IF
            END FOR
        END FOR
        FOR EACH (A, B) IN QR
            SET XL TO dictionary WITH default value positive infinity
            SET NB TO [0]
            SET FT TO [0]
            SET RG TO 0
            SET NS TO length of s
            WHILE RG LESS THAN NS
                SET CG TO s[RG]
                SET lastNB TO NB[length of NB MINUS 1]
                SET lastFT TO FT[length of FT MINUS 1]
                IF CG EQUALS A THEN
                    APPEND lastNB PLUS 1 TO NB
                ELSE
                    APPEND 0 TO NB
                END IF
                IF CG EQUALS B THEN
                    APPEND lastFT PLUS 1 TO FT
                ELSE
                    APPEND 0 TO FT
                END IF
                WHILE (RG MINUS LQ PLUS 1) GREATER THAN OR EQUAL TO k AND NB[LQ] LESS THAN NB[length of NB MINUS 1] AND FT[LQ] LESS THAN FT[length of FT MINUS 1]
                    SET MK TO (NB[LQ] MOD 2, FT[LQ] MOD 2)
                    SET XL[MK] TO minimum of XL[MK] AND NB[LQ] MINUS FT[LQ]
                    SET LQ TO LQ PLUS 1
                END WHILE
                SET lastNBV TO NB[length of NB MINUS 1]
                SET lastFTV TO FT[length of FT MINUS 1]
                SET QK TO ( (1 MINUS lastNBV MOD 2), (lastFTV MOD 2) )
                SET PX TO lastNBV MINUS lastFTV MINUS XL[QK]
                SET Wd TO maximum of Wd AND PX
                INCREMENT RG BY 1
            END WHILE
        END FOR
        RETURN Wd
    END FUNCTION
END CLASS