CLASS Solution
    FUNCTION getPermutationIndex(perm)
        SET q TO (10 ^ 9) + 1
        SET r TO LENGTH(perm)
        SET t TO ARRAY OF SIZE r WITH ALL ELEMENTS = 1
        
        SET s TO 1
        WHILE s < r
            SET t[s] TO t[s - 1] * s
            SET s TO s + 1
        END WHILE
        
        SET u TO LIST FROM 1 TO r
        
        SET v TO 0
        SET w TO 0
        REPEAT
            IF w = r THEN
                BREAK
            END IF
            
            SET x TO 0
            REPEAT
                IF u[x] = perm[w] THEN
                    EXIT
                END IF
                SET x TO x + 1
            UNTIL x = LENGTH(u)
            
            SET v TO v + x * t[r - w - 1]
            REMOVE u[x]
            
            SET w TO w + 1
        UNTIL FALSE
        
        RETURN v MOD q
    END FUNCTION
END CLASS