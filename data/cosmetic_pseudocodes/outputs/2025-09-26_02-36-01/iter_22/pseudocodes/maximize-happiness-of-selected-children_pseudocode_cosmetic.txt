CLASS Solution
    FUNCTION maximumHappinessSum(happiness, k)
        DEFINE FUNCTION sortDescending(arr)
            DEFINE FUNCTION swapElements(a, b)
                SET temp TO arr[a]
                SET arr[a] TO arr[b]
                SET arr[b] TO temp
            END FUNCTION
            SET n TO 1
            WHILE n LESS THAN LENGTH(arr)
                SET j TO 0
                WHILE j LESS THAN LENGTH(arr) MINUS n
                    IF arr[j] LESS THAN arr[j + 1]
                        CALL swapElements(j, j + 1)
                    END IF
                    INCREMENT j BY 1
                END WHILE
                INCREMENT n BY 1
            END WHILE
            RETURN arr
        END FUNCTION

        SET orderedList TO CALL sortDescending(happiness)
        SET resultTotal TO 0
        DEFINE PROCEDURE accumulateSum(limit)
            SET count TO 0
            SET reduction TO 0
            WHILE count LESS THAN limit
                SET adjustedVal TO orderedList[count] MINUS reduction
                IF adjustedVal LESS THAN 0
                    SET adjustedVal TO 0
                END IF
                SET resultTotal TO resultTotal PLUS adjustedVal
                INCREMENT reduction BY 1
                INCREMENT count BY 1
            END WHILE
        END PROCEDURE

        CALL accumulateSum(k)
        RETURN resultTotal
    END FUNCTION
END CLASS