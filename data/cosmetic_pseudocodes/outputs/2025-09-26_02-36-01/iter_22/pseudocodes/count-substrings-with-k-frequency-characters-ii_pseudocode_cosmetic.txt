CLASS Solution

    FUNCTION numberOfSubstrings(s parameter, k parameter)
    
        PROCEDURE adjustCount(mappingRef, keyVal, deltaVal)
            IF mappingRef CONTAINS keyVal THEN
                SET mappingRef[keyVal] TO mappingRef[keyVal] + deltaVal
            ELSE
                IF deltaVal > 0 THEN
                    SET mappingRef[keyVal] TO deltaVal
                END IF
            END IF
            IF mappingRef CONTAINS keyVal AND mappingRef[keyVal] = 0 THEN
                REMOVE keyVal FROM mappingRef
            END IF
        END PROCEDURE

        SET accumulator TO 0
        SET tracker TO dictionary()
        SET front TO 0

        SET back TO 0

        WHILE back < LENGTH(s)
            CALL adjustCount(tracker, s[back], 1)
            
            WHILE NOT (FOR ALL key IN tracker : tracker[key] < k)
                
                CALL adjustCount(tracker, s[front], -1)
                SET front TO front + 1
            END WHILE

            SET accumulator TO accumulator + front
            SET back TO back + 1
        END WHILE

        RETURN accumulator
    END FUNCTION

END CLASS