CLASS Solution
    FUNCTION countBalancedPermutations(num)
        SET fjqornht TO num
        FUNCTION dfs(pyr, xehk, vilo, eman)
            IF NOT (pyr LESS OR EQUAL nine)
                RETURN (xehk NOT EQUAL zero) EQUALS FALSE AND (vilo EQUAL zero) AND (eman EQUAL zero)
            END IF
            IF (vilo EQUAL zero) AND (xehk NOT EQUAL zero)
                RETURN zero
            END IF
            SET hwyqav TO 0
            SET omkynq TO 0
            WHILE omkynq LESS OR EQUAL cnt[pyr] AND omkynq LESS OR EQUAL vilo
                SET mcbzvpi TO cnt[pyr] MINUS omkynq
                IF mcbzvpi GREATER OR EQUAL zero AND mcbzvpi LESS OR EQUAL eman AND (omkynq MULTIPLY pyr) LESS OR EQUAL xehk
                    SET ymwxe TO dfs(pyr PLUS 1, xehk MINUS (omkynq MULTIPLY pyr), vilo MINUS omkynq, eman MINUS mcbzvpi)
                    SET hwyqav TO hwyqav PLUS (Combination(vilo, omkynq) MULTIPLY Combination(eman, mcbzvpi) MULTIPLY ymwxe)
                END IF
                SET omkynq TO omkynq PLUS 1
            END WHILE
            RETURN hwyqav MODULO mod
        END FUNCTION

        SET kuplafx TO []
        SET idx_vjf TO 0
        WHILE idx_vjf LESS THAN LENGTH(fjqornht)
            SET kuplafx TO kuplafx + [INTEGER(fjqornht[idx_vjf])]
            SET idx_vjf TO idx_vjf PLUS 1
        END WHILE

        SET uqlkop TO 0
        SET oprvaj TO 0
        WHILE oprvaj LESS THAN LENGTH(kuplafx)
            SET uqlkop TO uqlkop PLUS kuplafx[oprvaj]
            SET oprvaj TO oprvaj PLUS 1
        END WHILE

        IF NOT ((uqlkop MODULO 2) EQUAL zero)
            RETURN zero
        END IF

        SET vkrapu TO LENGTH(kuplafx)
        SET mod TO (10 POWER 9) PLUS 7

        // Counting frequency of digits in kuplafx
        SET cnt TO EMPTY_DICTIONARY
        SET zbkyh TO 0
        WHILE zbkyh LESS THAN vkrapu
            IF kuplafx[zbkyh] NOT IN cnt
                SET cnt[kuplafx[zbkyh]] TO 0
            END IF
            SET cnt[kuplafx[zbkyh]] TO cnt[kuplafx[zbkyh]] PLUS 1
            SET zbkyh TO zbkyh PLUS 1
        END WHILE

        RETURN dfs(zero, uqlkop DIVIDED 2, vkrapu DIVIDED 2, (vkrapu PLUS 1) DIVIDED 2)
    END FUNCTION
END CLASS