CLASS Solution  
    FUNCTION numberOfStableArrays(zero zero, one one, limit limit) RETURNS integer  
        DECLARE moduloBase AS (1000000000 PLUS 1)  
  
        FUNCTION dp(z zVal, o oVal, last lastDigit, consecutive countConsecutive) RETURNS integer  
            IF (zVal EQUALS zero AND oVal EQUALS zero) THEN  
                RETURN one  
            ELSE IF (zVal LESS THAN zero OR oVal LESS THAN zero) THEN  
                RETURN zero  
            END IF  
  
            DECLARE accumulator AS zero  
  
            IF (lastDigit EQUALS zero) THEN  
                IF (countConsecutive LESS THAN limit) THEN  
                    DECLARE tempResult AS dp(zVal MINUS one, oVal, zero, countConsecutive PLUS one)  
                    accumulator = accumulator PLUS tempResult  
                END IF  
                DECLARE otherResult AS dp(zVal, oVal MINUS one, one, one)  
                accumulator = accumulator PLUS otherResult  
            ELSE  
                IF (zVal GREATER THAN zero) THEN  
                    DECLARE partialResult AS dp(zVal MINUS one, oVal, zero, one)  
                    accumulator = accumulator PLUS partialResult  
                END IF  
                IF (countConsecutive LESS THAN limit) THEN  
                    DECLARE addResult AS dp(zVal, oVal MINUS one, one, countConsecutive PLUS one)  
                    accumulator = accumulator PLUS addResult  
                END IF  
            END IF  
  
            DECLARE finalValue AS accumulator MODULO moduloBase  
            RETURN finalValue  
        END FUNCTION  
  
        RETURN dp(zero, one MINUS one, zero, zero)  
    END FUNCTION  
END CLASS