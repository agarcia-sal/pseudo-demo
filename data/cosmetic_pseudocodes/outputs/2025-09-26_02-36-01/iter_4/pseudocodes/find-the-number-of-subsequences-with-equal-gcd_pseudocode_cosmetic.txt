CLASS Solution  
    FUNCTION subsequencePairCount(nums)  
        DECLARE CONST MODULO AS 1000000007  
        DECLARE max_value AS max element in nums  
        DECLARE dp_table AS a 2D array sized (max_value + 1) by (max_value + 1) filled with zeros  
        ASSIGN dp_table[0][0] TO 1  

        DECLARE index AS 0  
        WHILE index < length of nums DO  
            DECLARE current_num AS nums[index]  
            DECLARE temp_dp AS 2D array sized (max_value + 1) by (max_value + 1) initialized with zeros  
            DECLARE i AS 0  
            WHILE i <= max_value DO  
                DECLARE j AS 0  
                WHILE j <= max_value DO  
                    LET val = dp_table[i][j]  
                    LET temp_dp[i][j] = (temp_dp[i][j] + val) MODULO  
                    
                    LET gcd_x_num = gcd(i, current_num)  
                    LET temp_dp[gcd_x_num][j] = (temp_dp[gcd_x_num][j] + val) MODULO  
                    
                    LET gcd_y_num = gcd(j, current_num)  
                    LET temp_dp[i][gcd_y_num] = (temp_dp[i][gcd_y_num] + val) MODULO  
                    
                    INCREMENT j BY 1  
                END WHILE  
                INCREMENT i BY 1  
            END WHILE  
            ASSIGN dp_table TO temp_dp  
            INCREMENT index BY 1  
        END WHILE  

        DECLARE total AS 0  
        DECLARE g_counter AS 1  
        WHILE g_counter <= max_value DO  
            LET total = total + dp_table[g_counter][g_counter]  
            INCREMENT g_counter BY 1  
        END WHILE  
        ASSIGN total TO total MODULO  
        RETURN total  
    END FUNCTION  
END CLASS