CLASS Solution  
    FUNCTION lastNonEmptyString(s)  
        DECLARE frequencyMap AS empty dictionary  
        DECLARE indexCounter AS zero  
        WHILE indexCounter LESS THAN length of s  
            SET currentChar TO character at position indexCounter in s  
            IF currentChar NOT IN frequencyMap THEN  
                ASSIGN frequencyMap[currentChar] TO one  
            ELSE  
                ASSIGN frequencyMap[currentChar] TO frequencyMap[currentChar] PLUS one  
            END IF  
            INCREMENT indexCounter BY one  
        END WHILE  

        DECLARE highestFrequency AS zero  
        FOR EACH keyChar IN frequencyMap KEYS  
            IF frequencyMap[keyChar] GREATER THAN highestFrequency THEN  
                ASSIGN highestFrequency TO frequencyMap[keyChar]  
            END IF  
        END FOR  

        DECLARE charsWithMaxFreq AS empty set  
        FOR EACH keyChar IN frequencyMap KEYS  
            IF frequencyMap[keyChar] EQUALS highestFrequency THEN  
                ADD keyChar TO charsWithMaxFreq  
            END IF  
        END FOR  

        DECLARE collectedChars AS empty list  
        DECLARE pos AS (length of s) MINUS one  
        WHILE pos GREATER THAN OR EQUAL TO zero  
            SET currentCharacter TO character at index pos in s  
            IF currentCharacter IS MEMBER OF charsWithMaxFreq THEN  
                APPEND currentCharacter TO collectedChars  
                REMOVE currentCharacter FROM charsWithMaxFreq  
            END IF  
            DECREMENT pos BY one  
        END WHILE  

        DECLARE outputString AS empty string  
        DECLARE revIndex AS length of collectedChars MINUS one  
        WHILE revIndex GREATER THAN OR EQUAL TO zero  
            SET outputString TO outputString CONCATENATED WITH collectedChars[revIndex]  
            DECREMENT revIndex BY one  
        END WHILE  

        RETURN outputString  
    END FUNCTION  
END CLASS