CLASS Solution

    FUNCTION maximumLength(nums k)
        DECLARE lengthNums AS LENGTH OF nums
        DECLARE dpMatrix AS LIST OF LISTS WITH lengthNums ROWS AND (k PLUS 1) COLUMNS EACH FILLED WITH integer ONE
        DECLARE maxAnswer AS number ZERO
        
        DECLARE currentIndex AS number ZERO
        WHILE currentIndex LESS THAN lengthNums
            DECLARE currentValue AS nums AT currentIndex
            DECLARE hValue AS number ZERO
            WHILE hValue LESS THAN OR EQUAL TO k
                DECLARE previousIndex AS number ZERO
                WHILE previousIndex LESS THAN currentIndex
                    DECLARE previousValue AS nums AT previousIndex
                    IF currentValue EQUALS previousValue THEN
                        DECLARE candidate1 AS dpMatrix AT currentIndex AT hValue
                        DECLARE candidate2 AS dpMatrix AT previousIndex AT hValue PLUS one
                        IF candidate2 GREATER THAN candidate1 THEN
                            SET dpMatrix AT currentIndex AT hValue TO candidate2
                        END IF
                    ELSE
                        IF hValue GREATER THAN ZERO THEN
                            DECLARE candidateA AS dpMatrix AT currentIndex AT hValue
                            DECLARE candidateB AS dpMatrix AT previousIndex AT (hValue MINUS one) PLUS one
                            IF candidateB GREATER THAN candidateA THEN
                                SET dpMatrix AT currentIndex AT hValue TO candidateB
                            END IF
                        END IF
                    END IF
                    INCREMENT previousIndex BY one
                END WHILE
                INCREMENT hValue BY one
            END WHILE
            
            IF dpMatrix AT currentIndex AT k GREATER THAN maxAnswer THEN
                SET maxAnswer TO dpMatrix AT currentIndex AT k
            END IF
            INCREMENT currentIndex BY one
        END WHILE

        RETURN maxAnswer
    END FUNCTION

END CLASS