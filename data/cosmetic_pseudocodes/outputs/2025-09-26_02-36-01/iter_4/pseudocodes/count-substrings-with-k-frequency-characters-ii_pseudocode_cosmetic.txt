CLASS Solution
    FUNCTION numberOfSubstrings(s parameter, k parameter)
        DECLARE frequencyMap AS an empty dictionary with default integer zero
        DECLARE totalSubstrings AS 0
        DECLARE leftIndex AS 0
        DECLARE currentIndex AS 0
        WHILE currentIndex LESS THAN LENGTH OF s
            LET currentChar BE s AT currentIndex
            SET frequencyMap[currentChar] TO frequencyMap[currentChar] PLUS 1
            DECLARE hasCharWithCountAtLeastK AS FALSE
            FOR each key IN frequencyMap KEYS
                IF frequencyMap[key] GREATER THAN OR EQUAL TO k
                    SET hasCharWithCountAtLeastK TO TRUE
                END IF
            END FOR
            WHILE hasCharWithCountAtLeastK IS TRUE
                LET leftChar BE s AT leftIndex
                SET frequencyMap[leftChar] TO frequencyMap[leftChar] MINUS 1
                IF frequencyMap[leftChar] EQUALS 0
                    REMOVE leftChar FROM frequencyMap
                END IF
                INCREASE leftIndex BY 1

                SET hasCharWithCountAtLeastK TO FALSE
                FOR EACH key IN frequencyMap KEYS
                    IF frequencyMap[key] GREATER THAN OR EQUAL TO k
                        SET hasCharWithCountAtLeastK TO TRUE
                    END IF
                END FOR
            END WHILE
            SET totalSubstrings TO totalSubstrings PLUS leftIndex
            INCREMENT currentIndex BY 1
        END WHILE
        RETURN totalSubstrings
    END FUNCTION
END CLASS