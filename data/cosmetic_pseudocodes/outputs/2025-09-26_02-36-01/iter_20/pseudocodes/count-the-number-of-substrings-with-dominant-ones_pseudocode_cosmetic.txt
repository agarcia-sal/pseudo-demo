CLASS Solution  
    FUNCTION numberOfSubstrings(s)  
        FUNCTION customLen(x)  
            SET accumulator TO 0  
            SET cursor TO 0  
            WHILE (cursor LESS THAN x LENGTH) DO  
                SET accumulator TO accumulator PLUS 1  
                SET cursor TO cursor PLUS 1  
            END WHILE  
            RETURN accumulator  
        END FUNCTION  
  
        FUNCTION isOne(ch)  
            RETURN (ch EQUALS '1')  
        END FUNCTION  
  
        SET alpha TO customLen(s)  
        SET omega TO 0  
  
        FUNCTION processRange(startIndex, endIndex, onesAccum, zerosAccum)  
            IF (endIndex GREATER THAN OR EQUAL TO startIndex) THEN  
                SET currentChar TO s GET_AT endIndex  
                IF isOne(currentChar) THEN  
                    SET repartitionedOnes TO onesAccum PLUS 1  
                    SET repartitionedZeros TO zerosAccum  
                ELSE  
                    SET repartitionedOnes TO onesAccum  
                    SET repartitionedZeros TO zerosAccum PLUS 1  
                END IF  
                IF repartitionedOnes GREATER THAN OR EQUAL TO repartitionedZeros TIMES repartitionedZeros THEN  
                    SET incrementedCount TO 1  
                ELSE  
                    SET incrementedCount TO 0  
                END IF  
                RETURN incrementedCount PLUS processRange(startIndex, endIndex MINUS 1, onesAccum, zerosAccum)  
            ELSE  
                RETURN 0  
            END IF  
        END FUNCTION  
  
        SET i TO 0  
        WHILE i LESS THAN alpha DO  
            SET omega TO omega PLUS processRange(i, alpha MINUS 1, 0, 0)  
            SET i TO i PLUS 1  
        END WHILE  
  
        RETURN omega  
    END FUNCTION  
END CLASS