CLASS Solution
    FUNCTION countBalancedPermutations(num)
        SET xufrhzap TO num

        FUNCTION rzkej(z, w, y, v)
            IF z GREATER THAN 9 THEN
                RETURN (w OR y OR v) EQUALS 0
            END IF

            IF (y EQUALS 0) AND (w NOT EQUALS 0) THEN
                RETURN 0
            END IF

            SET ucivklwr TO 0

            SET rqaty TO 0
            WHILE rqaty LESS THAN OR EQUAL TO MINIMUM(cnt[z], y)
                SET uhqjm TO cnt[z] MINUS rqaty
                IF (uhqjm GREATER THAN OR EQUAL TO 0) AND (uhqjm LESS THAN OR EQUAL TO v) AND ((rqaty TIMES z) LESS THAN OR EQUAL TO w) THEN
                    SET edcbna TO COMBINATION(y, rqaty)
                    SET jlmxvi TO COMBINATION(v, uhqjm)
                    SET ucivklwr TO ucivklwr PLUS (edcbna TIMES jlmxvi TIMES rzkej(z PLUS 1, w MINUS (rqaty TIMES z), y MINUS rqaty, v MINUS uhqjm))
                END IF
                SET rqaty TO rqaty PLUS 1
            END WHILE

            RETURN ucivklwr MOD mod
        END FUNCTION

        FUNCTION COMBINATION(a, b)
            IF (b GREATER THAN a) OR (b LESS THAN 0) THEN
                RETURN 0
            END IF
            RETURN FACTORIAL(a) DIVIDED BY (FACTORIAL(b) TIMES FACTORIAL(a MINUS b))
        END FUNCTION

        FUNCTION FACTORIAL(n)
            SET otpqs TO 1
            SET gdklv TO 2
            WHILE gdklv LESS THAN OR EQUAL TO n
                SET otpqs TO otpqs TIMES gdklv
                SET gdklv TO gdklv PLUS 1
            END WHILE
            RETURN otpqs
        END FUNCTION

        SET rxyov TO []
        SET darlp TO 0
        WHILE darlp LESS THAN LENGTH(xufrhzap)
            APPEND INTEGER(xufrhzap[darlp]) TO rxyov
            SET darlp TO darlp PLUS 1
        END WHILE

        SET wrzgh TO 0
        FOR each hlvyn IN rxyov
            SET wrzgh TO wrzgh PLUS hlvyn
        END FOR

        IF (wrzgh MOD 2) NOT EQUAL TO 0 THEN
            RETURN 0
        END IF

        SET tanpq TO LENGTH(rxyov)
        SET mod TO (10 TIMES 10 TIMES 10 TIMES 10 TIMES 10 TIMES 10 TIMES 10 TIMES 10 TIMES 10) PLUS 7

        FUNCTION COUNTER(lst)
            SET plxkuj TO EMPTY DICTIONARY
            SET jbrmg TO 0
            WHILE jbrmg LESS THAN LENGTH(lst)
                IF lst[jbrmg] IN plxkuj THEN
                    SET plxkuj[lst[jbrmg]] TO plxkuj[lst[jbrmg]] PLUS 1
                ELSE
                    SET plxkuj[lst[jbrmg]] TO 1
                END IF
                SET jbrmg TO jbrmg PLUS 1
            END WHILE
            RETURN plxkuj
        END FUNCTION

        SET cnt TO COUNTER(rxyov)

        RETURN rzkej(0, wrzgh DIV 2, tanpq DIV 2, (tanpq PLUS 1) DIV 2)
    END FUNCTION
END CLASS