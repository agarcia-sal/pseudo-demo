CLASS Solution
    FUNCTION maximumLength(nums)
        SET freq TO an empty mapping
        FOR val IN nums
            IF val NOT IN freq THEN
                SET freq[val] TO 0
            END IF
            SET freq[val] TO freq[val] + 1
        END FOR

        SET memo TO an empty mapping

        FUNCTION recur(z)
            IF z NOT IN freq OR freq[z] < 2 THEN
                IF z IN freq AND freq[z] >= 1 THEN
                    RETURN 1
                ELSE
                    RETURN 0
                END IF
            END IF
            IF z IN memo THEN
                RETURN memo[z]
            END IF
            SET squared TO 0
            SET squared TO z * z
            SET computed TO 0
            SET computed TO recur(squared) + 2
            SET memo[z] TO computed
            RETURN memo[z]
        END FUNCTION

        SET result TO 1

        SET idx_list TO list of keys in freq
        SET pos TO 1
        WHILE pos <= length of idx_list
            SET key TO idx_list[pos]
            IF key == 1 THEN
                SET c TO freq[key]
                SET adjusted TO c - 1 - ((c MOD 2) * 2)
                SET candidate TO adjusted
                IF candidate > result THEN
                    SET result TO candidate
                END IF
            ELSE
                SET candidate_2 TO recur(key)
                IF candidate_2 > result THEN
                    SET result TO candidate_2
                END IF
            END IF
            SET pos TO pos + 1
        END WHILE

        RETURN result
    END FUNCTION
END CLASS