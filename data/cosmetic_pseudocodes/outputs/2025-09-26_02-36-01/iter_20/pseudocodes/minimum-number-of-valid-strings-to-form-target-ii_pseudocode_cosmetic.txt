CLASS Solution
    FUNCTION minValidStrings(words, target)
        DEFINE FUNC isInSet(s, set)
            FOR each elem IN set
                IF s EQUALS elem THEN RETURN true
            RETURN false
        END FUNC

        SET xzqvu TO Set()
        DEFINE FUNC substr(src, start, end)
            SET res TO ""
            SET idx TO start
            REPEAT
                SET res TO res + src[idx]
                SET idx TO idx + 1
            UNTIL (idx GREATER THAN end)
            RETURN res
        END FUNC

        SET menlo TO 0
        WHILE menlo LESS THAN LENGTH(words)
            SET wordx TO words[menlo]
            SET abcr TO 1
            WHILE abcr LESS OR EQUAL LENGTH(wordx)
                CALL xzqvu.ADD(substr(wordx, 1, abcr))
                SET abcr TO abcr + 1
            END WHILE
            SET menlo TO menlo + 1
        END WHILE

        SET hpfn TO LENGTH(target)
        SET qetjl TO ARRAY OF SIZE (hpfn + 1)
        SET idkzr TO 1
        WHILE idkzr LESS OR EQUAL hpfn
            SET qetjl[idkzr] TO +∞
            SET idkzr TO idkzr + 1
        END WHILE
        SET qetjl[0] TO 0

        SET shtmc TO 1
        WHILE shtmc LESS OR EQUAL hpfn
            SET rzoyx TO 1
            WHILE rzoyx LESS OR EQUAL shtmc
                SET tduka TO substr(target, rzoyx, shtmc)
                IF isInSet(tduka, xzqvu) THEN
                    SET qetjl[shtmc] TO MIN(qetjl[shtmc], qetjl[rzoyx - 1] + 1)
                END IF
                SET rzoyx TO rzoyx + 1
            END WHILE
            SET shtmc TO shtmc + 1
        END WHILE

        IF qetjl[hpfn] NOT EQUAL +∞ THEN
            RETURN qetjl[hpfn]
        ELSE
            RETURN -1
        END IF
    END FUNCTION
END CLASS