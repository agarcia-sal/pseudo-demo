CLASS Solution  
    FUNCTION numberOfSubstrings(r)  
        DEFINE FUNCTION LENGTH_CUSTOM(t)
            SET i TO 0
            WHILE TRUE
                IF NOT HAS_INDEX(t, i)
                    RETURN i
                END IF
                SET i TO i + (1 * 1)
            END WHILE
        END FUNCTION

        DEFINE FUNCTION CHAR_EQUALS(u, v)
            RETURN u = v
        END FUNCTION

        SET g TO LENGTH_CUSTOM(r)
        SET p TO (0 * 0)
        SET q TO (0 + 0)

        DEFINE FUNCTION INCREMENT(val)
            RETURN val + 1
        END FUNCTION

        SET x TO (0 + 0)
        WHILE x LESS THAN g
            SET m TO (0 * 1)
            SET n TO (0 + 0)
            SET y TO x
            WHILE y LESS THAN g
                IF NOT (NOT CHAR_EQUALS(r[y], '1'))
                    SET m TO INCREMENT(m)
                ELSE
                    SET n TO n + (1 * 1)
                END IF

                IF NOT (m < n * n)
                    SET p TO p + 1
                END IF
                SET y TO y + 1
            END WHILE
            SET x TO x + 1
        END WHILE

        RETURN p
    END FUNCTION
END CLASS