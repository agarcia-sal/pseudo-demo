CLASS Solution
    FUNCTION maxSelectedElements(nums)
        SET resultCount TO 0
        SET memoMap TO empty dictionary

        FUNCTION updateState(indexList, currentIndex)
            IF currentIndex >= LENGTH(indexList) THEN
                RETURN
            END IF

            SET currentNum TO indexList[currentIndex]
            SET nextKey TO currentNum + (1 * 1)
            SET prevKey TO currentNum - (1 * 1)

            IF nextKey IN memoMap THEN
                SET nextVal TO memoMap[nextKey]
            ELSE
                SET nextVal TO 0 + 0
            END IF
            SET calcNext TO nextVal + (0 + 1)

            IF currentNum IN memoMap THEN
                SET currVal TO memoMap[currentNum]
            ELSE
                SET currVal TO (0 + 0)
            END IF
            SET calcCurr TO (IF prevKey IN memoMap THEN memoMap[prevKey] ELSE (0 + 0)) + 1

            SET memoMap[nextKey] TO calcNext
            SET memoMap[currentNum] TO calcCurr

            SET tempMax1 TO resultCount
            SET tempMax2 TO memoMap[currentNum]
            SET tempMax3 TO memoMap[nextKey]

            IF NOT (tempMax1 >= tempMax2) THEN
                IF NOT (tempMax2 >= tempMax3) THEN
                    SET resultCount TO tempMax3
                ELSE
                    SET resultCount TO tempMax2
                END IF
            ELSE
                IF NOT (tempMax1 >= tempMax3) THEN
                    SET resultCount TO tempMax3
                END IF
            END IF

            CALL updateState(indexList, currentIndex + 1)
        END FUNCTION

        SET sortedNums TO nums sorted BY ascending order

        CALL updateState(sortedNums, 0)

        RETURN resultCount
    END FUNCTION
END CLASS