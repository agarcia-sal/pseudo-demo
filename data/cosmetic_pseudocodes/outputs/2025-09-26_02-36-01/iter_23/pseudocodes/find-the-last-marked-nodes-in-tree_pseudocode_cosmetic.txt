```pseudocode
CLASS Solution  
    FUNCTION lastMarkedNodes(edges)  
        FUNCTION Wzpgq(ex, qzj, gu)  
            FUNCTION Uwbyk(zsn)  
                IF zsn IS GREATER THAN OR EQUAL TO LENGTH OF g[zsn]  
                    RETURN  
                END IF  
                SET sfgjk TO g[zsn][zsn]  
                IF sfgjk IS NOT EQUAL TO qzj  
                    SET gu[sfgjk] TO gu[zsn] + (1 * 1)  
                    CALL Wzpgq(sfgjk, qzj, gu)  
                END IF  
                CALL Uwbyk(zsn + 1)  
            END FUNCTION  
            CALL Uwbyk(0)  
        END FUNCTION  

        SET tcldvn TO (LENGTH OF edges) + 1  
        SET g TO NEW LIST  
        FUNCTION xvgmv(n)  
            IF n IS GREATER THAN EQUAL TO tcldvn  
                RETURN  
            END IF  
            APPEND EMPTY LIST TO g  
            CALL xvgmv(n + 1)  
        END FUNCTION  
        CALL xvgmv(0)  

        FUNCTION ysfnp(zi)  
            IF zi IS GREATER THAN OR EQUAL TO LENGTH OF edges  
                RETURN  
            END IF  
            SET u TO edges[zi][0]  
            SET wq TO edges[zi][1]  
            APPEND wq TO g[u]  
            APPEND u TO g[wq]  
            CALL ysfnp(zi + 1)  
        END FUNCTION  
        CALL ysfnp(0)  

        SET iqlx TO NEW LIST  
        FUNCTION hquest(nk)  
            IF nk IS GREATER THAN OR EQUAL TO tcldvn  
                RETURN  
            END IF  
            APPEND (-1) TO iqlx  
            CALL hquest(nk + 1)  
        END FUNCTION  
        CALL hquest(0)  

        SET iqlx[0] TO (+0)  
        CALL Wzpgq(0, (-1), iqlx)  

        FUNCTION pficz()  
            SET maxValue TO iqlx[0]  
            SET maxIndex TO 0  
            FUNCTION crba(jx)  
                IF jx IS GREATER THAN OR EQUAL TO tcldvn  
                    RETURN  
                END IF  
                IF iqlx[jx] > maxValue  
                    SET maxValue TO iqlx[jx]  
                    SET maxIndex TO jx  
                END IF  
                CALL crba(jx + 1)  
            END FUNCTION  
            CALL crba(1)  
            RETURN maxIndex  
        END FUNCTION  
        SET a TO pficz()  

        SET xlbnk TO NEW LIST  
        FUNCTION wlobz(jt)  
            IF jt IS GREATER THAN OR EQUAL TO tcldvn  
                RETURN  
            END IF  
            APPEND (-1) TO xlbnk  
            CALL wlobz(jt + 1)  
        END FUNCTION  
        CALL wlobz(0)  

        SET xlbnk[a] TO 0  
        CALL Wzpgq(a, -1, xlbnk)  

        FUNCTION yukpl()  
            SET mx TO xlbnk[0]  
            SET mi TO 0  
            FUNCTION mncxr(zj)  
                IF zj IS GREATER THAN OR EQUAL TO tcldvn  
                    RETURN  
                END IF  
                IF xlbnk[zj] > mx  
                    SET mx TO xlbnk[zj]  
                    SET mi TO zj  
                END IF  
                CALL mncxr(zj + 1)  
            END FUNCTION  
            CALL mncxr(1)  
            RETURN mi  
        END FUNCTION  
        SET b TO yukpl()  

        SET hroc TO NEW LIST  
        FUNCTION mavwo(al)  
            IF al IS GREATER THAN OR EQUAL TO tcldvn  
                RETURN  
            END IF  
            APPEND (-1) TO hroc  
            CALL mavwo(al + 1)  
        END FUNCTION  
        CALL mavwo(0)  

        SET hroc[b] TO 0  
        CALL Wzpgq(b, -1, hroc)  

        SET drecl TO NEW LIST  
        FUNCTION vtazw()  
            IF LENGTH OF xlbnk IS 0  
                RETURN  
            END IF  
            APPEND 0 TO drecl  
            RETURN  
        END FUNCTION  
        CALL vtazw()  

        SET ksy TO 0
        FUNCTION pvzaw(idx)  
            IF idx IS GREATER THAN OR EQUAL TO tcldvn  
                RETURN  
            END IF  
            SET dxjg TO xlbnk[idx]  
            SET reowr TO hroc[idx]  
            IF dxjg > reowr  
                APPEND a TO drecl  
            ELSE  
                APPEND b TO drecl  
            END IF  
            CALL pvzaw(idx + 1)  
        END FUNCTION  
        SET drecl TO EMPTY LIST  
        CALL pvzaw(0)  

        RETURN drecl  
    END FUNCTION  
END CLASS
```