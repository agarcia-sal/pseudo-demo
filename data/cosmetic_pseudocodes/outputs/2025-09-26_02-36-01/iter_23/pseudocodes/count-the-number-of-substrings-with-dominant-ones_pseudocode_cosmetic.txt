```pseudocode
CLASS Solution
    FUNCTION numberOfSubstrings(s)
        PROCEDURE iterateEnd(startIndex, accCount)
            PROCEDURE step(i, onesAcc, zerosAcc, countAcc)
                IF i GREATER THAN n SUBTRACT 1 THEN
                    RETURN countAcc
                ELSE
                    IF s AT i EQUALS '1' THEN
                        SET updatedOnes TO onesAcc PLUS 1
                        SET updatedZeros TO zerosAcc
                    ELSE
                        SET updatedOnes TO onesAcc
                        SET updatedZeros TO zerosAcc PLUS 1
                    END IF
                    IF updatedOnes GREATER THAN OR EQUAL TO updatedZeros TIMES updatedZeros THEN
                        SET newCount TO countAcc PLUS 1
                    ELSE
                        SET newCount TO countAcc
                    END IF
                    RETURN step(i PLUS 1, updatedOnes, updatedZeros, newCount)
                END IF
            END PROCEDURE
            RETURN step(startIndex, 0, 0, accCount)
        END PROCEDURE

        PROCEDURE iterateStart(j, total)
            IF j GREATER THAN n SUBTRACT 1 THEN
                RETURN total
            ELSE
                SET newTotal TO iterateEnd(j, total)
                RETURN iterateStart(j PLUS 1, newTotal)
            END IF
        END PROCEDURE

        SET n TO LENGTH OF s
        RETURN iterateStart(0, 0)
    END FUNCTION
END CLASS
```