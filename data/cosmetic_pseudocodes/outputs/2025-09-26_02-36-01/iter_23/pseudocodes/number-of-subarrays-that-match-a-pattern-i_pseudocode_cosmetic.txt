```  
CLASS Solution  
    FUNCTION countMatchingSubarrays(nums parameter, pattern parameter)  
        SET lenNums TO LENGTH(nums parameter)  
        SET lenPattern TO LENGTH(pattern parameter)  
        SET tally TO 0  

        FUNCTION checkMatch(index parameter, offset parameter)  
            IF offset parameter GREATER THAN OR EQUAL TO lenPattern THEN  
                RETURN True  
            END IF  

            SET patElem TO pattern parameter AT offset parameter  
            SET currNum TO nums parameter AT (index parameter + offset parameter)  
            SET nextNum TO nums parameter AT (index parameter + offset parameter + 1)  

            IF (patElem EQUALS 1 AND NOT (nextNum > currNum)) OR  
               (patElem EQUALS 0 AND (nextNum NOT EQUAL currNum)) OR  
               (patElem EQUALS -1 AND NOT (nextNum < currNum)) THEN  
                RETURN False  
            END IF  

            RETURN checkMatch(index parameter, offset parameter + 1)  
        END FUNCTION  

        SET position TO 0  
        WHILE position <= lenNums - lenPattern - 1 DO  
            IF checkMatch(position, 0) THEN  
                SET tally TO tally + 1  
            END IF  
            SET position TO position + 1  
        END WHILE  

        RETURN tally  
    END FUNCTION  
END CLASS  
```