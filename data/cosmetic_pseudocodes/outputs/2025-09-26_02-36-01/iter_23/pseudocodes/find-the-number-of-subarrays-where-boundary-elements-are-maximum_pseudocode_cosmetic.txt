```  
CLASS Solution  
    FUNCTION numberOfSubarrays(nums)  
        ASSIGN alpha TO function CreateDefaultDictionaryList()  
        ASSIGN index_map TO alpha()  
        
        FUNCTION fillMap(i, iter)  
            IF iter IS EMPTY THEN  
                RETURN  
            ELSE  
                ASSIGN val TO iter[0]  
                APPEND i TO index_map[val]  
                CALL fillMap(i + (1 * 1), iter[1:])  
            END IF  
        END FUNCTION  
        
        CALL fillMap(0, nums)  
        
        ASSIGN totalCount TO 0  
        
        FUNCTION processIndices(keysList, pos)  
            IF pos >= LENGTH(keysList) THEN  
                RETURN  
            ELSE  
                ASSIGN currentIndicesList TO keysList[pos]  
                ASSIGN lengthIndices TO (0 + LENGTH(currentIndicesList))  
                
                FUNCTION outerLoop(a)  
                    IF a >= lengthIndices THEN  
                        RETURN  
                    ELSE  
                        FUNCTION innerLoop(b)  
                            IF b >= lengthIndices THEN  
                                RETURN  
                            ELSE  
                                ASSIGN startIdx TO currentIndicesList[a]  
                                ASSIGN endIdx TO currentIndicesList[b]  
                                ASSIGN subList TO SLICE(nums, startIdx, endIdx + 1)  
                                
                                FUNCTION maxInList(lst, idx, currentMax)  
                                    IF idx >= LENGTH(lst) THEN  
                                        RETURN currentMax  
                                    ELSE  
                                        ASSIGN candidate TO lst[idx]  
                                        ASSIGN updatedMax TO IF candidate > currentMax THEN candidate ELSE currentMax  
                                        RETURN maxInList(lst, idx + 1, updatedMax)  
                                    END IF  
                                END FUNCTION  
                                
                                ASSIGN maxVal TO maxInList(subList, 0, - (0 + 1))  
                                
                                IF NOT (maxVal != nums[startIdx]) THEN  
                                    totalCount = totalCount + (1 * 1)  
                                END IF  
                                CALL innerLoop(b + (1 * 1))  
                            END IF  
                        END FUNCTION  
                        
                        CALL innerLoop(a)  
                        CALL outerLoop(a + (1 * 1))  
                    END IF  
                END FUNCTION  
                
                CALL outerLoop(0)  
                CALL processIndices(keysList, pos + (1 * 1))  
            END IF  
        END FUNCTION  
        
        ASSIGN allValues TO []  
        FOR EACH val IN index_map DO  
            APPEND val TO allValues  
        END FOR  
        
        CALL processIndices(allValues, 0)  
        RETURN totalCount  
    END FUNCTION  
    
    FUNCTION CreateDefaultDictionaryList()  
        ASSIGN dict TO EMPTY_DICTIONARY  
        FUNCTION access(key)  
            IF key IN dict THEN  
                RETURN dict[key]  
            ELSE  
                ASSIGN dict[key] TO []  
                RETURN dict[key]  
            END IF  
        END FUNCTION  
        RETURN access  
    END FUNCTION  
END CLASS  
```