```pseudocode
CLASS Solution
    FUNCTION maximumLength(nums k)
        SET d TO LENGTH OF nums
        FUNCTION generate_ones_matrix(r c)
            IF r EQUALS 0
                RETURN empty list
            ELSE
                RETURN [list OF length c FILLED WITH 1] CONCAT generate_ones_matrix(r MINUS 1 c)
            END IF
        END FUNCTION
        SET m TO generate_ones_matrix(d k PLUS 1)
        FUNCTION max_val(a b)
            IF a GREATER THAN b
                RETURN a
            ELSE
                RETURN b
            END IF
        END FUNCTION
        FUNCTION recur_i(ii)
            IF ii GREATER THAN OR EQUAL TO d
                RETURN nothing
            END IF
            FUNCTION recur_h(hh)
                IF hh GREATER THAN k
                    RETURN nothing
                END IF
                FUNCTION recur_j(jj)
                    IF jj GREATER THAN OR EQUAL TO ii
                        RETURN nothing
                    END IF
                    SET a_val TO nums AT ii
                    SET b_val TO nums AT jj
                    IF NOT (a_val NOT EQUAL b_val)
                        SET cur1 TO m AT ii hh
                        SET cur2 TO m AT jj hh PLUS 1
                        SET m AT ii hh TO max_val(cur1 cur2)
                    ELSE
                        IF hh GREATER THAN 0
                            SET cur3 TO m AT ii hh
                            SET cur4 TO m AT jj hh MINUS 1 PLUS 1
                            SET m AT ii hh TO max_val(cur3 cur4)
                        END IF
                    END IF
                    recur_j(jj PLUS 1)
                END FUNCTION
                recur_j(0)
                recur_h(hh PLUS 1)
            END FUNCTION
            recur_h(0)
            recur_i(ii PLUS 1)
        END FUNCTION
        recur_i(0)
        SET result TO 0
        FUNCTION recur_ans(idx)
            IF idx GREATER THAN OR EQUAL TO d
                RETURN nothing
            END IF
            SET result TO max_val(result m AT idx k)
            recur_ans(idx PLUS 1)
        END FUNCTION
        recur_ans(0)
        RETURN result
    END FUNCTION
END CLASS
```