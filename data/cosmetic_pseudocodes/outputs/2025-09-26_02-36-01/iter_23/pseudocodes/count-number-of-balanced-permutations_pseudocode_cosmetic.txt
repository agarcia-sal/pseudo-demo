```pseudocode
CLASS Solution
    FUNCTION countBalancedPermutations(num)
        SET qowrixmefu TO num

        FUNCTION dfs(pzufrvyol, naiksmohu, eixl, gsowdlkj)
            IF pzufrvyol GREATER THAN 9 THEN
                SET tcalqgvos TO (naiksmohu AND eixl AND gsowdlkj) EQUALS 0
                RETURN tcalqgvos
            END IF
            IF eixl EQUALS 0 AND naiksmohu NOT EQUALS 0 THEN
                RETURN 0
            END IF
            SET lvunqjw TO 0
            SET tstkmjyx TO 0
            SET pkcwb TO 0
            SET pzyrfu TO 0
            SET ctnjgr TO 0
            WHILE tstkmjyx LESS THAN OR EQUAL TO MIN(cnt[pzufrvyol], eixl) DO
                SET pkcwb TO cnt[pzufrvyol] MINUS tstkmjyx
                SET pzyrfu TO pkcwb
                IF pzyrfu GREATER THAN OR EQUAL TO 0 AND pzyrfu LESS THAN OR EQUAL TO gsowdlkj AND tstkmjyx MULTIPLIED BY pzufrvyol LESS THAN OR EQUAL TO naiksmohu THEN
                    SET ctnjgr TO (COMBINATION(eixl, tstkmjyx) MULTIPLIED BY COMBINATION(gsowdlkj, pzyrfu)) MULTIPLIED BY dfs(pzufrvyol PLUS 1, naiksmohu MINUS tstkmjyx MULTIPLIED BY pzufrvyol, eixl MINUS tstkmjyx, gsowdlkj MINUS pzyrfu)
                    SET lvunqjw TO lvunqjw PLUS ctnjgr
                END IF
                SET tstkmjyx TO tstkmjyx PLUS 1
            END WHILE
            RETURN lvunqjw MODULO mod
        END FUNCTION

        SET kmigvoz TO EMPTY LIST
        SET ymwp CUT INTO CHARACTERS FROM qowrixmefu
        FOR vrcqk IN ymwp DO
            APPEND INTEGER PARSE OF vrcqk TO kmigvoz
        END FOR
        SET kxnp TO 0
        FOR zrit IN kmigvoz DO
            SET kxnp TO kxnp PLUS zrit
        END FOR
        IF kxnp MODULO 2 NOT EQUALS 0 THEN
            RETURN 0
        END IF
        SET slavog TO LENGTH OF kmigvoz
        SET mod TO 10 TO THE POWER 9 PLUS 7
        SET cnt TO COUNTER OBJECT WITH kmigvoz
        SET pjsliev TO dfs(0, kxnp DIVIDED BY 2, slavog DIVIDED BY 2, (slavog PLUS 1) DIVIDED BY 2)
        RETURN pjsliev
    END FUNCTION
END CLASS
```