```pseudocode
CLASS Solution
    FUNCTION numberOfStableArrays(zero zero, one one, limit limit) RETURNS integer
        SET M TO (1000000000 + 1)
        
        FUNCTION dp(z z, o o, last last, consecutive consecutive) RETURNS integer
            FUNCTION innerDp(x x, y y, previous previous, chain chain) RETURNS integer
                IF (x = 0) AND (y = 0) THEN
                    RETURN one
                ELSE
                    IF (x < 0) OR (y < 0) THEN
                        RETURN zero
                    ELSE
                        SET sum TO 0
                        
                        IF previous = zero THEN
                            IF chain < limit THEN
                                SET sum TO sum + innerDp(x - 1, y, zero, chain + 1)
                            END IF
                            SET sum TO sum + innerDp(x, y - 1, one, 1)
                        ELSE
                            IF x > 0 THEN
                                SET sum TO sum + innerDp(x - 1, y, zero, 1)
                            END IF
                            IF chain < limit THEN
                                SET sum TO sum + innerDp(x, y - 1, one, chain + 1)
                            END IF
                        END IF
                        
                        RETURN sum MOD M
                    END IF
                END IF
            END FUNCTION

            RETURN innerDp(z, o, last, consecutive)
        END FUNCTION

        RETURN dp(zero, one, -1, zero)
END CLASS
```