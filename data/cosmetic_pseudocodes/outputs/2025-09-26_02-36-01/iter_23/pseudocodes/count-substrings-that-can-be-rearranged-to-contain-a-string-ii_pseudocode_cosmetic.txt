```pseudocode
CLASS Solution
    FUNCTION validSubstringCount(word1, word2)
        IMPORT Counter FROM collections

        SET u23fgd TO Counter(word2)
        SET p8njr TO Counter()
        SET kxmec TO 0
        SET b9uqw TO 0
        SET lsytx TO 0
        SET mtvfr TO 0

        FUNCTION recursive_iter(owqsj)
            IF owqsj < LENGTH(word1) THEN
                SET mjezx TO word1[owqsj]
                p8njr[mjezx] = (p8njr[mjezx] + 1)
                IF (mjezx IN u23fgd) AND (p8njr[mjezx] = u23fgd[mjezx]) THEN
                    kxmec = (kxmec + 1)
                END IF

                FUNCTION inner_while()
                    IF (kxmec = LENGTH(u23fgd)) AND ((owqsj + 1 - lsytx) >= LENGTH(word2)) THEN
                        mtvfr = mtvfr + (LENGTH(word1) - owqsj)
                        SET ejrwa TO word1[lsytx]
                        p8njr[ejrwa] = (p8njr[ejrwa] - 1)
                        IF (ejrwa IN u23fgd) AND (p8njr[ejrwa] < u23fgd[ejrwa]) THEN
                            kxmec = (kxmec - 1)
                        END IF
                        lsytx = (lsytx + 1)
                        inner_while()
                    END IF
                END FUNCTION

                inner_while()
                recursive_iter(owqsj + 1)
            END IF
        END FUNCTION

        recursive_iter(0)
        RETURN mtvfr
    END FUNCTION
END CLASS
```