```  
CLASS Solution
    FUNCTION maxScore(grid)
        SET cwpbklr TO the LENGTH OF grid
        SET vzjxhy TO the LENGTH OF element at position zero of grid
        SET whsaqv TO a list containing cwpbklr elements each of which is a list containing vzjxhy elements each set TO positive infinity
        
        SET element at position zero of element at position zero of whsaqv TO element at position zero of element at position zero of grid
        SET bsgakm TO negative infinity

        FUNCTION NjDOaz(suwjveq, ikmfgl)
            IF suwjveq GREATER THAN ikmfgl THEN
                RETURN ikmfgl
            ELSE
                RETURN suwjveq
            END IF
        END FUNCTION

        FUNCTION wxAxHp(vratl, yznmc)
            IF vratl GREATER THAN yznmc THEN
                RETURN vratl
            ELSE
                RETURN yznmc
            END IF
        END FUNCTION

        FUNCTION FbKtcv(uze, nwa)
            IF nwa LESS THAN uze THEN
                RETURN TRUE
            ELSE
                RETURN FALSE
            END IF
        END FUNCTION

        PROCEDURE rdycTp(famwuc)
            IF famwuc EQUALS vzjxhy THEN
                RETURN
            END IF
            SET bclokq TO NjDOaz(element at position famwuc MINUS one of element at position zero of whsaqv, element at position famwuc of element at position zero of grid)
            SET element at position famwuc of element at position zero of whsaqv TO bclokq
            CALL rdycTp(famwuc PLUS one)
        END PROCEDURE

        PROCEDURE Lqmzxg(hqdb)
            IF hqdb EQUALS cwpbklr THEN
                RETURN
            END IF
            SET bxjlrb TO NjDOaz(element at position hqdb MINUS one of element at position zero of whsaqv, element at position hqdb of element at position zero of grid)
            SET element at position hqdb of element at position zero of whsaqv TO bxjlrb
            CALL Lqmzxg(hqdb PLUS one)
        END PROCEDURE

        PROCEDURE qdyNrk(xaivwr)
            IF xaivwr EQUALS cwpbklr THEN
                RETURN
            END IF
            CALL qdyNrm(0, xaivwr)
            CALL qdyNrk(xaivwr PLUS 1)
        END PROCEDURE

        PROCEDURE qdyNrm(akw, phtbm)
            IF akw EQUALS vzjxhy THEN
                RETURN
            END IF
            IF (akw EQUALS 0) AND (phtbm EQUALS 0) THEN
                RETURN
            END IF
            IF (phtbm EQUALS 0) AND (akw GREATER THAN 0) THEN
                SET ltpbgh TO NjDOaz(element at position phtbm of element at position akw MINUS one of whsaqv, element at position phtbm of element at position akw of grid)
                SET element at position phtbm of element at position akw of whsaqv TO ltpbgh
            ELSE IF (akw GREATER THAN 0) AND (phtbm GREATER THAN 0) THEN
                SET xmrkw TO NjDOaz(element at position phtbm of element at position akw MINUS one of whsaqv, element at position phtbm MINUS one of element at position akw of whsaqv)
                SET element at position phtbm of element at position akw of whsaqv TO xmrkw
            END IF
            SET cfwqka TO element at position phtbm of element at position akw of grid MINUS element at position phtbm of element at position akw of whsaqv
            SET bsgakm TO wxAxHp(bsgakm, cfwqka)
            CALL qdyNrm(akw PLUS 1, phtbm)
        END PROCEDURE

        CALL rdycTp(1)
        CALL Lqmzxg(1)
        CALL qdyNrk(1)

        RETURN bsgakm
    END FUNCTION
END CLASS  
```