CLASS Solution  
    FUNCTION subsequencePairCount(nums)  
        CONST MODULO = 1000000007  
        LET maximum = max(nums)  
        LET dpMatrix BE a (maximum + 1) x (maximum + 1) matrix FILLED WITH 0  
        dpMatrix[0][0] = 1  

        FOR EACH currentNum IN nums DO  
            LET updatedDp BE a (maximum + 1) x (maximum + 1) matrix FILLED WITH 0  
            FOR i FROM 0 TO maximum DO  
                FOR j FROM 0 TO maximum DO  
                    LET value = dpMatrix[i][j]  
                    IF value IS 0 THEN  
                        CONTINUE TO NEXT iteration  
                    END IF  
                    updatedDp[i][j] = (updatedDp[i][j] + value) MODULO  

                    LET gcd_i = GCD(i, currentNum)  
                    updatedDp[gcd_i][j] = (updatedDp[gcd_i][j] + value) MODULO  

                    LET gcd_j = GCD(j, currentNum)  
                    updatedDp[i][gcd_j] = (updatedDp[i][gcd_j] + value) MODULO  
                END FOR  
            END FOR  
            dpMatrix = updatedDp  
        END FOR  

        LET totalCount = 0  
        FOR k FROM 1 TO maximum DO  
            totalCount = (totalCount + dpMatrix[k][k]) MODULO  
        END FOR  
        RETURN totalCount  
    END FUNCTION  
END CLASS