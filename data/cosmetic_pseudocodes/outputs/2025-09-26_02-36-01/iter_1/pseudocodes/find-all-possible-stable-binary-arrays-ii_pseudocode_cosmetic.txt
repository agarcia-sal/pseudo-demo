CLASS Solution  
    FUNCTION numberOfStableArrays(zero zero, one one, limit limit) RETURNS integer  
        CONSTANT MODULO ← 1_000_000_001  
  
        FUNCTION dp(z z, o o, last last, consecutive consecutive) RETURNS integer  
            IF z = 0 AND o = 0 THEN  
                RETURN 1  
            ELSE IF z < 0 OR o < 0 THEN  
                RETURN 0  
            END IF  
  
            VARIABLE result ← 0  
  
            IF last = 0 THEN  
                IF consecutive < limit THEN  
                    result ← result + dp(z - 1, o, 0, consecutive + 1)  
                END IF  
                result ← result + dp(z, o - 1, 1, 1)  
            ELSE  
                IF z > 0 THEN  
                    result ← result + dp(z - 1, o, 0, 1)  
                END IF  
                IF consecutive < limit THEN  
                    result ← result + dp(z, o - 1, 1, consecutive + 1)  
                END IF  
            END IF  
  
            RETURN result MOD MODULO  
        END FUNCTION  
  
        RETURN dp(zero, one, -1, 0)  
    END FUNCTION  
END CLASS