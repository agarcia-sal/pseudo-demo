CLASS Solution  
    FUNCTION minimizeStringValue(s)  
        FROM collections IMPORT Counter  
        counts <- Counter(s)  
        
        IF '?' IN counts THEN  
            DELETE counts['?']  
        END IF  
        
        question_positions <- []  
        FOR index FROM 0 TO LENGTH(s) - 1  
            IF s[index] == '?' THEN  
                APPEND index TO question_positions  
            END IF  
        END FOR  
        
        replacements <- []  
        ALPHABET <- 'abcdefghijklmnopqrstuvwxyz'  
        
        FOR pos IN question_positions  
            lowest_freq <- INFINITY  
            chosen_char <- NULL  
            FOR letter IN ALPHABET  
                freq <- counts[letter] IF letter IN counts ELSE 0  
                IF freq < lowest_freq THEN  
                    lowest_freq <- freq  
                    chosen_char <- letter  
                END IF  
            END FOR  
            APPEND chosen_char TO replacements  
            counts[chosen_char] <- counts.get(chosen_char, 0) + 1  
        END FOR  
        
        replacements <- SORTED(replacements)  
        char_array <- CONVERT s TO list  
        
        FOR i FROM 0 TO LENGTH(question_positions) - 1  
            char_array[question_positions[i]] <- replacements[i]  
        END FOR  
        
        RETURN JOIN(char_array)  
    END FUNCTION  
END CLASS