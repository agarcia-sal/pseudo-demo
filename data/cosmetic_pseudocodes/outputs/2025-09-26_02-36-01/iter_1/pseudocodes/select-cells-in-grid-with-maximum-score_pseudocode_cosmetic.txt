CLASS Solution  
    FUNCTION maxScore(grid)  
        SET max_sum TO 0  
        FOR index FROM 0 TO LENGTH OF grid - 1 DO  
            SORT grid[index] IN DESCENDING ORDER  
        END FOR  

        FUNCTION backtrack(row, used, current_sum)  
            IF row IS EQUAL TO LENGTH OF grid THEN  
                IF current_sum > max_sum THEN  
                    SET max_sum TO current_sum  
                END IF  
                RETURN  
            END IF  
            backtrack(row + 1, used, current_sum)  

            FOR EACH val IN grid[row] DO  
                IF val NOT IN used THEN  
                    used.ADD(val)  
                    backtrack(row + 1, used, current_sum + val)  
                    used.REMOVE(val)  
                END IF  
            END FOR  
        END FUNCTION  

        backtrack(0, SET(), 0)  
        RETURN max_sum  
    END FUNCTION  
END CLASS