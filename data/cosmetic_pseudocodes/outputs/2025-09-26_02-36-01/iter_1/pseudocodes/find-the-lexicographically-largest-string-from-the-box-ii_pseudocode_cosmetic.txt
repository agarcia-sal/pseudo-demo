CLASS Solution  
    FUNCTION answerString(word, numFriends)  
        IF numFriends IS 1 THEN  
            RETURN word  
        END IF  
        
        SET candidateSubstring TO CALL _lastSubstring WITH word  
        SET allowedLength TO LENGTH(word) - numFriends + 1  
        SET resultLength TO IF LENGTH(candidateSubstring) < allowedLength THEN LENGTH(candidateSubstring) ELSE allowedLength  
        RETURN SUBSTRING(candidateSubstring, 1, resultLength)  
    END FUNCTION  
  
    FUNCTION _lastSubstring(s)  
        SET startIndex TO 0  
        SET compareIndex TO 1  
        SET offset TO 0  
        WHILE (compareIndex + offset) < LENGTH(s)  
            SET charAtStart TO CHARACTER_AT(s, startIndex + offset)  
            SET charAtCompare TO CHARACTER_AT(s, compareIndex + offset)  
            IF charAtStart == charAtCompare THEN  
                offset = offset + 1  
            ELSEIF charAtStart > charAtCompare THEN  
                compareIndex = compareIndex + offset + 1  
                offset = 0  
            ELSE  
                startIndex = MAX(startIndex + offset + 1, compareIndex)  
                compareIndex = startIndex + 1  
                offset = 0  
            END IF  
        END WHILE  
        RETURN SUBSTRING(s, startIndex + 1, LENGTH(s))  
    END FUNCTION  
END CLASS