CLASS Solution  
    FUNCTION numberOfSubstrings(s parameter, k parameter)  
        INITIALIZE frequency AS empty map  
        INITIALIZE result TO 0  
        INITIALIZE leftPointer TO 0  
        FOR index FROM 0 TO LENGTH(s) - 1  
            LET currentChar BE s AT index  
            IF currentChar NOT IN frequency  
                SET frequency[currentChar] TO 1  
            ELSE  
                INCREMENT frequency[currentChar] BY 1  
            END IF  
            WHILE EXISTS char IN frequency WHERE frequency[char] >= k  
                LET leftChar BE s AT leftPointer  
                DECREMENT frequency[leftChar] BY 1  
                IF frequency[leftChar] EQUALS 0  
                    DELETE frequency[leftChar]  
                END IF  
                INCREMENT leftPointer BY 1  
            END WHILE  
            ADD leftPointer TO result  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS