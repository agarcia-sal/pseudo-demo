CLASS Solution  
    FUNCTION maxFrequency(nums, k, numOperations)  
        DECLARE cnt AS dictionary with default integer zero  
        DECLARE d AS dictionary with default integer zero  
        
        FOR x IN nums DO  
            cnt[x] = cnt[x] + 1  
            d[x] = d[x] + 0  
            d[x - k] = d[x - k] + 1  
            d[x + k + 1] = d[x + k + 1] - 1  
        END FOR  
        
        ans = 0  
        s = 0  
        
        FOR key IN sorted keys of d DO  
            s = s + d[key]  
            possible = MIN(s, cnt[key] + numOperations)  
            IF possible > ans THEN  
                ans = possible  
            END IF  
        END FOR  
        
        RETURN ans  
    END FUNCTION  
END CLASS