CLASS Solution  
    FUNCTION minValidStrings(words, target)  
        INITIALIZE prefixSet AS an empty set  
        FOR word IN words DO  
            FOR lengthIndex FROM 1 TO LENGTH(word) DO  
                ADD word[1 TO lengthIndex] TO prefixSet  
            END FOR  
        END FOR  
  
        LET targetLength BE LENGTH(target)  
        CREATE dpArray OF SIZE targetLength + 1 FILLED WITH infinity  
        SET dpArray[0] TO 0  
  
        FOR endIndex FROM 1 TO targetLength DO  
            FOR startIndex FROM 1 TO endIndex DO  
                LET segment BE target[startIndex TO endIndex]  
                IF segment IS IN prefixSet THEN  
                    dpArray[endIndex] = MIN(dpArray[endIndex], dpArray[startIndex - 1] + 1)  
                END IF  
            END FOR  
        END FOR  
  
        IF dpArray[targetLength] IS FINITE THEN  
            RETURN dpArray[targetLength]  
        ELSE  
            RETURN -1  
        END IF  
    END FUNCTION  
END CLASS