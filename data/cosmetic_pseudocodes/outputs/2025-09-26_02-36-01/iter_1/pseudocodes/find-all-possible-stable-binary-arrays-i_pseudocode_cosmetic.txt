CLASS Solution  
    FUNCTION numberOfStableArrays(zero, one, limit)  
        DEFINE MOD_CONST AS (10 ^ 9) + 1  
        
        FUNCTION dp(zeros_remaining, ones_remaining, prev_char, run_len)  
            IF zeros_remaining == 0 AND ones_remaining == 0 THEN  
                RETURN 1  
            END IF  
            IF zeros_remaining < 0 OR ones_remaining < 0 THEN  
                RETURN 0  
            END IF  
            
            LET total_ways = 0  
            
            IF prev_char != 0 OR run_len < limit THEN  
                LET next_run = IF prev_char == 0 THEN run_len + 1 ELSE 1  
                total_ways = total_ways + dp(zeros_remaining - 1, ones_remaining, 0, next_run)  
                total_ways = total_ways MOD MOD_CONST  
            END IF  
            
            IF prev_char != 1 OR run_len < limit THEN  
                LET next_run = IF prev_char == 1 THEN run_len + 1 ELSE 1  
                total_ways = total_ways + dp(zeros_remaining, ones_remaining - 1, 1, next_run)  
                total_ways = total_ways MOD MOD_CONST  
            END IF  
            
            RETURN total_ways  
        END FUNCTION  
        
        RETURN dp(zero, one, -1, 0)  
    END FUNCTION  
END CLASS