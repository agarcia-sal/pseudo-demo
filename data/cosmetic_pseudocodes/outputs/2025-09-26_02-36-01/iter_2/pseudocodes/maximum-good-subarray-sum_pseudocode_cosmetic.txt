CLASS Solution  
    FUNCTION maximumSubarraySum(nums k)  
        DECLARE prefixSumsMap AS empty map  
        DECLARE highestSum AS the smallest possible number  
        DECLARE runningTotal AS 0  
        
        SET index TO 0  
        WHILE index < length of nums DO  
            SET val TO nums at index  
            
            IF prefixSumsMap CONTAINS KEY (val - k) THEN  
                SET candidate1 TO runningTotal - prefixSumsMap[val - k] + val  
                SET highestSum TO maximum of highestSum AND candidate1  
            END IF  
            
            IF prefixSumsMap CONTAINS KEY (val + k) THEN  
                SET candidate2 TO runningTotal - prefixSumsMap[val + k] + val  
                SET highestSum TO maximum of highestSum AND candidate2  
            END IF  
            
            IF prefixSumsMap CONTAINS KEY val THEN  
                SET prefixSumsMap[val] TO minimum of prefixSumsMap[val] AND runningTotal  
            ELSE  
                INSERT INTO prefixSumsMap KEY val VALUE runningTotal  
            END IF  
            
            SET runningTotal TO runningTotal + val  
            INCREMENT index BY 1  
        END WHILE  
        
        IF highestSum IS GREATER THAN negative infinity THEN  
            RETURN highestSum  
        ELSE  
            RETURN 0  
        END IF  
    END FUNCTION  
END CLASS