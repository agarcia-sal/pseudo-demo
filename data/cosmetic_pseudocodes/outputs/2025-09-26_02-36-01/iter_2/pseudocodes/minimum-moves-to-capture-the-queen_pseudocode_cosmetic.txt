CLASS Solution  
    FUNCTION minMovesToCaptureTheQueen(w x y z p q)  
        IF w == p THEN  
            IF y != w THEN  
                RETURN 1  
            END IF  
            IF (x < z AND z < q) OR (q < z AND z < x) THEN  
                RETURN 2  
            END IF  
            RETURN 1  
        END IF  
        IF x == q THEN  
            IF z != x THEN  
                RETURN 1  
            END IF  
            IF (w < y AND y < p) OR (p < y AND y < w) THEN  
                RETURN 2  
            END IF  
            RETURN 1  
        END IF  
        sum1 = y + z  
        sum2 = p + q  
        IF sum1 == sum2 THEN  
            sum3 = w + x  
            IF sum3 != sum1 THEN  
                RETURN 1  
            END IF  
            cond1 = (y < w AND w < p AND z < x AND x < q)  
            cond2 = (p < w AND w < y AND q < x AND x < z)  
            IF cond1 OR cond2 THEN  
                RETURN 2  
            END IF  
            RETURN 1  
        END IF  
        diff1 = y - z  
        diff2 = p - q  
        IF diff1 == diff2 THEN  
            diff3 = w - x  
            IF diff3 != diff1 THEN  
                RETURN 1  
            END IF  
            cond3 = (y < w AND w < p AND z > x AND x > q)  
            cond4 = (p < w AND w < y AND q > x AND x > z)  
            IF cond3 OR cond4 THEN  
                RETURN 2  
            END IF  
            RETURN 1  
        END IF  
        RETURN 2  
    END FUNCTION  
END CLASS