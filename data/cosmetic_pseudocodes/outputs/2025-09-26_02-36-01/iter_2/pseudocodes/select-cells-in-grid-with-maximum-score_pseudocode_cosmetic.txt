CLASS Solution  
    FUNCTION maxScore(grid)  
        FUNCTION backtrack(index, selected, total)  
            IF index = LENGTH(grid) THEN  
                IF total > max_sum THEN  
                    max_sum = total  
                END IF  
                RETURN  
            END IF  

            CALL backtrack(index + 1, selected, total)  

            SET current_line TO grid[index]  
            FOR element_pos FROM 0 TO LENGTH(current_line) - 1  
                SET element TO current_line[element_pos]  
                IF NOT (element IN selected) THEN  
                    INSERT element INTO selected  
                    SET next_total TO total + element  
                    CALL backtrack(index + 1, selected, next_total)  
                    DELETE element FROM selected  
                END IF  
            END FOR  
        END FUNCTION  

        FOR i FROM 0 TO LENGTH(grid) - 1  
            SET line TO grid[i]  
            SORT line IN ORDER descending  
        END FOR  

        SET max_sum = 0  
        SET used_set TO empty set  
        CALL backtrack(0, used_set, 0)  

        RETURN max_sum  
    END FUNCTION  
END CLASS