CLASS Solution
    FUNCTION numberOfSubstrings(s parameter, k parameter)
        INITIALIZE frequencyMap AS empty dictionary with default zero
        INITIALIZE resultAccumulator AS 0
        ASSIGN leftIndex AS 0
        ASSIGN currentIndex AS 0
        WHILE currentIndex LESS THAN LENGTH OF s
            LET currentChar BE s AT currentIndex
            LET updatedCount BE frequencyMap[currentChar] PLUS 1
            SET frequencyMap[currentChar] TO updatedCount
            WHILE EXISTS key IN frequencyMap WHERE frequencyMap[key] NOT LESS THAN k
                LET leftChar BE s[leftIndex]
                DECREMENT frequencyMap[leftChar] BY 1
                IF frequencyMap[leftChar] EQUALS 0 THEN
                    REMOVE leftChar FROM frequencyMap
                END IF
                INCREMENT leftIndex BY 1
            END WHILE
            SET resultAccumulator TO resultAccumulator PLUS leftIndex
            INCREMENT currentIndex BY 1
        END WHILE
        RETURN resultAccumulator
    END FUNCTION
END CLASS