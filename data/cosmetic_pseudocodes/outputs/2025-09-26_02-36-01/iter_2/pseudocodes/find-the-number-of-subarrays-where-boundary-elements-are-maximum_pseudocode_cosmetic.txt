CLASS Solution
    FUNCTION numberOfSubarrays(nums)
        CREATE indexDictionary AS a dictionary with default value empty list
        SET pos TO 0
        WHILE pos < LENGTH(nums)
            LET element BE nums[pos]
            APPEND pos TO indexDictionary[element]
            INCREMENT pos BY 1
        END WHILE

        LET totalCount BE 0
        FOR indicesList IN indexDictionary VALUES
            LET lengthIndices BE LENGTH(indicesList)
            LET outerIdx BE 0
            WHILE outerIdx <= lengthIndices - 1
                LET innerIdx BE outerIdx
                WHILE innerIdx <= lengthIndices - 1
                    LET startPos BE indicesList[outerIdx]
                    LET endPos BE indicesList[innerIdx]
                    LET subSequence BE SLICE nums FROM startPos TO endPos + 1
                    LET maxVal BE subSequence[0] 
                    LET k BE 1
                    WHILE k < LENGTH(subSequence)
                        IF subSequence[k] > maxVal THEN
                            SET maxVal TO subSequence[k]
                        END IF
                        INCREMENT k BY 1
                    END WHILE
                    IF maxVal == nums[startPos] THEN
                        totalCount = totalCount + 1
                    END IF
                    innerIdx = innerIdx + 1
                END WHILE
                outerIdx = outerIdx + 1
            END WHILE
        END FOR

        RETURN totalCount
    END FUNCTION
END CLASS