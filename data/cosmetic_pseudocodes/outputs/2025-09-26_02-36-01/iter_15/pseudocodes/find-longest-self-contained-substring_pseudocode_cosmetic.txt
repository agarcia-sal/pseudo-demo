```  
CLASS Solution  
    FUNCTION maxSubstringLength(s)  
        SET alphaFreq TO empty map  
        FOR pos FROM 0 TO length(s) - 1 DO  
            SET ch TO s[pos]  
            IF alphaFreq CONTAINS ch THEN  
                SET alphaFreq[ch] TO alphaFreq[ch] + 1  
            ELSE  
                SET alphaFreq[ch] TO 1  
            END IF  
        END FOR  

        SET bestLen TO -1  

        SET outerIdx TO 0  
        WHILE outerIdx < length(s) DO  
            SET subFreq TO empty map  
            SET innerIdx TO outerIdx  

            REPEAT  
                SET curChar TO s[innerIdx]  
                IF subFreq CONTAINS curChar THEN  
                    SET subFreq[curChar] TO subFreq[curChar] + 1  
                ELSE  
                    SET subFreq[curChar] TO 1  
                END IF  

                SET validSub TO true  
                FOR each keyChar IN subFreq KEYS DO  
                    IF NOT (subFreq[keyChar] >= alphaFreq[keyChar]) THEN  
                        SET validSub TO false  
                        EXIT FOR  
                    END IF  
                END FOR  

                IF validSub AND (COUNT(subFreq KEYS) < COUNT(alphaFreq KEYS)) THEN  
                    SET candidateLen TO (innerIdx - outerIdx + 1)  
                    IF candidateLen > bestLen THEN  
                        SET bestLen TO candidateLen  
                    END IF  
                END IF  

                SET innerIdx TO innerIdx + 1  
            UNTIL innerIdx >= length(s)  
            SET outerIdx TO outerIdx + 1  
        END WHILE  

        RETURN bestLen  
    END FUNCTION  
END CLASS  
```