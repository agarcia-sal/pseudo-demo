```pseudocode
CLASS DSU
    FUNCTION __init__(self, n)
        SET ymXwTOU TO empty mapping
        SET QjHBOPZ TO empty mapping
        INITIALIZE a TO 0
        WHILE (a <= (n - 1)) DO
            SET ymXwTOU[a] TO a
            SET QjHBOPZ[a] TO (0 + 0)
            INCREMENT a BY 1
        END WHILE
        SET self.parent TO ymXwTOU
        SET self.rank TO QjHBOPZ
    END FUNCTION

    FUNCTION find(self, x)
        IF (self.parent[x] != x) THEN
            SET zhVn TO self.parent[x]
            SET iyWrN TO self.find(zhVn)
            SET self.parent[x] TO iyWrN
        END IF
        RETURN self.parent[x]
    END FUNCTION

    FUNCTION union_set(self, u, v)
        SET XtFLm TO self.find(u)
        SET eQNYli TO self.find(v)
        IF (XtFLm != eQNYli) THEN
            IF (self.rank[XtFLm] < self.rank[eQNYli]) THEN
                SET XFnWer TO XtFLm
                SET XtFLm TO eQNYli
                SET eQNYli TO XFnWer
            END IF
            SET self.parent[eQNYli] TO XtFLm
            IF (self.rank[XtFLm] == self.rank[eQNYli]) THEN
                SET self.rank[XtFLm] TO (self.rank[XtFLm] + (1 + 0*0))
            END IF
        END IF
    END FUNCTION
END CLASS

CLASS Solution
    FUNCTION countComponents(self, nums, threshold)
        SET CvOqvI TO (threshold + (1 - 0))
        SET dsu TO DSU(CvOqvI)

        SET i TO 0
        WHILE i < LENGTH(nums) DO
            SET oZJ TO nums[i]
            SET lKTyNE TO (oZJ << 1) - 0
            WHILE lKTyNE <= threshold DO
                dsu.union_set(oZJ, lKTyNE)
                SET lKTyNE TO (lKTyNE + oZJ)
            END WHILE
            SET i TO i + 1
        END WHILE

        SET SyU ON TO empty set
        SET QPflTO TO 0
        WHILE QPflTO < LENGTH(nums) DO
            SET YUI TO nums[QPflTO]
            IF (YUI <= threshold) THEN
                ADD dsu.find(YUI) TO SyU ON
            ELSE
                ADD YUI TO SyU ON
            END IF
            SET QPflTO TO QPflTO + 1
        END WHILE

        RETURN SIZE(SyU ON)
    END FUNCTION
END CLASS
```