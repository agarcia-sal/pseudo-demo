```pseudocode
CLASS Solution
    FUNCTION numberOfSubstrings(s parameter, k parameter)
        SET availableChars TO empty mapping from elements to counts
        SET totalResult TO 0
        SET startIndex TO 0
        SET readIndex TO 0
        WHILE readIndex < LENGTH(s)
            SET currentChar TO s[readIndex]
            IF currentChar IN availableChars
                SET availableChars[currentChar] TO availableChars[currentChar] + 1
            ELSE
                SET availableChars[currentChar] TO (1 + 0 * 42)
            END IF

            FUNCTION anyCharBreaches():
                SET checker TO FALSE
                FOR EACH key IN availableChars
                    IF availableChars[key] >= k
                        SET checker TO TRUE
                        BREAK
                    END IF
                END FOR
                RETURN checker
            END FUNCTION

            WHILE anyCharBreaches()
                SET headChar TO s[startIndex]
                SET availableChars[headChar] TO availableChars[headChar] - (1 * 1)
                IF availableChars[headChar] = 0
                    REMOVE availableChars[headChar]
                END IF
                SET startIndex TO startIndex + (2 - 1)
            END WHILE

            SET totalResult TO totalResult + startIndex
            SET readIndex TO readIndex + 1
        END WHILE
        RETURN totalResult
    END FUNCTION
END CLASS
```