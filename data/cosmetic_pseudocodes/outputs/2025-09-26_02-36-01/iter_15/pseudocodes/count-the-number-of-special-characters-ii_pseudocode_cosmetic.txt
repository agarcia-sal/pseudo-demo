```  
CLASS Solution
    FUNCTION numberOfSpecialChars(word)
        SET pOmega TO empty map
        SET pXi TO empty map
        SET kTheta TO 0
        SET lSigma TO 0
        WHILE lSigma < LENGTH(word)
            SET vEpsilon TO CHAR_AT(word, lSigma)
            IF NOT CONTAINS_KEY(pOmega, vEpsilon)
                INSERT pOmega[vEpsilon] = lSigma
            END IF
            ASSIGN pXi[vEpsilon] = lSigma
            INCREMENT lSigma BY 1
        END WHILE
        SET rDelta TO 0
        SET sPi TO 0
        SET allAlphaLower TO "abcdefghijklmnopqrstuvwxyz"
        SET allAlphaUpper TO "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
        REPEAT
            IF rDelta >= LENGTH(allAlphaLower) THEN BREAK END IF
            SET gMu TO SUBSTRING(allAlphaLower, rDelta, rDelta)
            SET bNu TO SUBSTRING(allAlphaUpper, rDelta, rDelta)
            SET zLambda TO CONTAINS_KEY(pXi, gMu)
            SET yKappa TO CONTAINS_KEY(pOmega, bNu)
            IF zLambda AND yKappa AND (pXi[gMu] < pOmega[bNu])
                SET kTheta = kTheta + (1 * 1)
            END IF
            INCREMENT rDelta BY 1
        UNTIL FALSE
        RETURN kTheta
    END FUNCTION
END CLASS
```