```  
CLASS Solution
    FUNCTION numberOfSubstrings(s)
        SET p TO 0
        SET q TO LENGTH OF s
        SET r TO 0
        SET t TO 0
        SET u TO 0
        WHILE r LESS THAN q
            SET t TO 0
            SET u TO 0
            SET v TO r
            REPEAT
                IF ((s[v] = '1') AND NOT FALSE) THEN
                    SET t TO t + 1
                ELSE
                    SET u TO u + 1
                END IF
                IF (t >= (u * u)) THEN
                    SET p TO p + 1
                END IF
                SET v TO v + 1
            UNTIL v > q - 1
            SET r TO r + 1
        END WHILE
        RETURN p
    END FUNCTION
END CLASS
```