```pseudocode
CLASS Solution
    FUNCTION numberOfSubarrays(nums)
        ASSIGN omega TO empty default dictionary of lists

        ASSIGN theta TO 0
        ASSIGN kappa TO 0
        WHILE kappa < LENGTH(nums)
            ASSIGN phi TO nums[kappa]
            IF phi NOT IN omega THEN
                ASSIGN omega[phi] TO empty list
            END IF
            APPEND kappa TO omega[phi]
            SET kappa TO kappa + 1
        END WHILE

        ASSIGN psi TO 0
        ASSIGN chi TO VALUES(omega)
        ASSIGN mu TO LENGTH(chi)
        ASSIGN delta TO 0
        WHILE delta < mu
            ASSIGN epsilon TO chi[delta]
            ASSIGN nu TO LENGTH(epsilon)
            ASSIGN alpha TO 0
            WHILE alpha < nu
                ASSIGN beta TO alpha
                WHILE beta < nu
                    ASSIGN gamma TO epsilon[alpha]
                    ASSIGN eta TO epsilon[beta]
                    ASSIGN zeta TO gamma
                    ASSIGN iota TO eta
                    ASSIGN sublist TO EMPTY LIST
                    ASSIGN lax TO zeta
                    WHILE lax <= iota
                        APPEND nums[lax] TO sublist
                        SET lax TO lax + 1
                    END WHILE

                    ASSIGN maxVal TO sublist[0]
                    ASSIGN index_max TO 1
                    WHILE index_max < LENGTH(sublist)
                        IF sublist[index_max] > maxVal THEN
                            SET maxVal TO sublist[index_max]
                        END IF
                        SET index_max TO index_max + 1
                    END WHILE

                    IF maxVal = nums[gamma] THEN
                        SET psi TO psi + 1
                    END IF

                    SET beta TO beta + 1
                END WHILE
                SET alpha TO alpha + 1
            END WHILE
            SET delta TO delta + 1
        END WHILE

        RETURN psi
    END FUNCTION
END CLASS
```