```pseudocode
CLASS Solution
    FUNCTION numberOfStableArrays(zero, one, limit)
      CONST P = (10 ^ 9) + 1
      
      FUNCTION dp(bits_a, bits_b, last_c, last_len)
          IF bits_a = 0 AND bits_b = 0 THEN
              RETURN 1
          ELSE IF bits_a < 0 OR bits_b < 0 THEN
              RETURN 0
          END IF
          
          SET total TO 0
          
          IF NOT (last_c = 0 AND last_len = limit) THEN
              SET v1 TO dp(bits_a - 1, bits_b, 0, (IF last_c = 0 THEN last_len + 1 ELSE 1))
              SET total TO (total + v1) % P
          END IF
          
          IF NOT (last_c = 1 AND last_len = limit) THEN
              SET v2 TO dp(bits_a, bits_b - 1, 1, (IF last_c = 1 THEN last_len + 1 ELSE 1))
              SET total TO (total + v2) % P
          END IF
          
          RETURN total
      END FUNCTION
      
      RETURN dp(zero, one, -1, 0)
    END FUNCTION
END CLASS
```