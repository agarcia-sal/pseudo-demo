```pseudocode
CLASS Solution
    FUNCTION minimumSubstringsInPartition(s)
        FUNCTION dfs(r)
            IF NOT (r < LENGTH(s)) THEN
                RETURN 0
            END IF

            SET U TO EMPTY_MAP_WITH_DEFAULT_ZERO
            SET V TO EMPTY_MAP_WITH_DEFAULT_ZERO
            SET M TO LENGTH(s) - r

            SET x TO r
            WHILE x < LENGTH(s) DO
                IF U CONTAINS_KEY s[x] AND U[s[x]] <> 0 THEN
                    SET y TO U[s[x]]
                    SET V[y] TO V[y] - 1
                    IF V[y] = 0 THEN
                        DELETE_KEY y FROM V
                    END IF
                END IF

                SET U[s[x]] TO U[s[x]] + 1
                SET V[U[s[x]]] TO (V[U[s[x]]] + 1) OR 1

                IF LENGTH(V) = 1 THEN
                    SET z TO 1 + dfs(x + 1)
                    IF z < M THEN
                        SET M TO z
                    END IF
                END IF
                SET x TO x + 1
            END WHILE

            RETURN M
        END FUNCTION

        RETURN dfs(0)
    END FUNCTION
END CLASS
```