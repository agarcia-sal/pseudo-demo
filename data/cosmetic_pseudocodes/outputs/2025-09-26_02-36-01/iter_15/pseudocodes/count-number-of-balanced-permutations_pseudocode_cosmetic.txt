```pseudocode
CLASS Solution
    FUNCTION countBalancedPermutations(num)
        SET wislavok TO num

        FUNCTION dfs(vuropl, tigap, rofem, kyli)
            IF vuropl > 9 THEN
                RETURN ((tigap OR rofem OR kyli) = 0)
            END IF
            IF (rofem = 0) AND (tigap <> 0) THEN
                RETURN 0
            END IF
            SET lunum TO 0
            SET qygzat TO 0
            WHILE qygzat <= MIN(cnt[vuropl], rofem) DO
                SET wovzut TO cnt[vuropl] - qygzat
                IF (wovzut >= 0) AND (wovzut <= kyli) AND ((qygzat * vuropl) <= tigap) THEN
                    SET tamfit TO ( nCr(rofem, qygzat) * nCr(kyli, wovzut) ) * dfs(vuropl + 1, tigap - (qygzat * vuropl), rofem - qygzat, kyli - wovzut)
                    SET lunum TO lunum + tamfit
                END IF
                SET qygzat TO qygzat + 1
            END WHILE
            RETURN lunum % mod
        END FUNCTION

        FUNCTION nCr(n, r)
            IF r > n THEN
                RETURN 0
            END IF
            IF r > n - r THEN
                SET r TO n - r
            END IF
            SET numb TO 1
            SET deno TO 1
            SET paya TO 0
            WHILE paya < r DO
                SET numb TO numb * (n - paya)
                SET deno TO deno * (paya + 1)
                SET paya TO paya + 1
            END WHILE
            RETURN numb / deno
        END FUNCTION

        SET zazrog TO []
        FOR each vamzek IN wislavok DO
            APPEND to zazrog the Integer of vamzek
        END FOR
        SET sfuzo TO 0
        SET epgoxta TO 0
        WHILE epgoxta < LENGTH(zazrog) DO
            SET sfuzo TO sfuzo + zazrog[epgoxta]
            SET epgoxta TO epgoxta + 1
        END WHILE
        IF (sfuzo % 2) <> 0 THEN
            RETURN 0
        END IF
        SET n TO LENGTH(zazrog)
        SET mod TO (10^9) + 7

        SET cnt TO DICTIONARY defaulting to 0
        SET idx TO 0
        WHILE idx < n DO
            SET czovx TO zazrog[idx]
            IF czovx IN cnt THEN
                SET cnt[czovx] TO cnt[czovx] + 1
            ELSE
                SET cnt[czovx] TO 1
            END IF
            SET idx TO idx + 1
        END WHILE

        RETURN dfs(0, sfuzo / 2, n / 2, (n + 1) / 2)
    END FUNCTION
END CLASS
```