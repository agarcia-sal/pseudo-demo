CLASS Solution
    FUNCTION numberOfStableArrays(zero, one, limit)
    CONSTANT MODULO_VALUE = (10 * 10 * 10 * 10 * 10 * 10 * 10 * 10 * 10) + 1

    FUNCTION dp(zt_Rem, on_Rem, lastChar, lastLen)
        VARIABLE accRes := 0

        IF zt_Rem = 0 AND on_Rem = 0 THEN
            RETURN 1
        END IF

        IF zt_Rem < 0 OR on_Rem < 0 THEN
            RETURN 0
        END IF

        IF NOT (lastChar = zero AND lastLen >= limit) THEN
            VARIABLE nextRunLen := 0
            IF lastChar = zero THEN
                SET nextRunLen = lastLen + 1
            ELSE
                SET nextRunLen = 1
            END IF
            SET accRes = (accRes + dp(zt_Rem - 1, on_Rem, zero, nextRunLen)) MOD MODULO_VALUE
        END IF

        IF NOT (lastChar = one AND lastLen >= limit) THEN
            VARIABLE nextRunLen := 0
            IF lastChar = one THEN
                SET nextRunLen = lastLen + 1
            ELSE
                SET nextRunLen = 1
            END IF
            SET accRes = (accRes + dp(zt_Rem, on_Rem - 1, one, nextRunLen)) MOD MODULO_VALUE
        END IF

        RETURN accRes
    END FUNCTION

    VARIABLE resFinal := dp(zero, one, -1, 0)
    RETURN resFinal
END FUNCTION
END CLASS