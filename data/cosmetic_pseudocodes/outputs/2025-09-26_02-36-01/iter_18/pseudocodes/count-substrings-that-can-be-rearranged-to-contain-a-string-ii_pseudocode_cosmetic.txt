```pseudocode
CLASS Solution
    FUNCTION validSubstringCount(word1, word2)
        IMPORT Counter FROM collections

        SET kqzbnm TO Counter(word2)
        SET wsrytp TO Counter()
        SET lcfuvx TO 0
        SET dgheoj TO 0
        SET bximrw TO 0
        SET pnkael TO 0

        SET tnovcm TO LENGTH(word1)
        SET quhfba TO LENGTH(word2)

        FUNCTION recurse(rhgdvo, bximrw, wsrytp, dgheoj, lcfuvx, pnkael) RETURNS INTEGER
            IF rhgdvo >= tnovcm THEN
                RETURN bximrw
            ELSE
                SET memeft TO word1[rhgdvo]
                wsrytp[memeft] = wsrytp[memeft] + 1

                IF (memeft IN kqzbnm) AND (wsrytp[memeft] = kqzbnm[memeft]) THEN
                    SET dgheoj TO dgheoj + 1
                END IF

                WHILE (dgheoj = lcfuvx) AND ((rhgdvo + 1 - pnkael) >= quhfba) DO
                    SET bximrw TO bximrw + (tnovcm - rhgdvo)
                    SET edjliq TO word1[pnkael]
                    wsrytp[edjliq] = wsrytp[edjliq] - 1
                    IF (edjliq IN kqzbnm) AND (wsrytp[edjliq] < kqzbnm[edjliq]) THEN
                        SET dgheoj TO dgheoj - 1
                    END IF
                    SET pnkael TO pnkael + 1
                END WHILE

                RETURN recurse(rhgdvo + 1, bximrw, wsrytp, dgheoj, lcfuvx, pnkael)
            END IF
        END FUNCTION

        SET lcfuvx TO LENGTH(kqzbnm)
        RETURN recurse(0, bximrw, wsrytp, dgheoj, lcfuvx, pnkael)
    END FUNCTION
END CLASS
```