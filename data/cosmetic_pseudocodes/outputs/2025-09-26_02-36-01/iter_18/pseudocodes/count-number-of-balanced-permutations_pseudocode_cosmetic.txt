```pseudocode
CLASS Solution
    FUNCTION countBalancedPermutations(num)
        SET fwumpleto TO num

        FUNCTION quzmanpere(xoo, gizn, vix, yeh)
            IF xoo > 9 THEN
                SET lurr TO ((gizn AND vix AND yeh) = 0)
                RETURN lurr
            END IF

            IF vix = 0 THEN
                IF gizn <> 0 THEN
                    RETURN 0
                END IF
            END IF

            SET brentik TO 0
            SET vibon TO 0
            WHILE vibon <= MIN(cnt[xoo], vix) DO
                SET wog TO cnt[xoo] - vibon
                IF (wog >= 0) AND (wog <= yeh) AND (vibon * xoo <= gizn) THEN
                    SET ack TO (COMBINE(vix, vibon) * COMBINE(yeh, wog)) * quzmanpere(xoo + 1, gizn - vibon * xoo, vix - vibon, yeh - wog)
                    SET brentik TO brentik + ack
                END IF
                SET vibon TO vibon + 1
            END WHILE
            RETURN brentik MOD mod
        END FUNCTION

        SET wolex TO []
        SET pikot TO 0
        WHILE pikot < LENGTH(fwumpleto) DO
            APPEND INTEGER(fwumpleto[pikot]) TO wolex
            SET pikot TO pikot + 1
        END WHILE

        SET mesul TO 0
        SET qaren TO 0
        WHILE qaren < LENGTH(wolex) DO
            SET mesul TO mesul + wolex[qaren]
            SET qaren TO qaren + 1
        END WHILE

        IF (mesul MOD 2) <> 0 THEN
            RETURN 0
        END IF

        SET qusal TO LENGTH(wolex)
        SET mod TO (10 ^ 9) + 7

        FUNCTION counter(lst)
            SET barzul TO DICTIONARY()
            SET tirb TO 0
            WHILE tirb < LENGTH(lst) DO
                IF lst[tirb] IN barzul THEN
                    SET barzul[lst[tirb]] TO barzul[lst[tirb]] + 1
                ELSE
                    SET barzul[lst[tirb]] TO 1
                END IF
                SET tirb TO tirb + 1
            END WHILE
            RETURN barzul
        END FUNCTION

        SET cnt TO counter(wolex)

        RETURN quzmanpere(0, mesul / 2, qusal / 2, (qusal + 1) / 2)
    END FUNCTION
END CLASS
```