```pseudocode
CLASS Solution
    FUNCTION unmarkedSumArray(nums FUNCTION PARAMETER, queries FUNCTION PARAMETER) RETURNS list
        SET temp_heap TO []
        SET p TO 0
        WHILE p < LENGTH(nums)
            APPEND (nums[p], p) TO temp_heap
            SET p TO p + 1
        END WHILE

        CALL heapify ON temp_heap

        SET visited TO {}
        SET aggregate TO 0
        SET q TO 0
        WHILE q < LENGTH(nums)
            SET aggregate TO aggregate + nums[q]
            SET q TO q + 1
        END WHILE

        SET output_list TO []

        SET m TO 0
        WHILE m < LENGTH(queries)
            SET current_j TO queries[m][0]
            SET current_l TO queries[m][1]

            IF NOT (current_j IN visited) THEN
                ADD current_j TO visited
                SET aggregate TO aggregate - nums[current_j]
            END IF

            SET x TO 0

            REPEAT
                IF x >= current_l OR LENGTH(temp_heap) = 0 THEN
                    EXIT REPEAT
                END IF

                SET extracted TO heappop(temp_heap)
                SET val TO extracted[0]
                SET idx TO extracted[1]

                IF (idx IN visited) THEN
                    CONTINUE REPEAT
                END IF

                ADD idx TO visited
                SET aggregate TO aggregate - val
                SET x TO x + 1
            UNTIL FALSE

            APPEND aggregate TO output_list

            SET m TO m + 1
        END WHILE

        RETURN output_list
    END FUNCTION
END CLASS
```