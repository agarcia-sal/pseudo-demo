```pseudocode
CLASS Solution
    FUNCTION countKConstraintSubstrings(s parameter k parameter queries parameter) RETURNS LIST OF INTEGER
        SET zeta TO LENGTH OF s
        SET delta TO LIST OF 0 REPEATED zeta + 1 TIMES
        SET omega TO LIST OF 0 REPEATED zeta + 1 TIMES

        SET iota TO 0
        WHILE iota < zeta
            SET delta[iota + 1] TO delta[iota] + (s[iota] = '0' ? 1 : 0)
            SET omega[iota + 1] TO omega[iota] + (s[iota] = '1' ? 1 : 0)
            SET iota TO iota + 1
        END WHILE

        FUNCTION count_valid_substrings(alpha parameter beta parameter) RETURNS INTEGER
            SET gamma TO 0
            SET phi TO alpha
            REPEAT phi <= beta
                SET mu TO phi
                SET nu TO beta + 1
                WHILE mu < nu
                    SET xi TO FLOOR((mu + nu) / 2)
                    SET sigma TO delta[xi + 1] - delta[phi]
                    SET tau TO omega[xi + 1] - omega[phi]
                    IF (sigma <= k) OR (tau <= k)
                        SET mu TO xi + 1
                    ELSE
                        SET nu TO xi
                    END IF
                END WHILE
                SET psi TO mu - 1
                IF psi >= phi
                    SET gamma TO gamma + (psi - phi + 1)
                END IF
                SET phi TO phi + 1
            END REPEAT
            RETURN gamma
        END FUNCTION

        SET rho TO EMPTY LIST
        FOR EACH pair lambda, omicron IN queries
            APPEND count_valid_substrings(lambda, omicron) TO rho
        END FOR

        RETURN rho
    END FUNCTION
END CLASS
```