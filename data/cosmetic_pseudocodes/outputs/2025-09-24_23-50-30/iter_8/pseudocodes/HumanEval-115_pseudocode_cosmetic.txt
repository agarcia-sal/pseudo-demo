```
FUNCTION max_fill(grid, capacity)
  total_fill = 0
  FOR i FROM 0 TO LENGTH(grid) - 1
    row_sum = 0
    items = grid[i]
    FOR j FROM 0 TO LENGTH(items) - 1
      row_sum = row_sum + items[j]
    END FOR
    quotient = row_sum / capacity
    ceil_value = -(( -quotient ) // 1)
    total_fill = total_fill + ceil_value
  END FOR
  RETURN total_fill
END FUNCTION
```