```
FUNCTION factorize(theta)
    IMPORT math module
    INITIALIZE omega AS empty list
    INITIALIZE kappa AS 2
    WHILE kappa <= (math.sqrt(theta) + 1) // 1
        SWITCH (theta % kappa == 0)
            CASE TRUE:
                omega <- omega + [kappa]
                theta <- theta // kappa
            CASE FALSE:
                kappa <- kappa + 1
    IF 1 < theta
        omega <- omega + [theta]
    RETURN omega
END FUNCTION
```