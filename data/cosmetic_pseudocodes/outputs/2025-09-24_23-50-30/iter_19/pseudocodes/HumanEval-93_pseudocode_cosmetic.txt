```
FUNCTION encode(text) {
  DEFINE map := EMPTY_DICTIONARY
  FOR c IN "aeiouAEIOU" DO {
    map[c] <- CHAR(ORD(c) + 2)
  }
  
  LET swapped := ""
  FOR ch IN text DO {
    LET upper := ch >= 'A' AND ch <= 'Z'
    LET lower := ch >= 'a' AND ch <= 'z'
    IF upper THEN swapped <- swapped + TO_LOWER(ch)
    ELSE IF lower THEN swapped <- swapped + TO_UPPER(ch)
    ELSE swapped <- swapped + ch
  }
  
  LET output <- NEW STRING_BUILDER
  FOR k IN RANGE(0, LENGTH(swapped)) DO {
    LET elem := swapped[k]
    IF elem IN map THEN output.APPEND(map[elem])
    ELSE output.APPEND(elem)
  }
  RETURN output.TO_STRING()
}
```