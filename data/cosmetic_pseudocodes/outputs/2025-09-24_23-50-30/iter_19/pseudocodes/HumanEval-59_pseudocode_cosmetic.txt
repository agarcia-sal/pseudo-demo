```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        IF NOT (k GREATERTHAN 1) THEN RETURN False
        SET m TO 2
        WHILE m LESS THAN k DO
            IF (k MOD m) EQUALS 0 THEN RETURN False
            SET m TO m PLUS 1
        END WHILE
        RETURN True
    END FUNCTION

    SET candidate TO 2
    SET best TO 1
    WHILE candidate LESS OR EQUAL n DO
        IF (n MOD candidate) EQUALS 0 THEN
            IF is_prime(candidate) THEN
                IF best LESS THAN candidate THEN SET best TO candidate END IF
            END IF
        END IF
        SET candidate TO candidate PLUS 1
    END WHILE
    RETURN best
END FUNCTION
```