```
FUNCTION factorize(kappa)
  DECLARE omega AS empty array
  DECLARE psi AS 2
  DECLARE theta AS (kappa ^ 0.5) FLOOR + 1
  LOOP
    IF psi > theta THEN EXIT LOOP
    IF (kappa - (kappa // psi) * psi) == 0 THEN
      APPEND psi TO omega
      SET kappa TO kappa // psi
      SET theta TO (kappa ^ 0.5) FLOOR + 1
      CONTINUE LOOP
    END IF
    SET psi TO psi + 1
  END LOOP
  IF kappa > 1 THEN APPEND kappa TO omega
  RETURN omega
END FUNCTION
```