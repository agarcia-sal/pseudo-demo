```
FUNCTION check_dict_case(map)
  IF map KEYS LENGTH = 0 THEN RETURN False
  STATE ← "start"
  INDEX ← 0
  WHILE INDEX < map KEYS LENGTH DO
    ITEM ← map KEYS AT INDEX
    IF NOT (ITEM IS STRING) THEN
      STATE ← "mixed"
      EXIT WHILE
    ELSE IF STATE = "start" THEN
      STATE ← (IF ITEM EQUALS ITEM TO UPPERCASE THEN "upper" ELSE IF ITEM EQUALS ITEM TO LOWERCASE THEN "lower" ELSE BREAK WHILE)
    ELSE IF (STATE = "upper" AND ITEM ≠ ITEM TO UPPERCASE) OR (STATE = "lower" AND ITEM ≠ ITEM TO LOWERCASE) THEN
      STATE ← "mixed"
      EXIT WHILE
    ELSE IF STATE ≠ "upper" AND STATE ≠ "lower" THEN
      BREAK WHILE
    END IF
    INDEX ← INDEX + 1
  END WHILE
  RETURN (STATE = "upper") OR (STATE = "lower")
END FUNCTION
```