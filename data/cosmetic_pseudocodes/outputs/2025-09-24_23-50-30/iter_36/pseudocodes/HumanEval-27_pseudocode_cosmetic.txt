```
FUNCTION flip_case(source_text)
    DEFINE FUNCTION transform_at(index, length, text):
        IF index >= length THEN
            RETURN empty_sequence
        ELSE
            DEFINE current_character = text[index]
            DEFINE toggled_character = 
                IF current_character >= 'a' AND current_character <= 'z' THEN
                    uppercase_of(current_character)
                ELSE IF current_character >= 'A' AND current_character <= 'Z' THEN
                    lowercase_of(current_character)
                ELSE
                    current_character
            ENDIF
            RETURN concatenation_of(toggled_character, transform_at(index + 1, length, text))
        ENDIF
    END DEFINE

    RETURN transform_at(0, length_of(source_text), source_text)
END FUNCTION
```