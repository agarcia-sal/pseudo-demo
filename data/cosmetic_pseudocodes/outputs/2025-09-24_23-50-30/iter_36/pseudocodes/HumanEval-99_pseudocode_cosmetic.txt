```pseudocode
FUNCTION closest_integer(inputstr)
    IMPORT floor, ceil FROM math

    FUNCTION strip_trailing_zeros_rec(s)
        IF LENGTH(s) > 0 AND LAST_CHAR(s) = '0'
            RETURN strip_trailing_zeros_rec(ALL_BUT_LAST_CHAR(s))
        ELSE
            RETURN s
        END IF
    END FUNCTION

    FUNCTION count_char(s, ch, idx, acc)
        IF idx >= LENGTH(s)
            RETURN acc
        ELSE
            RETURN count_char(s, ch, idx + 1, acc + IF s[idx] = ch THEN 1 ELSE 0)
        END IF
    END FUNCTION

    IF count_char(inputstr, '.', 0, 0) = 1
        SET inputstr TO strip_trailing_zeros_rec(inputstr)
    END IF

    SET numeric_val TO FLOAT(inputstr)

    FUNCTION ends_with_suffix(s, suffix)
        SET s_len TO LENGTH(s)
        SET suf_len TO LENGTH(suffix)
        IF s_len < suf_len
            RETURN FALSE
        ELSE
            RETURN ALL_CHAR_AT(s, s_len - suf_len, suf_len) = suffix
        END IF
    END FUNCTION

    IF ends_with_suffix(inputstr, ".5")
        IF numeric_val > 0 THEN
            RETURN ceil(numeric_val)
        ELSE
            RETURN floor(numeric_val)
        END IF
    ELSE IF LENGTH(inputstr) > 0
        RETURN ROUND(numeric_val)
    ELSE
        RETURN 0
    END IF
END FUNCTION
```