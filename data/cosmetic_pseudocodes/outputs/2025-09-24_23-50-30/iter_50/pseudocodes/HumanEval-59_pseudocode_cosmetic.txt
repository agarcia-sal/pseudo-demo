```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        RETURN NOT (k < 2) AND NOT EXISTS(i in SEQUENCE(2, k-1)) WHERE (k MOD i = 0)
    END FUNCTION

    SET result_accumulator TO 1
    SET divisor_candidates TO LIST_FROM_RANGE(2, n)
    SET index_tracker TO 0
    WHILE index_tracker < LENGTH(divisor_candidates)
        SET current_divisor TO divisor_candidates[index_tracker]
        IF (n MOD current_divisor = 0) AND is_prime(current_divisor)
            SET result_accumulator TO (IF result_accumulator > current_divisor THEN result_accumulator ELSE current_divisor)
        SET index_tracker TO index_tracker + 1
    RETURN result_accumulator
END FUNCTION
```