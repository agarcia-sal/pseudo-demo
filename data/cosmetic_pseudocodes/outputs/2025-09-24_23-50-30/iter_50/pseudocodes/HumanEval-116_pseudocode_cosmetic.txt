```
FUNCTION sort_array(array_of_integers)
    FUNCTION count_ones_in_bin(num_x)
        SET bin_str_representation TO CONVERT_TO_BINARY(num_x)
        SET count_ones TO 0
        FOR idx IN RANGE(2, LENGTH(bin_str_representation))
            IF bin_str_representation[idx] == '1'
                SET count_ones TO count_ones + 1
            ENDIF
        ENDFOR
        RETURN count_ones
    END FUNCTION

    SET temp_array TO COPY(array_of_integers)
    SET temp_array TO temp_array SORTED BY (a, b) -> IF a < b THEN -1 ELSE IF a > b THEN 1 ELSE 0
    SET key_value_pairs TO EMPTY_LIST
    FOR each_element IN temp_array
        ADD (each_element, count_ones_in_bin(each_element)) TO key_value_pairs
    ENDFOR

    FUNCTION insertion_sort_by_key(arr_pairs)
        FOR i FROM 1 TO LENGTH(arr_pairs) - 1
            SET current_pair TO arr_pairs[i]
            SET j TO i - 1
            WHILE j >= 0 AND arr_pairs[j][1] > current_pair[1]
                SET arr_pairs[j + 1] TO arr_pairs[j]
                SET j TO j - 1
            ENDWHILE
            SET arr_pairs[j + 1] TO current_pair
        ENDFOR
        RETURN arr_pairs
    END FUNCTION

    SET sorted_pairs TO insertion_sort_by_key(key_value_pairs)
    SET final_result TO EMPTY_LIST
    FOR pair IN sorted_pairs
        APPEND pair[0] TO final_result
    ENDFOR

    RETURN final_result
END FUNCTION
```