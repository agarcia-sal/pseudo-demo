```
FUNCTION flip_case(source_text)
    FUNCTION toggle_character(index, accumulator)
        IF index >= LENGTH(source_text)
            RETURN accumulator
        ELSE
            SET current_char = source_text[index]
            SET is_upper = (current_char >= 'A') AND (current_char <= 'Z')
            SET new_char = (is_upper) ? TO_LOWER(current_char) : TO_UPPER(current_char)
            RETURN toggle_character(index + 1, accumulator + new_char)
        END IF
    END FUNCTION

    RETURN toggle_character(0, "")
END FUNCTION
```