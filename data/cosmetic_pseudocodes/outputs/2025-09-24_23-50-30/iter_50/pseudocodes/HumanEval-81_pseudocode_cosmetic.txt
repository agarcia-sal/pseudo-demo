```
FUNCTION numerical_letter_grade(list_of_grades)
    FUNCTION classify_indexed(index, result)
        IF index EQUALS length(list_of_grades) THEN
            RETURN result
        ELSE
            SET val = list_of_grades[index]
            IF NOT (val < 4.0) AND val = 4.0 THEN
                SET label = "A+"
            ELSE
                SWITCH true
                    CASE val > 3.7:
                        SET label = "A"
                    CASE val > 3.3:
                        SET label = "A-"
                    CASE val > 3.0:
                        SET label = "B+"
                    CASE val > 2.7:
                        SET label = "B"
                    CASE val > 2.3:
                        SET label = "B-"
                    CASE val > 2.0:
                        SET label = "C+"
                    CASE val > 1.7:
                        SET label = "C"
                    CASE val > 1.3:
                        SET label = "C-"
                    CASE val > 1.0:
                        SET label = "D+"
                    CASE val > 0.7:
                        SET label = "D"
                    CASE val > 0.0:
                        SET label = "D-"
                    DEFAULT:
                        SET label = "E"
                END SWITCH
            END IF
            RETURN classify_indexed(index + 1, result + [label])
        END IF
    END FUNCTION
    RETURN classify_indexed(0, [])
END FUNCTION
```