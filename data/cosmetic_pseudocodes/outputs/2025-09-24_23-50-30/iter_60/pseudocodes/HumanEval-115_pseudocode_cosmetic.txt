```
FUNCTION max_fill(matrix, limit)
    IMPORT math
    FUNCTION inner_sum(lst)
        IF lst = [] THEN
            RETURN 0
        ELSE
            RETURN lst[0] + inner_sum(SLICE lst FROM 1)
        END IF
    END FUNCTION

    FUNCTION map_ceil(input_list)
        IF input_list = [] THEN
            RETURN []
        ELSE
            RETURN [ math ceiling((input_list[0]) / limit) ] + map_ceil(SLICE input_list FROM 1)
        END IF
    END FUNCTION

    FUNCTION reduce_sum(num_list)
        FUNCTION loop(index, acc)
            IF index = LENGTH(num_list) THEN
                RETURN acc
            ELSE
                RETURN loop(index + 1, acc + num_list[index])
            END IF
        END FUNCTION
        RETURN loop(0, 0)
    END FUNCTION

    RETURN reduce_sum(map_ceil([ inner_sum(row) FOR row IN matrix ]))
END FUNCTION
```