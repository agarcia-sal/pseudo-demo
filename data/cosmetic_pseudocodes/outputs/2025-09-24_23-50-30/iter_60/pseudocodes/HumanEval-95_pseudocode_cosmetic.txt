```
FUNCTION check_dict_case(p1)
  PROCEDURE recur(p2, p3)
    SWITCH
      CASE LENGTH OF p2 KEYS IS 0: RETURN False
      CASE p3 = "start":
        IF LENGTH OF p2 KEYS = 0 THEN RETURN False
        ELSE
          LET p4 := HEAD OF p2 KEYS
          LET p5 := TAIL OF p2 KEYS
          IF NOT p4 IS INSTANCE OF STRING THEN RETURN False
          ELSE
            SWITCH
              CASE (p4 = UPPERCASE(p4)): LET p6 := "upper"
              CASE (p4 = LOWERCASE(p4)): LET p6 := "lower"
              DEFAULT: RETURN False
            END SWITCH
          END IF
          RETURN recur(CONSTRUCT_DICT(p5, p2), p6)
        END ELSE
      CASE (p3 = "upper") OR (p3 = "lower"):
        IF LENGTH OF p2 KEYS = 0 THEN RETURN True
        LET p7 := HEAD OF p2 KEYS
        LET p8 := TAIL OF p2 KEYS
        IF NOT p7 IS INSTANCE OF STRING THEN RETURN False
        ELSE
          IF p3 = "upper" THEN
            IF p7 = UPPERCASE(p7) THEN
              RETURN recur(CONSTRUCT_DICT(p8, p2), p3)
            ELSE RETURN False
            END IF
          ELSE
            IF p7 = LOWERCASE(p7) THEN
              RETURN recur(CONSTRUCT_DICT(p8, p2), p3)
            ELSE RETURN False
            END IF
          END IF
        END IF
      DEFAULT: RETURN False
    END SWITCH
  END PROCEDURE
  RETURN recur(p1, "start")
END FUNCTION
```