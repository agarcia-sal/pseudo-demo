```
FUNCTION closest_integer(input)
    IMPORT floor, ceil FROM math

    IF (COUNT '.' IN input) = 1 THEN
        WHILE (input[-1] = '0') DO
            input ← SUBSTRING(input, 0, LENGTH(input) - 1)
        END WHILE
    END IF

    num_val ← TO_FLOAT(input)

    CASE
        WHEN LENGTH(input) > 1 AND SUBSTRING(input, LENGTH(input) - 2, 2) = '.5' THEN
            IF num_val > 0 THEN
                output ← ceil(num_val)
            ELSE
                output ← floor(num_val)
            END IF
        WHEN LENGTH(input) > 0 THEN
            output ← ROUND(num_val)
        ELSE
            output ← 0
    END CASE

    RETURN output
END FUNCTION
```