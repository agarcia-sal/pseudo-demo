```
FUNCTION largest_prime_factor(m)
    FUNCTION is_prime(p)
        SET x TO 2
        WHILE NOT (p < 2) AND x < p
            IF (p MOD x) = 0 THEN
                RETURN False
            SET x TO x + 1
        END WHILE
        IF p < 2 THEN
            RETURN False
        ELSE
            RETURN True
    END FUNCTION

    SET r TO 1
    SET q TO 2
    WHILE q <= m
        IF ((m MOD q) = 0) AND is_prime(q)
            IF r < q THEN
                SET r TO q
        SET q TO q + 1
    RETURN r
END FUNCTION
```