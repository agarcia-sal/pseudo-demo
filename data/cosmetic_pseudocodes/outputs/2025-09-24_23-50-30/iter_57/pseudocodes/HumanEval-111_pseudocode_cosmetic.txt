```
FUNCTION histogram(test_string)
  INITIALIZE freq_map AS empty dictionary
  INITIALIZE chars_list AS SPLIT test_string BY " "
  INITIALIZE top_freq TO 0

  FOR idx FROM 0 TO LENGTH OF chars_list - 1 DO
    LET current_char BE chars_list[idx]
    LET char_count BE 0
    LET scan_idx BE 0
    WHILE scan_idx < LENGTH OF chars_list DO
      IF chars_list[scan_idx] = current_char THEN
        char_count <- char_count + 1
      scan_idx <- scan_idx + 1
    END WHILE
    IF char_count > 0 AND NOT (current_char = "") THEN
      IF char_count > top_freq THEN
        top_freq <- char_count
      END IF
    END IF
  END FOR

  IF NOT (top_freq <= 0) THEN
    FOR pos FROM 0 TO LENGTH OF chars_list - 1 DO
      LET candidate_char BE chars_list[pos]
      LET frequency_count BE 0
      LET iter_pos BE 0
      WHILE iter_pos < LENGTH OF chars_list DO
        IF chars_list[iter_pos] = candidate_char THEN
          frequency_count <- frequency_count + 1
        END IF
        iter_pos <- iter_pos + 1
      END WHILE
      IF frequency_count = top_freq THEN
        freq_map[candidate_char] <- top_freq
      END IF
    END FOR
  END IF

  RETURN freq_map
END FUNCTION
```