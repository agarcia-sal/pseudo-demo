```
FUNCTION max_fill(matrix, limit)
    IMPORT math
    VARIABLE acc = 0
    FOR EACH row_element IN matrix DO
        VARIABLE total_value = 0
        VARIABLE idx = 0
        WHILE idx < LENGTH(row_element) DO
            total_value <- total_value + row_element[idx]
            idx <- idx + 1
        END WHILE
        acc <- acc + math.ceiling(total_value / limit)
    END FOR
    RETURN acc
END FUNCTION
```