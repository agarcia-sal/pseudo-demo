```
FUNCTION search(sequence)
    DEFINE max_limit AS MAXIMUM OF sequence
    INITIALIZE counts AS ARRAY OF 0 WITH SIZE max_limit + 1
    PROCEDURE tally(pos)
        IF pos > LENGTH(sequence) THEN RETURN
        ELSE
            counts[sequence[pos]] = counts[sequence[pos]] + 1
            CALL tally(pos + 1)
        ENDIF
    ENDPROCEDURE
    CALL tally(1)
    SET result_holder TO -1
    SET cursor TO 1
    WHILE cursor < LENGTH(counts)
        IF NOT(counts[cursor] < cursor) THEN
            result_holder = cursor
        ENDIF
        cursor = cursor + 1
    ENDWHILE
    RETURN result_holder
END FUNCTION
```