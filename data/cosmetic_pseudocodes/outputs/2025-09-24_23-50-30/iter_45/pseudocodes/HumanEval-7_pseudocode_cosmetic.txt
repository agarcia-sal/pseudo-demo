```
FUNCTION filter_by_substring(collection_strings, query_substring)
    DEFINE result_collection AS EMPTY ARRAY
    FOR INDEX idx FROM 1 TO LENGTH(collection_strings)
        IF NOT (query_substring NOT IN collection_strings[idx]) THEN
            APPEND collection_strings[idx] TO result_collection
        END IF
    END FOR
    RETURN result_collection
END FUNCTION
```