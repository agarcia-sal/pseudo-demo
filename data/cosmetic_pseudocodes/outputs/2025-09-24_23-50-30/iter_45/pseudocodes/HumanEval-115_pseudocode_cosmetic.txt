```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    FUNCTION helper(accumulator, idx)
        IF idx >= LENGTH(grid) THEN
            RETURN accumulator
        ELSE
            DECLARE temp_sum = 0
            FOR element_idx FROM 0 TO LENGTH(grid[idx]) - 1 DO
                SET temp_sum = temp_sum + grid[idx][element_idx]
            END FOR
            RETURN helper(accumulator + math.ceil(temp_sum / capacity), idx + 1)
        END IF
    END FUNCTION
    RETURN helper(0, 0)
END FUNCTION
```