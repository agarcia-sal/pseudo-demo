```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        IF NOT (k >= 2)
            RETURN False
        SET idx TO 2
        WHILE idx < k
            IF (k MOD idx) = 0
                RETURN False
            SET idx TO idx + 1
        RETURN True
    END FUNCTION

    SET candidate TO 2
    SET max_factor TO 1
    WHILE candidate <= n
        IF ((n MOD candidate) = 0) AND (is_prime(candidate))
            IF candidate > max_factor
                SET max_factor TO candidate
        SET candidate TO candidate + 1
    RETURN max_factor
END FUNCTION
```