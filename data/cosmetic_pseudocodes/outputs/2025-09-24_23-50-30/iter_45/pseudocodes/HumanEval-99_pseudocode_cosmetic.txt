```
FUNCTION closest_integer(value)
    IMPORT floor, ceil FROM math

    FUNCTION strip_trailing_zeros(str_val)
        IF COUNT OF '.' IN str_val != 1 THEN
            RETURN str_val
        ELSE
            WHILE str_val[-1] == '0'
                SET str_val TO SUBSTRING OF str_val FROM 0 TO LENGTH(str_val) - 1
            END WHILE
            RETURN str_val
        END IF
    END FUNCTION

    SET processed_string TO strip_trailing_zeros(value)
    SET number_value TO FLOAT(processed_string)

    IF LENGTH(processed_string) > 1 AND SUBSTRING(processed_string, LENGTH(processed_string) - 2, LENGTH(processed_string)) == '.5' THEN
        IF number_value > 0 THEN
            SET closest_num TO ceil(number_value)
        ELSE 
            SET closest_num TO floor(number_value)
        END IF
    ELSE IF LENGTH(processed_string) >= 1 THEN
        SET closest_num TO ROUND(number_value)
    ELSE
        SET closest_num TO 0
    END IF
    
    RETURN closest_num
END FUNCTION
```