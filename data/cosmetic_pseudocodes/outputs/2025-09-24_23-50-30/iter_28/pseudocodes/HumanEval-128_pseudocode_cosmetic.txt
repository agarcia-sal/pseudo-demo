```
FUNCTION prod_signs(q)
    PROCEDURE r(p, w)
        IF p IS EMPTY THEN RETURN w END IF
        RETURN r(REST OF p, w + ABSOLUTE VALUE OF FIRST ELEMENT OF p)
    END PROCEDURE

    IF LENGTH OF q = 0 THEN RETURN None END IF

    PROCEDURE f(u, c)
        IF u IS EMPTY THEN RETURN c END IF
        c := c + CASE (FIRST ELEMENT OF u = 0) OF
                     TRUE: 0;
                     FALSE: IF FIRST ELEMENT OF u < 0 THEN 1 ELSE 0 END IF
                 END CASE
        RETURN f(REST OF u, c)
    END PROCEDURE

    x := f(q, 0)

    CASE x OF
        0:
            y := 0
        1..MAXINT:
            y := (-1) ^ (x - 1)
    END CASE

    z := r(q, 0)

    RETURN y * z
END FUNCTION
```