```
FUNCTION max_fill(grid, capacity)
    FUNCTION helper(index, acc)
        IF NOT (index < LENGTH(grid)) THEN
            RETURN acc
        ENDIF
        VAR row_total <- 0
        FOR i <- 0 TO LENGTH(grid[index]) - 1 DO
            row_total <- row_total + grid[index][i]
        ENDFOR
        VAR ceil_div <- -( ( -row_total ) \ capacity )
        RETURN helper(index + 1, acc + ceil_div)
    ENDFUNCTION
    RETURN helper(0, 0)
END FUNCTION
```