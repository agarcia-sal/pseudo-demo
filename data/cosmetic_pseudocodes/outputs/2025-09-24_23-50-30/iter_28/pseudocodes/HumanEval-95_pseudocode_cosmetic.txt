```
FUNCTION check_dict_case(mu)
  DEFINE FUNCTION traverse(idx, sigma)
    IF idx >= LENGTH(mu KEYS)
      RETURN (sigma = "upper") OR (sigma = "lower")
    ELSE
      DEFINE p = mu KEYS AT idx
      SWITCH TRUE
        CASE NOT (p IS INSTANCE OF STRING):
          RETURN FALSE
        CASE sigma = "start":
          IF p = TO_UPPERCASE(p)
            RETURN traverse((idx + 1), "upper")
          ELSEIF p = TO_LOWERCASE(p)
            RETURN traverse((idx + 1), "lower")
          ELSE
            RETURN FALSE
          ENDIF
        CASE (sigma = "upper") AND (p <> TO_UPPERCASE(p)):
          RETURN FALSE
        CASE (sigma = "lower") AND (p <> TO_LOWERCASE(p)):
          RETURN FALSE
        DEFAULT:
          RETURN traverse((idx + 1), sigma)
      END SWITCH
    ENDIF
  IF LENGTH(mu KEYS) = 0
    RETURN FALSE
  ELSE
    RETURN traverse(0, "start")
  ENDIF
END FUNCTION
```