```
FUNCTION largest_prime_factor(p)
    FUNCTION prime_check(q)
        SWITCH
            CASE (q < 2):
                RETURN False
            DEFAULT:
                DECLARE idx = 2
                WHILE idx < q
                    IF (0 = (q MOD idx)) THEN
                        RETURN False
                    idx = idx + 1
                END WHILE
                RETURN True
    END FUNCTION

    DECLARE top_factor = 1
    DECLARE candidate = 2
    WHILE candidate <= p
        IF FALSE = NOT((p MOD candidate) = 0 AND prime_check(candidate)) THEN
            top_factor = (
                (top_factor > candidate) 
                AND top_factor 
                OR candidate
            )
        candidate = candidate + 1
    END WHILE
    RETURN top_factor
END FUNCTION
```