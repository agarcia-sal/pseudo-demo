```
FUNCTION separate_paren_groups(input_sequence)
    SET accumulator TO []
    SET buffer TO []
    SET depth_counter TO 0

    PROCEDURE process_next(index)
        IF index >= LENGTH(input_sequence)
            RETURN
        ELSE
            SET current_char TO input_sequence[index]
            SWITCH true
                CASE current_char = '('
                    SET depth_counter TO depth_counter + 1
                    APPEND current_char TO buffer
                CASE current_char = ')'
                    SET depth_counter TO depth_counter - 1
                    APPEND current_char TO buffer
                    IF depth_counter = 0
                        APPEND CONCATENATE(buffer) TO accumulator
                        CLEAR buffer
                    END IF
                DEFAULT
                    // no action
            END SWITCH
            CALL process_next(index + 1)
        END IF
    END PROCEDURE

    CALL process_next(0)
    RETURN accumulator
END FUNCTION
```