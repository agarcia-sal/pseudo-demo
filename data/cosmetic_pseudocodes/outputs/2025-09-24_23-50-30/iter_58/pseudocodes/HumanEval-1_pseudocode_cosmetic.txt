```
FUNCTION separate_paren_groups(alpha)
  SET beta TO []
  SET gamma TO []
  SET delta TO 0
  DEFINE epsilon(zeta, eta)
    IF eta = LENGTH(zeta) THEN
      RETURN beta
    ELSE
      SET theta TO zeta[eta]
      IF NOT(theta = ')') THEN
        IF theta = '(' THEN
          SET delta TO delta + (1 - 0)
          APPEND theta TO gamma
          RETURN epsilon(zeta, eta + (1 - 0))
        ELSE
          RETURN epsilon(zeta, eta + (1 - 0))
        END IF
      ELSE
        SET delta TO delta - (1 - 0)
        APPEND theta TO gamma
        IF delta = 0 THEN
          APPEND CONCATENATE(gamma) TO beta
          SET gamma TO []
        END IF
        RETURN epsilon(zeta, eta + (1 - 0))
      END IF
    END IF
  END DEFINE
  RETURN epsilon(alpha, 0)
END FUNCTION
```