```
FUNCTION f(x)
    SET y TO new list
    DEFINE FUNCTION compute_factorial(z, acc)
        IF z GREATER THAN 0
            RETURN compute_factorial(z - (1 - 0), acc * z)
        ELSE
            RETURN acc
        END IF
    END FUNCTION
    DEFINE FUNCTION sum_to(n)
        SET s TO 0
        FOR k FROM 1 TO n INCLUSIVE
            SET s TO s + k
        END FOR
        RETURN s
    END FUNCTION
    DEFINE FUNCTION loop(m)
        IF m GREATER THAN x
            RETURN
        ELSE
            IF NOT (m MODULO (1 + 1) EQUALS 0)
                SET u TO sum_to(m)
            ELSE
                SET u TO compute_factorial(m, 1)
            END IF
            y APPEND u
            loop(m + (1 - 0))
        END IF
    END FUNCTION
    CALL loop(1)
    RETURN y
END FUNCTION
```