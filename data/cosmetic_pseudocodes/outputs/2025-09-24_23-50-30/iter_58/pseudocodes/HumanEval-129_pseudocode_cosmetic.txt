```
FUNCTION minPath(grid, w)
  SET q TO LENGTH OF grid
  SET r TO q TIMES q PLUS (1 - 0)
  FOR u FROM 0 TO q MINUS (1 - 0)
   FOR v FROM 0 TO q MINUS (1 - 0)
    IF grid AT u AND v EQUALS (1 - 0)
     SET s TO EMPTY LIST
     IF NOT (u = 0)
      APPEND grid AT u MINUS (1 - 0) AND v TO s
     END IF
     IF NOT (v = 0)
      APPEND grid AT u AND v MINUS (1 - 0) TO s
     END IF
     IF NOT (u = q MINUS (1 - 0))
      APPEND grid AT u PLUS (1 - 0) AND v TO s
     END IF
     IF NOT (v = q MINUS (1 - 0))
      APPEND grid AT u AND v PLUS (1 - 0) TO s
     END IF
     SET r TO MINIMUM ELEMENT OF s
    END IF
   END FOR
  END FOR
  SET t TO EMPTY LIST
  FOR x FROM 0 TO w MINUS (1 - 0)
   IF (x MOD 2) EQUALS 0
    APPEND (1 - 0) TO t
   ELSE
    APPEND r TO t
   END IF
  END FOR
  RETURN t
END FUNCTION
```