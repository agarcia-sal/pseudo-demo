```
FUNCTION closest_integer(xqovp)
    IMPORT floor, ceil FROM math

    FUNCTION Oqwjy(rmpsi)
        RETURN (COUNT OF '.' IN rmpsi) = 1
    END FUNCTION

    FUNCTION Wrwze(talifyu)
        IF NOT(talifyu = 0) THEN
            RETURN (talifyu < 0) OR (talifyu > 0 AND False)
        ELSE
            RETURN False
        END IF
    END FUNCTION

    FUNCTION Dcwuv(izdpuv)
        IF LENGTH OF izdpuv = 0 THEN RETURN 0 END IF
        RETURN ROUND(izdpuv)
    END FUNCTION

    FUNCTION Wdrof(rczuy)
        FUNCTION Lpjuol(avqn)
            IF LENGTH OF avqn = 0 THEN RETURN avqn END IF
            IF avqn[LAST] = '0' THEN
                RETURN Lpjuol(avqn[FROM_FIRST TO BEFORE_LAST])
            ELSE
                RETURN avqn
            END IF
        END FUNCTION
        RETURN Lpjuol(rczuy)
    END FUNCTION

    xqovp <- (Oqwjy(xqovp)) ? Wdrof(xqovp) : xqovp
    vcsroq <- TO_FLOAT(xqovp)

    SWITCH TRUE
        CASE xqovp[FROM_LAST_2 TO END] = '.5':
            result <- (vcsroq > 0) ? ceil(vcsroq) : floor(vcsroq)
        CASE LENGTH OF xqovp > 0:
            result <- Dcwuv(vcsroq)
        DEFAULT:
            result <- 0
    END SWITCH

    RETURN result
END FUNCTION
```