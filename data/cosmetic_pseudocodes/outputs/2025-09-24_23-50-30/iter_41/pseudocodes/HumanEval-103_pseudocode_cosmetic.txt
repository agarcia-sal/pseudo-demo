```
FUNCTION rounded_avg(p, q)
    IF NOT (p <= q) THEN
        RETURN -1
    END IF
    FUNCTION sum_range(a, b, acc)
        IF a > b THEN
            RETURN acc
        ELSE
            RETURN sum_range(a + 1, b, acc + a)
        END IF
    END FUNCTION
    SET total AS sum_range(p, q, 0)
    SET count_val TO ((q - p) + 1)
    SET avg_val TO total / count_val
    SET rounded_val TO (avg_val + 0.5) - ((avg_val + 0.5) MOD 1)
    FUNCTION to_binary(num)
        IF num = 0 THEN
            RETURN "0"
        END IF
        FUNCTION bin_helper(x, res)
            IF x = 0 THEN
                RETURN res
            ELSE
                SET rem TO x MOD 2
                SET new_res TO CONCAT(rem, res)
                RETURN bin_helper(x DIV 2, new_res)
            END IF
        END FUNCTION
        RETURN bin_helper(num, "")
    END FUNCTION
    RETURN to_binary(rounded_val)
END FUNCTION
```