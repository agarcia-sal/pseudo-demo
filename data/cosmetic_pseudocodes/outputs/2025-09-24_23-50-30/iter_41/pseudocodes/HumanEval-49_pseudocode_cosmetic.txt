```
FUNCTION modp(q, r)
    SET s TO 0
    FUNCTION loop()
        IF s EQUALS q THEN
            RETURN 1
        ELSE
            SET t TO (2 MULTIPLIED BY loop()) MODULO r
            RETURN t
        END IF
    END FUNCTION
    RETURN loop()
END FUNCTION
```