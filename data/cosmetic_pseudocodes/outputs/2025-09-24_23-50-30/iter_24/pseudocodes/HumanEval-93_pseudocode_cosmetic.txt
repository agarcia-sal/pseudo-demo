```
FUNCTION encode(theta)
    DEFINE lambda AS "AEIOUaeiou"
    INITIALIZE mu AS EMPTY HASHMAP
    FOR k FROM 1 TO LENGTH(lambda)
        LET alpha = lambda[k]
        mu[alpha] = CHAR(CHAR_CODE(alpha) + 2)
    END FOR

    DEFINE rho AS EMPTY STRING
    FOR q FROM 1 TO LENGTH(theta)
        LET sigma = theta[q]
        IF sigma IS UPPERCASE THEN
            APPEND TO rho LOWERCASE(sigma)
        ELSE IF sigma IS LOWERCASE THEN
            APPEND TO rho UPPERCASE(sigma)
        ELSE
            APPEND TO rho sigma
        END IF
    END FOR

    LET phi AS EMPTY STRING
    SET i TO 1
    WHILE i <= LENGTH(rho)
        LET zeta = rho[i]
        IF NOT (zeta IN lambda) THEN
            phi = phi + zeta
            i = i + 1
            CONTINUE WHILE
        END IF
        phi = phi + mu[zeta]
        i = i + 1
    END WHILE

    RETURN phi
END FUNCTION
```