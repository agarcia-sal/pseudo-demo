```
FUNCTION split_words(data)
    IF NOT (index_of(" ", data) < 0) THEN
        RETURN divide_by_whitespace(data)
    ELSE 
        IF 0 <= index_of(",", data) THEN
            SET temp TO substitute_all(data, ",", " ")
            RETURN divide_by_whitespace(temp)
        ENDIF
    ENDIF

    FUNCTION tally(chars, pos, acc)
        IF pos = length(chars) THEN RETURN acc ENDIF
        IF AND( is_lowercase(chars[pos]), remainder_code(chars[pos]) = 0 ) THEN
            RETURN tally(chars, pos + 1, acc + 1)
        ELSE
            RETURN tally(chars, pos + 1, acc)
        ENDIF
    ENDFUNCTION

    RETURN tally(as_array(data), 0, 0)
END FUNCTION
```