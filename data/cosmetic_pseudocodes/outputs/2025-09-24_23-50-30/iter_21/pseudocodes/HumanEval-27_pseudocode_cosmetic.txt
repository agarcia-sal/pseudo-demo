```
FUNCTION flip_case(text)
    DECLARE result AS EMPTY LIST
    DECLARE index AS INTEGER := 0
    WHILE index < LENGTH(text)
        DECLARE ch AS CHARACTER := text[index]
        IF ch == TO_UPPER(ch) THEN
            IF ch == TO_LOWER(ch) THEN
                APPEND result, ch
            ELSE
                APPEND result, TO_LOWER(ch)
            END IF
        ELSE
            APPEND result, TO_UPPER(ch)
        END IF
        INCREMENT index BY 1
    END WHILE
    RETURN JOIN(result)
END FUNCTION
```