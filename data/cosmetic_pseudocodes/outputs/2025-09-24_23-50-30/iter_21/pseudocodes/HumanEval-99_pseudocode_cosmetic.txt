```
FUNCTION closest_integer(input_value)
    IMPORT floor, ceil FROM math

    FUNCTION trim_trailing_zeros(str_val)
        IF (COUNT OF '.' IN str_val) != 1 THEN
            RETURN str_val
        END IF

        FUNCTION remove_zeros_rec(s)
            IF LENGTH OF s == 0 THEN
                RETURN s
            END IF

            IF LAST CHARACTER OF s == '0' THEN
                RETURN remove_zeros_rec(ALL CHARACTERS OF s EXCEPT THE LAST)
            ELSE
                RETURN s
            END IF
        END FUNCTION

        RETURN remove_zeros_rec(str_val)
    END FUNCTION

    DECLARE cleaned_value = trim_trailing_zeros(input_value)

    DECLARE numeric_value = FLOAT(cleaned_value)

    SWITCH TRUE
        CASE (LENGTH OF cleaned_value > 0) AND (LAST TWO CHARACTERS OF cleaned_value == '.5'):
            IF numeric_value > 0 THEN
                RETURN ceil(numeric_value)
            ELSE
                RETURN floor(numeric_value)
            END IF

        CASE (LENGTH OF cleaned_value > 0):
            RETURN ROUND(numeric_value)

        DEFAULT:
            RETURN 0
    END SWITCH
END FUNCTION
```