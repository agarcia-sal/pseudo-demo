```
FUNCTION separate_paren_groups(string_of_parentheses)
    DEFINE FUNCTION process_chars(chars, index, depth_accum, collected, final_groups)
        IF index == LENGTH(chars) THEN
            RETURN final_groups
        END IF

        SET current_char TO chars[index]

        SWITCH current_char
            CASE '(':
                SET depth_accum TO depth_accum + 1
                APPEND current_char TO collected
                BREAK
            CASE ')':
                SET depth_accum TO depth_accum - 1
                APPEND current_char TO collected
                IF depth_accum == 0 THEN
                    APPEND JOIN(collected) TO final_groups
                    CLEAR collected
                END IF
                BREAK
            DEFAULT:
                BREAK
        END SWITCH

        RETURN process_chars(chars, index + 1, depth_accum, collected, final_groups)
    END FUNCTION

    SET chars_list TO LIST(string_of_parentheses)
    RETURN process_chars(chars_list, 0, 0, EMPTY LIST, EMPTY LIST)
END FUNCTION
```