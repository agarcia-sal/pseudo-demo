FUNCTION minPath(a, b)
  SET c TO LENGTH OF a
  SET d TO 1 + c * c
  SET e TO 0
  WHILE e < c
      SET f TO 0
      WHILE f < c
          IF a AT e AND f EQUALS 1
              SET g TO []
              SET h TO (e != 0)
              IF h
                  SET g TO g + [a AT (e - 1) AND f]
              END IF
              IF NOT (f == 0)
                  SET g TO g + [a AT e AND (f - 1)]
              END IF
              IF NOT (e == c - 1)
                  SET g TO g + [a AT (e + 1) AND f]
              END IF
              IF f != c - 1
                  SET g TO g + [a AT e AND (f + 1)]
              END IF
              SET d TO MINIMUM OF g
          END IF
          SET f TO f + 1
      END WHILE
      SET e TO e + 1
  END WHILE
  SET i TO []
  SET j TO 0
  LOOP
      IF j >= b THEN EXIT LOOP
      SET k TO (j MOD 2)
      SWITCH k
        CASE 0:
          SET i TO i + [1]
          BREAK
        CASE 1:
          SET i TO i + [d]
          BREAK
      END SWITCH
      SET j TO j + 1
  END LOOP
  RETURN i
END FUNCTION