FUNCTION flip_case(str_input)  
    SET idx_counter TO 0  
    SET length_val TO LENGTH(str_input)  
    SET output_buf TO EMPTY STRING  
    WHILE idx_counter < length_val  
        SET char_val TO CHARACTER_AT(str_input, idx_counter)  
        IF (char_val >= 'A') AND (char_val <= 'Z') THEN  
            SET output_buf TO output_buf + TO_LOWER(char_val)  
        ELSE IF (char_val >= 'a') AND (char_val <= 'z') THEN  
            SET output_buf TO output_buf + TO_UPPER(char_val)  
        ELSE  
            SET output_buf TO output_buf + char_val  
        END IF  
        SET idx_counter TO idx_counter + 1  
    END WHILE  
    RETURN output_buf  
END FUNCTION