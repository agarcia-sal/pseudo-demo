FUNCTION separate_paren_groups(omega)  
  DECLARE xi = []  
  DECLARE upsilon = []  
  DECLARE zeta = 0  

  DECLARE FUNCTION helper(delta, theta, eta, kappa)  
    IF kappa >= LENGTH(delta)  
      RETURN theta  
    END IF  

    DECLARE lambda = delta[kappa]  
    IF lambda = '(' THEN  
      DECLARE new_eta = eta + 1  
      DECLARE new_theta = upsilon ++ [lambda]  
      RETURN helper(delta, new_theta, new_eta, kappa + 1)  
    ELSE IF lambda = ')' THEN  
      DECLARE new_eta = eta - 1  
      DECLARE new_theta = upsilon ++ [lambda]  
      IF new_eta = 0 THEN  
        DECLARE concatenated = CONCATENATE(new_theta)  
        DECLARE new_xi = xi ++ [concatenated]  
        xi = new_xi  
        upsilon = []  
        RETURN helper(delta, [], new_eta, kappa + 1)  
      ELSE  
        RETURN helper(delta, new_theta, new_eta, kappa + 1)  
      END IF  
    ELSE  
      RETURN helper(delta, upsilon, eta, kappa + 1)  
    END IF  
  END FUNCTION  

  xi = helper(omega, [], zeta, 0)  
  RETURN xi  
END FUNCTION