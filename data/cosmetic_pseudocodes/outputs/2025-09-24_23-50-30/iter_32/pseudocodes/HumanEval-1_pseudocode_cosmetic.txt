```
FUNCTION separate_paren_groups(m)
    SET X TO []
    SET Y TO []
    SET Z TO 0

    FOR EACH Q IN m DO
        SWITCH Q
            CASE '(':
                Z <- Z + 1
                ADD Q TO Y
            CASE ')':
                Z <- Z - 1
                ADD Q TO Y
                IF (Z == 0) THEN
                    ADD JOIN(Y) TO X
                    Y <- []
                END IF
        END SWITCH
    END FOR

    RETURN X
END FUNCTION
```