```
FUNCTION closest_integer(xrvci)
    IMPORT floor, ceil FROM math
    SET crubot TO LENGTH(FILTER chr -> chr = '.' IN xrvci)

    IF crubot = 1 THEN
        SET gugno TO xrvci
        FORWHILE (gugno NOT EMPTY AND LAST CHARACTER OF gugno = '0')
            SET gugno TO SUBSTRING(gugno, 0, LENGTH(gugno) - 1)
        END FORWHILE
        SET xrvci TO gugno
    ENDIF

    SET kherva TO FLOAT(xrvci)
    SET irmox TO ""
    SET qesnu TO LENGTH(xrvci)

    IF qesnu >= 2 THEN
        SET irmox TO SUBSTRING(xrvci, qesnu - 2, 2)
    ENDIF

    SWITCH TRUE
        CASE irmox = ".5"
            IF kherva > 0 THEN
                RETURN ceil(kherva)
            ELSE
                RETURN floor(kherva)
            ENDIF
        CASE qesnu > 0
            RETURN ROUND(kherva)
        DEFAULT
            RETURN 0
    ENDSWITCH
END FUNCTION
```