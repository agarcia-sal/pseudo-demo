```
FUNCTION minPath(grid, k)
    SET q TO LENGTH OF grid
    SET u TO (q * q) + 1
    FOR m FROM 0 TO q - 1
        FOR r FROM 0 TO q - 1
            IF (grid[m][r] = 1)
                SET w TO []
                IF (NOT m = 0)
                    APPEND grid[m - 1][r] TO w
                END IF
                IF (NOT r = 0)
                    APPEND grid[m][r - 1] TO w
                END IF
                IF (NOT m = q - 1)
                    APPEND grid[m + 1][r] TO w
                END IF
                IF (NOT r = q - 1)
                    APPEND grid[m][r + 1] TO w
                END IF
                SET u TO MINIMUM OF w
            END IF
        END FOR
    END FOR
    SET p TO []
    FOR s FROM 0 TO k - 1
        IF s MOD 2 = 0 THEN
            APPEND 1 TO p
        ELSE
            APPEND u TO p
        END IF
    END FOR
    RETURN p
END FUNCTION
```