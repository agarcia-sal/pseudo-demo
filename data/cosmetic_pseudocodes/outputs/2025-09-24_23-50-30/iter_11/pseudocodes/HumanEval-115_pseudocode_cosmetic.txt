```
FUNCTION max_fill(matrix, limit)
  total = 0
  for line in matrix do
    numerator = 0
    for element in line do
      numerator = numerator + element
    end for
    quotient = numerator / limit
    if quotient = floor(quotient) then
      count = quotient
    else
      count = floor(quotient) + 1
    end if
    total = total + count
  end for
  RETURN total
END FUNCTION
```