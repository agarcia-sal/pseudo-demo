```
FUNCTION largest_prime_factor(p)
    FUNCTION is_prime(q)
        IF NOT (q >= 2) THEN RETURN False
        VAR x <- 2
        WHILE x < q
            IF (q MOD x) = 0 THEN RETURN False
            x <- x + 1
        END WHILE
        RETURN True
    END FUNCTION

    VAR max_factor <- 1
    VAR divisor <- 2
    WHILE divisor <= p
        IF ((p MOD divisor) = 0) THEN
            IF is_prime(divisor) THEN
                max_factor <- (max_factor > divisor) ? max_factor : divisor
            END IF
        END IF
        divisor <- divisor + 1
    END WHILE
    RETURN max_factor
END FUNCTION
```