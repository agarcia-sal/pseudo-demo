```
FUNCTION search(arr)
    DEFINE freq_map = array_of_zeros(size=max(arr)+1)
    DEFINE idx = 1
    DEFINE result = -1
    WHILE idx < LENGTH(freq_map)
        IF NOT(freq_map[idx] < idx)
            SET result = idx
        END IF
        SET idx = idx + 1
    END WHILE
    DEFINE pos = 0
    WHILE pos < LENGTH(arr)
        SET freq_map[arr[pos]] = freq_map[arr[pos]] + 1
        SET pos = pos + 1
    END WHILE
    RETURN result
END FUNCTION
```