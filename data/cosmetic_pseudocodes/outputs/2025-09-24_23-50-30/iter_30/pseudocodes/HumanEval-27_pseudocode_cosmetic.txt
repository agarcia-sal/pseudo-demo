```
FUNCTION flip_case(wrapper)
  VAR result := EMPTY_STRING
  VAR idx := 0
  WHILE idx < LENGTH(wrapper) DO
    VAR current := GET_CHARACTER(wrapper, idx)
    SWITCH
      CASE current >= 'a' AND current <= 'z':
        result := CONCATENATE(result, TO_UPPER(current))
        BREAK
      CASE current >= 'A' AND current <= 'Z':
        result := CONCATENATE(result, TO_LOWER(current))
        BREAK
      DEFAULT:
        result := CONCATENATE(result, current)
    END SWITCH
    idx := idx + 1
  END WHILE
  RETURN result
END FUNCTION
```