```
FUNCTION closest_integer(input_val)
    IMPORT floor, ceil FROM math
    
    PROCEDURE trim_zero_trail(s)
        LOOP
            EXIT WHEN s IS EMPTY OR s[-1] â‰  '0'
            s := s[0 TO LENGTH(s)-2]
        END LOOP
        RETURN s
    END PROCEDURE
    
    TEST dot_count IS (NUMBER OF CHARACTERS IN input_val EQUAL TO '.')
    VARIABLE adjusted_val
    
    SWITCH dot_count
        CASE 1:
            adjusted_val := trim_zero_trail(input_val)
        DEFAULT:
            adjusted_val := input_val
    END SWITCH

    VARIABLE temp_num := CONVERT adjusted_val TO FLOAT
    VARIABLE output_num

    SWITCH 
        CASE LENGTH(adjusted_val) >= 2 AND adjusted_val[-2..-1] = '.5':
            SWITCH
                CASE temp_num > 0:
                    output_num := ceil(temp_num)
                DEFAULT:
                    output_num := floor(temp_num)
            END SWITCH
        CASE LENGTH(adjusted_val) > 0:
            output_num := ROUND(temp_num)
        DEFAULT:
            output_num := 0
    END SWITCH

    RETURN output_num
END FUNCTION
```