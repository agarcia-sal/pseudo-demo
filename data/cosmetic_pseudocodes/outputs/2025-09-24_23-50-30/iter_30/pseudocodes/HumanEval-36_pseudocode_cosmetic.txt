```
FUNCTION fizz_buzz(limit)
  SET indices TO []
  SET idx TO 0
  WHILE idx < limit
    SWITCH TRUE
      CASE idx % 11 = 0:
      CASE idx % 13 = 0:
        indices = indices + [idx]
        BREAK
      DEFAULT:
        BREAK
    END SWITCH
    SET idx TO idx + 1
  END WHILE
  SET result_str TO ""
  SET pointer TO 0
  WHILE pointer < LENGTH(indices)
    result_str = result_str + STRING(indices[pointer])
    SET pointer TO pointer + 1
  END WHILE

  FUNCTION count_sevens(pos, acc)
    IF pos = LENGTH(result_str) THEN
      RETURN acc
    ELSE
      RETURN count_sevens(pos + 1, acc + ((result_str[pos] = '7') ? 1 : 0))
    END IF
  END FUNCTION

  RETURN count_sevens(0, 0)
END FUNCTION
```