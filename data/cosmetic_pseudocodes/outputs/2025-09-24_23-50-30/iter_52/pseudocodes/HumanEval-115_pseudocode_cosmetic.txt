```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    FUNCTION helper(rows, index, accumulator)
        IF index EQUALS LENGTH(rows) THEN
            RETURN accumulator
        ELSE
            LET current_row = rows[index]
            LET total = 0
            FUNCTION sum_elements(elements, pos, subtotal)
                IF pos EQUALS LENGTH(elements) THEN
                    RETURN subtotal
                ELSE
                    RETURN sum_elements(elements, pos + 1, subtotal + elements[pos])
                END IF
            END FUNCTION
            LET row_sum = sum_elements(current_row, 0, 0)
            LET addition = math.ceiling(row_sum / capacity)
            RETURN helper(rows, index + 1, accumulator + addition)
        END IF
    END FUNCTION
    RETURN helper(grid, 0, 0)
END FUNCTION
```