```
FUNCTION separate_paren_groups(string_of_parentheses)
  SET results TO []
  SET cluster TO []
  SET depth_counter TO 0

  SET index TO 0
  WHILE index < LENGTH(string_of_parentheses)
    SET token TO string_of_parentheses[index]

    IF token = '(' THEN
      SET depth_counter TO depth_counter + 1
      APPEND token TO cluster
      SET index TO index + 1
      CONTINUE
    END IF

    IF token = ')' THEN
      SET depth_counter TO depth_counter - 1
      APPEND token TO cluster

      IF NOT(depth_counter <> 0) THEN
        APPEND JOIN(cluster) TO results
        SET cluster TO []
      END IF
    END IF

    SET index TO index + 1
  END WHILE

  RETURN results
END FUNCTION
```