```
FUNCTION numerical_letter_grade(input_collection)
    DECLARE output_map AS DICTIONARY
    SET output_map TO {
        4.0: "A+",
        3.7: "A",
        3.3: "A-",
        3.0: "B+",
        2.7: "B",
        2.3: "B-",
        2.0: "C+",
        1.7: "C",
        1.3: "C-",
        1.0: "D+",
        0.7: "D",
        0.0: "D-"
    }
    DECLARE result_collection AS LIST
    SET result_collection TO EMPTY LIST

    FOR index FROM 0 TO LENGTH(input_collection) - 1
        DECLARE numeric_value AS NUMBER
        SET numeric_value TO input_collection[index]
        DECLARE grade_label AS STRING

        IF numeric_value == 4.0 THEN
            SET grade_label TO output_map[4.0]
        ELSE
            DECLARE thresholds AS LIST
            SET thresholds TO [3.7, 3.3, 3.0, 2.7, 2.3, 2.0, 1.7, 1.3, 1.0, 0.7, 0.0]
            DECLARE matched AS BOOLEAN
            SET matched TO FALSE

            FOR each threshold_value IN thresholds
                IF numeric_value > threshold_value THEN
                    SET grade_label TO output_map[threshold_value]
                    SET matched TO TRUE
                    BREAK
                END IF
            END FOR

            IF NOT matched THEN
                SET grade_label TO "E"
            END IF
        END IF

        CALL APPEND(result_collection, grade_label)
    END FOR

    RETURN result_collection
END FUNCTION
```