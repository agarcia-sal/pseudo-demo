```
FUNCTION largest_prime_factor(n)
    SET accumulator TO 1
    SET candidates TO [x IN RANGE(2, n + 1)]
    SET filtered_candidates TO []

    FOR candidate_element IN candidates
        IF (n MOD candidate_element) = 0
            APPEND candidate_element TO filtered_candidates

    DEFINE FUNCTION check_prime(number)
        IF number <= 1 THEN
            RETURN False
        SET divisor TO 2

        WHILE divisor < number
            IF (number MOD divisor) = 0 THEN
                RETURN False
            SET divisor TO divisor + 1
        RETURN True

    FOR element IN filtered_candidates
        IF check_prime(element) THEN
            IF element > accumulator THEN
                SET accumulator TO element

    RETURN accumulator
END FUNCTION
```