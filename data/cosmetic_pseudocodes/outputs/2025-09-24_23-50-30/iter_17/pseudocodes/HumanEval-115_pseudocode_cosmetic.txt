```
FUNCTION max_fill(grid, capacity)
    total_value := 0
    FOR index FROM 0 TO LENGTH(grid) - 1
        row_sum := 0
        current_row := grid[index]
        iterator := 0
        WHILE iterator < LENGTH(current_row)
            row_sum := row_sum + current_row[iterator]
            iterator := iterator + 1
        END WHILE
        row_fraction := row_sum / capacity
        row_ceiled := IF row_fraction = FLOOR(row_fraction) THEN row_fraction ELSE FLOOR(row_fraction) + 1
        total_value := total_value + row_ceiled
    END FOR
    RETURN total_value
END FUNCTION
```