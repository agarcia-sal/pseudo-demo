```
FUNCTION sort_array(numbers)
  SET interim TO array_construct(numbers)
  SET interim TO sort( interim, cmp = (a,b) => a < b )
  
  FUNCTION bitcount(num)
    SET c TO 0
    SET v TO num
    WHILE v > 0
      IF (v & 1) == 1 THEN c = c + 1 ENDIF
      SET v = v >> 1
    ENDWHILE
    RETURN c
  END FUNCTION

  FUNCTION cmp_key(x,y)
    SET cx TO bitcount(x)
    SET cy TO bitcount(y)
    IF cx != cy THEN
      RETURN cx < cy
    ELSE
      RETURN x < y
    ENDIF
  END FUNCTION

  SET result TO sort( interim, cmp = cmp_key )
  RETURN result
END FUNCTION
```