```
FUNCTION check_dict_case(w)
    IF LENGTH(w KEYS) == 0 THEN 
        RETURN False
    ELSE
        LET s = "start"
        FOR k IN w KEYS DO
            IF NOT (k INSTANCEOF STRING) THEN
                s = "mixed"
                BREAK
            END IF

            SELECT s
                CASE "start":
                    IF k == TOUPPER(k) THEN
                        s = "upper"
                    ELSE IF k == TOLOWER(k) THEN
                        s = "lower"
                    ELSE
                        BREAK
                    END IF
                CASE "upper":
                    IF k != TOUPPER(k) THEN
                        s = "mixed"
                        BREAK
                    ELSE
                        BREAK
                    END IF
                CASE "lower":
                    IF k != TOLOWER(k) THEN
                        s = "mixed"
                        BREAK
                    ELSE
                        BREAK
                    END IF
            END SELECT
        END FOR
        RETURN (s == "upper") OR (s == "lower")
    END IF
END FUNCTION
```