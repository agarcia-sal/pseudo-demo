```
FUNCTION histogram(test_string)
  SET freq_map TO NEW empty dictionary
  SET letters TO SPLIT test_string BY " "
  
  FUNCTION max_count(index, current_max)
    IF index == LENGTH(letters) THEN
      RETURN current_max
    ELSE
      SET curr_letter TO letters[index]
      SET count_curr TO LENGTH(FILTER(letters, L -> L == curr_letter))
      SET new_max TO current_max
      IF curr_letter != "" AND count_curr > current_max THEN
        SET new_max TO count_curr
      RETURN max_count(index + 1, new_max)
  
  SET maximum_count TO max_count(0, 0)

  FUNCTION fill_freq(index)
    IF index == LENGTH(letters) THEN
      RETURN
    SET curr_letter TO letters[index]
    SET count_curr TO LENGTH(FILTER(letters, L -> L == curr_letter))
    IF count_curr == maximum_count THEN
      freq_map[curr_letter] = maximum_count
    fill_freq(index + 1)

  IF maximum_count > 0 THEN
    fill_freq(0)
  RETURN freq_map
END FUNCTION
```