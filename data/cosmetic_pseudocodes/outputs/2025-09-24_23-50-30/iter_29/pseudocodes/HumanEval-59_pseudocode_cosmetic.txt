```
FUNCTION largest_prime_factor(x)
    FUNCTION is_prime(m)
        IF NOT (m >= 2)
            RETURN False
        SET p TO 2
        WHILE p < m
            IF (m MOD p) = 0
                RETURN False
            SET p TO p + 1
        END WHILE
        RETURN True
    END FUNCTION

    SET q TO 1
    SET r TO 2
    WHILE r <= x
        IF ((x MOD r) = 0) 
            IF is_prime(r)
                IF r > q
                    SET q TO r
        SET r TO r + 1
    END WHILE
    RETURN q
END FUNCTION
```