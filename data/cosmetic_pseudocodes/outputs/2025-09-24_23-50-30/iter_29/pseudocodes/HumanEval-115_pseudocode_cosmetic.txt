```
FUNCTION max_fill(matrix, limit)
    IMPORT math
    LET total = 0
    FOR each line IN matrix
        LET sum_line = 0
        FOR each element IN line
            sum_line = sum_line + element
        END FOR
        total = total + math.ceil(sum_line / limit)
    END FOR
    RETURN total
END FUNCTION
```