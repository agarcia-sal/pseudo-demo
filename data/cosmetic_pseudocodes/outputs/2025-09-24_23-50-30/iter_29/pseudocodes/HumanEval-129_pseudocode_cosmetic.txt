```
FUNCTION minPath(matrix, p)
  LET m BE LENGTH OF matrix
  LET w BE m * m + 1
  FOR x FROM 0 TO m - 1
     FOR y IN RANGE 0 TO m - 1
  SWITCH matrix AT x AND y EQUALS 1
    CASE TRUE:
      LET neighbors BE EMPTY ARRAY
      IF NOT (x = 0) THEN
        APPEND matrix AT x - 1 AND y TO neighbors
      ENDIF
      IF NOT (y = 0) THEN
        APPEND matrix AT x AND y - 1 TO neighbors
      ENDIF
      IF NOT (x = m - 1) THEN
        APPEND matrix AT x + 1 AND y TO neighbors
      ENDIF
      IF NOT (y = m - 1) THEN
        APPEND matrix AT x AND y + 1 TO neighbors
      ENDIF
      LET w BE THE MINIMUM VALUE FOUND IN neighbors
  ENDCASE
  ENDFOR
  ENDFOR

  LET resultArray BE EMPTY LIST
  FOR index IN [0 .. p - 1]
     APPEND (IF (index MOD 2 = 0) THEN 1 ELSE w) TO resultArray
  ENDFOR

  RETURN resultArray
END FUNCTION
```