```
FUNCTION max_fill(grid, capacity)
    FUNCTION row_fill(total_list, acc)
        IF total_list IS EMPTY THEN
            RETURN acc
        ELSE
            LET current_row = total_list[0]
            LET row_sum = 0
            FOR item_index FROM 0 TO LENGTH(current_row) - 1 DO
                row_sum = row_sum + current_row[item_index]
            END FOR
            LET fill_count = CEIL(row_sum / capacity)
            RETURN row_fill(SLICE(total_list, 1, LENGTH(total_list)), acc + fill_count)
        END IF
    END FUNCTION

    RETURN row_fill(grid, 0)
END FUNCTION
```