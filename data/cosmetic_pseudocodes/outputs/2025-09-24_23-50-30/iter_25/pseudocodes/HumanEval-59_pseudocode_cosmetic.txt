```
FUNCTION largest_prime_factor(m)
    FUNCTION is_prime(p)
        IF NOT (p >= 2)
            RETURN False
        SET q TO 2
        WHILE q < p
            IF (p MOD q) = 0
                RETURN False
            SET q TO q + 1
        RETURN True
    END FUNCTION

    SET max_factor TO 1
    SET r TO 2
    WHILE r <= m
        IF ((m MOD r) = 0) AND (is_prime(r) = True)
            IF max_factor < r
                SET max_factor TO r
        SET r TO r + 1
    RETURN max_factor
END FUNCTION
```