```
FUNCTION encode(text)
  DECLARE vowels_str AS STRING
  DECLARE shift_map AS DICTIONARY
  DECLARE position AS INTEGER
  DECLARE transformed AS STRING
  SET vowels_str = "aeiouAEIOU"
  INITIALIZE shift_map TO EMPTY DICTIONARY

  FOR position = 1 TO LENGTH(vowels_str) DO
    LET char = vowels_str[position]
    SET shift_map[char] = CHAR(ASCII(char) + 2)
  END FOR

  DEFINE FUNCTION swap_case(s)
    DECLARE idx AS INTEGER
    DECLARE result AS STRING
    SET result = ""
    FOR idx = 1 TO LENGTH(s) DO
      LET curr = s[idx]
      IF curr >= 'a' AND curr <= 'z' THEN
        SET result = result + TO_UPPER(curr)
      ELSE IF curr >= 'A' AND curr <= 'Z' THEN
        SET result = result + TO_LOWER(curr)
      ELSE
        SET result = result + curr
      END IF
    END FOR
    RETURN result
  END FUNCTION

  SET text = swap_case(text)

  SET transformed = ""
  DECLARE i AS INTEGER = 1
  WHILE i <= LENGTH(text) DO
    LET ch = text[i]
    IF NOT (ch NOT IN vowels_str) THEN
      SET transformed = transformed + shift_map[ch]
    ELSE
      SET transformed = transformed + ch
    END IF
    SET i = i + 1
  END WHILE

  RETURN transformed
END FUNCTION
```