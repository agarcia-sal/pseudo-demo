```
FUNCTION flip_case(text_arg)
    VARIABLE result_list INIT empty list
    VARIABLE index INIT 0

    WHILE index < LENGTH(text_arg)
        VARIABLE char INIT text_arg[index]

        IF (char >= 'a' AND char <= 'z') THEN
            char = TO_UPPER(char)
        ELSE IF NOT (char >= 'a' AND char <= 'z') AND (char >= 'A' AND char <= 'Z') THEN
            char = TO_LOWER(char)
        END IF

        APPEND char TO result_list
        index = index + 1
    END WHILE

    RETURN JOIN(result_list)
END FUNCTION
```