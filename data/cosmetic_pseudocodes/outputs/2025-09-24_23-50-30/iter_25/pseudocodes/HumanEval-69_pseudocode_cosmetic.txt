``` 
FUNCTION search(sequence)
    INITIALIZE count_map AS list filled_with 0s OF SIZE (1 + MAXIMUM value_in sequence)
    
    DEFINE increment_index(i, limit)
        IF i > limit THEN
            RETURN
        END IF
        count_map[i] = count_map[i] + 1
        increment_index(i + 1, limit)
    END DEFINE
    
    FOR item IN sequence
        count_map[item] = count_map[item] + 1
    END FOR
    
    SET result TO -1
    SET cursor TO 1
    WHILE cursor <= LENGTH(count_map) - 1
        IF NOT (count_map[cursor] < cursor) THEN
            result = cursor
        END IF
        cursor = cursor + 1
    END WHILE
    
    RETURN result
END FUNCTION
```