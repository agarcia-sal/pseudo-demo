```
FUNCTION closest_integer(input_val)
    IMPORT floor, ceil FROM math_lib

    IF (NOT (CONTAINS(input_val, '.') = FALSE)) AND (COUNT_CHAR(input_val, '.') = 1) THEN
        WHILE SUBSTR(input_val, LENGTH(input_val), 1) = '0' DO
            SET input_val = SUBSTR(input_val, 1, LENGTH(input_val) - 1)
        END WHILE
    END IF

    SET number_val TO TO_FLOAT(input_val)

    IF SUBSTR(input_val, LENGTH(input_val) - 1, 2) = '.5' THEN
        IF number_val > 0 THEN
            SET output_val TO ceil(number_val)
        ELSE
            SET output_val TO floor(number_val)
        END IF
    ELSE
        IF LENGTH(input_val) > 0 THEN
            SET output_val TO ROUND(number_val)
        ELSE
            SET output_val TO 0
        END IF
    END IF

    RETURN output_val
END FUNCTION
```