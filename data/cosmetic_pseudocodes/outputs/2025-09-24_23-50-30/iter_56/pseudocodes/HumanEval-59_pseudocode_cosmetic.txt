```
FUNCTION largest_prime_factor(m)
    FUNCTION is_prime(q)
        SWITCH TRUE
            CASE q < 2:
                RETURN False
            DEFAULT:
                FUNCTION check_divisor(r, s)
                    IF s = r THEN RETURN True
                    SWITCH (q MOD s = 0)
                        CASE True:
                            RETURN False
                        CASE False:
                            RETURN check_divisor(r, s + 1)
                    END SWITCH
                END FUNCTION
                RETURN check_divisor(q, 2)
        END SWITCH
    END FUNCTION

    VAR e = 1
    VAR u = 2
    WHILE u <= m DO
        IF ((m MOD u = 0) AND is_prime(u)) THEN
            e = IF (e < u) THEN u ELSE e
        u = u + 1
    RETURN e
END FUNCTION
```