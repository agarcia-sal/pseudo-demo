```
FUNCTION parse_nested_parens(parentheses_string)
  FUNCTION parse_paren_group(group_string)
    SET alpha TO 0
    SET beta TO 0

    FUNCTION recur(delta, epsilon)
      IF epsilon EQUALS LENGTH(group_string)
        RETURN beta
      ELSE
        SET gamma TO SUBSTRING(group_string, epsilon, 1)
        SET delta_new TO delta + (gamma = '(' ? 1 : -1)
        SET beta_new TO (delta_new > beta) * delta_new + (delta_new <= beta) * beta
        RETURN recur(delta_new, epsilon + 1)
      END IF
    END FUNCTION

    RETURN recur(alpha, 0)
  END FUNCTION

  SET kappa TO []
  SET lambda TO 0

  FUNCTION iterate(mu)
    IF mu = LENGTH(parentheses_string)
      RETURN kappa
    ELSE
      SET nu TO SUBSTRING(parentheses_string, mu, 1)
      IF nu = ' '
        RETURN iterate(mu + 1)
      ELSE
        SET pi TO mu
        WHILE pi < LENGTH(parentheses_string) AND SUBSTRING(parentheses_string, pi, 1) != ' '
          SET pi TO pi + 1
        END WHILE
        SET rho TO SUBSTRING(parentheses_string, mu, pi - mu)
        IF LENGTH(rho) > 0
          SET kappa TO kappa + [parse_paren_group(rho)]
        END IF
        RETURN iterate(pi)
      END IF
    END IF
  END FUNCTION

  RETURN iterate(0)
END FUNCTION
```