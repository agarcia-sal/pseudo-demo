```
FUNCTION filter_by_substring(array_of_strings, target_substring)
  VAR index_tracker := 0
  VAR filtered_collection := []
  WHILE index_tracker < LENGTH(array_of_strings)
    BLOCK_LABEL start_filter_loop
      SWITCH TRUE
        CASE NOT(CONTAINS(array_of_strings[index_tracker], target_substring)):
          index_tracker := index_tracker + 1
          BREAK start_filter_loop
        DEFAULT:
          filtered_collection := filtered_collection + [array_of_strings[index_tracker]]
          index_tracker := index_tracker + 1
          BREAK start_filter_loop
      END SWITCH
    END BLOCK
  END WHILE
  RETURN filtered_collection
END FUNCTION
```