```
FUNCTION max_fill(grid, volume)
    IMPORT math
    VAR delta ARRAY = EMPTY ARRAY
    VAR idx INTEGER = 0
    WHILE idx < LENGTH(grid)
        VAR omega INTEGER = 0
        VAR zeta INTEGER = 0
        WHILE zeta < LENGTH(grid[idx])
            omega = omega + grid[idx][zeta]
            zeta = zeta + 1
        END WHILE
        APPEND delta, math.ceiling(omega / volume)
        idx = idx + 1
    END WHILE
    VAR kappa INTEGER = 0
    VAR lam INTEGER = 0
    WHILE lam < LENGTH(delta)
        kappa = kappa + delta[lam]
        lam = lam + 1
    END WHILE
    RETURN kappa
END FUNCTION
```