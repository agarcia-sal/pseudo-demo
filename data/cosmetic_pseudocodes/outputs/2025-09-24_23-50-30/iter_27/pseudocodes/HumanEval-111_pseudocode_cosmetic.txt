```
FUNCTION histogram(input_text)
    frequency_map := {}
    tokens := []
    idx := 0
    WHILE idx < LENGTH(input_text)
        current_char := input_text[idx]
        IF current_char = ' '
            tokens := tokens + [""]
        ELSE
            IF LENGTH(tokens) = 0
                tokens := tokens + [current_char]
            ELSE
                tokens[-1] := tokens[-1] + current_char
        ENDIF
        idx := idx + 1
    ENDWHILE

    max_freq := 0
    pos := 0
    WHILE pos < LENGTH(tokens)
        token := tokens[pos]
        count_occurrences := 0
        scan_pos := 0
        WHILE scan_pos < LENGTH(tokens)
            count_occurrences := count_occurrences + ((tokens[scan_pos] = token) ? 1 : 0)
            scan_pos := scan_pos + 1
        ENDWHILE
        IF (count_occurrences > max_freq) AND NOT (token = "")
            max_freq := count_occurrences
        ENDIF
        pos := pos + 1
    ENDWHILE

    IF max_freq <> 0
        cursor := 0
        WHILE cursor < LENGTH(tokens)
            char_item := tokens[cursor]
            count_repeats := 0
            scan_index := 0
            WHILE scan_index < LENGTH(tokens)
                count_repeats := count_repeats + ((tokens[scan_index] = char_item) ? 1 : 0)
                scan_index := scan_index + 1
            ENDWHILE
            IF count_repeats = max_freq
                frequency_map[char_item] := max_freq
            ENDIF
            cursor := cursor + 1
        ENDWHILE
    ENDIF

    RETURN frequency_map
END FUNCTION
```