```
FUNCTION longest(collection)
  
  DEFINE find_maximum_length(current_max, remaining_items)
    IF remaining_items IS EMPTY THEN
      RETURN current_max
    ELSE
      LET head = remaining_items[0]
      LET tail = remaining_items[1:]
      LET candidate = LENGTH OF head
      RETURN find_maximum_length(
        (candidate > current_max) * candidate + (candidate <= current_max) * current_max,
        tail
      )
    END IF
  END DEFINE

  IF NOT (collection IS NONEMPTY) THEN
    RETURN None
  END IF

  LET max_len = find_maximum_length(0, collection)
  DEFINE search_longest_item(items)
    IF items IS EMPTY THEN
      RETURN None
    ELSE
      LET current_item = items[0]
      LET rest_items = items[1:]
      RETURN (LENGTH OF current_item = max_len) ? current_item : search_longest_item(rest_items)
    END IF
  END DEFINE

  RETURN search_longest_item(collection)

END FUNCTION
```