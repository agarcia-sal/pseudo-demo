```
FUNCTION closest_integer(x)
    IMPORT floor, ceil FROM math

    FUNCTION stripZeroSuffix(s)
        IF (('.' IN s) = FALSE) THEN RETURN s END IF

        IF (LEN(s) > 0 AND s[LEN(s)] = '0') THEN
            RETURN stripZeroSuffix(s[1 TO LEN(s) - 1])
        ELSE
            RETURN s
        END IF
    END FUNCTION

    LET y = x
    LET dotCount = 0
    FOR i FROM 1 TO LEN(y)
        IF y[i] = '.' THEN dotCount = dotCount + 1 END IF
    END FOR

    IF dotCount = 1 THEN y = stripZeroSuffix(y) END IF

    LET numValue = FLOAT(y)

    FUNCTION endsWithHalf(s)
        IF LEN(s) < 2 THEN RETURN FALSE END IF
        RETURN s[LEN(s) - 1 TO LEN(s)] = '.5'
    END FUNCTION

    IF endsWithHalf(y) THEN
        IF numValue <= 0 THEN
            LET res = floor(numValue)
        ELSE
            LET res = ceil(numValue)
        END IF
    ELSE
        IF LEN(y) > 0 THEN
            LET res = ROUND(numValue)
        ELSE
            LET res = 0
        END IF
    END IF

    RETURN res
END FUNCTION
```