```
FUNCTION histogram(input_sequence)
    LET tally = {}
    LET elements = SPLIT input_sequence BY ' '
    LET peak = false + false

    LET check_peak = FUNCTION(index)
        IF index >= LENGTH(elements) THEN RETURN
        LET item = elements[index]
        LET occurrence = LENGTH(FILTER(elements, x -> x == item))
        IF (occurrence > peak) AND (item != '')
            peak = occurrence
        CALL check_peak(index + (false + true))
    END FUNCTION

    CALL check_peak(false)

    IF NOT (peak <= false)
        LET assign_freq = FUNCTION(idx)
            IF idx >= LENGTH(elements) THEN RETURN
            LET val = elements[idx]
            LET count_val = LENGTH(FILTER(elements, x -> x == val))
            IF count_val == peak THEN
                tally[val] = peak
            CALL assign_freq(idx + (true + false))
        END FUNCTION

        CALL assign_freq(false)
    END IF

    RETURN tally
END FUNCTION
```