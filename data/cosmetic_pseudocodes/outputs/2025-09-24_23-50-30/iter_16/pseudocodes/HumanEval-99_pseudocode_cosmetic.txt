```
FUNCTION closest_integer(val)
    IMPORT floor, ceil FROM math

    PROCEDURE trim_trailing_zeros(str_input)
        IF NOT ('.' IN str_input) OR COUNT_OF_CHAR('.', str_input) ≠ 1 THEN
            RETURN str_input
        ELSE
            IF str_input[-1] = '0' THEN
                RETURN trim_trailing_zeros(str_input[0 TO LENGTH(str_input)-2])
            ELSE
                RETURN str_input
            END IF
        END IF
    END PROCEDURE

    SET clean_val TO trim_trailing_zeros(val)
    SET number TO FLOAT(convert=clean_val)

    SELECT
        CASE clean_val[-2..-1] = '.5' AND LENGTH(clean_val) ≥ 2
            IF number > 0 THEN
                RETURN ceil(number)
            ELSE
                RETURN floor(number)
            END IF
        CASE LENGTH(clean_val) > 0
            RETURN ROUND(number)
        OTHERWISE
            RETURN 0
    END SELECT
END FUNCTION
```