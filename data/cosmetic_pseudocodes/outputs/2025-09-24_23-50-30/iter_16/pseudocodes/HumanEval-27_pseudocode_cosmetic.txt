```
FUNCTION flip_case(str_input)
    DEFINE SWITCH_CASE(char_val) AS
        IF char_val EQUALS char_val LOWERCASE THEN
            RETURN char_val UPPERCASE
        ELSE
            RETURN char_val LOWERCASE
        END IF
    END DEFINE

    DEFINE PROCESS(index_acc, acc_str) AS
        IF index_acc GREATER THAN OR EQUAL TO LENGTH(str_input) THEN
            RETURN acc_str
        ELSE
            RETURN PROCESS(
                index_acc + 1,
                acc_str CONCATENATE SWITCH_CASE(CHAR_AT(str_input, index_acc))
            )
        END IF
    END DEFINE

    RETURN PROCESS(0, EMPTY_STRING)
END FUNCTION
```