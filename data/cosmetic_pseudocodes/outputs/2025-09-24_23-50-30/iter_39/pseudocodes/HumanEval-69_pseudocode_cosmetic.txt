```
FUNCTION search(sequence)
    SET counts TO ARRAY OF ZEROS WITH SIZE (MAXIMUM ELEMENT IN sequence) + 1
    DEFINE PROCEDURE update_counts(seq, pos)
        IF pos EQUALS LENGTH OF seq
            RETURN
        SET counts AT seq AT pos TO counts AT seq AT pos + 1
        CALL update_counts(seq, pos + 1)
    CALL update_counts(sequence, 0)
    SET result TO -1
    DEFINE PROCEDURE find_result(idx)
        IF idx GREATER THAN LENGTH OF counts - 1
            RETURN
        IF NOT (counts AT idx < idx)
            SET result TO idx
        CALL find_result(idx + 1)
    CALL find_result(1)
    RETURN result
END FUNCTION
```