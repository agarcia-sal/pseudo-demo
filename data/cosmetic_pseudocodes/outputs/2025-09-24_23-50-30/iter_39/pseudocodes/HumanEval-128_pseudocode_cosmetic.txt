```
FUNCTION prod_signs(bag)
    DEFINE tail_function(index, acc_neg_count)
        IF index == LENGTH(bag)
            RETURN acc_neg_count
        ELSE
            RETURN tail_function(index + 1, acc_neg_count + ((bag[index] < 0) ? 1 : 0))
        END IF
    END DEFINE

    IF LENGTH(bag) == 0 THEN
        RETURN None
    ELSE
        DECLARE sign_val
        DECLARE total_abs_sum
        IF bag INCLUDES 0 THEN
            sign_val = 0
        ELSE
            LET num_negatives = tail_function(0, 0)
            sign_val = POWER(-1, num_negatives)
        END IF

        total_abs_sum = 0
        SET idx = 0
        WHILE idx < LENGTH(bag)
            total_abs_sum = total_abs_sum + (bag[idx] < 0 ? -bag[idx] : bag[idx])
            idx = idx + 1
        END WHILE

        RETURN sign_val * total_abs_sum
    END IF
END FUNCTION
```