```
FUNCTION flip_case(str_param)
    SET result_array TO EMPTY ARRAY
    SET idx TO 0
    WHILE idx < LENGTH(str_param) DO
        SET ch TO GET CHARACTER AT str_param[idx]
        IF NOT (ch >= 'a' AND ch <= 'z') THEN
            IF ch >= 'A' AND ch <= 'Z' THEN
                APPEND TO result_array (ch + 32)
            ELSE
                APPEND TO result_array ch
            END IF
        ELSE
            APPEND TO result_array (ch - 32)
        END IF
        idx ← idx + 1
    END WHILE
    RETURN JOIN result_array INTO STRING
END FUNCTION
```