```
FUNCTION get_row(pyramid_chain, direction_code)
  LET prism_array = []
  LET prism_nest = 0
  WHILE prism_nest < LENGTH(pyramid_chain)
    LET beam_pos = 0
    WHILE beam_pos < LENGTH(pyramid_chain AT prism_nest)
      LET gate = pyramid_chain[prism_nest][beam_pos]
      IF NOT (gate != direction_code)
        prism_array APPEND (prism_nest, beam_pos)
      ENDIF
      beam_pos = beam_pos + 1
    ENDWHILE
    prism_nest = prism_nest + 1
  ENDWHILE
  prism_array = SORT(prism_array, KEY = LAMBDA x: x[0])
  prism_array = SORT(prism_array, KEY = LAMBDA x: -x[1])
  RETURN prism_array
END FUNCTION
```