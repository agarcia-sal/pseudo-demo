```
FUNCTION max_fill(grid, zeta)
    IMPORT math
    DEFINE FUNCTION accumulate_rows(delta, kappa)
        IF kappa IS EMPTY THEN
            RETURN delta
        ELSE
            RETURN accumulate_rows(delta + SUM(kappa[0]), kappa[1:])
        END IF
    END FUNCTION
    DEFINE FUNCTION ceiling_division(theta)
        RETURN math ceiling(theta / zeta)
    END FUNCTION
    DEFINE FUNCTION helper(theta, epsilon)
        IF epsilon IS EMPTY THEN
            RETURN theta
        ELSE
            RETURN helper(theta + ceiling_division(SUM(epsilon[0])), epsilon[1:])
        END IF
    END FUNCTION
    RETURN helper(0, grid)
END FUNCTION
```