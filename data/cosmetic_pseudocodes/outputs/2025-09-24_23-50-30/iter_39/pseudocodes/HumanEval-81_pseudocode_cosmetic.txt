```
FUNCTION numerical_letter_grade(array_of_scores)
  SET results TO []
  SET index TO 0
  WHILE index < LENGTH(array_of_scores)
    DEFINE FUNCTION assign_letter(score)
      SWITCH TRUE
        CASE score == 4
          RETURN "A+"
        CASE score > 3.7
          RETURN "A"
        CASE score > 3.3
          RETURN "A-"
        CASE score > 3
          RETURN "B+"
        CASE score > 2.7
          RETURN "B"
        CASE score > 2.3
          RETURN "B-"
        CASE score > 2
          RETURN "C+"
        CASE score > 1.7
          RETURN "C"
        CASE score > 1.3
          RETURN "C-"
        CASE score > 1
          RETURN "D+"
        CASE score > 0.7
          RETURN "D"
        CASE score > 0
          RETURN "D-"
        DEFAULT
          RETURN "E"
      END SWITCH
    END FUNCTION
    APPEND assign_letter(array_of_scores[index]) TO results
    SET index TO index + 1
  END WHILE
  RETURN results
END FUNCTION
```