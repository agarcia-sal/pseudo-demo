```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    DECLARE pqr = 0
    DECLARE stu = 0
    FOR vwx FROM 0 TO LENGTH(grid) - 1 DO
        DECLARE yza = 0
        FOR bcd FROM 0 TO LENGTH(grid[vwx]) - 1 DO
            SET yza = yza + grid[vwx][bcd]
        END FOR
        SET stu = stu + math.ceil(yza / capacity)
    END FOR
    RETURN stu
END FUNCTION
```