```
FUNCTION is_happy(text_value)
  DEFINE check_position(pos_val)
    IF pos_val > (LENGTH OF text_value) - 3 THEN
      RETURN True
    SELECT CASE TRUE OF
      (text_value[pos_val] = text_value[pos_val + 1]) OR
      (text_value[pos_val + 1] = text_value[pos_val + 2]) OR
      (text_value[pos_val] = text_value[pos_val + 2]) :
        RETURN False
      DEFAULT:
        RETURN check_position(pos_val + 1)
    END SELECT
  END DEFINE

  IF LENGTH OF text_value < 3 THEN
    RETURN False
  END IF

  RETURN check_position(0)
END FUNCTION
```