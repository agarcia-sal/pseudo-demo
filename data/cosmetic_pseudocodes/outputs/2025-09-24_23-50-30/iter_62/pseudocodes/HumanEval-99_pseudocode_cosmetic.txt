```
FUNCTION closest_integer(x)
    IMPORT floor, ceil FROM math

    FUNCTION trim_trailing_zeros(s)
        IF COUNT OF '.' IN s IS NOT 1 THEN
            RETURN s
        END IF
        IF s[-1] = '0' THEN
            RETURN trim_trailing_zeros(s[:-1])
        ELSE
            RETURN s
        END IF
    END FUNCTION

    LET w = trim_trailing_zeros(x)
    LET z = FLOAT(w)

    FUNCTION select_result(v, val)
        IF val >= 0 THEN
            RETURN ceil(val)
        ELSE
            RETURN floor(val)
        END IF
    END FUNCTION

    IF LENGTH(w) > 0 THEN
        LET tail = w[-2..]
        IF tail = '.5' THEN
            LET y = select_result(w, z)
        ELSE
            LET y = ROUND(z)
        END IF
    ELSE
        LET y = 0
    END IF

    RETURN y
END FUNCTION
```