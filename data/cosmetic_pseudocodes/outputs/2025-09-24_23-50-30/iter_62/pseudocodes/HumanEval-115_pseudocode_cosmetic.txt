```
FUNCTION max_fill(matrix, limit)
    IMPORT math
    FUNCTION recursive_sum(list, index, total)
        IF index = LENGTH(list) THEN
            RETURN total
        END IF
        RETURN recursive_sum(list, index + 1, total + list[index])
    END FUNCTION
    FUNCTION row_ceil(rw)
        RETURN math ceiling(recursive_sum(rw, 0, 0) / limit)
    END FUNCTION
    FUNCTION sum_rows(lst, idx, accum)
        IF idx = LENGTH(lst) THEN
            RETURN accum
        END IF
        RETURN sum_rows(lst, idx + 1, accum + row_ceil(lst[idx]))
    END FUNCTION
    RETURN sum_rows(matrix, 0, 0)
END FUNCTION
```