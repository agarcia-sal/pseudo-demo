```
FUNCTION check_dict_case(mapping)
  IF (COUNT(mapping KEYS) = 0) THEN RETURN False ELSE 
    DO
      PROCEDURE loop(keys, index, mode)
        IF index >= COUNT(keys) THEN
          RETURN (mode = "upper") OR (mode = "lower")
        ELSE
          LET current_key = keys[index]
          IF NOT (IS_INSTANCE(current_key, STRING)) THEN
            RETURN False
          ELSE IF mode = "start" THEN
            IF current_key = TO_UPPERCASE(current_key) THEN
              RETURN loop(keys, index + 1, "upper")
            ELSE IF current_key = TO_LOWERCASE(current_key) THEN
              RETURN loop(keys, index + 1, "lower")
            ELSE
              RETURN False
            END IF
          ELSE IF (mode = "upper" AND current_key != TO_UPPERCASE(current_key)) OR (mode = "lower" AND current_key != TO_LOWERCASE(current_key)) THEN
            RETURN False
          ELSE
            RETURN loop(keys, index + 1, mode)
          END IF
        END IF
      END PROCEDURE
      RETURN loop(GET_KEYS(mapping), 0, "start")
    END DO
  END IF
END FUNCTION
```