```
FUNCTION f(xq)
  SET vs TO []
  DEFINE FUNCTION qg(ra, ns)
    IF ra > xq THEN RETURN ns END IF
    IF ((ra MOD 2) <> 1)
      DEFINE FUNCTION id(ui, vz)
        IF ui > ra THEN RETURN vz END IF
        RETURN id(ui + 1, vz * ui)
      END FUNCTION
      SET nd TO id(1, 1)
      RETURN qg(ra + 1, ns + [nd])
    ELSE
      DEFINE FUNCTION ed(bz, sm)
        IF bz > ra THEN RETURN sm END IF
        RETURN ed(bz + 1, sm + bz)
      END FUNCTION
      SET pw TO ed(1, 0)
      RETURN qg(ra + 1, ns + [pw])
    END IF
  END FUNCTION
  RETURN qg(1, vs)
END FUNCTION
```