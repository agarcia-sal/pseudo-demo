```
FUNCTION closest_integer(x)
    IMPORT floor, ceil FROM math

    LET contains_dot = 0
    LET i = 0
    WHILE i < LENGTH(x)
        IF x[i] = '.'
            contains_dot = contains_dot + 1
        END IF
        i = i + 1
    END WHILE

    IF contains_dot = 1 THEN
        LET trimmed = TRUE
        WHILE trimmed
            trimmed = FALSE
            IF LENGTH(x) > 0 AND x[LENGTH(x)-1] = '0'
                x = x[0 TO LENGTH(x)-2]
                trimmed = TRUE
            END IF
        END WHILE
    END IF

    LET n = FLOAT(x)

    LET len_x = LENGTH(x)
    LET last_two = (len_x >= 2) ? x[len_x-2] + x[len_x-1] : ''

    LET r
    SWITCH TRUE
        CASE last_two = '.5':
            r = (n > 0) ? ceil(n) : floor(n)
        CASE len_x > 0:
            r = INT(n + 0.5)  // rounding to nearest integer
        DEFAULT:
            r = 0
    END SWITCH

    RETURN r
END FUNCTION
```