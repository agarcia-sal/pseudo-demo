```
FUNCTION max_fill(grid, capacity)
  IMPORT math
  SET accumulator = 0
  FOR index FROM 0 TO LENGTH(grid) - 1 DO
    SET currentRow = grid[index]
    SET total = 0
    FOR elementIndex FROM 0 TO LENGTH(currentRow) - 1 DO
      SET total = total + currentRow[elementIndex]
    END FOR
    SET accumulator = accumulator + math.ceil(total / capacity)
  END FOR
  RETURN accumulator
END FUNCTION
```