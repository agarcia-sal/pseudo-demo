```
FUNCTION intersperse(p, q)
    LABEL loop_start
        IF NOT (p IS NOT EMPTY) THEN
            RETURN []
        END IF
    END LABEL

    SET r TO []

    FUNCTION aux(a, b)
        IF a IS EMPTY THEN
            RETURN b
        ELSE
            SET c TO FIRST ELEMENT OF a
            SET d TO REST OF a
            RETURN aux(d, b + [c, q])
        END IF
    END FUNCTION

    SET s TO aux(p[0: LENGTH(p)-1], r)

    RETURN s + [p[LENGTH(p) - 1]]
END FUNCTION
```