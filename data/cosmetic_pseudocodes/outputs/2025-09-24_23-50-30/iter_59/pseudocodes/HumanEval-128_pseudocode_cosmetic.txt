```
FUNCTION prod_signs(b)
    FUNCTION h(c, d, e)
        IF e IS EMPTY THEN
            RETURN d
        ELSE
            RETURN h(TAIL(e), d + ABSOLUTE_VALUE(HEAD(e)), c)
        END IF
    END FUNCTION
    IF NOT (b IS EMPTY) THEN
        SWITCH
            CASE (b CONTAINS 0):
                LET x = 0
            CASE ELSE:
                LET f = 0
                FUNCTION m(g, i)
                    IF g IS EMPTY THEN
                        RETURN i
                    ELSE
                        RETURN m(TAIL(g), IF HEAD(g) < 0 THEN i + 1 ELSE i)
                    END IF
                END FUNCTION
                LET x = (-1) ^ m(b, f)
        END SWITCH
        LET y = h(b, 0, b)
        RETURN x * y
    ELSE
        RETURN None
    END IF
END FUNCTION
```