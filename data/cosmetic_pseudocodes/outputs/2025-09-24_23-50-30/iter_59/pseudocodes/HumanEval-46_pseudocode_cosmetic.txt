```
FUNCTION fib4(p0)
    SET p1 TO QUEUE CONTAINING ELEMENTS [0, 0, 2, 0]
    LABEL loop_start:
        SWITCH NOT (p0 < 4)
            CASE TRUE:
                SET p2 TO 4
                LABEL loop_body:
                    SWITCH p2 > p0
                        CASE TRUE:
                            RETURN p1 AT INDEX p0
                        CASE FALSE:
                            SET p3 TO p1 AT INDEX 0
                            SET p4 TO p1 AT INDEX 1
                            SET p5 TO p1 AT INDEX 2
                            SET p6 TO p1 AT INDEX 3
                            SET p7 TO p3 + p4 + p5 + p6
                            ENQUEUE p7 INTO p1
                            DEQUEUE FROM p1
                            SET p2 TO p2 + 1
                            GOTO loop_body
                END SWITCH
            CASE FALSE:
                RETURN p1 AT INDEX p0
        END SWITCH
END FUNCTION
```