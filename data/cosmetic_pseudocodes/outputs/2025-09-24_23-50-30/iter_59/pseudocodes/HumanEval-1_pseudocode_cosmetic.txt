```
FUNCTION separate_paren_groups(a)
    SET b TO []
    SET c TO []
    SET d TO 0

    LABEL e:
        IF LENGTH(a) = 0 THEN
            GOTO f
        END IF

        SET g TO a[1]
        SET a TO a[2:]

        SWITCH
            CASE NOT (g ≠ '(' AND g ≠ ')'):
                IF g = '(' THEN
                    SET d TO d + 1
                    SET c TO c + [g]
                    GOTO e
                ELSE
                    IF g = ')' THEN
                        SET d TO d + (-1)
                        SET c TO c + [g]
                        IF d = 0 THEN
                            SET b TO b + [JOIN(c)]
                            SET c TO []
                        END IF
                        GOTO e
                    ELSE
                        GOTO e
                    END IF
                END IF
            CASE ELSE:
                GOTO e
        END SWITCH

    LABEL f:
    RETURN b
END FUNCTION
```