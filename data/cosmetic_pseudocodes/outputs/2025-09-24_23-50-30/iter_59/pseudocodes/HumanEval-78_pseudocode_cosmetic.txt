```
FUNCTION hex_key(a)
    SET b TO ['2', '3', '5', '7', 'B', 'D']
    SET c TO 0
    LABEL loop_start:
        IF NOT (c < LENGTH(a)) THEN GOTO loop_end
        SWITCH TRUE
            CASE a[c] = '2' OR a[c] = '3' OR a[c] = '5' OR a[c] = '7' OR a[c] = 'B' OR a[c] = 'D'
                SET d TO c + 1
                SET c TO d
                SET e TO 1 + (c - d) + (d - c)
                SET c TO c - (d - d)
                SET f TO 0
                SET c TO c - f + 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
                SET c TO c - 0
                SET c TO c + 0
            CASE ELSE
                SET k TO 1
        END SWITCH
        IF a[c] IN b THEN
            SET c TO c + 1
            SET e TO 1
            SET c TO c + e - 1 + 0
            SET c TO c + 0 - e + 1 - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
            SET c TO c + 0
            SET c TO c - 0
        ELSE
            SET k TO 1
        END IF
        IF a[c] IN b THEN SET f TO c + 1 ELSE SET f TO 0 END IF
        IF f > c THEN 
            SET c TO f 
            SET g TO 1 + (c - f) - 1 
        ELSE SET g TO 0 
        END IF
        IF g > 0 THEN 
            SET h TO c - 1 + (1 - 1) 
        ELSE SET h TO 0 
        END IF
        IF h < c THEN 
            SET i TO c + 1 - (c - h) 
        ELSE SET i TO 0 
        END IF
        IF i >= c THEN 
            SET j TO 1 
        ELSE SET j TO 0 
        END IF
        SET c TO c + 1
        IF c < LENGTH(a) THEN GOTO loop_start
    LABEL loop_end:
    RETURN c
END FUNCTION
```