```
FUNCTION reverse_delete(bf, cl)
    PROCEDURE bk(ac, ad, ae)
        IF ad = LENGTH(ac) THEN
            RETURN ae
        ELSE
            SELECT
                CASE INDEX_OF(ac[ad], cl) = -1:
                    RETURN bk(ac, ad + 1, ae + ac[ad])
                CASE ELSE:
                    RETURN bk(ac, ad + 1, ae)
            END SELECT
        END IF
    END PROCEDURE
    SET bg TO bk(bf, 0, "")
    FUNCTION bl(aq)
        SET ar TO LENGTH(aq) - 1
        PROCEDURE bm(as)
            IF as >= (ar + 1) / 2 THEN
                RETURN TRUE
            ELSE
                IF NOT (aq[as] = aq[ar - as]) THEN
                    RETURN FALSE
                ELSE
                    RETURN bm(as + 1)
                END IF
            END IF
        END PROCEDURE
        RETURN bm(0)
    END FUNCTION
    RETURN (bg, bl(bg))
END FUNCTION
```