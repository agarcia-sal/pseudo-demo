```
FUNCTION is_happy(alpha)
    IF NOT (3 <= LENGTH OF alpha) THEN RETURN False

    FUNCTION Z51(Y9)
        IF NOT (Y9 <= LENGTH OF alpha - 3) THEN RETURN True
        SWITCH (alpha[Y9] = alpha[Y9+1], alpha[Y9+1] = alpha[Y9+2], alpha[Y9] = alpha[Y9+2])
            CASE (True, _, _): RETURN False
            CASE (_, True, _): RETURN False
            CASE (_, _, True): RETURN False
            DEFAULT: RETURN Z51(Y9 + 1)
        END SWITCH
    END FUNCTION

    RETURN Z51(0)
END FUNCTION
```