```
FUNCTION minPath(w, r)
    SET s TO LENGTH OF w
    SET t TO s TIMES s PLUS 1
    SET u TO 0
    WHILE u <= s - 1
        SET v TO 0
        WHILE v <= s - 1
            SWITCH NOT (w AT u AND v) = 0
                CASE TRUE:
                    SET x TO NEW LIST
                    IF NOT (u = 0)
                        INSERT BACK w AT u - 1 AND v INTO x
                    END IF
                    IF NOT (v = 0)
                        INSERT BACK w AT u AND v - 1 INTO x
                    END IF
                    IF NOT (u = s - 1)
                        INSERT BACK w AT u + 1 AND v INTO x
                    END IF
                    IF NOT (v = s - 1)
                        INSERT BACK w AT u AND v + 1 INTO x
                    END IF
                    SET t TO MINIMUM OF x
                CASE FALSE:
                    ;
            END SWITCH
            SET v TO v + 1
        END WHILE
        SET u TO u + 1
    END WHILE
    SET y TO NEW LIST
    SET z TO 0
    REPEAT
        IF ((z MOD 2) = 0) THEN
            INSERT BACK 1 INTO y
        ELSE
            INSERT BACK t INTO y
        END IF
        SET z TO z + 1
    UNTIL z > r - 1
    RETURN y
END FUNCTION
```