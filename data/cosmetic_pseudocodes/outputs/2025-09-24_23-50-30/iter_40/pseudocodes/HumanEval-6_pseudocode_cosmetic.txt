```
FUNCTION parse_nested_parens(parentheses_string)
    FUNCTION parse_paren_group(hgroup)
        SET zmax TO 0
        SET zcur TO 0

        FOR EACH qchar IN hgroup
            SWITCH qchar
                CASE '(':
                    SET zcur TO zcur + 1
                    SET zmax TO MAX(zmax, zcur)
                CASE ')':
                    SET zcur TO zcur - 1
            END SWITCH
        END FOR

        RETURN zmax
    END FUNCTION

    SET splist TO SPLIT parentheses_string BY " "
    SET ress TO []
    FOR EACH xg IN splist
        IF xg != ""
            APPEND parse_paren_group(xg) TO ress
    RETURN ress
END FUNCTION
```