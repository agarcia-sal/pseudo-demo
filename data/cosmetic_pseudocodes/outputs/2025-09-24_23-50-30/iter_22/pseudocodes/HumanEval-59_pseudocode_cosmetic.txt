```
FUNCTION largest_prime_factor(m)
    FUNCTION is_prime(q)
        IF q GREATER OR EQUAL 2 THEN
            FOR r IN RANGE(2, q)
                IF (q MOD r) == 0 THEN
                    RETURN False
            RETURN True
        ELSE
            RETURN False
    END FUNCTION

    SET candidate_list TO []
    FOR s IN RANGE(2, m + 1)
        IF (m MOD s) == 0 THEN
            candidate_list.APPEND(s)

    SET max_factor TO 1
    FOR element IN candidate_list
        IF is_prime(element) THEN
            IF element > max_factor THEN
                SET max_factor TO element

    RETURN max_factor
END FUNCTION
```