```
FUNCTION closest_integer(input_string)
    IMPORT floor, ceil FROM math

    FUNCTION trim_trailing_zeros(str_val)
        IF COUNT('.', str_val) == 1 THEN
            WHILE str_val END WITH '0' DO
                str_val = SUBSTRING(str_val, 0, LENGTH(str_val) - 1)
            END WHILE
        END IF
        RETURN str_val
    END FUNCTION

    trimmed_val = trim_trailing_zeros(input_string)
    converted_num = TO_FLOAT(trimmed_val)

    FUNCTION select_rounding(num_val, str_val)
        suffix_len = LENGTH(str_val)
        IF suffix_len >= 2 AND SUBSTRING(str_val, suffix_len - 2, suffix_len) == '.5' THEN
            IF num_val > 0 THEN
                RETURN ceil(num_val)
            ELSE
                RETURN floor(num_val)
            END IF
        ELSE
            RETURN CASE 
                WHEN suffix_len > 0 THEN TO_INT(ROUND(num_val))
                ELSE 0
            END
        END IF
    END FUNCTION

    RETURN select_rounding(converted_num, trimmed_val)
END FUNCTION
```