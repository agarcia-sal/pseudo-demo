```
FUNCTION valid_date(input_str)
    SET input_trimmed TO input_str WITH ALL LEADING AND TRAILING WHITESPACE REMOVED

    TRY
        SET parts TO SPLIT input_trimmed BY '-'
        SET a TO CONVERT parts[0] TO INTEGER
        SET b TO CONVERT parts[1] TO INTEGER
        SET c TO CONVERT parts[2] TO INTEGER
    EXCEPT ANY ERROR
        RETURN False
    END TRY

    IF a NOT IN {1..12}
        RETURN False
    END IF

    SELECT CASE a
        CASE 2:
            IF b NOT IN {1..29}
                RETURN False
            END IF
        CASE 4, 6, 9, 11:
            IF b NOT IN {1..30}
                RETURN False
            END IF
        CASE 1, 3, 5, 7, 8, 10, 12:
            IF b NOT IN {1..31}
                RETURN False
            END IF
    END SELECT

    RETURN True
END FUNCTION
```