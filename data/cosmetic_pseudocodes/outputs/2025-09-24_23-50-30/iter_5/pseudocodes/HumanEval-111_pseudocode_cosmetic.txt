```
FUNCTION histogram(test_string)
    LET tokens ← FILTER(SPLIT test_string BY " ") WHERE item ≠ ""
    LET map_counts ← {}
    LET max_freq ← 0

    LET update_max ← FUNCTION(idx)
        IF idx = LENGTH(tokens) THEN RETURN max_freq
        LET current ← tokens[idx]
        LET current_count ← COUNT occurrences OF current IN tokens
        LET max_freq ← IF current_count > max_freq THEN current_count ELSE max_freq
        RETURN update_max(idx + 1)
    END FUNCTION

    LET max_freq ← update_max(0)

    IF max_freq > 0 THEN
        FOR idx FROM 0 TO LENGTH(tokens) - 1 DO
            LET candidate ← tokens[idx]
            LET freq ← COUNT occurrences OF candidate IN tokens
            IF freq = max_freq THEN
                map_counts[candidate] ← max_freq
    RETURN map_counts
END FUNCTION
```