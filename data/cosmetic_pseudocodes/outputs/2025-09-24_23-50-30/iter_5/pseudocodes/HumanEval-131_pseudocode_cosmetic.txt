```
FUNCTION digits(n)
  DEFINE helper(chars, acc_prod, acc_odd)
    IF chars IS EMPTY
      RETURN 0 IF acc_odd EQUALS 0 ELSE acc_prod
    ELSE
      LET current_char = HEAD OF chars
      LET rest_chars = TAIL OF chars
      LET digit_val = INTEGER VALUE OF current_char
      IF (digit_val & 1) == 1
        RETURN helper(rest_chars, acc_prod * digit_val, acc_odd + 1)
      ELSE
        RETURN helper(rest_chars, acc_prod, acc_odd)
      END IF
    END IF
  END DEFINE
  RETURN helper(LIST OF CHARACTERS FROM STRING OF n, 1, 0)
END FUNCTION
```