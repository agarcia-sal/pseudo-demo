```
FUNCTION closest_integer(value)
    IMPORT floor, ceil FROM math

    FUNCTION remove_trailing_zeroes(s)
        RETURN s IF NOT (s ENDS WITH '0')
        RETURN remove_trailing_zeroes(SUBSTRING s FROM 0 TO LENGTH(s)-1)
    END FUNCTION

    result <- 0

    IF (COUNT(value, '.') = 1) THEN
        value <- remove_trailing_zeroes(value)
    END IF

    num <- FLOAT(value)

    condition_half <- (SUBSTRING value FROM LENGTH(value)-1 TO LENGTH(value)) = '.5'
    positive_num <- (num > 0)

    result <- 
        IF condition_half THEN 
            IF positive_num THEN ceil(num) ELSE floor(num) END IF
        ELSE IF LENGTH(value) > 0 THEN
            ROUND(num)
        ELSE
            0
        END IF

    RETURN result
END FUNCTION
```