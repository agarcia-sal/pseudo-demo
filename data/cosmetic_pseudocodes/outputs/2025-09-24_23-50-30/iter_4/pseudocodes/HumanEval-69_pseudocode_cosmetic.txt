```
FUNCTION search(list_of_integers)
    DEFINE count_map AS ARRAY FILLED WITH 0 LENGTH max(list_of_integers) + 1
    PROCEDURE increment_counts(idx)
        IF idx > LENGTH(list_of_integers) THEN RETURN
        count_map[list_of_integers[idx]] = count_map[list_of_integers[idx]] + 1
        increment_counts(idx + 1)
    END PROCEDURE
    increment_counts(1)
    answer = -1
    index = LENGTH(count_map) - 1
    WHILE index >= 1
        IF count_map[index] >= index THEN
            answer = index
            BREAK
        END IF
        index = index - 1
    END WHILE
    RETURN answer
END FUNCTION
```