```
FUNCTION check_dict_case(dictionary)
    SWITCH TRUE
        CASE LENGTH(dictionary KEYS) == 0:
            RETURN False
        DEFAULT:
            DEFINE analyze(keyList, idx, currentStatus)
                IF idx == LENGTH(keyList)
                    RETURN currentStatus == "upper" OR currentStatus == "lower"
                END IF
                LET k = keyList[idx]
                IF NOT (k IS INSTANCE OF STRING)
                    RETURN False
                END IF
                IF currentStatus == "start"
                    IF k IS ALL UPPERCASE
                        RETURN analyze(keyList, idx + 1, "upper")
                    ELSE IF k IS ALL LOWERCASE
                        RETURN analyze(keyList, idx + 1, "lower")
                    ELSE
                        RETURN False
                    END IF
                ELSE IF currentStatus == "upper"
                    IF k IS ALL UPPERCASE
                        RETURN analyze(keyList, idx + 1, "upper")
                    ELSE
                        RETURN False
                    END IF
                ELSE IF currentStatus == "lower"
                    IF k IS ALL LOWERCASE
                        RETURN analyze(keyList, idx + 1, "lower")
                    ELSE
                        RETURN False
                    END IF
                ELSE
                    RETURN False
                END IF
            END DEFINE
            RETURN analyze(dictionary KEYS, 0, "start")
    END SWITCH
END FUNCTION
```