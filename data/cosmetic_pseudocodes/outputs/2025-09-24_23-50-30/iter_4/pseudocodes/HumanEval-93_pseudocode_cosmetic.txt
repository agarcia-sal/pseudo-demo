```
FUNCTION encode(message)
    SET swap_case_message TO ""
    FOR i FROM 1 TO LENGTH(message)
        IF message[i] IS UPPERCASE
            SET swap_case_message TO swap_case_message + TO_LOWERCASE(message[i])
        ELSE IF message[i] IS LOWERCASE
            SET swap_case_message TO swap_case_message + TO_UPPERCASE(message[i])
        ELSE
            SET swap_case_message TO swap_case_message + message[i]
    SET transform_map TO EMPTY MAP
    FOR ch IN "a e i o u A E I O U".SPLIT(" ")
        SET transform_map[ch] TO CHAR(ASCII_CODE(ch) + 2)
    SET result TO ""
    INDEX_LOOP:
    WHILE TRUE
        IF LENGTH(swap_case_message) = 0
            BREAK INDEX_LOOP
        SET c TO FIRST_CHARACTER(swap_case_message)
        SET swap_case_message TO SUBSTRING_FROM_SECOND_CHAR(swap_case_message)
        IF c IN transform_map KEYS
            SET result TO result + transform_map[c]
        ELSE
            SET result TO result + c
    RETURN result
END FUNCTION
```