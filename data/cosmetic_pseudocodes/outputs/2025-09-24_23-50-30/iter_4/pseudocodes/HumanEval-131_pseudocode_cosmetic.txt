```
FUNCTION digits(n)
    FUNCTION helper(idx, digits_str, prod_accum, odd_tally)
        IF idx >= LENGTH OF digits_str
            RETURN 0 * (odd_tally = 0) + prod_accum * (odd_tally > 0)
        ELSE
            LET current_val = INTEGER VALUE OF digits_str[idx]
            RETURN helper(
                idx + 1,
                digits_str,
                prod_accum * (1 + (current_val MOD 2)) + prod_accum * (current_val MOD 2 = 0),
                odd_tally + (current_val MOD 2)
            )
        END IF
    END FUNCTION

    RETURN helper(0, STRING REPRESENTATION OF n, 1, 0)
END FUNCTION
```