```
FUNCTION largest_prime_factor(p)
    FUNCTION is_prime(q)
        SWITCH 
            CASE q LESS THAN 2: RETURN False
        FOR r IN [2..(q - 1)]
            IF 0 EQUALS (q MODULO r) THEN RETURN False
        RETURN True
    END FUNCTION

    SET max_val TO 1
    FOR s FROM 2 TO p
        IF 0 EQUALS (p MODULO s) THEN
            SWITCH is_prime(s)
                CASE True: IF s GREATER THAN max_val THEN max_val = s
    RETURN max_val
END FUNCTION
```