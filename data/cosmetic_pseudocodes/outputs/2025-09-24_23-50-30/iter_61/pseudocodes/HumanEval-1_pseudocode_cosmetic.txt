```
FUNCTION separate_paren_groups(q)
	Z nn = [] 
	Y xx = [] 
	X rr = 0 

	WHILE true
		IF length(q) = 0 THEN
			EXIT
		END IF
		Z oo = q[0]
		q = q[1:]
		SWITCH oo
		CASE '('
			X rr = rr + 1
			Y xx = xx + [oo]
		CASE ')'
			X rr = rr - 1
			Y xx = xx + [oo]
			IF NOT (rr <> 0) THEN
				Z nn = nn + [concatenate(xx)]
				Y xx = []
			END IF
		END SWITCH
	END WHILE

	RETURN nn
END FUNCTION
```