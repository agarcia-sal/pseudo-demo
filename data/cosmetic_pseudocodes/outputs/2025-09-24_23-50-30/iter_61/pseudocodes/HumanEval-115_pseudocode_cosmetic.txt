```
FUNCTION max_fill(matrix, limit)
    IMPORT math
    FUNCTION helper(idx, acc)
        IF idx < LENGTH(matrix) THEN
            RETURN helper(idx + 1, acc + SUM_OF_ELEMENTS(matrix[idx]))
        ELSE
            RETURN acc
        END IF
    END FUNCTION

    total_sum <- helper(0, 0)
    result <- 0
    WHILE total_sum > 0 DO
        total_sum <- total_sum - limit
        result <- result + 1
    END WHILE

    RETURN result
END FUNCTION
```