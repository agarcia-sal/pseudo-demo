```
FUNCTION exchange(a, b)
    VAR i ← 0
    VAR j ← 0

    PROCEDURE count_odds(L, idx)
        IF idx = LENGTH(L) THEN RETURN 0
        VAR cur ← L[idx]
        RETURN (1 - ((cur % 2) + 1) / 2) + count_odds(L, idx + 1)
    END PROCEDURE

    PROCEDURE count_evens(M, pos)
        IF pos = LENGTH(M) THEN RETURN 0
        VAR val ← M[pos]
        VAR increment ← 1 - (val % 2)
        RETURN increment + count_evens(M, pos + 1)
    END PROCEDURE

    i ← count_odds(a, 0)
    j ← count_evens(b, 0)

    VAR result ← "NO"
    IF NOT (j < i) THEN
        result ← "YES"
    END IF
    RETURN result
END FUNCTION
```