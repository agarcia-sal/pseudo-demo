```
FUNCTION search(array_of_numbers)
    INITIALIZE counts AS list OF zeros WITH SIZE (1 + MAXIMUM OF array_of_numbers)
    
    PROCEDURE accumulateCounts(position)
        IF position EQUALS LENGTH OF array_of_numbers THEN
            RETURN
        ENDIF
        counts[ array_of_numbers[position] ] = counts[ array_of_numbers[position] ] + 1
        CALL accumulateCounts(position + 1)
    END PROCEDURE

    CALL accumulateCounts(0)

    DECLARE result = -1
    
    PROCEDURE findAnswer(index)
        IF index GREATER THAN LENGTH OF counts - 1 THEN
            RETURN
        ENDIF
        IF NOT (counts[index] < index) THEN
            result = index
        ENDIF
        CALL findAnswer(index + 1)
    END PROCEDURE

    CALL findAnswer(1)

    RETURN result
END FUNCTION
```