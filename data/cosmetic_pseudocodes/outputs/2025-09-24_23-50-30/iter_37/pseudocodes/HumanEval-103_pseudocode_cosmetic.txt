```
FUNCTION rounded_avg(u, v)
    DECLARE acc = 0
    IF NOT (u <= v)
        RETURN -1
    FUNCTION accumulate(x, y, total)
        IF y > x
            RETURN accumulate(x, y - 1, total + y)
        ELSE
            RETURN total + y
    END FUNCTION
    SET acc = accumulate(u, v, 0)
    SET count = (v - u + 1)
    SET mean_val = acc / count
    SET rounded_val = (mean_val + 0.5) FLOOR
    SET bin_result = CONVERT_TO_BINARY(rounded_val)
    RETURN bin_result
END FUNCTION
```