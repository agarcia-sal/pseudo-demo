```
FUNCTION vowels_count(text_value)
    DECLARE vowels_collection AS "AEIOUaeiou"
    DECLARE total_vowels AS 0
    total_vowels = REDUCE((accumulator, item) -> accumulator + (CONTAINS(vowels_collection, item) ? 1 : 0), SPLIT_TO_CHARS(text_value), 0)
    SELECT CASE TRUE
        CASE (SUBSTRING(text_value, LENGTH(text_value) - 1, 1) = 'y') OR (SUBSTRING(text_value, LENGTH(text_value) - 1, 1) = 'Y'):
            total_vowels = total_vowels + 1
        DEFAULT:
            NO_OP()
    END SELECT
    RETURN total_vowels
END FUNCTION
```