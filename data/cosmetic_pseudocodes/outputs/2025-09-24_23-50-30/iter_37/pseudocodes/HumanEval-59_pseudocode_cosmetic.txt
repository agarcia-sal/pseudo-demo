```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(x)
        IF NOT (x >= 2)
            RETURN False
        FOR m IN 2 TO x - 1
            IF x MOD m = 0 THEN RETURN False
        RETURN True
    END FUNCTION

    SET result TO 1
    FOR candidate IN 2 TO n DO
        IF (n MOD candidate = 0) AND is_prime(candidate) THEN
            result := IF result > candidate THEN result ELSE candidate
    RETURN result
END FUNCTION
```