```
FUNCTION largest_prime_factor(n)
  FUNCTION is_prime(k)
    IF NOT (k >= 2)
      RETURN False
    SET arr TO []
    FOR x FROM 2 TO k - 1
        arr APPEND x
    FOR each idx IN arr
      IF (k MOD idx) = 0
        RETURN False
    RETURN True
  END FUNCTION

  SET maxVal TO 1
  SET divisorQueue TO []
  FOR t FROM 2 TO n
    divisorQueue APPEND t
  WHILE LENGTH(divisorQueue) > 0
    SET current TO divisorQueue POP_FRONT
    IF ((n MOD current) = 0) AND is_prime(current)
      IF current > maxVal
        SET maxVal TO current
  RETURN maxVal
END FUNCTION
```