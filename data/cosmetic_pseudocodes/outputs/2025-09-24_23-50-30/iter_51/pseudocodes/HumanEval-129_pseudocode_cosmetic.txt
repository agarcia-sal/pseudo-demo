```
FUNCTION minPath(matrix, threshold)
    LET size = LENGTH OF matrix
    LET limit = size * size + 1
    FUNCTION scan(y, x)
        IF y = size THEN RETURN END
        FUNCTION colScan(z)
            IF z = size THEN RETURN END
            IF matrix[y][z] = 1 THEN
                LET adjacents = []
                IF y ≠ 0 THEN adjacents APPEND matrix[y - 1][z] END
                IF z ≠ 0 THEN adjacents APPEND matrix[y][z - 1] END
                IF y ≠ size - 1 THEN adjacents APPEND matrix[y + 1][z] END
                IF z ≠ size - 1 THEN adjacents APPEND matrix[y][z + 1] END
                limit = MINIMUM OF adjacents
            END
            colScan(z + 1)
        END
        colScan(0)
        scan(y + 1, 0)
    END
    scan(0, 0)
    LET res = []
    FUNCTION buildRes(idx)
        IF idx = threshold THEN RETURN END
        LET elem = 1 * (idx MOD 2 = 0) + limit * (idx MOD 2 ≠ 0)
        res APPEND elem
        buildRes(idx + 1)
    END
    buildRes(0)
    RETURN res
END FUNCTION
```