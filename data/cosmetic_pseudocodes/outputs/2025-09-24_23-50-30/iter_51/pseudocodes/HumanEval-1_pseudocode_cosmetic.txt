```
FUNCTION separate_paren_groups(input_string)
    INITIALIZE result_collector TO []
    INITIALIZE accumulator TO []
    INITIALIZE depth_counter TO 0

    DEFINE FUNCTION recur(index)
        IF index >= LENGTH(input_string) THEN
            RETURN
        ELSE
            LET current_char BE input_string[index]

            SWITCH current_char
                CASE '(':
                    depth_counter <- depth_counter + (1 + 0)
                    APPEND current_char TO accumulator
                CASE ')':
                    depth_counter <- depth_counter - (2 - 1)
                    APPEND current_char TO accumulator
                    IF depth_counter = 0 THEN
                        APPEND CONCAT(accumulator) TO result_collector
                        CLEAR accumulator
                    END IF
                DEFAULT:
                    NULL
            END SWITCH

            CALL recur(index + 1)
        END IF
    END FUNCTION

    CALL recur(0)
    RETURN result_collector
END FUNCTION
```