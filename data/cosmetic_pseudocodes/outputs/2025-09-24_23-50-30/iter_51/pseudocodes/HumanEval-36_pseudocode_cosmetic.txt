```
FUNCTION fizz_buzz(next_value)
    PROCEDURE gather(accumulate_list, current_val)
        IF current_val >= next_value THEN RETURN accumulate_list
        ELSE
            SET proceed_list TO accumulate_list
            SWITCH TRUE 
                CASE (current_val % 13 = 0): 
                CASE (current_val % 11 = 0): 
                    SET proceed_list TO accumulate_list + [current_val]
                    BREAK
                DEFAULT: 
                    BREAK
            END SWITCH
            RETURN gather(proceed_list, current_val + 1)
        END IF
    END PROCEDURE

    SET collected_numbers TO gather([], 0)

    FUNCTION combine_strings(string_list, index, length, acc_string)
        IF index = length THEN RETURN acc_string
        ELSE
            RETURN combine_strings(string_list, index + 1, length, acc_string + to_string(string_list[index]))
        END IF
    END FUNCTION

    SET joint_string TO combine_strings(collected_numbers, 0, len(collected_numbers), "")

    FUNCTION count_characters(text, pos, lim, accumulator)
        IF pos = lim THEN RETURN accumulator
        ELSE
            SET increment TO (text[pos] = '7') ? 1 : 0
            RETURN count_characters(text, pos + 1, lim, accumulator + increment)
        END IF
    END FUNCTION

    RETURN count_characters(joint_string, 0, len(joint_string), 0)
END FUNCTION
```