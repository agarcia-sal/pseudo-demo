```
FUNCTION flip_case(input_string)
    DECLARE output_array AS ARRAY OF CHARACTERS INITIALIZED EMPTY
    DECLARE position AS INTEGER SET TO 0
    WHILE position < LENGTH(input_string) DO
        DECLARE current_character AS CHARACTER SET TO input_string[position]
        IF current_character >= 'a' AND current_character <= 'z' THEN
            DECLARE converted_character AS CHARACTER SET TO current_character - ('a' - 'A')
        ELSE IF current_character >= 'A' AND current_character <= 'Z' THEN
            DECLARE converted_character AS CHARACTER SET TO current_character + ('a' - 'A')
        ELSE
            DECLARE converted_character AS CHARACTER SET TO current_character
        END IF
        output_array.ADD(converted_character)
        position = position + 1
    END WHILE
    RETURN CONCATENATE_ELEMENTS_OF output_array INTO STRING
END FUNCTION
```