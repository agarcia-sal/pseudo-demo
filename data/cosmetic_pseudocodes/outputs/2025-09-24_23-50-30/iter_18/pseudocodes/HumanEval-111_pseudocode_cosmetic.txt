```
FUNCTION histogram(test_string)
  LET index_var BE 0
  LET letter_array BE SPLIT test_string BY " "
  LET freq_map BE empty dictionary
  LET peak_freq BE 0

  WHILE index_var < LENGTH(letter_array)
    LET current_letter BE letter_array[index_var]
    IF current_letter = "" THEN
      SET index_var TO index_var + 1 
      CONTINUE
    ENDIF
    LET repetition_count BE 0
    LET inner_index BE 0

    WHILE inner_index < LENGTH(letter_array)
      IF letter_array[inner_index] = current_letter THEN
        SET repetition_count TO repetition_count + 1
      ENDIF
      SET inner_index TO inner_index + 1
    ENDWHILE

    IF repetition_count <= peak_freq THEN
      SET index_var TO index_var + 1
      CONTINUE
    ENDIF

    SET peak_freq TO repetition_count
    SET index_var TO index_var + 1
  ENDWHILE

  IF peak_freq <= 0 THEN
    RETURN freq_map
  ENDIF

  LET pos BE 0
  WHILE pos < LENGTH(letter_array)
    LET candidate_letter BE letter_array[pos]
    IF candidate_letter = "" THEN
      SET pos TO pos + 1
      CONTINUE
    ENDIF

    LET candidate_count BE 0
    LET scan_pos BE 0

    WHILE scan_pos < LENGTH(letter_array)
      IF letter_array[scan_pos] = candidate_letter THEN
        SET candidate_count TO candidate_count + 1
      ENDIF
      SET scan_pos TO scan_pos + 1
    ENDWHILE

    IF candidate_count = peak_freq THEN
      SET freq_map[candidate_letter] TO peak_freq
    ENDIF

    SET pos TO pos + 1
  ENDWHILE

  RETURN freq_map
END FUNCTION
```