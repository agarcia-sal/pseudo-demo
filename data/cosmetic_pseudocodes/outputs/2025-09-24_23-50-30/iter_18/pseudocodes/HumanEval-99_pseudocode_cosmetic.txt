```
FUNCTION closest_integer(input_val)
    IMPORT floor, ceil FROM math

    SET dot_counts TO 0
    SET index_ptr TO 0

    WHILE index_ptr < LENGTH(input_val)
        IF input_val[index_ptr] = '.'
             SET dot_counts TO dot_counts + 1
        END IF
        SET index_ptr TO index_ptr + 1
    END WHILE

    IF dot_counts ≠ 1 THEN GOTO after_trim

    WHILE LENGTH(input_val) > 0 AND input_val[LENGTH(input_val) - 1] = '0' DO
        SET input_val TO SUBSTRING(input_val, 0, LENGTH(input_val) - 1)
    END WHILE

    after_trim:

    SET number_val TO FLOAT(input_val)

    IF LENGTH(input_val) ≥ 2 AND SUBSTRING(input_val, LENGTH(input_val) - 2, 2) = '.5' THEN
        IF number_val ≤ 0 THEN
            SET result_val TO floor(number_val)
            RETURN result_val
        END IF

        SET result_val TO ceil(number_val)
        RETURN result_val
    END IF

    IF LENGTH(input_val) > 0 THEN
        SET result_val TO ROUND(number_val)
    ELSE
        SET result_val TO 0
    END IF

    RETURN result_val
END FUNCTION
```