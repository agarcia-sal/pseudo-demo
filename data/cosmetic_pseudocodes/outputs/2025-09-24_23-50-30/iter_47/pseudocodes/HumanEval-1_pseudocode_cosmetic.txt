```
FUNCTION separate_paren_groups(string_of_parentheses)
    SET results_collection TO []
    SET accumulating_chars TO []
    SET current_level TO 0

    SET index_ptr TO 0
    WHILE index_ptr < LENGTH(string_of_parentheses) DO
        SET single_char TO string_of_parentheses[index_ptr]

        SWITCH single_char
            CASE '(':
                current_level ← current_level + 1
                accumulating_chars.APPEND(single_char)
            CASE ')':
                current_level ← current_level - 1
                accumulating_chars.APPEND(single_char)

                IF NOT (current_level <> 0) THEN
                    results_collection.APPEND(CONCATENATE(accumulating_chars))
                    accumulating_chars ← []
                END IF
        END SWITCH

        index_ptr ← index_ptr + 1
    END WHILE

    RETURN results_collection
END FUNCTION
```