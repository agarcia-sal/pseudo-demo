```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    SET result_sum TO 0
    FOR each_row_index FROM 0 TO LENGTH(grid) - 1
        SET current_row TO grid[each_row_index]
        SET row_accumulator TO 0
        FOR each_element_index FROM 0 TO LENGTH(current_row) - 1
            SET element TO current_row[each_element_index]
            SET row_accumulator TO row_accumulator + element
        END FOR
        SET division_result TO row_accumulator / capacity
        SET partial_ceil TO math.ceil(division_result)
        SET result_sum TO result_sum + partial_ceil
    END FOR
    RETURN result_sum
END FUNCTION
```