```
FUNCTION histogram(test_string)
  SET freq_map TO {}
  SET chars TO []
  SET idx TO 1
  WHILE idx <= LENGTH(test_string)
    IF SUBSTRING(test_string, idx, 1) = " "
      SET chars TO chars + [""]
    ELSE
      IF LENGTH(chars) = 0
        SET chars TO [SUBSTRING(test_string, idx, 1)]
      ELSE
        SET chars[-1] TO chars[-1] + SUBSTRING(test_string, idx, 1)
      ENDIF
    ENDIF
    SET idx TO idx + 1
  ENDWHILE

  SET top_count TO 0
  SET pos TO 1
  WHILE pos <= LENGTH(chars)
    SET curr_char TO chars[pos]
    IF curr_char ≠ ""
      SET count_curr TO 0
      SET scan TO 1
      WHILE scan <= LENGTH(chars)
        IF chars[scan] = curr_char
          SET count_curr TO count_curr + 1
        ENDIF
        SET scan TO scan + 1
      ENDWHILE
      IF NOT (count_curr ≤ top_count)
        SET top_count TO count_curr
      ENDIF
    ENDIF
    SET pos TO pos + 1
  ENDWHILE

  IF top_count > 0
    SET pos2 TO 1
    WHILE pos2 <= LENGTH(chars)
      SET curr_char2 TO chars[pos2]
      IF curr_char2 ≠ ""
        SET tally TO 0
        SET scan2 TO 1
        WHILE scan2 <= LENGTH(chars)
          IF chars[scan2] = curr_char2
            SET tally TO tally + 1
          ENDIF
          SET scan2 TO scan2 + 1
        ENDWHILE
        IF tally = top_count
          SET freq_map[curr_char2] TO top_count
        ENDIF
      ENDIF
      SET pos2 TO pos2 + 1
    ENDWHILE
  ENDIF

  RETURN freq_map
END FUNCTION
```