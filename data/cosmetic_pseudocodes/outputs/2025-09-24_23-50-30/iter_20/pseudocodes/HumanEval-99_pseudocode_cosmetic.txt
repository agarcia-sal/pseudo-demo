```
FUNCTION closest_integer(input_str)
    IMPORT floor, ceil FROM math

    DEFINE remove_trailing_zeros(str_val)
        IF '.' NOT IN str_val THEN RETURN str_val END IF
        DEFINE inner_loop(s)
            IF LENGTH(s) > 0 AND s[-1] = '0' THEN
                RETURN inner_loop(SUBSTRING(s, 0, LENGTH(s) - 1))
            ELSE
                RETURN s
            END IF
        END DEFINE
        RETURN inner_loop(str_val)
    END DEFINE

    SET trimmed_str TO remove_trailing_zeros(input_str)

    SET decimal_num TO FLOAT(trimmed_str)

    SWITCH TRUE
        CASE LENGTH(trimmed_str) = 0:
            SET output_num TO 0
        CASE LENGTH(trimmed_str) >= 2 AND SUBSTRING(trimmed_str, -2, 2) = '.5':
            IF NOT (decimal_num <= 0) THEN
                SET output_num TO ceil(decimal_num)
            ELSE
                SET output_num TO floor(decimal_num)
            END IF
        DEFAULT:
            SET output_num TO ROUND(decimal_num)
    END SWITCH

    RETURN output_num
END FUNCTION
```