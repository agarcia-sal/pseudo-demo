```
FUNCTION histogram(test_string)
    SET dict_result TO {}
    SET letters_arr TO []
    SET max_val TO 0
    SET idx TO 0

    letters_arr = SPLIT test_string BY " "

    WHILE idx < LENGTH(letters_arr)
        SET current_letter TO letters_arr[idx]
        IF current_letter != "" THEN
            SET curr_count TO 0
            SET inner_idx TO 0
            WHILE inner_idx < LENGTH(letters_arr)
                IF letters_arr[inner_idx] = current_letter THEN
                    SET curr_count TO curr_count + 1
                ENDIF
                SET inner_idx TO inner_idx + 1
            ENDWHILE
            IF NOT (curr_count <= max_val) THEN
                SET max_val TO curr_count
            ENDIF
        ENDIF
        SET idx TO idx + 1
    ENDWHILE

    IF max_val <= 0 THEN
        RETURN dict_result
    ENDIF

    SET out_idx TO 0
    WHILE out_idx < LENGTH(letters_arr)
        SET letter_candidate TO letters_arr[out_idx]
        SET count_candidate TO 0
        SET count_idx TO 0
        WHILE count_idx < LENGTH(letters_arr)
            IF letters_arr[count_idx] = letter_candidate THEN
                SET count_candidate TO count_candidate + 1
            ENDIF
            SET count_idx TO count_idx + 1
        ENDWHILE
        IF count_candidate = max_val THEN
            dict_result[letter_candidate] = max_val
        ENDIF
        SET out_idx TO out_idx + 1
    ENDWHILE

    RETURN dict_result
END FUNCTION
```