```
FUNCTION largest_prime_factor(p)
    FUNCTION is_prime(q)
        SET r TO 2
        IF q <= 1 THEN
            RETURN False
        WHILE r < q DO
            IF (q - (q DIV r)*r) = 0 THEN
                RETURN False
            SET r TO r + 1
        RETURN True
    END FUNCTION

    SET s TO 1
    SET t TO 2
    WHILE t <= p DO
        IF (p - (p DIV t)*t) = 0 THEN
            IF is_prime(t) THEN
                IF t > s THEN
                    SET s TO t
        SET t TO t + 1
    RETURN s
END FUNCTION
```