```
FUNCTION strange_sort_list(array_of_numbers)
    INITIALIZE output_sequence AS an empty sequence
    INITIALIZE toggle_indicator AS True

    DEFINE FUNCTION process(input_sequence, accumulator, flag)
        IF input_sequence IS empty THEN
            RETURN accumulator
        ELSE
            LET selected_element =
                IF flag THEN
                    FIND element e IN input_sequence WHERE e <= all elements in input_sequence
                ELSE
                    FIND element e IN input_sequence WHERE e >= all elements in input_sequence
            LET filtered_sequence = FILTER elements x IN input_sequence WHERE x != selected_element OR (count of x in input_sequence > 1 AND first occurrence ignored)
            RETURN process(filtered_sequence, accumulator + [selected_element], NOT flag)
        END IF
    END FUNCTION

    RETURN process(array_of_numbers, output_sequence, toggle_indicator)
END FUNCTION
```