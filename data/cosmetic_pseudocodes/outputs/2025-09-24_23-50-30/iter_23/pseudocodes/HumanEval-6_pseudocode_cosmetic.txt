```
FUNCTION parse_nested_parens(parens_str)
 parse_paren_group = FUNCTION(segment)
  depth_ctr ← 0
  peak_depth ← 0
  INDEX ← 0
  WHILE INDEX < LENGTH(segment)
   char ← segment[INDEX]
   IF char = '(' THEN
    depth_ctr ← depth_ctr + 1
    peak_depth ← (IF depth_ctr > peak_depth THEN depth_ctr ELSE peak_depth)
   ELSE
    depth_ctr ← depth_ctr - 1
   END IF
   INDEX ← INDEX + 1
  END WHILE
  RETURN peak_depth
 END FUNCTION

 sections ← FILTER(LAMBDA(x) : x ≠ "", SPLIT(parens_str, " "))
 RETURN MAP(LAMBDA(s) : parse_paren_group(s), sections)
END FUNCTION
```