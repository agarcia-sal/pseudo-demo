```
FUNCTION closest_integer(input_val)
    IMPORT ceil, floor FROM math

    PROCEDURE strip_trailing_zeros(str_val)
        IF COUNT OF '.' IN str_val = 1 THEN
            WHILE str_val != "" AND LAST CHARACTER OF str_val = '0' DO
                SET str_val TO SUBSTRING(str_val, 0, LENGTH(str_val) - 1)
            END WHILE
        END IF
        RETURN str_val
    END PROCEDURE

    SET temp_val TO strip_trailing_zeros(input_val)
    SET float_num TO FLOAT(temp_val)

    SWITCH 
        CASE (LENGTH(temp_val) >= 2 AND SUBSTRING(temp_val, LENGTH(temp_val)-2, LENGTH(temp_val)) = '.5'):
            IF float_num > 0 THEN
                RETURN ceil(float_num)
            ELSE 
                RETURN floor(float_num)
            END IF
        CASE (LENGTH(temp_val) > 0):
            RETURN ROUND(float_num)
        DEFAULT:
            RETURN 0
    END SWITCH
END FUNCTION
```