```
FUNCTION filter_by_substring(array_of_texts, key)
  PROCEDURE inner_filter(index, acc)
    IF index = LENGTH(array_of_texts) THEN
      RETURN acc
    ELSE
      LET element = array_of_texts[index]
      LET new_acc =
        SWITCH (key IN element)
          CASE true: acc + [element]
          CASE false: acc
        END SWITCH
      RETURN inner_filter(index + 1, new_acc)
    END IF
  END PROCEDURE

  RETURN inner_filter(0, [])
END FUNCTION
```