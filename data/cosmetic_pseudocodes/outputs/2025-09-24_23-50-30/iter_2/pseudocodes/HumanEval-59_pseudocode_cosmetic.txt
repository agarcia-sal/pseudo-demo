```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        FUNCTION check_divisor(d)
            IF d * d > k
                RETURN True
            IF k MOD d EQUALS 0
                RETURN False
            RETURN check_divisor(d + 1)
        IF k < 2
            RETURN False
        RETURN check_divisor(2)
    END FUNCTION

    SET largest_factor TO 1
    SET candidate TO n
    WHILE candidate >= 2
        IF n MOD candidate = 0
            IF is_prime(candidate)
                IF candidate > largest_factor
                    SET largest_factor TO candidate
        SET candidate TO candidate - 1
    RETURN largest_factor
END FUNCTION
```