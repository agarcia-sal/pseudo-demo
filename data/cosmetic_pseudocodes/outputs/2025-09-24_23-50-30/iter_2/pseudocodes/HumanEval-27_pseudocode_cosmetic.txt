```
FUNCTION flip_case(input_string)
    SET result to empty string
    SET index to LENGTH(input_string) - 1
    WHILE index >= 0 DO
        SET ch to input_string[index]
        IF NOT (ch >= "a" AND ch <= "z") THEN
            IF ch >= "A" AND ch <= "Z" THEN
                SET result to CHAR(ASCII(ch) + 32) + result
            ELSE
                SET result to ch + result
            END IF
        ELSE
            SET result to CHAR(ASCII(ch) - 32) + result
        END IF
        DECREMENT index
    END WHILE
    RETURN result
END FUNCTION
```