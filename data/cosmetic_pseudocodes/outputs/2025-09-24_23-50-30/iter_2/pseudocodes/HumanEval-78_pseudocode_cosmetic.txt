```
FUNCTION hex_key(string_num)
    SET tally TO 0
    SET primes_set TO {'2', '3', '5', '7', 'B', 'D'}
    
    RECURSIVE FUNCTION count_primes(pos)
        IF pos < 0 THEN
            RETURN 0
        IF NOT string_num[pos] IN primes_set THEN
            RETURN count_primes(pos - 1)
        ELSE
            RETURN 1 + count_primes(pos - 1)
    END FUNCTION
    
    SET tally TO count_primes(LENGTH(string_num) - 1)
    RETURN tally
END FUNCTION
```