```
FUNCTION sort_array(array_of_integers)
    DEFINE FUNCTION count_ones(n)
        SET bits TO ""
        SET num TO n
        WHILE num > 0
            SET bits TO (num % 2) + bits
            SET num TO FLOOR(num / 2)
        END WHILE
        SET ones_count TO 0
        FOR i FROM 1 TO LENGTH(bits)
            IF bits[i] != '1' THEN CONTINUE
            SET ones_count TO ones_count + 1
        END FOR
        RETURN ones_count
    END FUNCTION

    SET sorted_by_ones TO []
    FOR each_integer IN array_of_integers
        SET ones TO count_ones(each_integer)
        APPEND (ones, each_integer) TO sorted_by_ones
    END FOR

    SET n TO LENGTH(sorted_by_ones)
    SET index TO 0
    WHILE index < n - 1
        IF sorted_by_ones[index][0] > sorted_by_ones[index + 1][0] OR
           (sorted_by_ones[index][0] == sorted_by_ones[index + 1][0] AND 
            sorted_by_ones[index][1] > sorted_by_ones[index + 1][1])
            SWAP sorted_by_ones[index] WITH sorted_by_ones[index + 1]
            SET index TO 0
        ELSE
            SET index TO index + 1
        END IF
    END WHILE

    SET output_array TO []
    FOREACH pair IN sorted_by_ones
        APPEND pair[1] TO output_array
    END FOREACH

    RETURN output_array
END FUNCTION
```