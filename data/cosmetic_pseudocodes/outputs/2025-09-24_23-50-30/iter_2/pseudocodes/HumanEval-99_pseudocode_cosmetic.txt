``` 
FUNCTION closest_integer(value)
    IMPORT floor, ceil FROM math

    SET dot_count TO 0
    FOR char IN value
        IF char IS '.'
            SET dot_count TO dot_count + 1
    IF dot_count IS NOT 1 THEN
        // do nothing
    ELSE
        SET idx TO LENGTH(value) - 1
        REPEAT
            IF value[idx] IS NOT '0' THEN
                BREAK
            SET idx TO idx - 1
            IF idx < 0 THEN
                BREAK
        UNTIL FALSE
        SET value TO SUBSTRING(value, 0, idx + 1)
    END IF

    SET num TO 0.0
    IF LENGTH(value) > 0 THEN
        SET num TO FLOAT(value)
    END IF

    IF NOT (LENGTH(value) >= 2 AND SUBSTRING(value, LENGTH(value) - 2, 2) = '.5') THEN
        IF LENGTH(value) > 0 THEN
            SET result TO INTEGER(ROUND(num))
        ELSE
            SET result TO 0
        END IF
    ELSE
        IF num <= 0 THEN
            SET result TO floor(num)
        ELSE
            SET result TO ceil(num)
        END IF
    END IF

    RETURN result
END FUNCTION
```