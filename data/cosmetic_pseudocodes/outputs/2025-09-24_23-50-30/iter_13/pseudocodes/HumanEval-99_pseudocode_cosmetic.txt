```
FUNCTION closest_integer(input_str)
    IMPORT floor, ceil FROM math

    FUNCTION trim_trailing_zeros(s, zero_char)
        WHILE s ENDS WITH zero_char
            s := SUBSTRING(s, 0, LENGTH(s) - 1)
        RETURN s
    END FUNCTION

    VAR decimal_points_count := 0
    FOR EACH ch IN input_str
        IF ch = '.' THEN
            decimal_points_count := decimal_points_count + 1
        END IF
    END FOR

    IF decimal_points_count = 1 THEN
        input_str := trim_trailing_zeros(input_str, '0')
    END IF

    VAR number_value := FLOAT(input_str)

    SWITCH TRUE
        CASE (LENGTH(input_str) >= 2 AND SUBSTRING(input_str, LENGTH(input_str) - 2, 2) = '.5'):
            IF number_value > 0 THEN
                RETURN ceil(number_value)
            ELSE
                RETURN floor(number_value)
            END IF
        CASE (LENGTH(input_str) > 0):
            RETURN ROUND(number_value)
        DEFAULT:
            RETURN 0
    END SWITCH
END FUNCTION
```