```
FUNCTION flip_case(source_text)
    VARIABLE output_builder := EMPTY STRING
    FOR position FROM 1 TO LENGTH(source_text) DO
        VARIABLE current_char := source_text[position]
        IF current_char >= 'a' AND current_char <= 'z' THEN
            output_builder := output_builder + TO_UPPER(current_char)
        ELSE IF current_char >= 'A' AND current_char <= 'Z' THEN
            output_builder := output_builder + TO_LOWER(current_char)
        ELSE
            output_builder := output_builder + current_char
        END IF
    END FOR
    RETURN output_builder
END FUNCTION
```