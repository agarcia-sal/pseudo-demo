```
FUNCTION max_fill(grid, capacity)
    total_sum ← 0
    FOR EACH row_element IN grid DO
        row_accumulator ← 0
        FOR EACH value IN row_element DO
            row_accumulator ← row_accumulator + value
        END FOR
        divisions ← row_accumulator / capacity
        ceiling_value ← (IF divisions = INTEGER_PART(divisions) THEN divisions ELSE INTEGER_PART(divisions) + 1)
        total_sum ← total_sum + ceiling_value
    END FOR
    RETURN total_sum
END FUNCTION
```