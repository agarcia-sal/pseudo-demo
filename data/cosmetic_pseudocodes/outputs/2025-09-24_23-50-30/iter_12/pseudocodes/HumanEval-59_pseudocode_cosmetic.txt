```
FUNCTION largest_prime_factor(p)
    FUNCTION is_prime(m)
        SET q TO 2
        WHILE q DOES NOT EXCEED m MINUS 1
            IF m MODULO q EQUALS 0
                RETURN False
            SET q TO q PLUS 1
        IF m LESS THAN 2
            RETURN False
        RETURN True
    END FUNCTION

    SET z TO 1
    SET u TO 2
    WHILE u LESS THAN OR EQUAL TO p
        IF (p MODULO u EQUALS 0) NOT EQUAL TO False AND is_prime(u) EQUALS True
            SET z TO (IF z GREATER THAN u THEN z ELSE u)
        SET u TO u PLUS 1
    RETURN z
END FUNCTION
```