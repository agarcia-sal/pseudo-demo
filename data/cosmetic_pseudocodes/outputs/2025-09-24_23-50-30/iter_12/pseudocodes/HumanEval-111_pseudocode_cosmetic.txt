```
FUNCTION histogram(test_string)
  SET freq_map TO new dictionary
  SET letters_arr TO FILTER(SPLIT(test_string, " "), L -> L != "")
  
  DEFINE find_max_count(arr, current_max)
    IF arr IS empty THEN RETURN current_max
    ELSE
      SET head TO FIRST(arr)
      SET tail TO REST(arr)
      SET count_head TO LENGTH(FILTER(arr, X -> X = head))
      SET new_max TO (count_head > current_max) ? count_head : current_max
      RETURN find_max_count(tail, new_max)
    
  SET max_freq TO find_max_count(letters_arr, 0)
  
  IF max_freq <= 0 THEN RETURN freq_map
  
  DEFINE add_max_letters(arr, freq, map_acc)
    IF arr IS empty THEN RETURN map_acc
    ELSE
      SET head TO FIRST(arr)
      SET tail TO REST(arr)
      SET freq_head TO LENGTH(FILTER(arr, X -> X = head))
      IF freq_head = freq THEN
        map_acc[head] = freq
      ENDIF
      RETURN add_max_letters(tail, freq, map_acc)
    
  RETURN add_max_letters(letters_arr, max_freq, freq_map)
END FUNCTION
```