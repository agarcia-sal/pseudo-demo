```
FUNCTION vowels_count(text)
    DEFINE vowels_collection = ARRAY 'a', 'e', 'i', 'o', 'u', 'A', 'E', 'I', 'O', 'U'

    SET idx TO 0
    SET count TO 0
    WHILE idx < LENGTH(text)
        IF vowels_collection CONTAINS text[idx]
            count = count + 1
        END IF
        idx = idx + 1
    END WHILE

    SWITCH text[LENGTH(text) - 1]
        CASE 'y':
        CASE 'Y':
            count = count + 1
    END SWITCH

    RETURN count
END FUNCTION
```