```
FUNCTION flip_case(text)
    RESULT = EMPTY_STRING
    FOR POSITION FROM 1 TO LENGTH(text) DO
        LETTER = SUBSTRING(text, POSITION, 1)
        IF LETTER IS LOWERCASE THEN
            RESULT = RESULT + CONVERT LETTER TO UPPERCASE
        ELSE IF LETTER IS UPPERCASE THEN
            RESULT = RESULT + CONVERT LETTER TO LOWERCASE
        ELSE
            RESULT = RESULT + LETTER
        END IF
    END FOR
    RETURN RESULT
END FUNCTION
```