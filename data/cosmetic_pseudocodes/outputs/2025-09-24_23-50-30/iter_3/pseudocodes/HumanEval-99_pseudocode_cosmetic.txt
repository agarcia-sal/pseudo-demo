```
FUNCTION closest_integer(value)
    IMPORT ceil, floor FROM math

    IF value CONTAINS '.'
        FOR idx FROM LENGTH(value) DOWNTO 1
            IF value[idx] IS NOT '0' OR value[idx - 1] IS NOT '.'
                SET value TO SUBSTRING(value, 1, idx)
                BREAK
            END IF
        END FOR
    END IF

    SET number AS FLOAT(value)

    SELECT CASE TRUE
        CASE value ENDS WITH '.5'
            IF number > 0 THEN
                RETURN ceil(number)
            ELSE
                RETURN floor(number)
            END IF
        CASE LENGTH(value) > 0
            RETURN ROUND(number)
        DEFAULT
            RETURN 0
    END SELECT
END FUNCTION
```