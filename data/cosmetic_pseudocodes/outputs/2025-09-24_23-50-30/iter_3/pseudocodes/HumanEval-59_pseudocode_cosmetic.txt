```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        IF k <= 1 THEN
            RETURN False
        END IF
        FOR divisor IN RANGE(2, k)
            IF (k MOD divisor) = 0 THEN
                RETURN False
            END IF
        END FOR
        RETURN True
    END FUNCTION

    SET max_factor TO 1
    FOR candidate IN RANGE(2, n + 1)
        IF (n MOD candidate) = 0 THEN
            IF is_prime(candidate) THEN
                max_factor = (max_factor < candidate) ? candidate : max_factor
            END IF
        END IF
    END FOR
    RETURN max_factor
END FUNCTION
```