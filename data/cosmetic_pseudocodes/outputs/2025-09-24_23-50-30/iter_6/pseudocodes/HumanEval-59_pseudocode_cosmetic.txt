```
FUNCTION largest_prime_factor(x)
    FUNCTION is_prime(y)
        IF y LESS THAN 2 THEN RETURN False
        SET divisor_counter TO 2
        WHILE divisor_counter LESS THAN y DO
            IF (y MINUS (y DIVIDED_BY divisor_counter TIMES divisor_counter)) EQUALS 0 THEN RETURN False
            SET divisor_counter TO divisor_counter PLUS 1
        END WHILE
        RETURN True
    END FUNCTION

    SET max_factor TO 1
    SET candidate TO 2
    WHILE candidate LESS_EQUAL x DO
        IF (x MINUS ((x DIVIDED_BY candidate) TIMES candidate)) EQUALS 0 THEN
            IF is_prime(candidate) THEN
                IF candidate GREATER_THAN max_factor THEN
                    SET max_factor TO candidate
                END IF
            END IF
        END IF
        SET candidate TO candidate PLUS 1
    END WHILE
    RETURN max_factor
END FUNCTION
```