```
FUNCTION check_dict_case(collection)
    IF NOT (SIZE(collection.KEYS) > 0)
        RETURN False
    END IF

    VARIABLE mode ← "start"
    VARIABLE index ← 0
    VARIABLE keys_list ← collection.KEYS

    WHILE index < SIZE(keys_list)
        VARIABLE current_item ← keys_list[index]

        IF TYPE_OF(current_item) ≠ STRING
            mode ← "mixed"
            BREAK
        END IF

        SWITCH mode
            CASE "start":
                IF TO_UPPER(current_item) = current_item
                    mode ← "upper"
                ELSE 
                    IF TO_LOWER(current_item) = current_item
                        mode ← "lower"
                    ELSE
                        BREAK
                    END IF
                END IF
            CASE "upper":
                IF TO_UPPER(current_item) ≠ current_item
                    mode ← "mixed"
                    BREAK
                END IF
            CASE "lower":
                IF TO_LOWER(current_item) ≠ current_item
                    mode ← "mixed"
                    BREAK
                END IF
            DEFAULT:
                BREAK
        END SWITCH

        index ← index + 1
    END WHILE

    RETURN (mode = "upper") OR (mode = "lower")
END FUNCTION
```