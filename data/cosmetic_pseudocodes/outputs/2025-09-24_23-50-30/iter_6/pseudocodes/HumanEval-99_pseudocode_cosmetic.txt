```
FUNCTION closest_integer(value)
    IMPORT floor, ceil FROM math

    DEFINE remove_trailing_zeros(s)
        WHILE LENGTH(s) > 0 AND s[-1] == '0'
            s <- SUBSTRING s FROM 0 TO LENGTH(s) - 1
        RETURN s
    END DEFINE

    IF (LEN(FILTER c IN value WHERE c == '.') == 1)
        value <- remove_trailing_zeros(value)

    number <- TO_FLOAT(value)

    SWITCH TRUE
        CASE (LEN(value) >= 2 AND SUBSTRING(value, LEN(value)-2, LEN(value)) == '.5'):
            RETURN (number > 0) ? ceil(number) : floor(number)
        CASE (LEN(value) > 0):
            RETURN ROUND_TO_INT(number)
        DEFAULT:
            RETURN 0
    END SWITCH
END FUNCTION
```