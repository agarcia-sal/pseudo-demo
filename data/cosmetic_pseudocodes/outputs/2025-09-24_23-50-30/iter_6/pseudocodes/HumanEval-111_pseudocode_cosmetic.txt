```
FUNCTION histogram(test_string)
    SET freq_map TO {}
    SET chars TO []
    SET idx TO 0
    SET max_freq TO -1

    WHILE idx < LENGTH(test_string)
        IF SUBSTRING(test_string, idx, idx+1) == " "
            APPEND "" TO chars
        ELSE
            SET current_char TO ""
            WHILE idx < LENGTH(test_string) AND SUBSTRING(test_string, idx, idx+1) != " "
                SET current_char TO CONCATENATE(current_char, SUBSTRING(test_string, idx, idx+1))
                SET idx TO idx + 1
            END WHILE
            APPEND current_char TO chars
            CONTINUE
        END IF
        SET idx TO idx + 1
    END WHILE

    SET position TO 0
    WHILE position < LENGTH(chars)
        SET element TO chars[position]

        SET count_check TO 0
        FOR each item IN chars
            IF item == element THEN
                SET count_check TO count_check + 1
            END IF
        END FOR

        IF count_check > max_freq AND element != ""
            SET max_freq TO count_check
        END IF
        SET position TO position + 1
    END WHILE

    IF max_freq <= 0
        RETURN freq_map
    END IF

    SET pointer TO 0
    WHILE pointer < LENGTH(chars)
        SET val TO chars[pointer]

        SET tally TO 0
        FOR each element IN chars
            IF element == val THEN
                SET tally TO tally + 1
            END IF
        END FOR

        IF tally == max_freq
            SET freq_map[val] TO max_freq
        END IF

        SET pointer TO pointer + 1
    END WHILE

    RETURN freq_map
END FUNCTION
```