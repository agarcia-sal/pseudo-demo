```
FUNCTION minPath(grid, x)
 n ← LENGTH OF grid
 r ← n * n + 1
 FOR p FROM 0 TO n - 1
  FOR q FROM 0 TO n - 1
   IF grid AT p AND q = 1 THEN
    s ← EMPTY LIST
    IF p ≠ 0 THEN
     APPEND grid AT p - 1 AND q TO s
    END IF
    IF q ≠ 0 THEN
     APPEND grid AT p AND q - 1 TO s
    END IF
    IF p ≠ n - 1 THEN
     APPEND grid AT p + 1 AND q TO s
    END IF
    IF q ≠ n - 1 THEN
     APPEND grid AT p AND q + 1 TO s
    END IF
    r ← MINIMUM ELEMENT OF s
   END IF
  END FOR
 END FOR
 t ← EMPTY LIST
 FOR u FROM 0 TO x - 1
  IF u MOD 2 = 0 THEN
   APPEND 1 TO t
  ELSE
   APPEND r TO t
  END IF
 END FOR
 RETURN t
END FUNCTION
```