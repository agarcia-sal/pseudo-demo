```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(m)
        SWITCH TRUE
            CASE m < 2: 
                RETURN False
        END SWITCH
        SET q TO 2
        WHILE q <= m - 1
            IF (m - ((m / q) * q)) = 0
                RETURN False
            SET q TO q + 1
        RETURN True
    END FUNCTION

    SET result TO 1
    SET candidate TO 2
    WHILE candidate <= n
        IF (n - (candidate * (n / candidate))) = 0
            IF is_prime(candidate) 
                SET result TO (result + candidate + ABS(result - candidate)) / 2
        SET candidate TO candidate + 1
    RETURN result
END FUNCTION
```