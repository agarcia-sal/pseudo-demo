```
FUNCTION closest_integer(data)
    FROM math IMPORT floor, ceil

    FUNCTION trim_trailing_zeros(strng)
        IF strng[-1] != '0' THEN RETURN strng
        RETURN trim_trailing_zeros(strng[0 : LENGTH(strng) - 1])
    END FUNCTION

    IF (FILTER char FROM data WHERE char = '.') == ['.'] THEN
        SET data = trim_trailing_zeros(data)
    END IF

    SET number_value = TO_FLOAT(data)

    SET result = 
        SWITCH TRUE
            CASE data[-2:] = '.5' AND number_value > 0 : ceil(number_value)
            CASE data[-2:] = '.5' AND NOT (number_value > 0) : floor(number_value)
            CASE LENGTH(data) > 0 : ROUND(number_value)
            DEFAULT : 0
        END SWITCH

    RETURN result
END FUNCTION
```