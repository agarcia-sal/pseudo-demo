```
FUNCTION median(list_in)
    LET sorted_arr = []
    FOR i FROM 0 TO LENGTH_OF(list_in) - 1
        LET inserted = FALSE
        FOR j FROM 0 TO LENGTH_OF(sorted_arr) - 1
            IF list_in[i] < sorted_arr[j]
                INSERT list_in[i] INTO sorted_arr AT INDEX j
                SET inserted = TRUE
                BREAK
        IF NOT inserted
            APPEND list_in[i] TO sorted_arr

    LET length_val = LENGTH_OF(sorted_arr)
    LET midpoint = length_val DIV 2

    IF (length_val MOD 2) != 0 THEN RETURN sorted_arr[midpoint]

    LET val1 = sorted_arr[midpoint]
    LET val0 = sorted_arr[midpoint - 1]
    RETURN (val0 + val1) * 0.5
END FUNCTION
```