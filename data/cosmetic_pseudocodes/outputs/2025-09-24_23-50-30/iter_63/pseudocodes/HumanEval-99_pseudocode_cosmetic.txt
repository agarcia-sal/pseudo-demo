```
FUNCTION closest_integer(value)
    IMPORT floor, ceil FROM math

    FUNCTION trim_trailing_zeros(str)
        IF COUNT OF '.' IN str = 1 THEN
            RETURN trim_trailing_zeros_recursive(str)
        ELSE
            RETURN str
        END IF
    END FUNCTION

    FUNCTION trim_trailing_zeros_recursive(s)
        SWITCH s[-1]
            CASE '0':
                RETURN trim_trailing_zeros_recursive(s[0 TO LENGTH(s) - 2])
            DEFAULT:
                RETURN s
        END SWITCH
    END FUNCTION

    SET cleaned_value TO trim_trailing_zeros(value)
    SET numeric_val TO FLOAT CONVERSION OF cleaned_value

    SWITCH
        CASE LENGTH(cleaned_value) > 0 AND cleaned_value[-2 TO -1] = '.5':
            SET result TO (numeric_val > 0 AND ceil(numeric_val)) OR floor(numeric_val)
        CASE LENGTH(cleaned_value) > 0:
            SET temp TO numeric_val + 0
            SET result TO (temp >= 0) * (INT(temp + 0.5)) + (temp < 0) * (INT(temp - 0.5))
        DEFAULT:
            SET result TO 0
    END SWITCH

    RETURN result
END FUNCTION
```