```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        SWITCH
            CASE k < 2:
                RETURN False
            DEFAULT:
                FOR idx FROM 2 TO (k - 1)
                    IF (k MOD idx) = 0 THEN
                        RETURN False
                RETURN True
        END SWITCH
    END FUNCTION

    SET result TO 1
    FOR candidate FROM 2 TO n DO
        IF NOT ((n MOD candidate) <> 0 OR NOT is_prime(candidate)) THEN
            SET result TO ((result > candidate) ? result : candidate)
    RETURN result
END FUNCTION
```