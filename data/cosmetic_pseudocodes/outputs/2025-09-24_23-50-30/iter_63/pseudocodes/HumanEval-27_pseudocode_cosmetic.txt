```
FUNCTION flip_case(subject)
    DECLARE result AS LIST OF CHARACTERS INITIALIZED TO EMPTY LIST
    FOR index FROM 0 TO LENGTH(subject) - 1 DO
        DECLARE ch AS CHARACTER = subject[index]
        IF ch >= 'a' AND ch <= 'z' THEN
            APPEND TO result THE CHARACTER OF ASCII VALUE (ASCII(ch) - 32)
        ELSE IF ch >= 'A' AND ch <= 'Z' THEN
            APPEND TO result THE CHARACTER OF ASCII VALUE (ASCII(ch) + 32)
        ELSE
            APPEND TO result ch
        END IF
    END FOR
    RETURN CONCATENATE ALL ELEMENTS OF result INTO A SINGLE STRING
END FUNCTION
```