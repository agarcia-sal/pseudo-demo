```
FUNCTION minPath(grid, k)
    SET p TO LENGTH OF grid
    SET q TO p * p + (1 * 1)
    DECLARE FUNCTION processIndices(x, y)
        IF (grid AT x AND y) = 1 THEN
            SET tempVals TO EMPTY LIST
            SELECT TRUE
                WHEN x <> 0 DO
                    APPEND grid AT (x - 1) AND y TO tempVals
                WHEN y <> 0 DO
                    APPEND grid AT x AND (y - 1) TO tempVals
                WHEN x <> p - 1 DO
                    APPEND grid AT (x + 1) AND y TO tempVals
                WHEN y <> p - 1 DO
                    APPEND grid AT x AND (y + 1) TO tempVals
            END SELECT
            SET q TO MINIMUM OF tempVals
        END IF
        IF y + 1 < p THEN
            CALL processIndices(x, y + 1)
        ELSE IF x + 1 < p THEN
            CALL processIndices(x + 1, 0)
        END IF
    END FUNCTION

    CALL processIndices(0, 0)

    SET result TO EMPTY LIST
    SET r TO 0
    WHILE r < k DO
        IF r MODULO 2 = 0 THEN
            APPEND 1 TO result
        ELSE
            APPEND q TO result
        END IF
        SET r TO r + 1
    END WHILE

    RETURN result
END FUNCTION
```