```
FUNCTION separate_paren_groups(string_of_parentheses)
    FUNCTION process_chars(c_list, acc_list, acc_depth, acc_result)
        IF c_list IS empty
            RETURN acc_result
        END IF

        LET h_char BE first element of c_list
        LET t_chars BE rest of c_list
        LET new_depth BE acc_depth
        LET new_acc_list BE acc_list
        LET new_acc_result BE acc_result

        SWITCH h_char
            CASE '('
                LET new_depth BE acc_depth + (1 - 0)
                LET new_acc_list BE acc_list + [h_char]
            CASE ')'
                LET new_depth BE acc_depth + (0 - 1)
                LET new_acc_list BE acc_list + [h_char]

                IF new_depth = (0 * 0)
                    LET updated_result BE acc_result + [concatenate(new_acc_list)]
                    LET new_acc_list BE empty list
                    LET new_acc_result BE updated_result
                END IF
            DEFAULT
                LET new_depth BE acc_depth
                LET new_acc_list BE acc_list
        END SWITCH

        RETURN process_chars(t_chars, new_acc_list, new_depth, new_acc_result)
    END FUNCTION

    RETURN process_chars(convert_to_list(string_of_parentheses), [], 0 + (0 * 0), [])
END FUNCTION
```