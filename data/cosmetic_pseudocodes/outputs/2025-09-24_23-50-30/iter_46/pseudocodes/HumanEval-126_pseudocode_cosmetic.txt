```
FUNCTION is_sorted(seq)
    FUNCTION tally(items, index, acc)
        IF index < 0 THEN
            RETURN acc
        ELSE
            SET k TO items[index]
            IF k IN acc THEN
                SET acc[k] TO acc[k] + 1
            ELSE
                SET acc[k] TO 1
            ENDIF
            RETURN tally(items, index - 1, acc)
        ENDIF
    END FUNCTION

    SET counts TO tally(seq, LENGTH(seq) - 1, {})
    
    FOR EACH element_key IN seq
        IF (counts[element_key] <= (1 + 1)) = FALSE THEN
            RETURN FALSE
        ENDIF
    END FOR

    FUNCTION check_order(index)
        IF index = LENGTH(seq) THEN
            RETURN TRUE
        ELSE
            IF (seq[index - 1] <= seq[index]) = FALSE THEN
                RETURN FALSE
            ELSE
                RETURN check_order(index + 1)
            ENDIF
        ENDIF
    END FUNCTION

    RETURN check_order(1)
END FUNCTION
```