```
FUNCTION flip_case(str_input)
    FUNCTION toggle_char_case(index_acc, len_bound, char_seq, result_accum)
        IF NOT (index_acc < len_bound) THEN
            RETURN result_accum
        ELSE
            SET current_char TO char_seq[index_acc]
            SET toggled_char TO 
                SWITCH 
                    CASE current_char >= 'a' AND current_char <= 'z': 
                        TO_UPPER(current_char)
                    CASE current_char >= 'A' AND current_char <= 'Z': 
                        TO_LOWER(current_char)
                    DEFAULT: current_char
                END SWITCH
            RETURN toggle_char_case(index_acc + 1, len_bound, char_seq, result_accum + toggled_char)
        END IF
    END FUNCTION
    SET length_val TO LENGTH(str_input)
    SET char_array TO str_input
    RETURN toggle_char_case(0, length_val, char_array, "")
END FUNCTION
```