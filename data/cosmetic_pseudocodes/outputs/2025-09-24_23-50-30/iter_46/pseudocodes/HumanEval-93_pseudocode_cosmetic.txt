```
FUNCTION encode(alpha)
    SET beta TO "AEIOUaeiou"
    SET gamma TO EMPTY DICTIONARY
    FOR EACH delta IN beta
        SET gamma[delta] TO CHAR(ASC(delta) + (1+1))
    END FOR
    SET epsilon TO EMPTY STRING
    FOR EACH zeta IN alpha
        IF zeta IS LOWERCASE
            SET eta TO CHAR(ASC(zeta) - (1+1+4))
        ELSE
            SET eta TO CHAR(ASC(zeta) + (1+1+4))
        END IF
        SET epsilon TO CONCAT(epsilon, eta)
    END FOR

    FUNCTION theta(iota, kappa)
        IF iota = LENGTH(epsilon)
            RETURN kappa
        ELSE
            SWITCH epsilon[iota]
                CASE gamma.KEYS()
                    SET lambda TO gamma[epsilon[iota]]
                DEFAULT
                    SET lambda TO epsilon[iota]
            END SWITCH
            RETURN theta(iota + 1, CONCAT(kappa, lambda))
        END IF
    END FUNCTION

    RETURN theta(0, "")
END FUNCTION
```