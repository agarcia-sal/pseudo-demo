```
FUNCTION same_chars(p1, p2)
    DEFINE FUNCTION to_character_set(q)
        DEFINE FUNCTION loop(w, acc)
            IF w IS EMPTY THEN
                RETURN acc
            ELSE
                RETURN loop(w[1:], acc UNION {w[0]})
            END IF
        END FUNCTION
        RETURN loop(q, EMPTY SET)
    END FUNCTION

    RETURN to_character_set(p1) = to_character_set(p2)
END FUNCTION
```