```
FUNCTION digits(n)
    FUNCTION loop(i, p, c)
        IF i = LENGTH(STRING(n)) THEN
            IF c <> 0 THEN RETURN p ELSE RETURN 0 END IF
        END IF
        LET d BE INTEGER(POSITION(i, STRING(n)))
        IF d % 2 = 1 THEN
            RETURN loop(i + 1, p * d, c + 1)
        END IF
        RETURN loop(i + 1, p, c)
    END FUNCTION
    RETURN loop(0, 1, 0)
END FUNCTION
```