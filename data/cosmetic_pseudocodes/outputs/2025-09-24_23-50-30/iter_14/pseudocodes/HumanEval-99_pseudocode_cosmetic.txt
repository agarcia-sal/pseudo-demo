```
FUNCTION closest_integer(input_str)
    IMPORT floor, ceil FROM math

    FUNCTION trim_trailing_zeros(str_val)
        IF COUNT OF '.' IN str_val <> 1
            RETURN str_val
        END IF

        WHILE TRUE
            SET last_char_index TO LENGTH(str_val) - 1
            IF str_val[last_char_index] <> '0'
                RETURN str_val
            END IF
            SET str_val TO SUBSTRING str_val FROM 0 TO last_char_index
        END WHILE
    END FUNCTION

    SET trimmed_str TO trim_trailing_zeros(input_str)
    SET float_num TO FLOAT(trimmed_str)

    IF LENGTH(trimmed_str) = 0 THEN
        RETURN 0
    END IF

    IF LENGTH(trimmed_str) >= 2 AND SUBSTRING(trimmed_str FROM LENGTH(trimmed_str) - 2 TO LENGTH(trimmed_str)) = '.5' THEN
        IF float_num <= 0 THEN
            RETURN floor(float_num)
        END IF
        RETURN ceil(float_num)
    END IF

    RETURN ROUND(float_num)
END FUNCTION
```