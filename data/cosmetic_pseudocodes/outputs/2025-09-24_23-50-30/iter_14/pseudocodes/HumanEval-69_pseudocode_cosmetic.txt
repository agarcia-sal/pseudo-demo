```
FUNCTION search(collection)
    SET freq_map TO array_of_zeroes WITH SIZE (1 + MAX(collection))
    FOR element IN collection DO
        freq_map[element] ← freq_map[element] + 1
    SET result TO -1
    SET idx TO 1
    WHILE idx < LENGTH(freq_map) DO
        IF freq_map[idx] < idx THEN
            idx ← idx + 1
            CONTINUE
        ENDIF
        result ← idx
        idx ← idx + 1
    ENDWHILE
    RETURN result
END FUNCTION
```