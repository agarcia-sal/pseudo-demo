```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    DEFINE sum_result AS 0
    DEFINE index AS 0
    DEFINE grid_length AS LENGTH(grid)
    
    WHILE index < grid_length
        DEFINE current_row AS grid[index]
        DEFINE row_sum AS 0
        FOR element IN current_row
            SET row_sum TO row_sum + element
        END FOR
        SET sum_result TO sum_result + math ceiling(row_sum / capacity)
        SET index TO index + 1
    END WHILE
    
    RETURN sum_result
END FUNCTION
```