```
FUNCTION flip_case(str_param)
    DECLARE result_collection AS EMPTY ARRAY
    DECLARE idx_counter AS INTEGER <- 0

    WHILE idx_counter < LENGTH(str_param) DO
        DECLARE current_char AS CHARACTER <- str_param[idx_counter]
        IF (current_char >= 'a' AND current_char <= 'z') THEN
            APPEND (current_char - ('a' - 'A')) TO result_collection
        ELSIF (current_char >= 'A' AND current_char <= 'Z') THEN
            APPEND (current_char + ('a' - 'A')) TO result_collection
        ELSE
            APPEND current_char TO result_collection
        END IF

        idx_counter <- idx_counter + 1
    END WHILE

    RETURN JOIN_ELEMENTS(result_collection)
END FUNCTION
```