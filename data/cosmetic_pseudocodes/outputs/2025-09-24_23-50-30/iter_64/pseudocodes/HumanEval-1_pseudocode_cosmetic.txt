```
FUNCTION separate_paren_groups(str_param)
    VAR acc_results ← []
    VAR acc_chars ← []
    VAR depth_counter ← 0
    
    VAR idx ← 0
    WHILE idx < LENGTH(str_param) DO
        VAR curr_char ← str_param[idx]
        
        SWITCH curr_char
            CASE '(':
                depth_counter ← depth_counter + 1
                acc_chars ← acc_chars + [curr_char]
                BREAK
            
            CASE ')':
                depth_counter ← depth_counter - 1
                acc_chars ← acc_chars + [curr_char]
                
                IF NOT (depth_counter ≠ 0) THEN
                    acc_results ← acc_results + [JOIN(acc_chars)]
                    acc_chars ← []
                END IF
                BREAK

            DEFAULT:
                BREAK
        END SWITCH
        
        idx ← idx + 1
    END WHILE
    
    RETURN acc_results
END FUNCTION
```