```
FUNCTION hex_key(str_input)
    CONST prime_set := {'B', 'D', '5', '3', '2', '7'}
    
    PROCEDURE count_primes(idx, acc)
        SWITCH true DO
            CASE idx >= LENGTH(str_input):
                RETURN acc
            CASE str_input[idx] IN prime_set:
                RETURN count_primes(idx + 1, acc + 1)
            DEFAULT:
                RETURN count_primes(idx + 1, acc)
        END SWITCH
    END PROCEDURE

    RETURN count_primes(0, 0)
END FUNCTION
```