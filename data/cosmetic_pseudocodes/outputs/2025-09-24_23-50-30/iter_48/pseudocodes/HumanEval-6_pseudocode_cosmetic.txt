```
FUNCTION parse_nested_parens(string_input)
    FUNCTION parse_paren_group(string_piece)
        SET counter_depth = 0
        SET highest_depth = 0
        SET index = 0
        WHILE index < LENGTH(string_piece)
            SWITCH string_piece[index]
                CASE '(':
                    counter_depth = counter_depth + 1
                    IF highest_depth < counter_depth THEN
                        highest_depth = counter_depth
                    END IF
                CASE ')':
                    counter_depth = counter_depth - 1
            END SWITCH
            index = index + 1
        END WHILE
        RETURN highest_depth
    END FUNCTION

    SET parts = []
    SET start = 0
    SET pos = 0
    WHILE pos <= LENGTH(string_input)
        IF pos = LENGTH(string_input) OR string_input[pos] = ' ' THEN
            IF pos - start > 0 THEN
                SET parts = parts + [string_input[start : pos]]
            END IF
            start = pos + 1
        END IF
        pos = pos + 1
    END WHILE

    SET results = []
    SET idx = 0
    WHILE idx < LENGTH(parts)
        SET val = parts[idx]
        IF val â‰  '' THEN
            SET results = results + [parse_paren_group(val)]
        END IF
        idx = idx + 1
    END WHILE
    RETURN results
END FUNCTION
```