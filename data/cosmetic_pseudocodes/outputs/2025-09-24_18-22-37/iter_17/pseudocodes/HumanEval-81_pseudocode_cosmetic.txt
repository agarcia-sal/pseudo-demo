```
FUNCTION numerical_letter_grade(magnitude_values)
  INITIALIZE marks AS new empty list
  SET idx TO 0
  WHILE idx LESS THAN magnitude_values.length
    SET curr_val TO magnitude_values.at(idx)
    IF curr_val == 4.0 THEN
      marks.APPEND("A+")
    ELSE
      IF curr_val > 3.7 THEN 
        marks.APPEND("A")
      ELSE 
        IF curr_val > 3.3 THEN
          marks.APPEND("A-")
        ELSE 
          IF curr_val > 3.0 THEN
            marks.APPEND("B+")
          ELSE 
            IF curr_val > 2.7 THEN
              marks.APPEND("B")
            ELSE 
              IF curr_val > 2.3 THEN
                marks.APPEND("B-")
              ELSE 
                IF curr_val > 2.0 THEN
                  marks.APPEND("C+")
                ELSE 
                  IF curr_val > 1.7 THEN
                    marks.APPEND("C")
                  ELSE 
                    IF curr_val > 1.3 THEN
                      marks.APPEND("C-")
                    ELSE 
                      IF curr_val > 1.0 THEN
                        marks.APPEND("D+")
                      ELSE 
                        IF curr_val > 0.7 THEN
                          marks.APPEND("D")
                        ELSE 
                          IF curr_val > 0.0 THEN
                            marks.APPEND("D-")
                          ELSE 
                            marks.APPEND("E")
                          END IF
                        END IF
                      END IF
                    END IF
                  END IF
                END IF
              END IF
            END IF
          END IF
        END IF
      END IF
    END IF
    SET idx TO idx + 1
  END WHILE
  RETURN marks
END FUNCTION
```