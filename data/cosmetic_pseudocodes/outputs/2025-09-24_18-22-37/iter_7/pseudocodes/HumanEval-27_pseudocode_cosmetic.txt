FUNCTION flip_case(source_text)
  DECLARE result_text AS EMPTY STRING
  DECLARE idx AS INTEGER
  SET idx TO 1
  WHILE idx <= LENGTH(source_text) DO
    DECLARE current_char AS CHARACTER
    SET current_char TO source_text AT POSITION idx
    IF current_char IS BETWEEN 'a' AND 'z' THEN
      DECLARE adjusted_char AS CHARACTER
      SET adjusted_char TO CONVERT_TO_UPPERCASE(current_char)
      SET result_text TO result_text CONCATENATED WITH adjusted_char
    ELSE
      IF current_char IS BETWEEN 'A' AND 'Z' THEN
        DECLARE adjusted_char AS CHARACTER
        SET adjusted_char TO CONVERT_TO_LOWERCASE(current_char)
        SET result_text TO result_text CONCATENATED WITH adjusted_char
      ELSE
        SET result_text TO result_text CONCATENATED WITH current_char
      END IF
    END IF
    SET idx TO idx PLUS 1
  END WHILE
  RETURN result_text
END FUNCTION