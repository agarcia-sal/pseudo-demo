FUNCTION parse_nested_parens(parentheses_string)
    FUNCTION parse_paren_group(group_string)
        SET depth_counter := 0
        SET max_depth_value := 0
        SET index_var := 0
        WHILE index_var < LENGTH OF group_string
            SET char_val := group_string[index_var]
            IF char_val is equal to '(' THEN
                SET depth_counter := depth_counter + 1
                IF max_depth_value < depth_counter THEN
                    SET max_depth_value := depth_counter
                END IF
            ELSE
                SET depth_counter := depth_counter - 1
            END IF
            SET index_var := index_var + 1
        END WHILE
        RETURN max_depth_value
    END FUNCTION

    SET splitted_groups := SPLIT parentheses_string BY ' '
    SET result_list := EMPTY LIST
    SET pos := 0
    WHILE pos < LENGTH OF splitted_groups
        SET item := splitted_groups[pos]
        IF item is not equal to ''
            APPEND parse_paren_group(item) TO result_list
        END IF
        SET pos := pos + 1
    END WHILE
    RETURN result_list
END FUNCTION