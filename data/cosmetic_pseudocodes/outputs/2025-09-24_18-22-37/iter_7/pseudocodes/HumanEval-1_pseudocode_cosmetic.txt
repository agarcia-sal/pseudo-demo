FUNCTION separate_paren_groups(parens_string)
    INITIALIZE results_list AS empty list
    INITIALIZE temp_string_list AS empty list
    SET depth_counter TO 0

    SET index TO 0
    WHILE index LESS THAN length of parens_string
        SET current_char TO parens_string at position index

        SWITCH current_char
            CASE '(':
                SET depth_counter TO depth_counter plus 1
                APPEND current_char TO temp_string_list
                BREAK
            CASE ')':
                DECREMENT depth_counter BY 1
                APPEND current_char TO temp_string_list

                IF depth_counter IS EQUAL TO 0 THEN
                    SET concatenated_string TO empty string
                    SET temp_index TO 0
                    WHILE temp_index LESS THAN length of temp_string_list
                        SET concatenated_string TO concatenated_string plus temp_string_list at temp_index
                        INCREMENT temp_index BY 1
                    END WHILE
                    APPEND concatenated_string TO results_list
                    CLEAR temp_string_list
                END IF
                BREAK
            DEFAULT:
                /* no action */
        END SWITCH

        INCREMENT index BY 1
    END WHILE

    RETURN results_list
END FUNCTION