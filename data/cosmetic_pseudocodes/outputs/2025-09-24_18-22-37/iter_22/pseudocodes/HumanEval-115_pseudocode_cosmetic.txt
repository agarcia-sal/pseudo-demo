```
FUNCTION max_fill(matrix, limit)
    IMPORT math
    SET total TO 0
    SET idx TO 0
    WHILE idx < LENGTH(matrix)
        SET current_row TO matrix[idx]
        SET row_sum TO 0
        SET j TO 0
        WHILE j < LENGTH(current_row)
            SET row_sum TO row_sum + current_row[j]
            SET j TO j + 1
        END WHILE
        SET div_result TO row_sum / limit
        SET ceil_val TO math ceiling of div_result
        SET total TO total + ceil_val
        SET idx TO idx + 1
    END WHILE
    RETURN total
END FUNCTION
```