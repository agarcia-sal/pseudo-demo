```
FUNCTION closest_integer(input_val)
    IMPORT floor, ceil FROM math

    DECLARE str_chars, temp_str, trimmed_val, final_num, rounded_val, curr_char, len_val, prefix_val, suffix_val

    SET len_val TO LENGTH(input_val)
    SET str_chars TO input_val
    SET trimmed_val TO str_chars
    SET prefix_val TO ''
    SET suffix_val TO ''

    DECLARE dot_count, i, break_loop

    SET dot_count TO 0
    FOR i FROM 1 TO len_val
        IF str_chars[i] EQUALS '.'
            SET dot_count TO dot_count + 1
        END IF
    END FOR

    IF dot_count EQUALS 1
        SET break_loop TO FALSE
        WHILE break_loop EQUALS FALSE
            SET curr_char TO trimmed_val[LENGTH(trimmed_val)]
            IF curr_char EQUALS '0'
                SET trimmed_val TO trimmed_val[1 : LENGTH(trimmed_val) - 1]
            ELSE
                SET break_loop TO TRUE
            END IF
        END WHILE
    ELSE
        SET trimmed_val TO input_val
    END IF

    SET final_num TO FLOAT(trimmed_val)

    SET suffix_val TO ''
    IF LENGTH(trimmed_val) >= 2
        SET suffix_val TO trimmed_val[LENGTH(trimmed_val)-1 : LENGTH(trimmed_val)]
    END IF

    IF suffix_val EQUALS '.5'
        IF final_num > 0
            SET rounded_val TO ceil(final_num)
        ELSE
            SET rounded_val TO floor(final_num)
        END IF
    ELSE
        IF LENGTH(trimmed_val) > 0
            SET rounded_val TO INTEGER(ROUND(final_num))
        ELSE
            SET rounded_val TO 0
        END IF
    END IF

    RETURN rounded_val
END FUNCTION
```