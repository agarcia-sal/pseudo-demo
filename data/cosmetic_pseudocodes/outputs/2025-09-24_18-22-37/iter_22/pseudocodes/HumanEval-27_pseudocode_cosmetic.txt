```
FUNCTION flip_case(data_stream)
    VARIABLE position ← 0
    VARIABLE modified_stream ← EMPTY STRING
    WHILE position < LENGTH(data_stream) DO
        VARIABLE current_char ← CHARACTER AT data_stream[position]
        IF current_char >= 'a' AND current_char <= 'z' THEN
            VARIABLE uppercase_char ← current_char MINUS ('a' MINUS 'A')
            modified_stream ← modified_stream CONCATENATED WITH uppercase_char
        ELSE IF current_char >= 'A' AND current_char <= 'Z' THEN
            VARIABLE lowercase_char ← current_char PLUS ('a' MINUS 'A')
            modified_stream ← modified_stream CONCATENATED WITH lowercase_char
        ELSE
            modified_stream ← modified_stream CONCATENATED WITH current_char
        END IF
        position ← position + 1
    END WHILE
    RETURN modified_stream
END FUNCTION
```