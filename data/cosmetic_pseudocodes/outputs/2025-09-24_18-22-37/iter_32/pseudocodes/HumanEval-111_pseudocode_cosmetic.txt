```
FUNCTION histogram(test_string)
    DEFINE freq_map AS empty dictionary
    DEFINE letters_array AS SPLIT test_string INTO array BY delimiter ' '
    DEFINE max_freq_value AS 0
    DEFINE idx AS 0

    WHILE idx < LENGTH OF letters_array
        DEFINE current_letter AS letters_array AT idx
        DEFINE freq_count AS 0
        DEFINE inner_idx AS 0
        WHILE inner_idx < LENGTH OF letters_array
            IF letters_array AT inner_idx EQUALS current_letter THEN
                SET freq_count TO freq_count + 1
            END IF
            SET inner_idx TO inner_idx + 1
        END WHILE

        IF (freq_count > max_freq_value) AND NOT (current_letter EQUALS '')
            SET max_freq_value TO freq_count
        END IF

        SET idx TO idx + 1
    END WHILE

    IF max_freq_value <= 0 THEN
        RETURN freq_map
    END IF

    DEFINE j AS 0
    WHILE j < LENGTH OF letters_array
        DEFINE letter_to_check AS letters_array AT j
        DEFINE count_for_letter AS 0

        FOR k FROM 0 TO LENGTH OF letters_array - 1
            IF letters_array AT k EQUALS letter_to_check THEN
                SET count_for_letter TO count_for_letter + 1
            END IF
        END FOR

        IF count_for_letter EQUALS max_freq_value THEN
            SET freq_map[letter_to_check] TO max_freq_value
        END IF

        SET j TO j + 1
    END WHILE

    RETURN freq_map
END FUNCTION
```