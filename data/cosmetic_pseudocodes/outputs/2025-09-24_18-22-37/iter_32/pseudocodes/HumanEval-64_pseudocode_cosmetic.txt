```
FUNCTION vowels_count(text_param)
    SET vowel_letters TO "aeiouAEIOU"
    SET tally TO 0
    SET idx TO 0
    WHILE idx < LENGTH(text_param)
        SET current_char TO text_param.at(idx)
        IF current_char IN vowel_letters THEN
            SET tally TO tally + 1
        END IF
        SET idx TO idx + 1
    END WHILE
    IF text_param.at(LENGTH(text_param) - 1) = 'y' THEN
        SET tally TO tally + 1
    ELSE
        IF text_param.at(LENGTH(text_param) - 1) = 'Y' THEN
            SET tally TO tally + 1
        END IF
    END IF
    RETURN tally
END FUNCTION
```