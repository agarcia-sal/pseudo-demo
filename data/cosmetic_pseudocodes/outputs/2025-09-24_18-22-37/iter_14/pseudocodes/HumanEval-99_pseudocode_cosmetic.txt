FUNCTION closest_integer(phi)  
    IMPORT floor, ceil FROM math  

    DECLARE epsilon STRING = '.'  
    DECLARE dotCount INTEGER = 0  
    DECLARE idx INTEGER = 0  
    DECLARE trimmed STRING  
    DECLARE number FLOAT  
    DECLARE outcome INTEGER  

    idx = 0  
    WHILE idx < LENGTH(phi)  
        IF phi.at(idx) EQUALS epsilon THEN  
            dotCount = dotCount + 1  
        END IF  
        idx = idx + 1  
    END WHILE  

    IF dotCount EQUALS 1 THEN  
        DECLARE lastChar STRING  
        lastChar = phi.at(LENGTH(phi) MINUS 1)  
        WHILE lastChar EQUALS '0'  
            trimmed = ""  
            DECLARE j INTEGER = 0  
            WHILE j < LENGTH(phi) MINUS 1  
                trimmed = trimmed + phi.at(j)  
                j = j + 1  
            END WHILE  
            phi = trimmed  
            lastChar = phi.at(LENGTH(phi) MINUS 1)  
        END WHILE  
    END IF  

    number = FLOAT(phi)  

    DECLARE suffix STRING  
    IF LENGTH(phi) GREATER THAN 1 THEN  
        suffix = phi.at(LENGTH(phi) MINUS 2) + phi.at(LENGTH(phi) MINUS 1)  
    ELSE  
        suffix = ""  
    END IF  

    IF suffix EQUALS ".5" THEN  
        IF number GREATER THAN 0 THEN  
            outcome = ceil(number)  
        ELSE  
            outcome = floor(number)  
        END IF  
    ELSE   
        IF LENGTH(phi) GREATER THAN 0 THEN  
            outcome = ROUND(number)  
        ELSE  
            outcome = 0  
        END IF  
    END IF  

    RETURN outcome  
END FUNCTION