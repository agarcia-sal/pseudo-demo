FUNCTION parse_nested_parens(parentheses_string)  
    FUNCTION parse_paren_group(group_string)  
      SET tracker_depth TO 0  
      SET peak_depth TO 0  
      SET pointer_index TO 0  
      WHILE pointer_index LESS THAN LENGTH OF group_string DO  
          SET current_char TO group_string.at(pointer_index)  
          IF current_char EQUALS '(' THEN  
              SET tracker_depth TO tracker_depth PLUS 1  
              IF peak_depth LESS THAN tracker_depth THEN  
                  SET peak_depth TO tracker_depth  
              END IF  
          ELSE IF current_char EQUALS ')' THEN  
              SET tracker_depth TO tracker_depth MINUS 1  
          END IF  
          SET pointer_index TO pointer_index PLUS 1  
      END WHILE  
      RETURN peak_depth  
    END FUNCTION  

    SET fragment_list TO parentheses_string.split(' ')  
    SET results TO EMPTY LIST  
    SET iterator_position TO 0  
    WHILE iterator_position LESS THAN LENGTH OF fragment_list DO  
        SET candidate TO fragment_list[iterator_position]  
        IF candidate NOT EQUAL TO '' THEN  
            APPEND parse_paren_group(candidate) TO results  
        END IF  
        SET iterator_position TO iterator_position PLUS 1  
    END WHILE  
    RETURN results  
END FUNCTION