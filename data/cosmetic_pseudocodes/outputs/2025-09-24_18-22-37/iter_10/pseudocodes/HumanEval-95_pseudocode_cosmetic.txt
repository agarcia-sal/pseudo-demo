FUNCTION check_dict_case(widget)  
    IF widget.KEYS.LENGTH not equal to 0 THEN  
        DECLARE blender AS STRING  
        SET blender TO "start"  

        DECLARE plum AS ANY  
        FOR plum IN widget.KEYS DO  
            IF NOT (plum INSTANCEOF STRING) THEN  
                SET blender TO "mixed"  
                EXIT FOR  
            END IF  

            IF blender IS "start" THEN  
                IF plum IS ALL UPPERCASE THEN  
                    SET blender TO "upper"  
                ELSE  
                    IF plum IS ALL LOWERCASE THEN  
                        SET blender TO "lower"  
                    ELSE  
                        EXIT FOR  
                    END IF  
                END IF  
            ELSE  
                IF (blender IS "upper" ∧ NOT (plum IS ALL UPPERCASE)) OR (blender IS "lower" ∧ NOT (plum IS ALL LOWERCASE)) THEN  
                    SET blender TO "mixed"  
                    EXIT FOR  
                ELSE  
                    EXIT FOR  
                END IF  
            END IF  
        END FOR  
        RETURN (blender IS "upper") OR (blender IS "lower")  
    ELSE  
        RETURN False  
    END IF  
END FUNCTION