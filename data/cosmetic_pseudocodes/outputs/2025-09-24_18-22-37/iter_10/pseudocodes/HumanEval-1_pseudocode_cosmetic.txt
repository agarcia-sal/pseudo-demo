FUNCTION separate_paren_groups(operand_string)  
  SET accumulator_results TO empty list    
  SET buffer_string TO empty list    
  SET counter_depth_var TO 0  
  
  SET iterator_index TO 0  
  WHILE iterator_index LESS THAN length of operand_string  
    SET current_char TO operand_string.at(iterator_index)  
      
    IF NOT (current_char EQUALS ')') THEN  
      IF current_char EQUALS '(' THEN  
        SET counter_depth_var TO counter_depth_var plus 1  
        buffer_string.append(current_char)  
      END IF  
    ELSE  
      buffer_string.append(current_char)  
      SET counter_depth_var TO counter_depth_var minus 1  
      IF counter_depth_var EQUALS 0 THEN  
        SET joined_buffer TO concatenate all elements of buffer_string  
        accumulator_results.append(joined_buffer)  
        CALL buffer_string.clear()  
      END IF  
    END IF  
    SET iterator_index TO iterator_index plus 1  
  END WHILE  
  
  RETURN accumulator_results  
END FUNCTION