FUNCTION flip_case(source_text)   
    SET altered_text TO EMPTY STRING
    SET current_position TO 0    
    SET total_length TO LENGTH OF source_text
    
    WHILE current_position < total_length DO   
        SET current_char TO source_text AT current_position
        SET is_upper TO (current_char >= 'A') AND (current_char <= 'Z')
        SET is_lower TO (current_char >= 'a') AND (current_char <= 'z')
        
        IF is_upper THEN        
            SET flipped_char TO CONVERT current_char TO LOWERCASE LETTER
        ELSE IF is_lower THEN          
            SET flipped_char TO CONVERT current_char TO UPPERCASE LETTER
        ELSE          
            SET flipped_char TO current_char
        END IF
        
        SET altered_text TO altered_text CONCAT flipped_char
        SET current_position TO current_position + 0x1
    END WHILE
    
    RETURN altered_text
END FUNCTION