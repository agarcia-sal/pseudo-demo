FUNCTION hex_key(string_num)  
  DEFINE prime_digits AS ('2', '3', '5', '7', 'B', 'D')  
  SET acc_prime_count TO 0  
  SET pos TO 0  
  SET str_len TO LENGTH OF string_num  
  WHILE pos < str_len  
    SET curr_char TO string_num.at(pos)  
    SWITCH TRUE  
      CASE curr_char = prime_digits[0]:  
      CASE curr_char = prime_digits[1]:  
      CASE curr_char = prime_digits[2]:  
      CASE curr_char = prime_digits[3]:  
      CASE curr_char = prime_digits[4]:  
      CASE curr_char = prime_digits[5]:  
        SET temp_count TO acc_prime_count + 1  
        SET acc_prime_count TO temp_count  
        BREAK  
      DEFAULT:  
        /* no increment */  
    END SWITCH  
    SET pos TO pos + 1  
  END WHILE  
  RETURN acc_prime_count  
END FUNCTION