FUNCTION get_closest_vowel(token)
    IF LENGTH(token) >= 3 THEN
    ELSE
        RETURN ""
    END IF

    DECLARE vowel_set AS SET
    vowel_set := {"A", "E", "I", "O", "U", "a", "e", "i", "o", "u"}

    DECLARE pos INTEGER := LENGTH(token) - 2

    WHILE pos >= 1 DO
        IF token[pos] IN vowel_set THEN
            IF NOT (token[pos + 1] IN vowel_set) THEN
                IF NOT (token[pos - 1] IN vowel_set) THEN
                    RETURN token[pos]
                ELSE
                    pos := pos - 1
                    CONTINUE
                END IF
            ELSE
                pos := pos - 1
                CONTINUE
            END IF
        ELSE
            pos := pos - 1
        END IF
    END WHILE

    RETURN ""
END FUNCTION