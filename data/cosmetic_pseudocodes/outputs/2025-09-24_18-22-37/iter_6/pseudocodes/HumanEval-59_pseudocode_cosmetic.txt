FUNCTION largest_prime_factor(p)
    FUNCTION is_prime(q)
        IF q < 2 THEN
            RETURN False
        END IF
        
        SET u TO 2
        WHILE u <= q - 1
            IF (q MOD u) = 0 THEN
                RETURN False
            END IF
            SET u TO u + 1
        END WHILE
        
        RETURN True
    END FUNCTION

    SET r TO 1
    SET v TO 2
    WHILE v <= p
        IF (p MOD v) <> 0 THEN
            SET v TO v + 1
            CONTINUE
        ELSE
            IF is_prime(v) = True THEN
                IF r < v THEN
                    SET r TO v
                END IF
            END IF
        END IF
        SET v TO v + 1
    END WHILE

    RETURN r
END FUNCTION