FUNCTION closest_integer(parameter1)
    IMPORT floor, ceil FROM math

    SET count_dots TO 0
    SET index_tracker TO 0
    WHILE index_tracker < LENGTH(parameter1)
        IF parameter1[index_tracker] == '.'
            count_dots := count_dots + 1
        END IF
        index_tracker := index_tracker + 1
    END WHILE

    IF count_dots == 1
        SET idx_last TO LENGTH(parameter1) - 1
        WHILE idx_last >= 0 AND parameter1[idx_last] == '0'
            parameter1 := SUBSTRING(parameter1, 0, idx_last)
            idx_last := idx_last - 1
        END WHILE
    END IF

    SET floating_value TO 0.0
    SET i_temp TO 0
    SET temp_chars TO parameter1
    SET floating_value := FLOAT(temp_chars)

    SET tail_two TO ""
    IF LENGTH(parameter1) >= 2
        tail_two := CONCAT(parameter1[LENGTH(parameter1) - 2], parameter1[LENGTH(parameter1) - 1])
    END IF

    IF tail_two == '.5'
        IF floating_value > 0.0
            RETURN ceil(floating_value)
        ELSE
            RETURN floor(floating_value)
        END IF
    ELSE
        IF LENGTH(parameter1) > 0
            RETURN ROUND(floating_value)
        ELSE
            RETURN 0
        END IF
    END IF
END FUNCTION