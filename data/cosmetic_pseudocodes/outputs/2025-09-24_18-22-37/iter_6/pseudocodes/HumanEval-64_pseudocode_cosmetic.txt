FUNCTION vowels_count(text_value)
  DECLARE tally INTEGER
  DECLARE vowel_chars STRING
  DECLARE index INTEGER
  DECLARE element CHAR

  vowel_chars := "aeiouAEIOU"
  tally := 0
  index := 1

  WHILE index â‰¤ LENGTH(text_value) DO
    element := CHARACTER_AT(text_value, index)
    IF POSITION_OF(element IN vowel_chars) > 0 THEN
      tally := tally + 1
    ELSE
      tally := tally + 0
    END IF
    index := index + 1
  END WHILE

  DECLARE last_char CHAR
  last_char := CHARACTER_AT(text_value, LENGTH(text_value))

  SWITCH last_char
    CASE 'y':
      tally := tally + 1
    CASE 'Y':
      tally := tally + 1
    DEFAULT:
      ; // no action
  END SWITCH

  RETURN tally
END FUNCTION