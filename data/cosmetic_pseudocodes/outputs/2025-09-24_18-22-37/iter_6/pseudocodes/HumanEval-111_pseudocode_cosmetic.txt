FUNCTION histogram(test_string_param)
    frequency_map := dictionary()
    letters_array := SPLIT test_string_param BY " "
    peak_frequency := 0
    index_var := 0

    WHILE index_var < LENGTH(letters_array)
        current_letter := letters_array[index_var]
        IF current_letter IS ""
            index_var := index_var + 1
            CONTINUE
        END IF
        current_count := 0
        j := 0
        WHILE j < LENGTH(letters_array)
            IF letters_array[j] = current_letter
                current_count := current_count + 1
            END IF
            j := j + 1
        END WHILE

        IF current_count > peak_frequency
            peak_frequency := current_count
        END IF
        index_var := index_var + 1
    END WHILE

    IF peak_frequency <= 0
        RETURN frequency_map
    END IF

    index_var := 0
    WHILE index_var < LENGTH(letters_array)
        current_letter := letters_array[index_var]
        current_count := 0
        k := 0
        WHILE k < LENGTH(letters_array)
            IF letters_array[k] = current_letter
                current_count := current_count + 1
            END IF
            k := k + 1
        END WHILE

        SWITCH current_count = peak_frequency
            CASE TRUE:
                frequency_map[current_letter] := peak_frequency
            CASE FALSE:
                ; // no operation
        END SWITCH
        index_var := index_var + 1
    END WHILE

    RETURN frequency_map
END FUNCTION