FUNCTION vowels_count(str_param)
    SET vowel_chars TO "aeiouAEIOU"
    SET vowel_tally TO 0
    SET idx TO 0
    WHILE idx < LENGTH(str_param)
        SET current_ch TO str_param.at(idx)
        IF current_ch IN vowel_chars
            SET vowel_tally TO vowel_tally + 1
        END IF
        SET idx TO idx + 1
    END WHILE

    SET last_idx TO LENGTH(str_param) - 1
    SET last_ch TO str_param.at(last_idx)
    SWITCH TRUE
        CASE last_ch == 'y' âˆ¨ last_ch == 'Y'
            SET vowel_tally TO vowel_tally + 1
            BREAK
        DEFAULT
            BREAK
    END SWITCH

    RETURN vowel_tally
END FUNCTION