```
FUNCTION flip_case(str_input)
    VAR index_counter = 0
    VAR str_length = 0
    VAR output_buffer = EMPTY STRING
    str_length = LENGTH OF str_input

    WHILE index_counter < str_length
        VAR current_char = str_input AT index_counter
        SWITCH TRUE
            CASE current_char >= 'a' AND current_char <= 'z':
                VAR upper_char = current_char MINUS ('a' MINUS 'A')
                output_buffer = output_buffer + upper_char
                BREAK
            CASE current_char >= 'A' AND current_char <= 'Z':
                VAR lower_char = current_char PLUS ('a' MINUS 'A')
                output_buffer = output_buffer + lower_char
                BREAK
            DEFAULT:
                output_buffer = output_buffer + current_char
                BREAK
        END SWITCH
        index_counter = index_counter + 1
    END WHILE

    RETURN output_buffer
END FUNCTION
```