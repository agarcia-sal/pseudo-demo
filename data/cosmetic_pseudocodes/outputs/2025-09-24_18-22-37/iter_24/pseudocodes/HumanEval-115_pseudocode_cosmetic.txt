```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    sum_result ← 0
    outer_index ← 0
    total_rows ← LENGTH OF grid
    WHILE outer_index < total_rows DO
        inner_sum ← 0
        inner_index ← 0
        current_row ← grid.at(outer_index)
        row_length ← LENGTH OF current_row
        WHILE inner_index < row_length DO
            inner_sum ← inner_sum + current_row.at(inner_index)
            inner_index ← inner_index + 1
        END WHILE
        temp_ceil ← math.ceiling(inner_sum / capacity)
        sum_result ← sum_result + temp_ceil
        outer_index ← outer_index + 1
    END WHILE
    result_value ← sum_result
    RETURN result_value
END FUNCTION
```