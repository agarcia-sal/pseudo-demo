```
FUNCTION closest_integer(value)
    IMPORT floor, ceil FROM math

    VARIABLE first_flag = FALSE
    VARIABLE second_flag = FALSE
    VARIABLE temp_num = 0.0
    VARIABLE temp_result = 0
    VARIABLE idx = 0
    VARIABLE last_char = ''
    VARIABLE last_two_chars = ''
    VARIABLE len_value = 0
    VARIABLE dot_count = 0
    VARIABLE new_value = value

    dot_count = 0
    idx = 0
    WHILE idx < LENGTH(new_value)
        IF new_value.at(idx) == '.'
            dot_count = dot_count + 1
        END IF
        idx = idx + 1
    END WHILE

    first_flag = (dot_count == 1)

    IF first_flag
        last_char = ''
        WHILE TRUE
            len_value = LENGTH(new_value)
            IF len_value == 0
                BREAK
            END IF
            last_char = new_value.at(len_value - 1)
            IF last_char == '0'
                new_value = SUBSTRING(new_value, 0, len_value - 1)
            ELSE
                BREAK
            END IF
        END WHILE
    END IF

    temp_num = CAST(new_value, FLOAT)

    len_value = LENGTH(new_value)
    IF len_value >= 2
        last_two_chars = new_value.at(len_value - 2) + new_value.at(len_value - 1)
    ELSE
        last_two_chars = ''
    END IF

    second_flag = (last_two_chars == '.5')

    SWITCH second_flag
        CASE TRUE:
            IF temp_num > 0
                temp_result = ceil(temp_num)
            ELSE
                temp_result = floor(temp_num)
            END IF
        CASE FALSE:
            IF len_value > 0
                temp_result = ROUND(temp_num)
            ELSE
                temp_result = 0
            END IF
    END SWITCH

    RETURN temp_result
END FUNCTION
```