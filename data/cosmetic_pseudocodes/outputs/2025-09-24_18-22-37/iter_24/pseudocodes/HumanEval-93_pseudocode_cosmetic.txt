```
FUNCTION encode(text)
    SET vowelCollection TO "aeiouAEIOU"
    SET shiftedMapping TO EMPTY DICTIONARY
    SET posIndex TO 0

    WHILE posIndex < LENGTH(vowelCollection) DO
        SET currentChar TO vowelCollection.at(posIndex)
        SET asciiValue TO ASCII_VALUE(currentChar)
        SET incrementedValue TO asciiValue + 2
        SET mappedChar TO CHARACTER_FROM_ASCII(incrementedValue)
        SET shiftedMapping[currentChar] TO mappedChar
        SET posIndex TO posIndex + 1
    END WHILE

    SET transformedText TO EMPTY STRING
    SET idx TO 0
    WHILE idx < LENGTH(text) DO
        SET letter TO text.at(idx)
        SET flippedLetter TO IF letter IS LOWERCASE THEN TO_UPPERCASE(letter) ELSE TO_LOWERCASE(letter)
        SET transformedText TO transformedText + flippedLetter
        SET idx TO idx + 1
    END WHILE

    SET outputString TO EMPTY STRING
    SET i TO 0

    WHILE i < LENGTH(transformedText) DO
        SET currentChar TO transformedText.at(i)
        IF (currentChar IN vowelCollection) THEN
            SET replacementChar TO shiftedMapping[currentChar]
            SET outputString TO outputString + replacementChar
        ELSE
            SET outputString TO outputString + currentChar
        END IF
        SET i TO i + 1
    END WHILE

    RETURN outputString
END FUNCTION
```