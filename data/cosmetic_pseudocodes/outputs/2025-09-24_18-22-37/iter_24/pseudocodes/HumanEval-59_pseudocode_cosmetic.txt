```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        SET flag_prime TO True
        IF k < 2 THEN
            SET flag_prime TO False
        ELSE
            SET idx TO 2
            WHILE idx < k AND flag_prime = True
                SET remainder TO k MODULO idx
                SWITCH remainder
                    CASE 0:
                        SET flag_prime TO False
                        BREAK
                    DEFAULT:
                        idx ← idx + 1
                END SWITCH
            END WHILE
        END IF
        RETURN flag_prime
    END FUNCTION

    SET max_prime TO 1
    SET candidate TO 2
    WHILE candidate <= n
        SET divides_evenly TO (n MODULO candidate EQUALS 0)
        SET candidate_is_prime TO is_prime(candidate)
        IF divides_evenly ∧ candidate_is_prime THEN
            SET max_prime TO max_prime
            SET temp_max TO candidate
            IF max_prime < temp_max THEN
                SET max_prime TO temp_max
            END IF
        END IF
        candidate ← candidate + 1
    END WHILE
    RETURN max_prime
END FUNCTION
```