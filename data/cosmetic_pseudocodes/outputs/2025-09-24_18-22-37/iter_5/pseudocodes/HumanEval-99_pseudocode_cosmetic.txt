FUNCTION closest_integer(input_str)
    IMPORT floor, ceil FROM math

    SET dot_count TO 0
    SET idx TO 1
    WHILE idx <= LENGTH(input_str)
        IF input_str[idx] = '.'
            dot_count = dot_count + 1
        END IF
        idx = idx + 1
    END WHILE

    IF dot_count = 1 THEN
        SET str_len TO LENGTH(input_str)
        WHILE str_len > 0 AND input_str[str_len] = '0'
            input_str = SUBSTRING(input_str, 1, str_len - 1)
            str_len = str_len - 1
        END WHILE
    END IF

    SET numeric_value TO FLOAT(input_str)

    IF LENGTH(input_str) >= 2 THEN
        IF SUBSTRING(input_str, LENGTH(input_str) - 1, LENGTH(input_str)) = '.5' THEN
            IF numeric_value > 0 THEN
                RETURN ceil(numeric_value)
            ELSE
                RETURN floor(numeric_value)
            END IF
        END IF
    END IF

    IF LENGTH(input_str) > 0 THEN
        SET rounded_num TO ROUND(numeric_value)
        RETURN rounded_num
    ELSE
        RETURN 0
    END IF
END FUNCTION