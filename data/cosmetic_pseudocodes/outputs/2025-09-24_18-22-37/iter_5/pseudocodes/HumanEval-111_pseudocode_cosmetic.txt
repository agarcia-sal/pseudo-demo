FUNCTION histogram(test_string)
    INITIALIZE freq_map AS new empty dictionary
    ASSIGN words_array := SPLIT test_string BY " "
    INITIALIZE max_freq TO 0
    SET idx := 0
    WHILE idx < LENGTH(words_array)
        ASSIGN current_word := words_array[idx]
        ASSIGN word_count := 0
        SET count_idx := 0
        WHILE count_idx < LENGTH(words_array)
            IF words_array[count_idx] == current_word THEN
                INCREMENT word_count BY 1
            END IF
            INCREMENT count_idx BY 1
        END WHILE
        IF current_word != "" THEN
            IF word_count > max_freq THEN
                max_freq := word_count
            END IF
        END IF
        INCREMENT idx BY 1
    END WHILE

    IF max_freq <= 0 THEN
        RETURN freq_map
    END IF

    SET i := 0
    REPEAT WHILE i < LENGTH(words_array)
        ASSIGN candidate := words_array[i]
        ASSIGN candidate_count := 0
        SET j := 0
        WHILE j < LENGTH(words_array)
            IF words_array[j] == candidate THEN
                candidate_count := candidate_count + 1
            END IF
            j := j + 1
        END WHILE
        IF candidate_count == max_freq THEN
            freq_map[candidate] := max_freq
        END IF
        i := i + 1
    END REPEAT

    RETURN freq_map
END FUNCTION