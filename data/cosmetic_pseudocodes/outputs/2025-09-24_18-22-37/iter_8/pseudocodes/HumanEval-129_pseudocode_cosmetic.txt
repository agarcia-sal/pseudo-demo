FUNCTION minPath(grid, p)
   SET q TO LENGTH OF grid
   SET r TO q TIMES q PLUS 1
   SET s TO 0
   WHILE s LESS THAN q
     SET t TO 0
     WHILE t LESS THAN q
       SWITCH grid.at(s).at(t)
         CASE 1:
           SET u TO EMPTY LIST
           IF s GREATER THAN 0 THEN
             APPEND grid.at(s MINUS 1).at(t) TO u
           END IF
           IF t GREATER THAN 0 THEN
             APPEND grid.at(s).at(t MINUS 1) TO u
           END IF
           IF s LESS THAN q MINUS 1 THEN
             APPEND grid.at(s PLUS 1).at(t) TO u
           END IF
           IF t LESS THAN q MINUS 1 THEN
             APPEND grid.at(s).at(t PLUS 1) TO u
           END IF
           SET v TO u.at(0)
           SET w TO 1
           WHILE w LESS THAN LENGTH OF u
             IF u.at(w) LESS THAN v THEN
               SET v TO u.at(w)
             END IF
             INCREMENT w BY 1
           END WHILE
           SET r TO v
         DEFAULT:
           BREAK
       END SWITCH
       INCREMENT t BY 1
     END WHILE
     INCREMENT s BY 1
   END WHILE
   SET x TO EMPTY LIST
   SET y TO 0
   WHILE y LESS THAN p
     SET z TO y MODULO 2
     SWITCH z
       CASE 0:
         APPEND 1 TO x
       CASE 1:
         APPEND r TO x
     END SWITCH
     INCREMENT y BY 1
   END WHILE
   RETURN x
END FUNCTION