```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        IF k <= 1 THEN
            RETURN False
        END IF
        SET divisor TO 2
        WHILE divisor < k DO
            IF (k % divisor) == 0 THEN
                RETURN False
            END IF
            divisor = divisor + 1
        END WHILE
        RETURN True
    END FUNCTION

    DECLARE max_prime AS INTEGER = 1
    FOR candidate IN RANGE(2, n + 1)
        IF (n MOD candidate) == 0 THEN
            IF is_prime(candidate) THEN
                IF candidate > max_prime THEN
                    max_prime = candidate
                END IF
            END IF
        END IF
    END FOR
    RETURN max_prime
END FUNCTION
```