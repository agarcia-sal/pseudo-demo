```
FUNCTION encode(inputText)
    DECLARE vowelsStr AS "aeiouAEIOU"
    INITIALIZE substitutionMap AS EMPTY MAP
    FOR EACH ch IN vowelsStr DO
        LET shiftedChar = CHAR(ASCII_CODE(ch) + 2)
        INSERT (ch, shiftedChar) INTO substitutionMap
    END FOR
    
    LET toggledText = EMPTY STRING
    FOR EACH c IN inputText DO
        IF c IS UPPERCASE THEN
            toggledText = toggledText + TO_LOWERCASE(c)
        ELSE IF c IS LOWERCASE THEN
            toggledText = toggledText + TO_UPPERCASE(c)
        ELSE
            toggledText = toggledText + c
        END IF
    END FOR

    DECLARE resultText = EMPTY STRING
    FOR EACH char IN toggledText DO
        IF substitutionMap CONTAINS KEY char THEN
            resultText = resultText + substitutionMap[char]
        ELSE
            resultText = resultText + char
        END IF
    END FOR

    RETURN resultText
END FUNCTION
```