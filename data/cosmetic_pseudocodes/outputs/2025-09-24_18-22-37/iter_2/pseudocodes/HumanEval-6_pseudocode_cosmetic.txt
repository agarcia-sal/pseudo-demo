```
FUNCTION parse_nested_parens(str_of_parens)
    FUNCTION parse_paren_group(subgroup)
        depth_current ← 0
        depth_max ← 0
        idx ← 0
        WHILE idx < LENGTH(subgroup) DO
            char ← subgroup[idx]
            IF char = '(' THEN
                depth_current ← depth_current + 1
                IF depth_current > depth_max THEN
                    depth_max ← depth_current
                END IF
            ELSE
                depth_current ← depth_current - 1
            END IF
            idx ← idx + 1
        END WHILE
        RETURN depth_max
    END FUNCTION

    segments ← []
    word ← ""
    FOR i FROM 0 TO LENGTH(str_of_parens) - 1 DO
        IF str_of_parens[i] = ' ' THEN
            IF word ≠ "" THEN
                APPEND word TO segments
                word ← ""
            END IF
        ELSE
            word ← word + str_of_parens[i]
        END IF
    END FOR
    IF word ≠ "" THEN
        APPEND word TO segments
    END IF

    results ← []
    FOR EACH element IN segments DO
        APPEND parse_paren_group(element) TO results
    END FOR

    RETURN results
END FUNCTION
```