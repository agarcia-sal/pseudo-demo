FUNCTION search(array_of_numbers)
    SET counts TO empty list
    SET maximum TO 0

    FOR each element IN array_of_numbers
        IF element GREATER THAN maximum
            SET maximum TO element
    SET length_of_counts TO maximum + 1
    FOR counter FROM 0 TO length_of_counts - 1
        APPEND 0 TO counts

    SET idx TO 0
    WHILE idx LESS THAN LENGTH OF array_of_numbers
        SET num TO array_of_numbers AT idx
        SET current_count TO counts AT num
        SET counts AT num TO current_count + 1
        SET idx TO idx + 1

    SET result_value TO -1
    SET position TO 1
    WHILE position LESS THAN LENGTH OF counts
        SET count_at_pos TO counts AT position
        IF NOT (count_at_pos < position)
            SET result_value TO position
        SET position TO position + 1

    RETURN result_value
END FUNCTION