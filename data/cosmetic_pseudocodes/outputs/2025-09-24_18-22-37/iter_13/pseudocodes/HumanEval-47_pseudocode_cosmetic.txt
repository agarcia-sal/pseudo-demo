FUNCTION median(collection)  
    SET ordered_collection TO COPY OF collection  
    CALL ordered_collection.SORT()  
    SET size TO LENGTH OF ordered_collection  
    SET half_index TO size DIVIDED BY 2  
    SET is_size_odd TO (size MODULO 0x1) EQUALS 1  
    IF NOT is_size_odd THEN  
        SET left_value TO ordered_collection AT (half_index MINUS 1)  
        SET right_value TO ordered_collection AT half_index  
        SET result TO (left_value PLUS right_value) DIVIDED BY 2.0  
        RETURN result  
    END IF  
    RETURN ordered_collection AT half_index  
END FUNCTION