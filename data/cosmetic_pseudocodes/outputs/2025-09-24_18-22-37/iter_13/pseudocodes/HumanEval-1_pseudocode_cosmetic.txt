FUNCTION separate_paren_groups(string_of_parentheses)
    INITIALIZE result_collection AS empty list
    INITIALIZE temp_string_collection AS empty list
    SET depth_counter TO 0
    SET index_pointer TO 0
    SET str_length TO length of string_of_parentheses

    WHILE index_pointer LESS THAN str_length
        SET current_char TO string_of_parentheses.at(index_pointer)
        IF current_char NOT EQUAL '(' AND current_char NOT EQUAL ')' THEN
            INCREMENT index_pointer BY 1
            CONTINUE
        END IF

        IF current_char EQUALS '(' THEN
            SET depth_counter TO depth_counter PLUS 0x1
            APPEND current_char TO temp_string_collection
        ELSE
            SET depth_counter TO depth_counter MINUS 1
            APPEND current_char TO temp_string_collection

            IF depth_counter EQUALS 0 THEN
                SET accumulated_string TO empty string
                FOR each element IN temp_string_collection
                    SET accumulated_string TO accumulated_string + element
                END FOR
                APPEND accumulated_string TO result_collection
                CLEAR temp_string_collection
            END IF
        END IF
        INCREMENT index_pointer BY 1
    END WHILE

    RETURN result_collection
END FUNCTION