FUNCTION vowels_count(input_string)  
    SET vowel_characters TO "AEIOUaeiou"  
    SET count_vowels TO 0  
    SET position TO 0  
    WHILE position LESS THAN LENGTH(input_string) DO  
        SET current_char TO input_string.at(position)  
        IF vowel_characters.CONTAINS(current_char) EQUAL TO true THEN  
            SET count_vowels TO count_vowels PLUS 1  
        END IF  
        SET position TO position PLUS 1  
    END WHILE  
    IF input_string.at(LENGTH(input_string) MINUS 1) EQUALS 'y' OR input_string.at(LENGTH(input_string) MINUS 1) EQUALS 'Y' THEN  
        SET count_vowels TO count_vowels PLUS 1  
    END IF  
    RETURN count_vowels  
END FUNCTION