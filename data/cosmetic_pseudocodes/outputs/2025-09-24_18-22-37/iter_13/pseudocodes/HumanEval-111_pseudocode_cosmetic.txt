FUNCTION histogram(test_string)
    SET freq_map TO dictionary with no entries
    SET letters_array TO test_string SPLIT BY " "
    SET max_freq TO 0
    SET idx TO 0

    WHILE idx LESS THAN LENGTH OF letters_array
        SET current_letter TO letters_array.at(idx)
        IF current_letter NOT EQUAL TO ""
            SET count_current TO 0
            SET inner_idx TO 0
            REPEAT
                IF letters_array.at(inner_idx) EQUALS current_letter
                    SET count_current TO count_current PLUS 1
                SET inner_idx TO inner_idx PLUS 1
            UNTIL inner_idx GREATER OR EQUAL TO LENGTH OF letters_array
            IF count_current GREATER THAN max_freq
                SET max_freq TO count_current
        SET idx TO idx PLUS 1

    IF max_freq GREATER THAN 0
        SET j TO 0
        REPEAT
            SET candidate TO letters_array.at(j)
            IF candidate NOT EQUAL TO ""
                SET occurences TO 0
                SET k TO 0
                REPEAT
                    IF letters_array.at(k) EQUALS candidate
                        SET occurences TO occurences PLUS 1
                    SET k TO k PLUS 1
                UNTIL k GREATER OR EQUAL TO LENGTH OF letters_array
                IF occurences EQUALS max_freq
                    SET freq_map[candidate] TO max_freq
            SET j TO j PLUS 1
        UNTIL j GREATER OR EQUAL TO LENGTH OF letters_array

    RETURN freq_map
END FUNCTION