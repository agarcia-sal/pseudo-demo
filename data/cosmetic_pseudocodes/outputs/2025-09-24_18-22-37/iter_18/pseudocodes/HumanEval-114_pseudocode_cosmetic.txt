```
FUNCTION minSubArraySum(flag_collection) 
    SET accXx TO 0
    SET iterQk TO 0
    REPEAT
        FOR each element_x IN flag_collection DO
            SET iterQk TO iterQk + (-1) * element_x
            IF iterQk < 0 THEN
                SET iterQk TO 0
            END IF
            IF accXx < iterQk THEN
                SET accXx TO iterQk
            END IF
        END FOR
        BREAK
    UNTIL FALSE
    IF accXx == 0 THEN
        SET maxNegValue TO -flag_collection.at(0)
        FOR idxZ FROM 1 TO SIZE(flag_collection) - 1 DO
            SET candidate TO -flag_collection.at(idxZ)
            IF candidate > maxNegValue THEN
                SET maxNegValue TO candidate
            END IF
        END FOR
        SET accXx TO maxNegValue
    END IF
    SET resultM TO (-1) * accXx
    RETURN resultM
END FUNCTION
```