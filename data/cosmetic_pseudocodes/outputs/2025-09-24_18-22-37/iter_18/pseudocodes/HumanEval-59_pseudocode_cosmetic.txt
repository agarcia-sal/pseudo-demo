```
FUNCTION largest_prime_factor(m)
    FUNCTION is_prime(q)
        IF NOT (q >= 2) THEN
            RETURN False
        END IF

        SET r TO 2
        WHILE r < q DO
            IF (q mod r) = 0 THEN
                RETURN False
            END IF
            SET r TO r + 1
        END WHILE

        RETURN True
    END FUNCTION

    SET z TO 1
    REPEAT
        FOR u FROM 2 TO m DO
            IF ((m mod u) = 0) THEN
                IF is_prime(u) THEN
                    IF z < u THEN
                        SET z TO u
                    END IF
                END IF
            END IF
        END FOR
        BREAK
    UNTIL False

    RETURN z
END FUNCTION
```