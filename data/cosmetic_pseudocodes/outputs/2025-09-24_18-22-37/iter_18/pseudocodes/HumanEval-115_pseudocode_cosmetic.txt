```
FUNCTION max_fill(grid, capacity)
    IMPORT math
    LET accumulation_result BE 0
    LET iterator_index BE 0
    WHILE iterator_index < LENGTH(grid) DO
        LET current_row_sum BE 0
        LET element_counter BE 0
        REPEAT
            IF element_counter >= LENGTH(grid.at(iterator_index)) THEN
                EXIT REPEAT
            END IF
            SET current_element TO grid.at(iterator_index).at(element_counter)
            SET current_row_sum TO current_row_sum + current_element
            SET element_counter TO element_counter + 1
        UNTIL FALSE
        LET intermediate_value BE current_row_sum / capacity
        LET ceil_value BE math ceiling of intermediate_value
        SET accumulation_result TO accumulation_result + ceil_value
        SET iterator_index TO iterator_index + 1
    END WHILE
    RETURN accumulation_result
END FUNCTION
```