FUNCTION separate_paren_groups(string_of_parentheses)
    SET collector_results TO empty list
    SET buffer_chars TO empty list
    SET depth_counter TO 0
    SET index_iter TO 0
    SET length_input TO LENGTH(string_of_parentheses)

    WHILE index_iter < length_input
        SET current_char TO string_of_parentheses.at(index_iter)

        SWITCH current_char
            CASE '(':
                SET depth_counter TO depth_counter + 1
                APPEND current_char TO buffer_chars
                BREAK

            CASE ')':
                SET depth_counter TO depth_counter - 1
                APPEND current_char TO buffer_chars

                IF depth_counter EQUAL TO 0 THEN
                    SET group_string TO ''
                    SET pos TO 0
                    WHILE pos < LENGTH(buffer_chars)
                        SET group_string TO group_string + buffer_chars.at(pos)
                        SET pos TO pos + 1
                    END WHILE

                    APPEND group_string TO collector_results
                    CLEAR buffer_chars
                END IF
                BREAK

            DEFAULT:
                BREAK
        END SWITCH

        SET index_iter TO index_iter + 1
    END WHILE

    RETURN collector_results
END FUNCTION