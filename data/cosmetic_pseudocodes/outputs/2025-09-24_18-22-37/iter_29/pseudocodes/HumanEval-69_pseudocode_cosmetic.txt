```
FUNCTION search(p_array)
    SET p_maximum TO 0
    SET q_len TO LENGTH p_array
    SET q_cursor TO 0
    WHILE q_cursor < q_len
        SET s_val TO p_array.at(q_cursor)
        IF s_val > p_maximum THEN
            SET p_maximum TO s_val
        END IF
        SET q_cursor TO q_cursor + 1
    END WHILE

    SET r_counts TO new list of zeros having size p_maximum + 1
    SET u_pos TO 0
    WHILE u_pos < q_len
        SET v_current TO p_array[u_pos]
        SET r_counts.at(v_current) TO r_counts.at(v_current) + 1
        SET u_pos TO u_pos + 1
    END WHILE

    SET w_answer TO -1
    SET x_index TO 1
    WHILE x_index <= LENGTH r_counts - 1
        SET y_freq TO r_counts[x_index]
        IF y_freq >= x_index THEN
            SET w_answer TO x_index
        END IF
        SET x_index TO x_index + 1
    END WHILE
    RETURN w_answer
END FUNCTION
```