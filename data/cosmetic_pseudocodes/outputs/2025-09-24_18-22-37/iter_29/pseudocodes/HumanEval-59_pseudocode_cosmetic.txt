```
FUNCTION largest_prime_factor(x)
    FUNCTION is_prime(y)
        SWITCH
            CASE y < 2:
                RETURN False
        END SWITCH

        SET m TO 2
        WHILE m < y
            IF (y MODULO m) = 0 THEN
                RETURN False
            END IF
            SET m TO m + 1
        END WHILE

        RETURN True
    END FUNCTION

    SET p TO 1
    SET q TO 2
    WHILE q <= x
        IF ((x MODULO q) = 0) THEN
            IF is_prime(q) THEN
                IF p < q THEN
                    SET p TO q
                END IF
            END IF
        END IF
        SET q TO q + 1
    END WHILE

    RETURN p
END FUNCTION
```