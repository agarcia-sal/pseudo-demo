FUNCTION minSubArraySum(array)
    SET maxSumFound TO 0
    SET currSum TO 0
    SET index TO 0
    WHILE index < LENGTH(array)
        SET currSum TO currSum + (-array[index])
        IF currSum < 0 THEN
            SET currSum TO 0
        END IF
        IF currSum > maxSumFound THEN
            SET maxSumFound TO currSum
        END IF
        SET index TO index + 1
    END WHILE
    IF maxSumFound == 0 THEN
        SET maxElem TO -array[0]
        SET pos TO 1
        WHILE pos < LENGTH(array)
            SET negVal TO -array[pos]
            IF negVal > maxElem THEN
                SET maxElem TO negVal
            END IF
            SET pos TO pos + 1
        END WHILE
        SET maxSumFound TO maxElem
    END IF
    SET result TO -maxSumFound
    RETURN result
END FUNCTION