FUNCTION histogram(test_string)
    INITIALIZE freq_map AS empty dictionary
    SET letters_array TO SPLIT test_string BY " "
    SET max_freq TO -1
    SET idx TO 0
    WHILE idx < LENGTH(letters_array)
        SET current_letter TO letters_array[idx]
        IF current_letter != ""
            SET occurrences TO 0
            SET inner_idx TO 0
            WHILE inner_idx < LENGTH(letters_array)
                IF letters_array[inner_idx] = current_letter
                    INCREMENT occurrences BY 1
                INCREMENT inner_idx BY 1
            IF occurrences > max_freq
                SET max_freq TO occurrences
        INCREMENT idx BY 1

    IF max_freq > 0
        SET j TO 0
        WHILE j < LENGTH(letters_array)
            SET candidate_letter TO letters_array[j]
            IF candidate_letter != ""
                SET count_candidate TO 0
                SET k TO 0
                WHILE k < LENGTH(letters_array)
                    IF letters_array[k] = candidate_letter
                        INCREMENT count_candidate BY 1
                    INCREMENT k BY 1
                IF count_candidate = max_freq AND candidate_letter NOT IN KEYS OF freq_map
                    SET freq_map[candidate_letter] TO max_freq
            INCREMENT j BY 1
    RETURN freq_map
END FUNCTION