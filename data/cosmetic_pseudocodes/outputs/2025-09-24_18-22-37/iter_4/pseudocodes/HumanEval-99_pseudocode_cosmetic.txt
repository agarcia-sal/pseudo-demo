FUNCTION closest_integer(value)
    IMPORT floor, ceil FROM math

    SET dotCount TO 0
    SET index TO 0
    WHILE index < LENGTH OF value
        IF value[index] == '.'
            INCREMENT dotCount BY 1
        END IF
        INCREMENT index BY 1
    END WHILE

    IF dotCount == 1
        SET trimmedValue TO value
        WHILE LENGTH OF trimmedValue > 0 AND trimmedValue[LENGTH OF trimmedValue - 1] == '0'
            SET trimmedValue TO SUBSTRING OF trimmedValue FROM 0 TO LENGTH OF trimmedValue - 1
        END WHILE
        SET value TO trimmedValue
    END IF

    SET num TO CONVERT value TO FLOAT

    IF LENGTH OF value >= 2 THEN
        IF value[LENGTH OF value - 2] == '.' AND value[LENGTH OF value - 1] == '5'
            IF num > 0
                SET result TO ceil(num)
            ELSE
                SET result TO floor(num)
            END IF
        ELSE
            SET result TO ROUND(num)
        END IF
    ELSE IF LENGTH OF value > 0
        SET result TO ROUND(num)
    ELSE
        SET result TO 0
    END IF

    RETURN result
END FUNCTION