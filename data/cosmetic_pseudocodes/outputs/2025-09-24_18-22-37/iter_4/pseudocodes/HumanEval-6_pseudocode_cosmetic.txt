FUNCTION parse_nested_parens(input_string)
    FUNCTION parse_paren_group(substring)
        SET depth_counter TO 0
        SET max_depth_reached TO 0
        SET index TO 0
        WHILE index < LENGTH(substring)
            SET symbol TO substring[index]
            SWITCH symbol
                CASE '(':
                    depth_counter = depth_counter + 1
                    IF depth_counter > max_depth_reached THEN
                        max_depth_reached = depth_counter
                    END IF
                CASE ')':
                    depth_counter = depth_counter - 1
            END SWITCH
            index = index + 1
        END WHILE
        RETURN max_depth_reached
    END FUNCTION

    SET split_groups TO []
    SET start_pos TO 0
    FOR idx FROM 0 TO LENGTH(input_string)
        IF idx == LENGTH(input_string) OR input_string[idx] == ' ' THEN
            IF start_pos < idx THEN
                APPEND SUBSTRING(input_string, start_pos, idx - 1) TO split_groups
            END IF
            start_pos = idx + 1
        END IF
    END FOR

    SET result_list TO []
    SET pos TO 0
    WHILE pos < LENGTH(split_groups)
        IF split_groups[pos] != '' THEN
            APPEND parse_paren_group(split_groups[pos]) TO result_list
        END IF
        pos = pos + 1
    END WHILE

    RETURN result_list
END FUNCTION