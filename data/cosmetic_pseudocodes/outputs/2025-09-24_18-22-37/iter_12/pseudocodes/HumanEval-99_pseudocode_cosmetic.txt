FUNCTION closest_integer(input_str)
  IMPORT floor, ceil FROM math

  DECLARE dot_count_temp = 0
  FOR char_element IN input_str
    IF char_element EQUALS '.'
      dot_count_temp = dot_count_temp + 1
    END IF
  END FOR

  IF dot_count_temp EQUALS 1
    DECLARE finished_trim = FALSE
    WHILE finished_trim IS FALSE
      DECLARE last_char = input_str.at(LENGTH(input_str) - 1)
      IF last_char EQUALS '0'
        input_str = input_str.SUBSTRING(0, LENGTH(input_str) - 1)
      ELSE 
        finished_trim = TRUE
      END IF
    END WHILE
  END IF

  DECLARE numeric_val = FLOAT(input_str)

  DECLARE len_input = LENGTH(input_str)
  DECLARE last_two_chars = ''
  IF len_input GREATER THAN 1
    last_two_chars = input_str.SUBSTRING(len_input - 2, 2)
  END IF

  DECLARE output_result
  IF last_two_chars EQUALS '.5'
    IF numeric_val GREATER THAN 0
      output_result = ceil(numeric_val)
    ELSE
      output_result = floor(numeric_val)
    END IF
  ELSE
    IF len_input GREATER THAN 0
      output_result = ROUND(numeric_val)
    ELSE
      output_result = 0
    END IF
  END IF

  RETURN output_result
END FUNCTION