FUNCTION flip_case(string_param)  
    VARIABLE result_string ASSIGN EMPTY_STRING  
    VARIABLE idx ASSIGN 0  
    WHILE idx LESS_THAN LENGTH(string_param)  
        VARIABLE current_char ASSIGN string_param.at(idx)  
        IF current_char GREATER_OR_EQUAL 'a' AND current_char LESS_OR_EQUAL 'z' THEN  
            VARIABLE uppercase_char ASSIGN CHAR_FROM_CODE(CHAR_CODE(current_char) MINUS 0x20)  
            result_string APPEND uppercase_char  
        ELSE IF current_char GREATER_OR_EQUAL 'A' AND current_char LESS_OR_EQUAL 'Z' THEN  
            VARIABLE lowercase_char ASSIGN CHAR_FROM_CODE(CHAR_CODE(current_char) PLUS 32)  
            result_string APPEND lowercase_char  
        ELSE  
            result_string APPEND current_char  
        END IF  
        idx ASSIGN idx PLUS 1  
    END WHILE  
    RETURN result_string  
END FUNCTION