FUNCTION median(elements_collection)
  SET sorted_copy TO SORT(elements_collection)
  SET size_val TO LENGTH(sorted_copy)
  SET half_idx TO size_val DIV 2
  IF (size_val MOD 2) NOT EQUAL TO 0 THEN
    RETURN sorted_copy.at(half_idx)
  ELSE
    SET left_val TO sorted_copy.at(half_idx - 1)
    SET right_val TO sorted_copy.at(half_idx)
    SET sum_vals TO left_val + right_val
    SET avg_val TO sum_vals * 0.5
    RETURN avg_val
  END IF
END FUNCTION