FUNCTION separate_paren_groups(input_sequence)
    SET accumulator TO empty list
    SET buffer TO empty list
    SET depth_counter TO 0
    SET index_counter TO 0
    SET sequence_length TO LENGTH OF input_sequence
    
    WHILE index_counter LESS THAN sequence_length
        SET current_element TO input_sequence.at(index_counter)
        
        SWITCH current_element
            CASE '('
                SET intermediate_depth TO depth_counter + 1
                SET depth_counter TO intermediate_depth
                CALL buffer.APPEND(current_element)
                BREAK
            CASE ')'
                SET intermediate_depth TO depth_counter - 1
                SET depth_counter TO intermediate_depth
                CALL buffer.APPEND(current_element)
                
                IF depth_counter EQUALS 0 THEN
                    SET combined_string TO EMPTY_STRING
                    SET temp_index TO 0
                    SET buffer_size TO LENGTH OF buffer
                    
                    WHILE temp_index LESS THAN buffer_size
                        SET combined_string TO combined_string + buffer.at(temp_index)
                        SET temp_index TO temp_index + 1
                    END WHILE
                    
                    CALL accumulator.APPEND(combined_string)
                    CALL buffer.CLEAR()
                END IF
                BREAK
            DEFAULT
                /* no action */
        END SWITCH
        
        SET index_counter TO index_counter + 1
    END WHILE
    
    RETURN accumulator
END FUNCTION