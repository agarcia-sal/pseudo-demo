FUNCTION parse_nested_parens(a_string)
  
  FUNCTION parse_paren_group(b_string)
    SET p TO 0
    SET q TO 0
    SET r TO 0
    WHILE r < LENGTH(b_string)
      SET s TO b_string.at(r)
      SWITCH s
        CASE '(':
          SET p TO p + 1
          IF p > q THEN
            SET q TO p
          END IF
          BREAK
        DEFAULT:
          SET p TO p - 1
          BREAK
      END SWITCH
      SET r TO r + 1
    END WHILE
    RETURN q
  END FUNCTION

  SET t TO SPLIT a_string BY " "
  SET u TO EMPTY LIST
  SET v TO 0
  WHILE v < LENGTH(t)
    IF t.at(v) â‰  ""
      SET w TO parse_paren_group(t.at(v))
      APPEND w TO u
    END IF
    SET v TO v + 1
  END WHILE
  RETURN u
END FUNCTION