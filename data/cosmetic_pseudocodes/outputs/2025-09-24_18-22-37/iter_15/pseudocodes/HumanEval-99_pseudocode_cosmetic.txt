FUNCTION closest_integer(theta)
    IMPORT floor, ceil FROM math

    SET dot_count TO 0
    SET idx TO 0
    WHILE idx < LENGTH OF theta
        IF theta.at(idx) == '.'
            SET dot_count TO dot_count + 1
        END IF
        SET idx TO idx + 1
    END WHILE

    IF dot_count EQUALS 1
        SET finished TO FALSE
        WHILE finished == FALSE
            SET length_var TO LENGTH OF theta
            IF length_var EQUALS 0
                SET finished TO TRUE
            ELSE
                SET last_char TO theta.at(length_var - 1)
                IF last_char EQUALS '0'
                    SET theta TO SUBSTRING OF theta FROM 0 TO length_var - 1
                ELSE
                    SET finished TO TRUE
                END IF
            END IF
        END WHILE
    END IF

    SET float_val TO FLOAT CONVERSION OF theta

    SET len_theta TO LENGTH OF theta
    SET last_two_chars TO ''
    IF len_theta >= 2
        SET last_two_chars TO theta.at(len_theta - 2) + theta.at(len_theta - 1)
    END IF

    SET final_result TO 0

    SWITCH TRUE
        CASE last_two_chars == '.5'
            IF float_val > 0
                SET temp_result TO ceil(float_val)
                SET final_result TO temp_result
            ELSE
                SET temp_result2 TO floor(float_val)
                SET final_result TO temp_result2
            END IF
            BREAK
        CASE len_theta > 0
            SET rounded_val TO INTEGER ROUND OF float_val
            SET final_result TO rounded_val
            BREAK
        DEFAULT
            SET final_result TO 0
            BREAK
    END SWITCH

    RETURN final_result
END FUNCTION