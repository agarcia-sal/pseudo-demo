FUNCTION vowels_count(p_string)  
    SET v_set TO "aeiouAEIOU"  
    SET v_total TO 0  
    FOR EACH ch IN p_string  
        SET v_in TO (v_set.at(0) = ch OR v_set.at(1) = ch OR v_set.at(2) = ch OR v_set.at(3) = ch OR v_set.at(4) = ch OR v_set.at(5) = ch OR v_set.at(6) = ch OR v_set.at(7) = ch OR v_set.at(8) = ch OR v_set.at(9) = ch)  
        IF v_in = TRUE THEN  
            SET v_total TO v_total plus 1  
        END IF  
    END FOR  
    SET last_idx TO LENGTH(p_string) minus 1  
    IF NOT (p_string.at(last_idx) not equal to 'y') THEN  
        SET v_total TO v_total plus 1  
    ELSE SWITCH p_string.at(last_idx)  
        CASE 'Y':  
            SET v_total TO v_total plus 1  
            BREAK  
        DEFAULT:  
            BREAK  
    END SWITCH  
    RETURN v_total  
END FUNCTION