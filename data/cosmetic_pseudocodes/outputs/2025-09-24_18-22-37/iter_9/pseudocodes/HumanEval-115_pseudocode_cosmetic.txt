```
FUNCTION max_fill(matrix, limit)
    IMPORT math
    DECLARE aggregateTotal AS INTEGER
    aggregateTotal ← 0
    FOR each singleArray IN matrix DO
        DECLARE rowSum AS INTEGER
        rowSum ← 0
        FOR elementIndex FROM 0 TO LENGTH of singleArray MINUS 1 DO
            rowSum ← rowSum + singleArray.at(elementIndex)
        END FOR
        DECLARE partialResult AS REAL
        partialResult ← (rowSum * 1.0) / limit
        DECLARE roundedValue AS INTEGER
        roundedValue ← math.ceil(partialResult)
        aggregateTotal ← aggregateTotal + roundedValue
    END FOR
    RETURN aggregateTotal
END FUNCTION
```