```
FUNCTION separate_paren_groups(input_parentheses)
    SET result_collection TO []
    SET accumulating_chars TO []
    SET depth_counter TO 0
    SET idx TO 0

    WHILE idx LESS THAN length.of(input_parentheses)
        SET current_char TO input_parentheses.at(idx)

        SWITCH current_char
            CASE '(':
                SET temp_depth TO depth_counter PLUS 1
                SET depth_counter TO temp_depth
                accumulating_chars.APPEND(current_char)
                BREAK

            CASE ')':
                SET temp_depth TO depth_counter MINUS 1
                SET depth_counter TO temp_depth
                accumulating_chars.APPEND(current_char)

                IF NOT (depth_counter NOT EQUAL TO 0)
                    SET concatenated_str TO ""
                    FOR each ch IN accumulating_chars
                        SET concatenated_str TO concatenated_str PLUS ch
                    END FOR
                    result_collection.APPEND(concatenated_str)
                    accumulating_chars.CLEAR()
                END IF
                BREAK
        END SWITCH

        SET idx TO idx PLUS 1
    END WHILE

    RETURN result_collection
END FUNCTION
```