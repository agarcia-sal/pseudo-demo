FUNCTION numerical_letter_grade(grades_collection)  
    SET results_collection TO list()  
    SET index_counter TO 0  
    WHILE index_counter LESS THAN grades_collection.length DO  
        SET current_mark TO grades_collection.at(index_counter)  
        SET category_label TO ""  
        SWITCH TRUE  
            CASE current_mark EQUALS 4.0:  
                SET category_label TO "A+"  
                BREAK  
            CASE current_mark GREATER THAN 3.7:  
                SET category_label TO "A"  
                BREAK  
            CASE current_mark GREATER THAN 3.3:  
                SET category_label TO "A-"  
                BREAK  
            CASE current_mark GREATER THAN 3.0:  
                SET category_label TO "B+"  
                BREAK  
            CASE current_mark GREATER THAN 2.7:  
                SET category_label TO "B"  
                BREAK  
            CASE current_mark GREATER THAN 2.3:  
                SET category_label TO "B-"  
                BREAK  
            CASE current_mark GREATER THAN 2.0:  
                SET category_label TO "C+"  
                BREAK  
            CASE current_mark GREATER THAN 1.7:  
                SET category_label TO "C"  
                BREAK  
            CASE current_mark GREATER THAN 1.3:  
                SET category_label TO "C-"  
                BREAK  
            CASE current_mark GREATER THAN 1.0:  
                SET category_label TO "D+"  
                BREAK  
            CASE current_mark GREATER THAN 0.7:  
                SET category_label TO "D"  
                BREAK  
            CASE current_mark GREATER THAN 0.0:  
                SET category_label TO "D-"  
                BREAK  
            DEFAULT:  
                SET category_label TO "E"  
                BREAK  
        END SWITCH  
        results_collection APPEND category_label  
        index_counter INCREMENT BY 1  
    END WHILE  
    RETURN results_collection  
END FUNCTION