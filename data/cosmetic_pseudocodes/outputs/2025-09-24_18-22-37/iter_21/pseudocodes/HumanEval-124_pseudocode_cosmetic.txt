FUNCTION valid_date(input_str)
    TRY
        SET trimmed_str TO input_str WITH BOTH ENDS TRIMMED
        SPLIT trimmed_str USING '-' INTO first_part, second_part, third_part
        CONVERT first_part TO INTEGER mth
        CONVERT second_part TO INTEGER dy
        CONVERT third_part TO INTEGER yr

        SWITCH TRUE
            CASE (mth < 1) OR (mth > 12):
                RETURN False
            CASE (mth = 1) OR (mth = 3) OR (mth = 5) OR (mth = 7) OR (mth = 8) OR (mth = 10) OR (mth = 12):
                IF (dy < 1) OR (dy > 31) THEN
                    RETURN False
                END IF
            CASE (mth = 4) OR (mth = 6) OR (mth = 9) OR (mth = 11):
                IF NOT ((1 <= dy) AND (dy <= 30)) THEN
                    RETURN False
                END IF
            CASE (mth = 2):
                IF (dy < 1) OR (dy > 29) THEN
                    RETURN False
                END IF
        END SWITCH

    EXCEPT EXCEPTION e
        RETURN False
    END TRY

    RETURN True
END FUNCTION