FUNCTION minPath(matrix, threshold)
  SET size TO LENGTH OF matrix
  SET minVal TO size * size + 1
  SET row TO 0
  WHILE row < size
    SET col TO 0
    REPEAT
      IF matrix.at(row).at(col) == 1 THEN
        SET neighbors TO EMPTY LIST
        IF row != 0 THEN
          APPEND matrix.at(row - 1).at(col) TO neighbors
        END IF
        IF col != 0 THEN
          APPEND matrix.at(row).at(col - 1) TO neighbors
        END IF
        IF row != size - 1 THEN
          APPEND matrix.at(row + 1).at(col) TO neighbors
        END IF
        IF col != size - 1 THEN
          APPEND matrix.at(row).at(col + 1) TO neighbors
        END IF
        SET minVal TO MINIMUM ELEMENT OF neighbors
      END IF
      SET col TO col + 1
    UNTIL col >= size
    SET row TO row + 1
  END WHILE

  SET result TO EMPTY LIST
  SET index TO 0
  REPEAT
    SWITCH (index MOD 2)
      CASE 0:
        APPEND 1 TO result
        BREAK
      CASE 1:
        APPEND minVal TO result
        BREAK
    END SWITCH
    SET index TO index + 1
  UNTIL index >= threshold

  RETURN result
END FUNCTION