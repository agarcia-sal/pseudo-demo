FUNCTION longest(collection)
    DECLARE greatest_size
    IF NOT (collection IS NOT EMPTY) THEN
        RETURN None
    END IF

    greatest_size ← 0
    FOR idx FROM 1 TO LENGTH(collection)
        DECLARE current_element ← collection.at(idx)
        DECLARE element_length ← LENGTH(current_element)
        IF element_length > greatest_size THEN
            greatest_size ← element_length
        END IF
    END FOR

    FOR each element IN collection
        DECLARE element_len ← LENGTH(element)
        CASE
            WHEN element_len = greatest_size THEN
                RETURN element
        END CASE
    END FOR
END FUNCTION