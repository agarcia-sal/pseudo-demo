```
FUNCTION search(iterator)
    SET counts TO array_of_zeros OF SIZE (maximum_element_in iterator) + 1
    SET current_element TO FIRST_ELEMENT OF iterator
    WHILE current_element IS NOT BEYOND_LAST_ELEMENT OF iterator
        LET temp_index BE current_element
        counts.at(temp_index) = counts.at(temp_index) + 1
        current_element = NEXT_ELEMENT AFTER current_element
    END WHILE

    LET result TO -1

    SET pos TO LENGTH_OF(counts) - 1
    REPEAT
        IF counts.at(pos) >= pos THEN
            result = pos
        END IF
        pos = pos - 1
    UNTIL pos < 1

    RETURN result
END FUNCTION
```