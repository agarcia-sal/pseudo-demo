FUNCTION closest_integer(input_str)
    IMPORT floor, ceil FROM math

    DECLARE decimal_count, temp_str, curr_char, number_val, rounded_val, last_two_chars, str_len

    decimal_count ← 0
    FOR idx ← 0 TO LENGTH(input_str) - 1
        IF input_str.at(idx) = '.'
            decimal_count ← decimal_count + 1
        END IF
    END FOR

    IF decimal_count = 0x1
        temp_str ← input_str
        str_len ← LENGTH(temp_str)
        curr_char ← ''
        WHILE str_len > 0
            curr_char ← temp_str.at(str_len - 1)
            IF curr_char ≠ '0'
                EXIT WHILE
            END IF
            temp_str ← SUBSTRING(temp_str, 0, str_len - 1)
            str_len ← str_len - 1
        END WHILE
        input_str ← temp_str
    END IF

    number_val ← FLOAT(input_str)

    last_two_chars ← ''
    IF LENGTH(input_str) ≥ 2
        last_two_chars ← input_str.at(LENGTH(input_str) - 2) + input_str.at(LENGTH(input_str) - 1)
    END IF

    str_len ← LENGTH(input_str)

    IF last_two_chars = '.5'
        IF number_val > 0.0
            rounded_val ← ceil(number_val)
        ELSE
            rounded_val ← floor(number_val)
        END IF
    ELSE
        IF str_len > 0
            rounded_val ← ROUND(number_val)
        ELSE
            rounded_val ← 0
        END IF
    END IF

    RETURN rounded_val
END FUNCTION