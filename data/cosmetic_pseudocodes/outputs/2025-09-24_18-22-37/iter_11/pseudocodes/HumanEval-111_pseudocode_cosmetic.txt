FUNCTION histogram(test_string)
    SET freq_map TO empty dictionary
    SET letters_array TO SPLIT test_string BY space character
    SET max_freq TO 0

    SET idx_outer TO 0
    WHILE idx_outer < LENGTH of letters_array
        SET current_letter TO letters_array.at(idx_outer)
        IF current_letter != ""
            SET freq_counter TO 0
            SET idx_inner TO 0
            WHILE idx_inner < LENGTH of letters_array
                IF letters_array.at(idx_inner) == current_letter
                    SET freq_counter TO freq_counter + 1
                SET idx_inner TO idx_inner + 1
            IF freq_counter > max_freq
                SET max_freq TO freq_counter
        SET idx_outer TO idx_outer + 1

    IF max_freq > 0
        SET idx_outer TO 0
        WHILE idx_outer < LENGTH of letters_array
            SET current_letter TO letters_array.at(idx_outer)
            SET freq_counter TO 0
            SET idx_inner TO 0
            WHILE idx_inner < LENGTH of letters_array
                IF letters_array.at(idx_inner) == current_letter
                    SET freq_counter TO freq_counter + 1
                SET idx_inner TO idx_inner + 1
            IF freq_counter == max_freq
                SET freq_map[current_letter] TO max_freq
            SET idx_outer TO idx_outer + 1

    RETURN freq_map
END FUNCTION