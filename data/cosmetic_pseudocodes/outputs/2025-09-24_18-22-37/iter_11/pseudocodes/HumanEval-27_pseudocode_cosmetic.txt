FUNCTION flip_case(original_text)  
    SET result_text TO empty string  
    SET iterator_index TO 0  
    SET text_length TO LENGTH of original_text  

    WHILE iterator_index LESS THAN text_length DO  
        SET current_char TO original_text AT iterator_index  
        SET char_code TO ASCII VALUE OF current_char  
        
        IF char_code GREATER OR EQUAL TO 65 AND char_code LESS OR EQUAL TO 90 THEN  
            SET toggled_code TO char_code PLUS 32  
            SET toggled_char TO CHARACTER REPRESENTED BY toggled_code  
            SET result_text TO CONCATENATE result_text AND toggled_char  
        
        ELSE IF char_code GREATER OR EQUAL TO 97 AND char_code LESS OR EQUAL TO 122 THEN  
            SET toggled_code TO char_code MINUS 32  
            SET toggled_char TO CHARACTER REPRESENTED BY toggled_code  
            SET result_text TO CONCATENATE result_text AND toggled_char  
        
        ELSE  
            SET result_text TO CONCATENATE result_text AND current_char  
        END IF  
        
        SET iterator_index TO iterator_index PLUS 1  
    END WHILE  

    RETURN result_text  
END FUNCTION