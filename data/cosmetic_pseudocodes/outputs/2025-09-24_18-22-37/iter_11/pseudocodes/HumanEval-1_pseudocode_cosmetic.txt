FUNCTION separate_paren_groups(string_of_parentheses)  
    SET results_collector TO empty list  
    SET partial_sequence TO empty list  
    SET depth_counter TO 0  
    SET index_counter TO 0  
    SET total_length TO length of string_of_parentheses  

    WHILE index_counter < total_length  
        SET current_char TO string_of_parentheses.at(index_counter)  

        SWITCH current_char  
            CASE '(':  
                SET temp_depth TO depth_counter + 1  
                SET depth_counter TO temp_depth  
                APPEND current_char TO partial_sequence  
                BREAK  
            CASE ')':  
                SET temp_depth TO depth_counter - 1  
                SET depth_counter TO temp_depth  
                APPEND current_char TO partial_sequence  

                IF depth_counter == 0 THEN  
                    SET concatenated_string TO empty string  
                    SET temp_index TO 0  
                    SET partial_length TO length of partial_sequence  

                    WHILE temp_index < partial_length  
                        SET concatenated_string TO concatenated_string + partial_sequence.at(temp_index)  
                        SET temp_index TO temp_index + 1  
                    END WHILE  

                    APPEND concatenated_string TO results_collector  
                    CLEAR partial_sequence  
                END IF  
                BREAK  
            DEFAULT:  
                BREAK  
        END SWITCH  

        SET index_counter TO index_counter + 1  
    END WHILE  

    RETURN results_collector  
END FUNCTION