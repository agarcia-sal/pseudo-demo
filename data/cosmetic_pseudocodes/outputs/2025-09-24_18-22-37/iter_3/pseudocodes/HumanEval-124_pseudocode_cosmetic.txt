```
FUNCTION valid_date(date_string)
    BEGIN
        CLEANED = TRIM_SPACES(date_string)
        PARTS = SPLIT_STRING(CLEANED, '-')
        DECLARE m, d, y

        IF LENGTH(PARTS) IS NOT 3 THEN
            RETURN False
        END IF

        TRY
            m = TO_INT(PARTS[0])
            d = TO_INT(PARTS[1])
            y = TO_INT(PARTS[2])
        CATCH
            RETURN False
        END TRY

        IF m < 1 THEN
            RETURN False
        ELSE IF m > 12 THEN
            RETURN False
        END IF

        IF CONTAINS([1,3,5,7,8,10,12], m) THEN
            IF d < 1 OR d > 31 THEN
                RETURN False
            END IF
        ELSE IF CONTAINS([4,6,9,11], m) THEN
            IF d < 1 OR d > 30 THEN
                RETURN False
            END IF
        ELSE IF m = 2 THEN
            IF d < 1 OR d > 29 THEN
                RETURN False
            END IF
        END IF

        RETURN True
    END
END FUNCTION
```