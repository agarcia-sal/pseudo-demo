```
FUNCTION largest_prime_factor(n)
    FUNCTION is_prime(k)
        IF NOT (k >= 2) THEN
            RETURN False
        ENDIF

        SET divisor TO 2
        WHILE divisor < k DO
            IF (k % divisor) = 0 THEN
                RETURN False
            ENDIF
            SET divisor TO divisor + 1
        ENDWHILE

        RETURN True
    END FUNCTION

    SET candidate TO 2
    SET result TO 1
    WHILE candidate <= n DO
        IF (n % candidate) = 0 THEN
            IF is_prime(candidate) THEN
                IF candidate > result THEN
                    SET result TO candidate
                ENDIF
            ENDIF
        ENDIF
        SET candidate TO candidate + 1
    ENDWHILE
    RETURN result
END FUNCTION
```