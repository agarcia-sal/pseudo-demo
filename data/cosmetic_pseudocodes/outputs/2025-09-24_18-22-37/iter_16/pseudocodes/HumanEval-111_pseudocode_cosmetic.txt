FUNCTION histogram(w_input)
  SET counts_map TO empty dictionary
  SET letters_array TO SPLIT w_input BY " "
  SET max_occurrences TO 0
  SET idx TO 0

  WHILE idx < LENGTH OF letters_array
    SET current_letter TO letters_array.at(idx)
    IF current_letter != ""
      SET current_count TO 0
      SET jdx TO 0
      WHILE jdx < LENGTH OF letters_array
        IF letters_array.at(jdx) == current_letter
          SET current_count TO current_count + 1
        END IF
        SET jdx TO jdx + 1
      END WHILE
      IF current_count > max_occurrences
        SET max_occurrences TO current_count
      END IF
    END IF
    SET idx TO idx + 1
  END WHILE

  IF max_occurrences > 0
    SET step TO 0
    WHILE step < LENGTH OF letters_array
      SET candidate TO letters_array.at(step)
      SET freq_check TO 0
      IF candidate != ""
        SET scan TO 0
        WHILE scan < LENGTH OF letters_array
          IF letters_array.at(scan) == candidate
            SET freq_check TO freq_check + 1
          END IF
          SET scan TO scan + 1
        END WHILE
        IF freq_check == max_occurrences
          SET counts_map[candidate] TO max_occurrences
        END IF
      END IF
      SET step TO step + 1
    END WHILE
  END IF

  RETURN counts_map
END FUNCTION