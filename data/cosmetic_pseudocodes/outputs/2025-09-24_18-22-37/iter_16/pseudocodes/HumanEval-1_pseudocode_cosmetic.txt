FUNCTION separate_paren_groups(input_sequence)
  SET collected_substrings TO new empty list
  SET active_chars TO new empty list
  SET depth_counter TO 0

  SET position TO 0
  WHILE position < LENGTH(input_sequence) DO
    SET current_symbol TO input_sequence.at(position)

    IF current_symbol == '(' THEN
      LET depth_counter = depth_counter + 1
      APPEND current_symbol TO active_chars

    ELSE 
      IF current_symbol == ')' THEN
        SET depth_counter TO depth_counter - 1
        APPEND current_symbol TO active_chars

        IF depth_counter == 0 THEN 
          LET composed_string TO EMPTY STRING
          FOR index_var FROM 0 TO LENGTH(active_chars) - 1 DO
            SET composed_string TO composed_string + active_chars.at(index_var)
          END FOR
          APPEND composed_string TO collected_substrings
          CLEAR active_chars
        END IF

      END IF
    END IF

    SET position TO position + 1
  END WHILE

  RETURN collected_substrings
END FUNCTION