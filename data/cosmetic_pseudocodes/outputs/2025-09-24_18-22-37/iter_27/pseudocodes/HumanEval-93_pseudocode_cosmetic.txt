FUNCTION encode(batch)
    SET sequence TO "aeiouAEIOU"
    SET modifications TO EMPTY DICTIONARY
    SET alpha TO 0
    WHILE alpha < LENGTH(sequence)
        SET current_char TO sequence.at(alpha)
        SET asc_val TO ASCII(current_char)
        SET replacement_char TO CHAR(asc_val + 2)
        modifications[current_char] = replacement_char
        SET alpha TO alpha + 1
    END WHILE

    SET transformed_batch TO EMPTY STRING
    SET idx TO 0
    WHILE idx < LENGTH(batch)
        SET ch TO batch.at(idx)
        SET is_vowel TO FALSE
        SET check_idx TO 0
        WHILE check_idx < LENGTH(sequence)
            IF ch = sequence.at(check_idx)
                SET is_vowel TO TRUE
            END IF
            SET check_idx TO check_idx + 1
        END WHILE

        IF NOT is_vowel
            SET ch TO CASE_SWAP(ch)
        ELSE
            SET ch TO CASE_SWAP(ch)
        END IF

        SET lookup_val TO IF modifications CONTAINS KEY ch THEN modifications[ch] ELSE ch
        SET transformed_batch TO CONCATENATE(transformed_batch, lookup_val)
        SET idx TO idx + 1
    END WHILE
    RETURN transformed_batch
END FUNCTION