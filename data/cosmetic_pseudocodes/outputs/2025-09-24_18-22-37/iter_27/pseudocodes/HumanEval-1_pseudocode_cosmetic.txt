FUNCTION separate_paren_groups(string_of_parentheses)  
    SET accumulator_list TO empty list  
    SET buffer_list TO empty list  
    SET depth_counter TO 0  

    SET index_iterator TO 0  
    WHILE index_iterator < LENGTH(string_of_parentheses)  
        SET current_symbol TO string_of_parentheses.at(index_iterator)  

        SWITCH  
            CASE current_symbol = '('  
                SET step_increment TO 1  
                SET depth_counter TO depth_counter + step_increment  
                APPEND current_symbol TO buffer_list  
            CASE current_symbol = ')'  
                SET step_decrement TO 1  
                SET depth_counter TO depth_counter - step_decrement  
                APPEND current_symbol TO buffer_list  

                IF NOT (depth_counter != 0)  
                    SET concatenated_string TO ""  
                    SET concat_index TO 0  
                    WHILE concat_index < LENGTH(buffer_list)  
                        SET concatenated_string TO concatenated_string + buffer_list.at(concat_index)  
                        SET concat_index TO concat_index + 1  
                    END WHILE  
                    APPEND concatenated_string TO accumulator_list  
                    SET buffer_list TO empty list  
                END IF  
            DEFAULT  
                NO OPERATION  
        END SWITCH  

        SET index_iterator TO index_iterator + 1  
    END WHILE  

    RETURN accumulator_list  
END FUNCTION