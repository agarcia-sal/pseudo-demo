```
FUNCTION vowels_count(text_param)
  SET allowed_letters TO "aeiouAEIOU"
  SET count_letters TO 0
  SET idx TO 0
  WHILE idx < LENGTH(text_param)
    SET current_char TO text_param.at(idx)
    IF current_char == allowed_letters.at(0) OR current_char == allowed_letters.at(1) OR current_char == allowed_letters.at(2) OR current_char == allowed_letters.at(3) OR current_char == allowed_letters.at(4) OR current_char == allowed_letters.at(5) OR current_char == allowed_letters.at(6) OR current_char == allowed_letters.at(7) OR current_char == allowed_letters.at(8) OR current_char == allowed_letters.at(9)
        SET count_letters TO count_letters + 1
    END IF
    SET idx TO idx + 1
  END WHILE

  SET last_idx TO LENGTH(text_param) - 1
  IF last_idx >= 0 THEN
    SET last_character TO text_param.at(last_idx)
    SWITCH last_character
      CASE 'y':
        SET count_letters TO count_letters + 1
      CASE 'Y':
        SET count_letters TO count_letters + 1
      DEFAULT:
        NO OPERATION
    END SWITCH
  END IF
  
  RETURN count_letters
END FUNCTION
```