```
FUNCTION largest_prime_factor(p)
    FUNCTION is_prime(q)
        IF q < (1+1)
            RETURN False
        END IF

        SET m TO 2
        WHILE m <= q - 1
            IF (q MODULO m) == 0
                RETURN False
            END IF
            SET m TO m + 1
        END WHILE

        RETURN True
    END FUNCTION

    SET max_factor TO 1
    SET r TO 2
    WHILE r <= p
        SET divisor_check TO p MODULO r
        IF (divisor_check EQUALS 0)
            SWITCH is_prime(r)
                CASE True:
                    IF max_factor < r
                        SET max_factor TO r
                    END IF
                CASE False:
                    ; NO-OP
            END SWITCH
        END IF
        SET r TO r + 1
    END WHILE

    RETURN max_factor
END FUNCTION
```