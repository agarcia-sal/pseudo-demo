FUNCTION separate_paren_groups(input_sequence)
    SET collected_results TO list()
    SET collector_chars TO list()
    SET depth_counter TO 0

    SET iterator_index TO 0
    WHILE iterator_index < input_sequence.length
        SET current_symbol TO input_sequence.at(iterator_index)
        SET continue_processing TO TRUE

        IF current_symbol EQUAL '(' THEN
            depth_counter ← depth_counter + 1
            APPEND current_symbol TO collector_chars
        ELSE 
            IF current_symbol EQUAL ')' THEN
                depth_counter ← depth_counter - 1
                APPEND current_symbol TO collector_chars

                SWITCH depth_counter
                    CASE 0:
                        SET joined_string TO ""
                        SET temp_idx TO 0
                        WHILE temp_idx < collector_chars.length
                            joined_string ← joined_string + collector_chars.at(temp_idx)
                            temp_idx ← temp_idx + 1
                        END WHILE
                        APPEND joined_string TO collected_results
                        SET collector_chars TO list()
                    DEFAULT:
                        NO OP
                END SWITCH
            END IF
        END IF

        iterator_index ← iterator_index + 1
    END WHILE

    RETURN collected_results
END FUNCTION