FUNCTION max_fill(tessel, quota)  
    IMPORT math  
    DECLARE aggregate_values AS LIST OF NUMBER  
    SET aggregate_values TO EMPTY LIST  
    DECLARE idx AS INTEGER  
    SET idx = 0  
    REPEAT  
        EXIT WHEN idx >= LENGTH(tessel)  
        DECLARE current_row AS LIST OF NUMBER  
        SET current_row = tessel.at(idx)  
        DECLARE total_sum AS NUMBER  
        SET total_sum = 0  
        DECLARE col_index AS INTEGER  
        SET col_index = 0  
        WHILE col_index < LENGTH(current_row) DO  
            SET total_sum = total_sum + current_row.at(col_index)  
            SET col_index = col_index + 1  
        END WHILE  
        DECLARE scaled_value AS NUMBER  
        SET scaled_value = total_sum / quota  
        DECLARE ceil_result AS NUMBER  
        SET ceil_result = math.ceiling(scaled_value)  
        APPEND ceil_result TO aggregate_values  
        SET idx = idx + 1  
    END REPEAT  
    DECLARE final_result AS NUMBER  
    SET final_result = 0  
    DECLARE sum_idx AS INTEGER  
    SET sum_idx = 0  
    WHILE sum_idx < LENGTH(aggregate_values) DO  
        SET final_result = final_result + aggregate_values.at(sum_idx)  
        SET sum_idx = sum_idx + 1  
    END WHILE  
    RETURN final_result  
END FUNCTION