```
FUNCTION max_fill(matrix, limit)
    IMPORT math
    total_result ← 0
    row_idx ← 0
    WHILE row_idx < LENGTH(matrix) DO
        current_row ← matrix.at(row_idx)
        partial_sum ← 0
        element_idx ← 0
        WHILE element_idx < LENGTH(current_row) DO
            partial_sum ← partial_sum + current_row.at(element_idx)
            element_idx ← element_idx + 1
        END WHILE
        division_result ← partial_sum / limit
        ceil_value ← math.ceiling(division_result)
        total_result ← total_result + ceil_value
        row_idx ← row_idx + 1
    END WHILE
    RETURN total_result
END FUNCTION
```