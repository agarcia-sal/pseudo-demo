```
FUNCTION max_fill(grid, d)
    IMPORT math
    LET total_fill = 0
    LET j = 0
    WHILE j < LENGTH(grid) DO
        LET current_row = grid.at(j)
        LET row_sum = 0
        LET k = 0
        WHILE k < LENGTH(current_row) DO
            row_sum = row_sum + current_row.at(k)
            k = k + 1
        END WHILE
        LET divided_val = row_sum / d
        LET ceil_val = math ceiling of divided_val
        total_fill = total_fill + ceil_val
        j = j + 1
    END WHILE
    RETURN total_fill
END FUNCTION
```