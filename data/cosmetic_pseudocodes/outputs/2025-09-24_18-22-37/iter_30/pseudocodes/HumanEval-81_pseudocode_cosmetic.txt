```
FUNCTION numerical_letter_grade(weights)
  DEFINE results ← new empty array
  DEFINE idx ← 0
  DEFINE length ← weights.length
  WHILE idx < length
      DEFINE val ← weights.at(idx)
      IF val = 4.0 THEN
          results.append("A+")
      ELSE
          IF val > 3.7 THEN
              results.append("A")
          ELSE
              IF val > 3.3 THEN
                  results.append("A-")
              ELSE
                  IF val > 3.0 THEN
                      results.append("B+")
                  ELSE
                      IF val > 2.7 THEN
                          results.append("B")
                      ELSE
                          IF val > 2.3 THEN
                              results.append("B-")
                          ELSE
                              IF val > 2.0 THEN
                                  results.append("C+")
                              ELSE
                                  IF val > 1.7 THEN
                                      results.append("C")
                                  ELSE
                                      IF val > 1.3 THEN
                                          results.append("C-")
                                      ELSE
                                          IF val > 1.0 THEN
                                              results.append("D+")
                                          ELSE
                                              IF val > 0.7 THEN
                                                  results.append("D")
                                              ELSE
                                                  IF val > 0.0 THEN
                                                      results.append("D-")
                                                  ELSE
                                                      results.append("E")
                                                  ENDIF
                                              ENDIF
                                          ENDIF
                                      ENDIF
                                  ENDIF
                              ENDIF
                          ENDIF
                      ENDIF
                  ENDIF
              ENDIF
          ENDIF
      ENDIF
      idx ← idx + 1
  ENDWHILE
  RETURN results
END FUNCTION
```