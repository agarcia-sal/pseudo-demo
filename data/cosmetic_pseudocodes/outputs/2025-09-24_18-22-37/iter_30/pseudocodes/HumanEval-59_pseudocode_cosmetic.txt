```
FUNCTION largest_prime_factor(m)
    FUNCTION is_prime(p)
        IF p < 2 THEN
            RETURN False
        END IF

        SET r TO 2
        WHILE r < p
            SET s TO p % r
            IF s = 0 THEN
                RETURN False
            END IF
            SET r TO r + 1
        END WHILE

        RETURN True
    END FUNCTION

    SET max_factor TO 1
    SET q TO 2
    WHILE q <= m
        SET rem TO m mod q
        IF (rem = 0) THEN
            IF is_prime(q) THEN
                IF q > max_factor THEN
                    SET max_factor TO q
                END IF
            END IF
        END IF
        SET q TO q + 1
    END WHILE

    RETURN max_factor
END FUNCTION
```