```
FUNCTION solve(str_data)
  DECLARE toggle_flag AS INTEGER
  SET toggle_flag = 0
  DECLARE pos_counter AS INTEGER
  SET pos_counter = 0
  DECLARE char_array AS ARRAY OF CHAR
  ASSIGN char_array = SPLIT str_data INTO CHARACTERS

  WHILE pos_counter < LENGTH OF str_data DO
	DECLARE current_char AS CHAR
	SET current_char = str_data[pos_counter]

	IF NOT (current_char < 'A' OR (current_char > 'Z' AND current_char < 'a') OR current_char > 'z') THEN
	  IF current_char >= 'a' THEN
	    ASSIGN char_array[pos_counter] = TO_UPPER(current_char)
	  OTHERWISE
	    ASSIGN char_array[pos_counter] = TO_LOWER(current_char)
	  END IF
	  SET toggle_flag = 1
	END IF

	SET pos_counter = pos_counter + 1
  END WHILE

  DECLARE combined_str AS STRING
  SET combined_str = ""

  DECLARE idx AS INTEGER
  SET idx = 0
  REPEAT
    EXIT WHEN idx = LENGTH OF char_array
    SET combined_str = combined_str + char_array[idx]
    SET idx = idx + 1
  UNTIL FALSE

  IF toggle_flag = 0 THEN
    RETURN REVERSE(combined_str)
  END IF

  RETURN combined_str
END FUNCTION
```