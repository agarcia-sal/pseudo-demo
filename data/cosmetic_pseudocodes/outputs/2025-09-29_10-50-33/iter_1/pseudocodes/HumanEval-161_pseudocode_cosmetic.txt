```
FUNCTION solve(string_input)
    flag <- false
    new_chars <- array()
    FOR i FROM 0 TO LENGTH(string_input) - 1
        current_char <- string_input[i]
        IF current_char IS LETTER
            IF current_char IS UPPERCASE
                new_chars[i] <- TO_LOWERCASE(current_char)
            ELSE
                new_chars[i] <- TO_UPPERCASE(current_char)
            END IF
            flag <- true
        ELSE
            new_chars[i] <- current_char
        END IF
    END FOR

    result <- ""
    FOR ch IN new_chars
        result <- result + ch
    END FOR

    IF NOT flag THEN
        reversed_result <- ""
        FOR j FROM LENGTH(result) DOWNTO 1
            reversed_result <- reversed_result + result[j - 1]
        END FOR
        RETURN reversed_result
    ELSE
        RETURN result
    END IF
END FUNCTION
```