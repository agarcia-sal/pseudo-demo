FUNCTION sum_squares(array_of_numbers)
    INITIALIZE accumulated_values AS new sequence
    SET position TO 0
    PERFORM WHILE position IS LESS THAN SIZE OF array_of_numbers
        SET divisible_by_three TO (position REMAINDER 3 EQUALS 0)
        SET divisible_by_four TO (position REMAINDER 4 EQUALS 0)
        IF divisible_by_three
            ADD (array_of_numbers AT position) TO THE POWER 2 TO accumulated_values
        OTHERWISE IF divisible_by_four AND NOT divisible_by_three
            ADD (array_of_numbers AT position) TO THE POWER 3 TO accumulated_values
        OTHERWISE
            ADD (array_of_numbers AT position) TO accumulated_values
        INCREMENT position BY 1
    CALCULATE total_sum AS ZERO
    USING element IN accumulated_values
        INCREASE total_sum BY element
    RETURN total_sum
END FUNCTION