FUNCTION fix_spaces(text)
  FUNCTION process_gap(size, output_acc)
    IF NOT (size <= 2)
      output_acc = output_acc + "-"
    ELSE IF size > 0
      output_acc = output_acc + repeat("_", size)
    END IF
    RETURN output_acc
  END FUNCTION

  FUNCTION loop_over(index, gap_start, gap_end, result)
    IF NOT (index < length(text))
      size_gap = gap_end - gap_start
      RETURN process_gap(size_gap, result)
    ELSE
      current_char = text[index]
      IF current_char = " "
        RETURN loop_over(index + 1, gap_start, gap_end + 1, result)
      ELSE
        gap_size = gap_end - gap_start
        updated_result = process_gap(gap_size, result) + current_char
        RETURN loop_over(index + 1, index + 1, index + 1, updated_result)
      END IF
    END IF
  END FUNCTION

  RETURN loop_over(0, 0, 0, "")
END FUNCTION