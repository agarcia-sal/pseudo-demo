FUNCTION sum_squares(list_of_integers)  
    INITIALIZE aggregation AS new empty collection  
    DEFINE PROCEDURE process_element(current_position)  
        IF NOT (NOT (current_position MOD 3 = 0)) THEN  
            EXECUTE aggregation APPEND (list_of_integers[current_position] ^ 2)  
        ELSE  
            IF (current_position MOD 4 = 0) AND NOT (current_position MOD 3 = 0) THEN  
                EXECUTE aggregation APPEND (list_of_integers[current_position] ^ 3)  
            ELSE  
                EXECUTE aggregation APPEND list_of_integers[current_position]  
            END IF  
        END IF  
    END PROCEDURE  
  
    DECLARE cursor ASSIGN 0  
    WHILE cursor < LENGTH(list_of_integers) DO  
        EXECUTE process_element(cursor)  
        INCREMENT cursor BY 1  
    END WHILE  
  
    INVOKE RETURN WITH the result of REDUCE aggregation BY addition OPERATOR WITH initial value 0  
END FUNCTION