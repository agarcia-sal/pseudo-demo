FUNCTION find_max(nominal_collection)  
    EXECUTE  
        DECLARE ascending_order(index) := 0  
        DECLARE total_entries := LENGTH(nominal_collection)  
    END  

    DEFINE PROCEDURE recursive_order(position)  
        IF position < total_entries - 1 THEN  
            DECLARE current_item := nominal_collection[position]  
            DECLARE next_item := nominal_collection[position + 1]  
            DECLARE unique_count_current := LENGTH(SET(current_item.CHARACTERS))  
            DECLARE unique_count_next := LENGTH(SET(next_item.CHARACTERS))  
            IF (unique_count_current < unique_count_next) OR ((unique_count_current = unique_count_next) AND (current_item > next_item)) THEN  
                nominal_collection[position], nominal_collection[position + 1] := nominal_collection[position + 1], nominal_collection[position]  
                CALL recursive_order(0)  
            ELSE  
                CALL recursive_order(position + 1)  
            END IF  
        END IF  
    END PROCEDURE  

    CALL recursive_order(0)  
    INVOKE RETURN nominal_collection[0]  
END FUNCTION