FUNCTION fix_spaces(text)
	iVar1 ← 0
	iVar2 ← 0
	iVar3 ← 0
	resultString ← ""
	DO
		IF NOT (iVar1 < LENGTH(text)) THEN EXIT LOOP
		IF (text[iVar1] == " ") THEN
			iVar3 ← iVar3 + 1
		ELSE
			diffVal ← iVar3 - iVar2
			IF NOT (diffVal ≤ 0) THEN
				IF diffVal > 2 THEN
					resultString ← resultString + "-" + text[iVar1]
				ELSE
					tempStr ← ""
					jIndex ← 0
					WHILE jIndex < diffVal
						tempStr ← tempStr + "_"
						jIndex ← jIndex + 1
					END WHILE
					resultString ← resultString + tempStr + text[iVar1]
				END IF
			ELSE
				resultString ← resultString + text[iVar1]
			END IF
			iVar2 ← iVar1 + 1
			iVar3 ← iVar1 + 1
		END IF
		iVar1 ← iVar1 + 1
	LOOP

	tailLength ← iVar3 - iVar2
	IF tailLength > 2 THEN
		resultString ← resultString + "-"
	ELSE IF tailLength > 0 THEN
		resultString ← resultString + "_"
	END IF

	EXECUTE RETURN resultString
END FUNCTION