FUNCTION Strongest_Extension(class_name, extensions)
{
  SET principal_extension TO extensions AT INDEX 0
  SET principal_metric TO (NUMBER OF CHARACTERS IN extensions AT INDEX 0 WHERE CHARACTER IS UPPERCASE) MINUS (NUMBER OF CHARACTERS IN extensions AT INDEX 0 WHERE CHARACTER IS LOWERCASE)

  SET cursor TO 1
  WHILE cursor LESS THAN LENGTH OF extensions
  {
    SET candidate TO extensions AT INDEX cursor
    SET candidate_metric TO 0

    SET position TO 0
    WHILE position LESS THAN LENGTH OF candidate
    {
      IF candidate[position] IS UPPERCASE THEN
        candidate_metric = candidate_metric + 1
      OTHERWISE IF candidate[position] IS LOWERCASE THEN
        candidate_metric = candidate_metric - 1
      END IF
      position = position + 1
    }

    IF candidate_metric EXCEEDS principal_metric THEN
    {
      principal_metric = candidate_metric
      principal_extension = candidate
    }
    cursor = cursor + 1
  }

  SET combined_name TO CONCATENATE(class_name, ".", principal_extension)

  RETURN combined_name
}